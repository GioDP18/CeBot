function CO(e,t){for(var r=0;r<t.length;r++){const l=t[r];if(typeof l!="string"&&!Array.isArray(l)){for(const h in l)if(h!=="default"&&!(h in e)){const m=Object.getOwnPropertyDescriptor(l,h);m&&Object.defineProperty(e,h,m.get?m:{enumerable:!0,get:()=>l[h]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))l(h);new MutationObserver(h=>{for(const m of h)if(m.type==="childList")for(const x of m.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&l(x)}).observe(document,{childList:!0,subtree:!0});function r(h){const m={};return h.integrity&&(m.integrity=h.integrity),h.referrerPolicy&&(m.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?m.credentials="include":h.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function l(h){if(h.ep)return;h.ep=!0;const m=r(h);fetch(h.href,m)}})();var kO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function l2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function cc(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function l(){return this instanceof l?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(l){var h=Object.getOwnPropertyDescriptor(e,l);Object.defineProperty(r,l,h.get?h:{enumerable:!0,get:function(){return e[l]}})}),r}var XA={exports:{}},S0={},KA={exports:{}},Tn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fm=Symbol.for("react.element"),IO=Symbol.for("react.portal"),AO=Symbol.for("react.fragment"),MO=Symbol.for("react.strict_mode"),PO=Symbol.for("react.profiler"),RO=Symbol.for("react.provider"),zO=Symbol.for("react.context"),LO=Symbol.for("react.forward_ref"),DO=Symbol.for("react.suspense"),OO=Symbol.for("react.memo"),BO=Symbol.for("react.lazy"),LC=Symbol.iterator;function FO(e){return e===null||typeof e!="object"?null:(e=LC&&e[LC]||e["@@iterator"],typeof e=="function"?e:null)}var YA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},JA=Object.assign,QA={};function kh(e,t,r){this.props=e,this.context=t,this.refs=QA,this.updater=r||YA}kh.prototype.isReactComponent={};kh.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};kh.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function eM(){}eM.prototype=kh.prototype;function c2(e,t,r){this.props=e,this.context=t,this.refs=QA,this.updater=r||YA}var u2=c2.prototype=new eM;u2.constructor=c2;JA(u2,kh.prototype);u2.isPureReactComponent=!0;var DC=Array.isArray,tM=Object.prototype.hasOwnProperty,d2={current:null},nM={key:!0,ref:!0,__self:!0,__source:!0};function rM(e,t,r){var l,h={},m=null,x=null;if(t!=null)for(l in t.ref!==void 0&&(x=t.ref),t.key!==void 0&&(m=""+t.key),t)tM.call(t,l)&&!nM.hasOwnProperty(l)&&(h[l]=t[l]);var a=arguments.length-2;if(a===1)h.children=r;else if(1<a){for(var E=Array(a),I=0;I<a;I++)E[I]=arguments[I+2];h.children=E}if(e&&e.defaultProps)for(l in a=e.defaultProps,a)h[l]===void 0&&(h[l]=a[l]);return{$$typeof:Fm,type:e,key:m,ref:x,props:h,_owner:d2.current}}function jO(e,t){return{$$typeof:Fm,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function h2(e){return typeof e=="object"&&e!==null&&e.$$typeof===Fm}function NO(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var OC=/\/+/g;function P1(e,t){return typeof e=="object"&&e!==null&&e.key!=null?NO(""+e.key):t.toString(36)}function e_(e,t,r,l,h){var m=typeof e;(m==="undefined"||m==="boolean")&&(e=null);var x=!1;if(e===null)x=!0;else switch(m){case"string":case"number":x=!0;break;case"object":switch(e.$$typeof){case Fm:case IO:x=!0}}if(x)return x=e,h=h(x),e=l===""?"."+P1(x,0):l,DC(h)?(r="",e!=null&&(r=e.replace(OC,"$&/")+"/"),e_(h,t,r,"",function(I){return I})):h!=null&&(h2(h)&&(h=jO(h,r+(!h.key||x&&x.key===h.key?"":(""+h.key).replace(OC,"$&/")+"/")+e)),t.push(h)),1;if(x=0,l=l===""?".":l+":",DC(e))for(var a=0;a<e.length;a++){m=e[a];var E=l+P1(m,a);x+=e_(m,t,r,E,h)}else if(E=FO(e),typeof E=="function")for(e=E.call(e),a=0;!(m=e.next()).done;)m=m.value,E=l+P1(m,a++),x+=e_(m,t,r,E,h);else if(m==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return x}function Iy(e,t,r){if(e==null)return e;var l=[],h=0;return e_(e,l,"","",function(m){return t.call(r,m,h++)}),l}function $O(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var oo={current:null},t_={transition:null},UO={ReactCurrentDispatcher:oo,ReactCurrentBatchConfig:t_,ReactCurrentOwner:d2};function iM(){throw Error("act(...) is not supported in production builds of React.")}Tn.Children={map:Iy,forEach:function(e,t,r){Iy(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Iy(e,function(){t++}),t},toArray:function(e){return Iy(e,function(t){return t})||[]},only:function(e){if(!h2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Tn.Component=kh;Tn.Fragment=AO;Tn.Profiler=PO;Tn.PureComponent=c2;Tn.StrictMode=MO;Tn.Suspense=DO;Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UO;Tn.act=iM;Tn.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var l=JA({},e.props),h=e.key,m=e.ref,x=e._owner;if(t!=null){if(t.ref!==void 0&&(m=t.ref,x=d2.current),t.key!==void 0&&(h=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(E in t)tM.call(t,E)&&!nM.hasOwnProperty(E)&&(l[E]=t[E]===void 0&&a!==void 0?a[E]:t[E])}var E=arguments.length-2;if(E===1)l.children=r;else if(1<E){a=Array(E);for(var I=0;I<E;I++)a[I]=arguments[I+2];l.children=a}return{$$typeof:Fm,type:e.type,key:h,ref:m,props:l,_owner:x}};Tn.createContext=function(e){return e={$$typeof:zO,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:RO,_context:e},e.Consumer=e};Tn.createElement=rM;Tn.createFactory=function(e){var t=rM.bind(null,e);return t.type=e,t};Tn.createRef=function(){return{current:null}};Tn.forwardRef=function(e){return{$$typeof:LO,render:e}};Tn.isValidElement=h2;Tn.lazy=function(e){return{$$typeof:BO,_payload:{_status:-1,_result:e},_init:$O}};Tn.memo=function(e,t){return{$$typeof:OO,type:e,compare:t===void 0?null:t}};Tn.startTransition=function(e){var t=t_.transition;t_.transition={};try{e()}finally{t_.transition=t}};Tn.unstable_act=iM;Tn.useCallback=function(e,t){return oo.current.useCallback(e,t)};Tn.useContext=function(e){return oo.current.useContext(e)};Tn.useDebugValue=function(){};Tn.useDeferredValue=function(e){return oo.current.useDeferredValue(e)};Tn.useEffect=function(e,t){return oo.current.useEffect(e,t)};Tn.useId=function(){return oo.current.useId()};Tn.useImperativeHandle=function(e,t,r){return oo.current.useImperativeHandle(e,t,r)};Tn.useInsertionEffect=function(e,t){return oo.current.useInsertionEffect(e,t)};Tn.useLayoutEffect=function(e,t){return oo.current.useLayoutEffect(e,t)};Tn.useMemo=function(e,t){return oo.current.useMemo(e,t)};Tn.useReducer=function(e,t,r){return oo.current.useReducer(e,t,r)};Tn.useRef=function(e){return oo.current.useRef(e)};Tn.useState=function(e){return oo.current.useState(e)};Tn.useSyncExternalStore=function(e,t,r){return oo.current.useSyncExternalStore(e,t,r)};Tn.useTransition=function(){return oo.current.useTransition()};Tn.version="18.3.1";KA.exports=Tn;var J=KA.exports;const Do=l2(J),am=CO({__proto__:null,default:Do},[J]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VO=J,WO=Symbol.for("react.element"),GO=Symbol.for("react.fragment"),qO=Object.prototype.hasOwnProperty,HO=VO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ZO={key:!0,ref:!0,__self:!0,__source:!0};function oM(e,t,r){var l,h={},m=null,x=null;r!==void 0&&(m=""+r),t.key!==void 0&&(m=""+t.key),t.ref!==void 0&&(x=t.ref);for(l in t)qO.call(t,l)&&!ZO.hasOwnProperty(l)&&(h[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps,t)h[l]===void 0&&(h[l]=t[l]);return{$$typeof:WO,type:e,key:m,ref:x,props:h,_owner:HO.current}}S0.Fragment=GO;S0.jsx=oM;S0.jsxs=oM;XA.exports=S0;var D=XA.exports,Ob={},sM={exports:{}},Vo={},aM={exports:{}},lM={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Re,ct){var Ie=Re.length;Re.push(ct);e:for(;0<Ie;){var st=Ie-1>>>1,Tt=Re[st];if(0<h(Tt,ct))Re[st]=ct,Re[Ie]=Tt,Ie=st;else break e}}function r(Re){return Re.length===0?null:Re[0]}function l(Re){if(Re.length===0)return null;var ct=Re[0],Ie=Re.pop();if(Ie!==ct){Re[0]=Ie;e:for(var st=0,Tt=Re.length,zt=Tt>>>1;st<zt;){var Nt=2*(st+1)-1,en=Re[Nt],Zt=Nt+1,Mn=Re[Zt];if(0>h(en,Ie))Zt<Tt&&0>h(Mn,en)?(Re[st]=Mn,Re[Zt]=Ie,st=Zt):(Re[st]=en,Re[Nt]=Ie,st=Nt);else if(Zt<Tt&&0>h(Mn,Ie))Re[st]=Mn,Re[Zt]=Ie,st=Zt;else break e}}return ct}function h(Re,ct){var Ie=Re.sortIndex-ct.sortIndex;return Ie!==0?Ie:Re.id-ct.id}if(typeof performance=="object"&&typeof performance.now=="function"){var m=performance;e.unstable_now=function(){return m.now()}}else{var x=Date,a=x.now();e.unstable_now=function(){return x.now()-a}}var E=[],I=[],L=1,O=null,F=3,K=!1,W=!1,G=!1,ne=typeof setTimeout=="function"?setTimeout:null,Z=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function V(Re){for(var ct=r(I);ct!==null;){if(ct.callback===null)l(I);else if(ct.startTime<=Re)l(I),ct.sortIndex=ct.expirationTime,t(E,ct);else break;ct=r(I)}}function oe(Re){if(G=!1,V(Re),!W)if(r(E)!==null)W=!0,St(pe);else{var ct=r(I);ct!==null&&It(oe,ct.startTime-Re)}}function pe(Re,ct){W=!1,G&&(G=!1,Z(De),De=-1),K=!0;var Ie=F;try{for(V(ct),O=r(E);O!==null&&(!(O.expirationTime>ct)||Re&&!ft());){var st=O.callback;if(typeof st=="function"){O.callback=null,F=O.priorityLevel;var Tt=st(O.expirationTime<=ct);ct=e.unstable_now(),typeof Tt=="function"?O.callback=Tt:O===r(E)&&l(E),V(ct)}else l(E);O=r(E)}if(O!==null)var zt=!0;else{var Nt=r(I);Nt!==null&&It(oe,Nt.startTime-ct),zt=!1}return zt}finally{O=null,F=Ie,K=!1}}var _e=!1,xe=null,De=-1,ye=5,Ae=-1;function ft(){return!(e.unstable_now()-Ae<ye)}function Ge(){if(xe!==null){var Re=e.unstable_now();Ae=Re;var ct=!0;try{ct=xe(!0,Re)}finally{ct?et():(_e=!1,xe=null)}}else _e=!1}var et;if(typeof H=="function")et=function(){H(Ge)};else if(typeof MessageChannel<"u"){var lt=new MessageChannel,gt=lt.port2;lt.port1.onmessage=Ge,et=function(){gt.postMessage(null)}}else et=function(){ne(Ge,0)};function St(Re){xe=Re,_e||(_e=!0,et())}function It(Re,ct){De=ne(function(){Re(e.unstable_now())},ct)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Re){Re.callback=null},e.unstable_continueExecution=function(){W||K||(W=!0,St(pe))},e.unstable_forceFrameRate=function(Re){0>Re||125<Re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ye=0<Re?Math.floor(1e3/Re):5},e.unstable_getCurrentPriorityLevel=function(){return F},e.unstable_getFirstCallbackNode=function(){return r(E)},e.unstable_next=function(Re){switch(F){case 1:case 2:case 3:var ct=3;break;default:ct=F}var Ie=F;F=ct;try{return Re()}finally{F=Ie}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Re,ct){switch(Re){case 1:case 2:case 3:case 4:case 5:break;default:Re=3}var Ie=F;F=Re;try{return ct()}finally{F=Ie}},e.unstable_scheduleCallback=function(Re,ct,Ie){var st=e.unstable_now();switch(typeof Ie=="object"&&Ie!==null?(Ie=Ie.delay,Ie=typeof Ie=="number"&&0<Ie?st+Ie:st):Ie=st,Re){case 1:var Tt=-1;break;case 2:Tt=250;break;case 5:Tt=1073741823;break;case 4:Tt=1e4;break;default:Tt=5e3}return Tt=Ie+Tt,Re={id:L++,callback:ct,priorityLevel:Re,startTime:Ie,expirationTime:Tt,sortIndex:-1},Ie>st?(Re.sortIndex=Ie,t(I,Re),r(E)===null&&Re===r(I)&&(G?(Z(De),De=-1):G=!0,It(oe,Ie-st))):(Re.sortIndex=Tt,t(E,Re),W||K||(W=!0,St(pe))),Re},e.unstable_shouldYield=ft,e.unstable_wrapCallback=function(Re){var ct=F;return function(){var Ie=F;F=ct;try{return Re.apply(this,arguments)}finally{F=Ie}}}})(lM);aM.exports=lM;var XO=aM.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KO=J,$o=XO;function _t(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cM=new Set,lm={};function Cu(e,t){uh(e,t),uh(e+"Capture",t)}function uh(e,t){for(lm[e]=t,e=0;e<t.length;e++)cM.add(t[e])}var Xa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bb=Object.prototype.hasOwnProperty,YO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,BC={},FC={};function JO(e){return Bb.call(FC,e)?!0:Bb.call(BC,e)?!1:YO.test(e)?FC[e]=!0:(BC[e]=!0,!1)}function QO(e,t,r,l){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return l?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function e5(e,t,r,l){if(t===null||typeof t>"u"||QO(e,t,r,l))return!0;if(l)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function so(e,t,r,l,h,m,x){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=l,this.attributeNamespace=h,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=m,this.removeEmptyString=x}var Li={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Li[e]=new so(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Li[t]=new so(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Li[e]=new so(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Li[e]=new so(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Li[e]=new so(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Li[e]=new so(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Li[e]=new so(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Li[e]=new so(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Li[e]=new so(e,5,!1,e.toLowerCase(),null,!1,!1)});var p2=/[\-:]([a-z])/g;function f2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(p2,f2);Li[t]=new so(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(p2,f2);Li[t]=new so(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(p2,f2);Li[t]=new so(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Li[e]=new so(e,1,!1,e.toLowerCase(),null,!1,!1)});Li.xlinkHref=new so("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Li[e]=new so(e,1,!1,e.toLowerCase(),null,!0,!0)});function m2(e,t,r,l){var h=Li.hasOwnProperty(t)?Li[t]:null;(h!==null?h.type!==0:l||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(e5(t,r,h,l)&&(r=null),l||h===null?JO(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):h.mustUseProperty?e[h.propertyName]=r===null?h.type===3?!1:"":r:(t=h.attributeName,l=h.attributeNamespace,r===null?e.removeAttribute(t):(h=h.type,r=h===3||h===4&&r===!0?"":""+r,l?e.setAttributeNS(l,t,r):e.setAttribute(t,r))))}var el=KO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ay=Symbol.for("react.element"),Fd=Symbol.for("react.portal"),jd=Symbol.for("react.fragment"),g2=Symbol.for("react.strict_mode"),Fb=Symbol.for("react.profiler"),uM=Symbol.for("react.provider"),dM=Symbol.for("react.context"),y2=Symbol.for("react.forward_ref"),jb=Symbol.for("react.suspense"),Nb=Symbol.for("react.suspense_list"),_2=Symbol.for("react.memo"),Ol=Symbol.for("react.lazy"),hM=Symbol.for("react.offscreen"),jC=Symbol.iterator;function vf(e){return e===null||typeof e!="object"?null:(e=jC&&e[jC]||e["@@iterator"],typeof e=="function"?e:null)}var Vr=Object.assign,R1;function Bf(e){if(R1===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);R1=t&&t[1]||""}return`
`+R1+e}var z1=!1;function L1(e,t){if(!e||z1)return"";z1=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(I){var l=I}Reflect.construct(e,[],t)}else{try{t.call()}catch(I){l=I}e.call(t.prototype)}else{try{throw Error()}catch(I){l=I}e()}}catch(I){if(I&&l&&typeof I.stack=="string"){for(var h=I.stack.split(`
`),m=l.stack.split(`
`),x=h.length-1,a=m.length-1;1<=x&&0<=a&&h[x]!==m[a];)a--;for(;1<=x&&0<=a;x--,a--)if(h[x]!==m[a]){if(x!==1||a!==1)do if(x--,a--,0>a||h[x]!==m[a]){var E=`
`+h[x].replace(" at new "," at ");return e.displayName&&E.includes("<anonymous>")&&(E=E.replace("<anonymous>",e.displayName)),E}while(1<=x&&0<=a);break}}}finally{z1=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Bf(e):""}function t5(e){switch(e.tag){case 5:return Bf(e.type);case 16:return Bf("Lazy");case 13:return Bf("Suspense");case 19:return Bf("SuspenseList");case 0:case 2:case 15:return e=L1(e.type,!1),e;case 11:return e=L1(e.type.render,!1),e;case 1:return e=L1(e.type,!0),e;default:return""}}function $b(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case jd:return"Fragment";case Fd:return"Portal";case Fb:return"Profiler";case g2:return"StrictMode";case jb:return"Suspense";case Nb:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case dM:return(e.displayName||"Context")+".Consumer";case uM:return(e._context.displayName||"Context")+".Provider";case y2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case _2:return t=e.displayName||null,t!==null?t:$b(e.type)||"Memo";case Ol:t=e._payload,e=e._init;try{return $b(e(t))}catch{}}return null}function n5(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $b(t);case 8:return t===g2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ic(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function pM(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function r5(e){var t=pM(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),l=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var h=r.get,m=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return h.call(this)},set:function(x){l=""+x,m.call(this,x)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return l},setValue:function(x){l=""+x},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function My(e){e._valueTracker||(e._valueTracker=r5(e))}function fM(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),l="";return e&&(l=pM(e)?e.checked?"true":"false":e.value),e=l,e!==r?(t.setValue(e),!0):!1}function P_(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ub(e,t){var r=t.checked;return Vr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function NC(e,t){var r=t.defaultValue==null?"":t.defaultValue,l=t.checked!=null?t.checked:t.defaultChecked;r=ic(t.value!=null?t.value:r),e._wrapperState={initialChecked:l,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function mM(e,t){t=t.checked,t!=null&&m2(e,"checked",t,!1)}function Vb(e,t){mM(e,t);var r=ic(t.value),l=t.type;if(r!=null)l==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Wb(e,t.type,r):t.hasOwnProperty("defaultValue")&&Wb(e,t.type,ic(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function $C(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var l=t.type;if(!(l!=="submit"&&l!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Wb(e,t,r){(t!=="number"||P_(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ff=Array.isArray;function Yd(e,t,r,l){if(e=e.options,t){t={};for(var h=0;h<r.length;h++)t["$"+r[h]]=!0;for(r=0;r<e.length;r++)h=t.hasOwnProperty("$"+e[r].value),e[r].selected!==h&&(e[r].selected=h),h&&l&&(e[r].defaultSelected=!0)}else{for(r=""+ic(r),t=null,h=0;h<e.length;h++){if(e[h].value===r){e[h].selected=!0,l&&(e[h].defaultSelected=!0);return}t!==null||e[h].disabled||(t=e[h])}t!==null&&(t.selected=!0)}}function Gb(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(_t(91));return Vr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function UC(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(_t(92));if(Ff(r)){if(1<r.length)throw Error(_t(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ic(r)}}function gM(e,t){var r=ic(t.value),l=ic(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),l!=null&&(e.defaultValue=""+l)}function VC(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function yM(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qb(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?yM(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Py,_M=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,l,h){MSApp.execUnsafeLocalFunction(function(){return e(t,r,l,h)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Py=Py||document.createElement("div"),Py.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Py.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function cm(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Hf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},i5=["Webkit","ms","Moz","O"];Object.keys(Hf).forEach(function(e){i5.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Hf[t]=Hf[e]})});function xM(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Hf.hasOwnProperty(e)&&Hf[e]?(""+t).trim():t+"px"}function vM(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var l=r.indexOf("--")===0,h=xM(r,t[r],l);r==="float"&&(r="cssFloat"),l?e.setProperty(r,h):e[r]=h}}var o5=Vr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Hb(e,t){if(t){if(o5[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(_t(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(_t(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(_t(61))}if(t.style!=null&&typeof t.style!="object")throw Error(_t(62))}}function Zb(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xb=null;function x2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Kb=null,Jd=null,Qd=null;function WC(e){if(e=$m(e)){if(typeof Kb!="function")throw Error(_t(280));var t=e.stateNode;t&&(t=I0(t),Kb(e.stateNode,e.type,t))}}function bM(e){Jd?Qd?Qd.push(e):Qd=[e]:Jd=e}function wM(){if(Jd){var e=Jd,t=Qd;if(Qd=Jd=null,WC(e),t)for(e=0;e<t.length;e++)WC(t[e])}}function SM(e,t){return e(t)}function EM(){}var D1=!1;function TM(e,t,r){if(D1)return e(t,r);D1=!0;try{return SM(e,t,r)}finally{D1=!1,(Jd!==null||Qd!==null)&&(EM(),wM())}}function um(e,t){var r=e.stateNode;if(r===null)return null;var l=I0(r);if(l===null)return null;r=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(_t(231,t,typeof r));return r}var Yb=!1;if(Xa)try{var bf={};Object.defineProperty(bf,"passive",{get:function(){Yb=!0}}),window.addEventListener("test",bf,bf),window.removeEventListener("test",bf,bf)}catch{Yb=!1}function s5(e,t,r,l,h,m,x,a,E){var I=Array.prototype.slice.call(arguments,3);try{t.apply(r,I)}catch(L){this.onError(L)}}var Zf=!1,R_=null,z_=!1,Jb=null,a5={onError:function(e){Zf=!0,R_=e}};function l5(e,t,r,l,h,m,x,a,E){Zf=!1,R_=null,s5.apply(a5,arguments)}function c5(e,t,r,l,h,m,x,a,E){if(l5.apply(this,arguments),Zf){if(Zf){var I=R_;Zf=!1,R_=null}else throw Error(_t(198));z_||(z_=!0,Jb=I)}}function ku(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function CM(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function GC(e){if(ku(e)!==e)throw Error(_t(188))}function u5(e){var t=e.alternate;if(!t){if(t=ku(e),t===null)throw Error(_t(188));return t!==e?null:e}for(var r=e,l=t;;){var h=r.return;if(h===null)break;var m=h.alternate;if(m===null){if(l=h.return,l!==null){r=l;continue}break}if(h.child===m.child){for(m=h.child;m;){if(m===r)return GC(h),e;if(m===l)return GC(h),t;m=m.sibling}throw Error(_t(188))}if(r.return!==l.return)r=h,l=m;else{for(var x=!1,a=h.child;a;){if(a===r){x=!0,r=h,l=m;break}if(a===l){x=!0,l=h,r=m;break}a=a.sibling}if(!x){for(a=m.child;a;){if(a===r){x=!0,r=m,l=h;break}if(a===l){x=!0,l=m,r=h;break}a=a.sibling}if(!x)throw Error(_t(189))}}if(r.alternate!==l)throw Error(_t(190))}if(r.tag!==3)throw Error(_t(188));return r.stateNode.current===r?e:t}function kM(e){return e=u5(e),e!==null?IM(e):null}function IM(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=IM(e);if(t!==null)return t;e=e.sibling}return null}var AM=$o.unstable_scheduleCallback,qC=$o.unstable_cancelCallback,d5=$o.unstable_shouldYield,h5=$o.unstable_requestPaint,Kr=$o.unstable_now,p5=$o.unstable_getCurrentPriorityLevel,v2=$o.unstable_ImmediatePriority,MM=$o.unstable_UserBlockingPriority,L_=$o.unstable_NormalPriority,f5=$o.unstable_LowPriority,PM=$o.unstable_IdlePriority,E0=null,ya=null;function m5(e){if(ya&&typeof ya.onCommitFiberRoot=="function")try{ya.onCommitFiberRoot(E0,e,void 0,(e.current.flags&128)===128)}catch{}}var Hs=Math.clz32?Math.clz32:_5,g5=Math.log,y5=Math.LN2;function _5(e){return e>>>=0,e===0?32:31-(g5(e)/y5|0)|0}var Ry=64,zy=4194304;function jf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function D_(e,t){var r=e.pendingLanes;if(r===0)return 0;var l=0,h=e.suspendedLanes,m=e.pingedLanes,x=r&268435455;if(x!==0){var a=x&~h;a!==0?l=jf(a):(m&=x,m!==0&&(l=jf(m)))}else x=r&~h,x!==0?l=jf(x):m!==0&&(l=jf(m));if(l===0)return 0;if(t!==0&&t!==l&&!(t&h)&&(h=l&-l,m=t&-t,h>=m||h===16&&(m&4194240)!==0))return t;if(l&4&&(l|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=l;0<t;)r=31-Hs(t),h=1<<r,l|=e[r],t&=~h;return l}function x5(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function v5(e,t){for(var r=e.suspendedLanes,l=e.pingedLanes,h=e.expirationTimes,m=e.pendingLanes;0<m;){var x=31-Hs(m),a=1<<x,E=h[x];E===-1?(!(a&r)||a&l)&&(h[x]=x5(a,t)):E<=t&&(e.expiredLanes|=a),m&=~a}}function Qb(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function RM(){var e=Ry;return Ry<<=1,!(Ry&4194240)&&(Ry=64),e}function O1(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function jm(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Hs(t),e[t]=r}function b5(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<r;){var h=31-Hs(r),m=1<<h;t[h]=0,l[h]=-1,e[h]=-1,r&=~m}}function b2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var l=31-Hs(r),h=1<<l;h&t|e[l]&t&&(e[l]|=t),r&=~h}}var nr=0;function zM(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var LM,w2,DM,OM,BM,ew=!1,Ly=[],Gl=null,ql=null,Hl=null,dm=new Map,hm=new Map,Fl=[],w5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function HC(e,t){switch(e){case"focusin":case"focusout":Gl=null;break;case"dragenter":case"dragleave":ql=null;break;case"mouseover":case"mouseout":Hl=null;break;case"pointerover":case"pointerout":dm.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":hm.delete(t.pointerId)}}function wf(e,t,r,l,h,m){return e===null||e.nativeEvent!==m?(e={blockedOn:t,domEventName:r,eventSystemFlags:l,nativeEvent:m,targetContainers:[h]},t!==null&&(t=$m(t),t!==null&&w2(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,h!==null&&t.indexOf(h)===-1&&t.push(h),e)}function S5(e,t,r,l,h){switch(t){case"focusin":return Gl=wf(Gl,e,t,r,l,h),!0;case"dragenter":return ql=wf(ql,e,t,r,l,h),!0;case"mouseover":return Hl=wf(Hl,e,t,r,l,h),!0;case"pointerover":var m=h.pointerId;return dm.set(m,wf(dm.get(m)||null,e,t,r,l,h)),!0;case"gotpointercapture":return m=h.pointerId,hm.set(m,wf(hm.get(m)||null,e,t,r,l,h)),!0}return!1}function FM(e){var t=au(e.target);if(t!==null){var r=ku(t);if(r!==null){if(t=r.tag,t===13){if(t=CM(r),t!==null){e.blockedOn=t,BM(e.priority,function(){DM(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function n_(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=tw(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var l=new r.constructor(r.type,r);Xb=l,r.target.dispatchEvent(l),Xb=null}else return t=$m(r),t!==null&&w2(t),e.blockedOn=r,!1;t.shift()}return!0}function ZC(e,t,r){n_(e)&&r.delete(t)}function E5(){ew=!1,Gl!==null&&n_(Gl)&&(Gl=null),ql!==null&&n_(ql)&&(ql=null),Hl!==null&&n_(Hl)&&(Hl=null),dm.forEach(ZC),hm.forEach(ZC)}function Sf(e,t){e.blockedOn===t&&(e.blockedOn=null,ew||(ew=!0,$o.unstable_scheduleCallback($o.unstable_NormalPriority,E5)))}function pm(e){function t(h){return Sf(h,e)}if(0<Ly.length){Sf(Ly[0],e);for(var r=1;r<Ly.length;r++){var l=Ly[r];l.blockedOn===e&&(l.blockedOn=null)}}for(Gl!==null&&Sf(Gl,e),ql!==null&&Sf(ql,e),Hl!==null&&Sf(Hl,e),dm.forEach(t),hm.forEach(t),r=0;r<Fl.length;r++)l=Fl[r],l.blockedOn===e&&(l.blockedOn=null);for(;0<Fl.length&&(r=Fl[0],r.blockedOn===null);)FM(r),r.blockedOn===null&&Fl.shift()}var eh=el.ReactCurrentBatchConfig,O_=!0;function T5(e,t,r,l){var h=nr,m=eh.transition;eh.transition=null;try{nr=1,S2(e,t,r,l)}finally{nr=h,eh.transition=m}}function C5(e,t,r,l){var h=nr,m=eh.transition;eh.transition=null;try{nr=4,S2(e,t,r,l)}finally{nr=h,eh.transition=m}}function S2(e,t,r,l){if(O_){var h=tw(e,t,r,l);if(h===null)q1(e,t,l,B_,r),HC(e,l);else if(S5(h,e,t,r,l))l.stopPropagation();else if(HC(e,l),t&4&&-1<w5.indexOf(e)){for(;h!==null;){var m=$m(h);if(m!==null&&LM(m),m=tw(e,t,r,l),m===null&&q1(e,t,l,B_,r),m===h)break;h=m}h!==null&&l.stopPropagation()}else q1(e,t,l,null,r)}}var B_=null;function tw(e,t,r,l){if(B_=null,e=x2(l),e=au(e),e!==null)if(t=ku(e),t===null)e=null;else if(r=t.tag,r===13){if(e=CM(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return B_=e,null}function jM(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(p5()){case v2:return 1;case MM:return 4;case L_:case f5:return 16;case PM:return 536870912;default:return 16}default:return 16}}var Ul=null,E2=null,r_=null;function NM(){if(r_)return r_;var e,t=E2,r=t.length,l,h="value"in Ul?Ul.value:Ul.textContent,m=h.length;for(e=0;e<r&&t[e]===h[e];e++);var x=r-e;for(l=1;l<=x&&t[r-l]===h[m-l];l++);return r_=h.slice(e,1<l?1-l:void 0)}function i_(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Dy(){return!0}function XC(){return!1}function Wo(e){function t(r,l,h,m,x){this._reactName=r,this._targetInst=h,this.type=l,this.nativeEvent=m,this.target=x,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(m):m[a]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Dy:XC,this.isPropagationStopped=XC,this}return Vr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Dy)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Dy)},persist:function(){},isPersistent:Dy}),t}var Ih={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},T2=Wo(Ih),Nm=Vr({},Ih,{view:0,detail:0}),k5=Wo(Nm),B1,F1,Ef,T0=Vr({},Nm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:C2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ef&&(Ef&&e.type==="mousemove"?(B1=e.screenX-Ef.screenX,F1=e.screenY-Ef.screenY):F1=B1=0,Ef=e),B1)},movementY:function(e){return"movementY"in e?e.movementY:F1}}),KC=Wo(T0),I5=Vr({},T0,{dataTransfer:0}),A5=Wo(I5),M5=Vr({},Nm,{relatedTarget:0}),j1=Wo(M5),P5=Vr({},Ih,{animationName:0,elapsedTime:0,pseudoElement:0}),R5=Wo(P5),z5=Vr({},Ih,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),L5=Wo(z5),D5=Vr({},Ih,{data:0}),YC=Wo(D5),O5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},B5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},F5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function j5(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=F5[e])?!!t[e]:!1}function C2(){return j5}var N5=Vr({},Nm,{key:function(e){if(e.key){var t=O5[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=i_(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?B5[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:C2,charCode:function(e){return e.type==="keypress"?i_(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?i_(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),$5=Wo(N5),U5=Vr({},T0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),JC=Wo(U5),V5=Vr({},Nm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:C2}),W5=Wo(V5),G5=Vr({},Ih,{propertyName:0,elapsedTime:0,pseudoElement:0}),q5=Wo(G5),H5=Vr({},T0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Z5=Wo(H5),X5=[9,13,27,32],k2=Xa&&"CompositionEvent"in window,Xf=null;Xa&&"documentMode"in document&&(Xf=document.documentMode);var K5=Xa&&"TextEvent"in window&&!Xf,$M=Xa&&(!k2||Xf&&8<Xf&&11>=Xf),QC=String.fromCharCode(32),ek=!1;function UM(e,t){switch(e){case"keyup":return X5.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function VM(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Nd=!1;function Y5(e,t){switch(e){case"compositionend":return VM(t);case"keypress":return t.which!==32?null:(ek=!0,QC);case"textInput":return e=t.data,e===QC&&ek?null:e;default:return null}}function J5(e,t){if(Nd)return e==="compositionend"||!k2&&UM(e,t)?(e=NM(),r_=E2=Ul=null,Nd=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return $M&&t.locale!=="ko"?null:t.data;default:return null}}var Q5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tk(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Q5[e.type]:t==="textarea"}function WM(e,t,r,l){bM(l),t=F_(t,"onChange"),0<t.length&&(r=new T2("onChange","change",null,r,l),e.push({event:r,listeners:t}))}var Kf=null,fm=null;function eB(e){tP(e,0)}function C0(e){var t=Vd(e);if(fM(t))return e}function tB(e,t){if(e==="change")return t}var GM=!1;if(Xa){var N1;if(Xa){var $1="oninput"in document;if(!$1){var nk=document.createElement("div");nk.setAttribute("oninput","return;"),$1=typeof nk.oninput=="function"}N1=$1}else N1=!1;GM=N1&&(!document.documentMode||9<document.documentMode)}function rk(){Kf&&(Kf.detachEvent("onpropertychange",qM),fm=Kf=null)}function qM(e){if(e.propertyName==="value"&&C0(fm)){var t=[];WM(t,fm,e,x2(e)),TM(eB,t)}}function nB(e,t,r){e==="focusin"?(rk(),Kf=t,fm=r,Kf.attachEvent("onpropertychange",qM)):e==="focusout"&&rk()}function rB(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return C0(fm)}function iB(e,t){if(e==="click")return C0(t)}function oB(e,t){if(e==="input"||e==="change")return C0(t)}function sB(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ks=typeof Object.is=="function"?Object.is:sB;function mm(e,t){if(Ks(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),l=Object.keys(t);if(r.length!==l.length)return!1;for(l=0;l<r.length;l++){var h=r[l];if(!Bb.call(t,h)||!Ks(e[h],t[h]))return!1}return!0}function ik(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ok(e,t){var r=ik(e);e=0;for(var l;r;){if(r.nodeType===3){if(l=e+r.textContent.length,e<=t&&l>=t)return{node:r,offset:t-e};e=l}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ik(r)}}function HM(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?HM(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ZM(){for(var e=window,t=P_();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=P_(e.document)}return t}function I2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function aB(e){var t=ZM(),r=e.focusedElem,l=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&HM(r.ownerDocument.documentElement,r)){if(l!==null&&I2(r)){if(t=l.start,e=l.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var h=r.textContent.length,m=Math.min(l.start,h);l=l.end===void 0?m:Math.min(l.end,h),!e.extend&&m>l&&(h=l,l=m,m=h),h=ok(r,m);var x=ok(r,l);h&&x&&(e.rangeCount!==1||e.anchorNode!==h.node||e.anchorOffset!==h.offset||e.focusNode!==x.node||e.focusOffset!==x.offset)&&(t=t.createRange(),t.setStart(h.node,h.offset),e.removeAllRanges(),m>l?(e.addRange(t),e.extend(x.node,x.offset)):(t.setEnd(x.node,x.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var lB=Xa&&"documentMode"in document&&11>=document.documentMode,$d=null,nw=null,Yf=null,rw=!1;function sk(e,t,r){var l=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;rw||$d==null||$d!==P_(l)||(l=$d,"selectionStart"in l&&I2(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Yf&&mm(Yf,l)||(Yf=l,l=F_(nw,"onSelect"),0<l.length&&(t=new T2("onSelect","select",null,t,r),e.push({event:t,listeners:l}),t.target=$d)))}function Oy(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ud={animationend:Oy("Animation","AnimationEnd"),animationiteration:Oy("Animation","AnimationIteration"),animationstart:Oy("Animation","AnimationStart"),transitionend:Oy("Transition","TransitionEnd")},U1={},XM={};Xa&&(XM=document.createElement("div").style,"AnimationEvent"in window||(delete Ud.animationend.animation,delete Ud.animationiteration.animation,delete Ud.animationstart.animation),"TransitionEvent"in window||delete Ud.transitionend.transition);function k0(e){if(U1[e])return U1[e];if(!Ud[e])return e;var t=Ud[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in XM)return U1[e]=t[r];return e}var KM=k0("animationend"),YM=k0("animationiteration"),JM=k0("animationstart"),QM=k0("transitionend"),eP=new Map,ak="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function uc(e,t){eP.set(e,t),Cu(t,[e])}for(var V1=0;V1<ak.length;V1++){var W1=ak[V1],cB=W1.toLowerCase(),uB=W1[0].toUpperCase()+W1.slice(1);uc(cB,"on"+uB)}uc(KM,"onAnimationEnd");uc(YM,"onAnimationIteration");uc(JM,"onAnimationStart");uc("dblclick","onDoubleClick");uc("focusin","onFocus");uc("focusout","onBlur");uc(QM,"onTransitionEnd");uh("onMouseEnter",["mouseout","mouseover"]);uh("onMouseLeave",["mouseout","mouseover"]);uh("onPointerEnter",["pointerout","pointerover"]);uh("onPointerLeave",["pointerout","pointerover"]);Cu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Cu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Cu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Cu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Cu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Cu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dB=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nf));function lk(e,t,r){var l=e.type||"unknown-event";e.currentTarget=r,c5(l,t,void 0,e),e.currentTarget=null}function tP(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var l=e[r],h=l.event;l=l.listeners;e:{var m=void 0;if(t)for(var x=l.length-1;0<=x;x--){var a=l[x],E=a.instance,I=a.currentTarget;if(a=a.listener,E!==m&&h.isPropagationStopped())break e;lk(h,a,I),m=E}else for(x=0;x<l.length;x++){if(a=l[x],E=a.instance,I=a.currentTarget,a=a.listener,E!==m&&h.isPropagationStopped())break e;lk(h,a,I),m=E}}}if(z_)throw e=Jb,z_=!1,Jb=null,e}function xr(e,t){var r=t[lw];r===void 0&&(r=t[lw]=new Set);var l=e+"__bubble";r.has(l)||(nP(t,e,2,!1),r.add(l))}function G1(e,t,r){var l=0;t&&(l|=4),nP(r,e,l,t)}var By="_reactListening"+Math.random().toString(36).slice(2);function gm(e){if(!e[By]){e[By]=!0,cM.forEach(function(r){r!=="selectionchange"&&(dB.has(r)||G1(r,!1,e),G1(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[By]||(t[By]=!0,G1("selectionchange",!1,t))}}function nP(e,t,r,l){switch(jM(t)){case 1:var h=T5;break;case 4:h=C5;break;default:h=S2}r=h.bind(null,t,r,e),h=void 0,!Yb||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(h=!0),l?h!==void 0?e.addEventListener(t,r,{capture:!0,passive:h}):e.addEventListener(t,r,!0):h!==void 0?e.addEventListener(t,r,{passive:h}):e.addEventListener(t,r,!1)}function q1(e,t,r,l,h){var m=l;if(!(t&1)&&!(t&2)&&l!==null)e:for(;;){if(l===null)return;var x=l.tag;if(x===3||x===4){var a=l.stateNode.containerInfo;if(a===h||a.nodeType===8&&a.parentNode===h)break;if(x===4)for(x=l.return;x!==null;){var E=x.tag;if((E===3||E===4)&&(E=x.stateNode.containerInfo,E===h||E.nodeType===8&&E.parentNode===h))return;x=x.return}for(;a!==null;){if(x=au(a),x===null)return;if(E=x.tag,E===5||E===6){l=m=x;continue e}a=a.parentNode}}l=l.return}TM(function(){var I=m,L=x2(r),O=[];e:{var F=eP.get(e);if(F!==void 0){var K=T2,W=e;switch(e){case"keypress":if(i_(r)===0)break e;case"keydown":case"keyup":K=$5;break;case"focusin":W="focus",K=j1;break;case"focusout":W="blur",K=j1;break;case"beforeblur":case"afterblur":K=j1;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":K=KC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":K=A5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":K=W5;break;case KM:case YM:case JM:K=R5;break;case QM:K=q5;break;case"scroll":K=k5;break;case"wheel":K=Z5;break;case"copy":case"cut":case"paste":K=L5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":K=JC}var G=(t&4)!==0,ne=!G&&e==="scroll",Z=G?F!==null?F+"Capture":null:F;G=[];for(var H=I,V;H!==null;){V=H;var oe=V.stateNode;if(V.tag===5&&oe!==null&&(V=oe,Z!==null&&(oe=um(H,Z),oe!=null&&G.push(ym(H,oe,V)))),ne)break;H=H.return}0<G.length&&(F=new K(F,W,null,r,L),O.push({event:F,listeners:G}))}}if(!(t&7)){e:{if(F=e==="mouseover"||e==="pointerover",K=e==="mouseout"||e==="pointerout",F&&r!==Xb&&(W=r.relatedTarget||r.fromElement)&&(au(W)||W[Ka]))break e;if((K||F)&&(F=L.window===L?L:(F=L.ownerDocument)?F.defaultView||F.parentWindow:window,K?(W=r.relatedTarget||r.toElement,K=I,W=W?au(W):null,W!==null&&(ne=ku(W),W!==ne||W.tag!==5&&W.tag!==6)&&(W=null)):(K=null,W=I),K!==W)){if(G=KC,oe="onMouseLeave",Z="onMouseEnter",H="mouse",(e==="pointerout"||e==="pointerover")&&(G=JC,oe="onPointerLeave",Z="onPointerEnter",H="pointer"),ne=K==null?F:Vd(K),V=W==null?F:Vd(W),F=new G(oe,H+"leave",K,r,L),F.target=ne,F.relatedTarget=V,oe=null,au(L)===I&&(G=new G(Z,H+"enter",W,r,L),G.target=V,G.relatedTarget=ne,oe=G),ne=oe,K&&W)t:{for(G=K,Z=W,H=0,V=G;V;V=Ad(V))H++;for(V=0,oe=Z;oe;oe=Ad(oe))V++;for(;0<H-V;)G=Ad(G),H--;for(;0<V-H;)Z=Ad(Z),V--;for(;H--;){if(G===Z||Z!==null&&G===Z.alternate)break t;G=Ad(G),Z=Ad(Z)}G=null}else G=null;K!==null&&ck(O,F,K,G,!1),W!==null&&ne!==null&&ck(O,ne,W,G,!0)}}e:{if(F=I?Vd(I):window,K=F.nodeName&&F.nodeName.toLowerCase(),K==="select"||K==="input"&&F.type==="file")var pe=tB;else if(tk(F))if(GM)pe=oB;else{pe=rB;var _e=nB}else(K=F.nodeName)&&K.toLowerCase()==="input"&&(F.type==="checkbox"||F.type==="radio")&&(pe=iB);if(pe&&(pe=pe(e,I))){WM(O,pe,r,L);break e}_e&&_e(e,F,I),e==="focusout"&&(_e=F._wrapperState)&&_e.controlled&&F.type==="number"&&Wb(F,"number",F.value)}switch(_e=I?Vd(I):window,e){case"focusin":(tk(_e)||_e.contentEditable==="true")&&($d=_e,nw=I,Yf=null);break;case"focusout":Yf=nw=$d=null;break;case"mousedown":rw=!0;break;case"contextmenu":case"mouseup":case"dragend":rw=!1,sk(O,r,L);break;case"selectionchange":if(lB)break;case"keydown":case"keyup":sk(O,r,L)}var xe;if(k2)e:{switch(e){case"compositionstart":var De="onCompositionStart";break e;case"compositionend":De="onCompositionEnd";break e;case"compositionupdate":De="onCompositionUpdate";break e}De=void 0}else Nd?UM(e,r)&&(De="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(De="onCompositionStart");De&&($M&&r.locale!=="ko"&&(Nd||De!=="onCompositionStart"?De==="onCompositionEnd"&&Nd&&(xe=NM()):(Ul=L,E2="value"in Ul?Ul.value:Ul.textContent,Nd=!0)),_e=F_(I,De),0<_e.length&&(De=new YC(De,e,null,r,L),O.push({event:De,listeners:_e}),xe?De.data=xe:(xe=VM(r),xe!==null&&(De.data=xe)))),(xe=K5?Y5(e,r):J5(e,r))&&(I=F_(I,"onBeforeInput"),0<I.length&&(L=new YC("onBeforeInput","beforeinput",null,r,L),O.push({event:L,listeners:I}),L.data=xe))}tP(O,t)})}function ym(e,t,r){return{instance:e,listener:t,currentTarget:r}}function F_(e,t){for(var r=t+"Capture",l=[];e!==null;){var h=e,m=h.stateNode;h.tag===5&&m!==null&&(h=m,m=um(e,r),m!=null&&l.unshift(ym(e,m,h)),m=um(e,t),m!=null&&l.push(ym(e,m,h))),e=e.return}return l}function Ad(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function ck(e,t,r,l,h){for(var m=t._reactName,x=[];r!==null&&r!==l;){var a=r,E=a.alternate,I=a.stateNode;if(E!==null&&E===l)break;a.tag===5&&I!==null&&(a=I,h?(E=um(r,m),E!=null&&x.unshift(ym(r,E,a))):h||(E=um(r,m),E!=null&&x.push(ym(r,E,a)))),r=r.return}x.length!==0&&e.push({event:t,listeners:x})}var hB=/\r\n?/g,pB=/\u0000|\uFFFD/g;function uk(e){return(typeof e=="string"?e:""+e).replace(hB,`
`).replace(pB,"")}function Fy(e,t,r){if(t=uk(t),uk(e)!==t&&r)throw Error(_t(425))}function j_(){}var iw=null,ow=null;function sw(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var aw=typeof setTimeout=="function"?setTimeout:void 0,fB=typeof clearTimeout=="function"?clearTimeout:void 0,dk=typeof Promise=="function"?Promise:void 0,mB=typeof queueMicrotask=="function"?queueMicrotask:typeof dk<"u"?function(e){return dk.resolve(null).then(e).catch(gB)}:aw;function gB(e){setTimeout(function(){throw e})}function H1(e,t){var r=t,l=0;do{var h=r.nextSibling;if(e.removeChild(r),h&&h.nodeType===8)if(r=h.data,r==="/$"){if(l===0){e.removeChild(h),pm(t);return}l--}else r!=="$"&&r!=="$?"&&r!=="$!"||l++;r=h}while(r);pm(t)}function Zl(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function hk(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ah=Math.random().toString(36).slice(2),ma="__reactFiber$"+Ah,_m="__reactProps$"+Ah,Ka="__reactContainer$"+Ah,lw="__reactEvents$"+Ah,yB="__reactListeners$"+Ah,_B="__reactHandles$"+Ah;function au(e){var t=e[ma];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ka]||r[ma]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=hk(e);e!==null;){if(r=e[ma])return r;e=hk(e)}return t}e=r,r=e.parentNode}return null}function $m(e){return e=e[ma]||e[Ka],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Vd(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(_t(33))}function I0(e){return e[_m]||null}var cw=[],Wd=-1;function dc(e){return{current:e}}function br(e){0>Wd||(e.current=cw[Wd],cw[Wd]=null,Wd--)}function mr(e,t){Wd++,cw[Wd]=e.current,e.current=t}var oc={},Yi=dc(oc),vo=dc(!1),gu=oc;function dh(e,t){var r=e.type.contextTypes;if(!r)return oc;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===t)return l.__reactInternalMemoizedMaskedChildContext;var h={},m;for(m in r)h[m]=t[m];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=h),h}function bo(e){return e=e.childContextTypes,e!=null}function N_(){br(vo),br(Yi)}function pk(e,t,r){if(Yi.current!==oc)throw Error(_t(168));mr(Yi,t),mr(vo,r)}function rP(e,t,r){var l=e.stateNode;if(t=t.childContextTypes,typeof l.getChildContext!="function")return r;l=l.getChildContext();for(var h in l)if(!(h in t))throw Error(_t(108,n5(e)||"Unknown",h));return Vr({},r,l)}function $_(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||oc,gu=Yi.current,mr(Yi,e),mr(vo,vo.current),!0}function fk(e,t,r){var l=e.stateNode;if(!l)throw Error(_t(169));r?(e=rP(e,t,gu),l.__reactInternalMemoizedMergedChildContext=e,br(vo),br(Yi),mr(Yi,e)):br(vo),mr(vo,r)}var $a=null,A0=!1,Z1=!1;function iP(e){$a===null?$a=[e]:$a.push(e)}function xB(e){A0=!0,iP(e)}function hc(){if(!Z1&&$a!==null){Z1=!0;var e=0,t=nr;try{var r=$a;for(nr=1;e<r.length;e++){var l=r[e];do l=l(!0);while(l!==null)}$a=null,A0=!1}catch(h){throw $a!==null&&($a=$a.slice(e+1)),AM(v2,hc),h}finally{nr=t,Z1=!1}}return null}var Gd=[],qd=0,U_=null,V_=0,os=[],ss=0,yu=null,Va=1,Wa="";function nu(e,t){Gd[qd++]=V_,Gd[qd++]=U_,U_=e,V_=t}function oP(e,t,r){os[ss++]=Va,os[ss++]=Wa,os[ss++]=yu,yu=e;var l=Va;e=Wa;var h=32-Hs(l)-1;l&=~(1<<h),r+=1;var m=32-Hs(t)+h;if(30<m){var x=h-h%5;m=(l&(1<<x)-1).toString(32),l>>=x,h-=x,Va=1<<32-Hs(t)+h|r<<h|l,Wa=m+e}else Va=1<<m|r<<h|l,Wa=e}function A2(e){e.return!==null&&(nu(e,1),oP(e,1,0))}function M2(e){for(;e===U_;)U_=Gd[--qd],Gd[qd]=null,V_=Gd[--qd],Gd[qd]=null;for(;e===yu;)yu=os[--ss],os[ss]=null,Wa=os[--ss],os[ss]=null,Va=os[--ss],os[ss]=null}var Bo=null,Oo=null,Ar=!1,Gs=null;function sP(e,t){var r=us(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function mk(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Bo=e,Oo=Zl(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Bo=e,Oo=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=yu!==null?{id:Va,overflow:Wa}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=us(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Bo=e,Oo=null,!0):!1;default:return!1}}function uw(e){return(e.mode&1)!==0&&(e.flags&128)===0}function dw(e){if(Ar){var t=Oo;if(t){var r=t;if(!mk(e,t)){if(uw(e))throw Error(_t(418));t=Zl(r.nextSibling);var l=Bo;t&&mk(e,t)?sP(l,r):(e.flags=e.flags&-4097|2,Ar=!1,Bo=e)}}else{if(uw(e))throw Error(_t(418));e.flags=e.flags&-4097|2,Ar=!1,Bo=e}}}function gk(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Bo=e}function jy(e){if(e!==Bo)return!1;if(!Ar)return gk(e),Ar=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!sw(e.type,e.memoizedProps)),t&&(t=Oo)){if(uw(e))throw aP(),Error(_t(418));for(;t;)sP(e,t),t=Zl(t.nextSibling)}if(gk(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(_t(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Oo=Zl(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Oo=null}}else Oo=Bo?Zl(e.stateNode.nextSibling):null;return!0}function aP(){for(var e=Oo;e;)e=Zl(e.nextSibling)}function hh(){Oo=Bo=null,Ar=!1}function P2(e){Gs===null?Gs=[e]:Gs.push(e)}var vB=el.ReactCurrentBatchConfig;function Tf(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(_t(309));var l=r.stateNode}if(!l)throw Error(_t(147,e));var h=l,m=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===m?t.ref:(t=function(x){var a=h.refs;x===null?delete a[m]:a[m]=x},t._stringRef=m,t)}if(typeof e!="string")throw Error(_t(284));if(!r._owner)throw Error(_t(290,e))}return e}function Ny(e,t){throw e=Object.prototype.toString.call(t),Error(_t(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yk(e){var t=e._init;return t(e._payload)}function lP(e){function t(Z,H){if(e){var V=Z.deletions;V===null?(Z.deletions=[H],Z.flags|=16):V.push(H)}}function r(Z,H){if(!e)return null;for(;H!==null;)t(Z,H),H=H.sibling;return null}function l(Z,H){for(Z=new Map;H!==null;)H.key!==null?Z.set(H.key,H):Z.set(H.index,H),H=H.sibling;return Z}function h(Z,H){return Z=Jl(Z,H),Z.index=0,Z.sibling=null,Z}function m(Z,H,V){return Z.index=V,e?(V=Z.alternate,V!==null?(V=V.index,V<H?(Z.flags|=2,H):V):(Z.flags|=2,H)):(Z.flags|=1048576,H)}function x(Z){return e&&Z.alternate===null&&(Z.flags|=2),Z}function a(Z,H,V,oe){return H===null||H.tag!==6?(H=tb(V,Z.mode,oe),H.return=Z,H):(H=h(H,V),H.return=Z,H)}function E(Z,H,V,oe){var pe=V.type;return pe===jd?L(Z,H,V.props.children,oe,V.key):H!==null&&(H.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===Ol&&yk(pe)===H.type)?(oe=h(H,V.props),oe.ref=Tf(Z,H,V),oe.return=Z,oe):(oe=d_(V.type,V.key,V.props,null,Z.mode,oe),oe.ref=Tf(Z,H,V),oe.return=Z,oe)}function I(Z,H,V,oe){return H===null||H.tag!==4||H.stateNode.containerInfo!==V.containerInfo||H.stateNode.implementation!==V.implementation?(H=nb(V,Z.mode,oe),H.return=Z,H):(H=h(H,V.children||[]),H.return=Z,H)}function L(Z,H,V,oe,pe){return H===null||H.tag!==7?(H=mu(V,Z.mode,oe,pe),H.return=Z,H):(H=h(H,V),H.return=Z,H)}function O(Z,H,V){if(typeof H=="string"&&H!==""||typeof H=="number")return H=tb(""+H,Z.mode,V),H.return=Z,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case Ay:return V=d_(H.type,H.key,H.props,null,Z.mode,V),V.ref=Tf(Z,null,H),V.return=Z,V;case Fd:return H=nb(H,Z.mode,V),H.return=Z,H;case Ol:var oe=H._init;return O(Z,oe(H._payload),V)}if(Ff(H)||vf(H))return H=mu(H,Z.mode,V,null),H.return=Z,H;Ny(Z,H)}return null}function F(Z,H,V,oe){var pe=H!==null?H.key:null;if(typeof V=="string"&&V!==""||typeof V=="number")return pe!==null?null:a(Z,H,""+V,oe);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Ay:return V.key===pe?E(Z,H,V,oe):null;case Fd:return V.key===pe?I(Z,H,V,oe):null;case Ol:return pe=V._init,F(Z,H,pe(V._payload),oe)}if(Ff(V)||vf(V))return pe!==null?null:L(Z,H,V,oe,null);Ny(Z,V)}return null}function K(Z,H,V,oe,pe){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return Z=Z.get(V)||null,a(H,Z,""+oe,pe);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case Ay:return Z=Z.get(oe.key===null?V:oe.key)||null,E(H,Z,oe,pe);case Fd:return Z=Z.get(oe.key===null?V:oe.key)||null,I(H,Z,oe,pe);case Ol:var _e=oe._init;return K(Z,H,V,_e(oe._payload),pe)}if(Ff(oe)||vf(oe))return Z=Z.get(V)||null,L(H,Z,oe,pe,null);Ny(H,oe)}return null}function W(Z,H,V,oe){for(var pe=null,_e=null,xe=H,De=H=0,ye=null;xe!==null&&De<V.length;De++){xe.index>De?(ye=xe,xe=null):ye=xe.sibling;var Ae=F(Z,xe,V[De],oe);if(Ae===null){xe===null&&(xe=ye);break}e&&xe&&Ae.alternate===null&&t(Z,xe),H=m(Ae,H,De),_e===null?pe=Ae:_e.sibling=Ae,_e=Ae,xe=ye}if(De===V.length)return r(Z,xe),Ar&&nu(Z,De),pe;if(xe===null){for(;De<V.length;De++)xe=O(Z,V[De],oe),xe!==null&&(H=m(xe,H,De),_e===null?pe=xe:_e.sibling=xe,_e=xe);return Ar&&nu(Z,De),pe}for(xe=l(Z,xe);De<V.length;De++)ye=K(xe,Z,De,V[De],oe),ye!==null&&(e&&ye.alternate!==null&&xe.delete(ye.key===null?De:ye.key),H=m(ye,H,De),_e===null?pe=ye:_e.sibling=ye,_e=ye);return e&&xe.forEach(function(ft){return t(Z,ft)}),Ar&&nu(Z,De),pe}function G(Z,H,V,oe){var pe=vf(V);if(typeof pe!="function")throw Error(_t(150));if(V=pe.call(V),V==null)throw Error(_t(151));for(var _e=pe=null,xe=H,De=H=0,ye=null,Ae=V.next();xe!==null&&!Ae.done;De++,Ae=V.next()){xe.index>De?(ye=xe,xe=null):ye=xe.sibling;var ft=F(Z,xe,Ae.value,oe);if(ft===null){xe===null&&(xe=ye);break}e&&xe&&ft.alternate===null&&t(Z,xe),H=m(ft,H,De),_e===null?pe=ft:_e.sibling=ft,_e=ft,xe=ye}if(Ae.done)return r(Z,xe),Ar&&nu(Z,De),pe;if(xe===null){for(;!Ae.done;De++,Ae=V.next())Ae=O(Z,Ae.value,oe),Ae!==null&&(H=m(Ae,H,De),_e===null?pe=Ae:_e.sibling=Ae,_e=Ae);return Ar&&nu(Z,De),pe}for(xe=l(Z,xe);!Ae.done;De++,Ae=V.next())Ae=K(xe,Z,De,Ae.value,oe),Ae!==null&&(e&&Ae.alternate!==null&&xe.delete(Ae.key===null?De:Ae.key),H=m(Ae,H,De),_e===null?pe=Ae:_e.sibling=Ae,_e=Ae);return e&&xe.forEach(function(Ge){return t(Z,Ge)}),Ar&&nu(Z,De),pe}function ne(Z,H,V,oe){if(typeof V=="object"&&V!==null&&V.type===jd&&V.key===null&&(V=V.props.children),typeof V=="object"&&V!==null){switch(V.$$typeof){case Ay:e:{for(var pe=V.key,_e=H;_e!==null;){if(_e.key===pe){if(pe=V.type,pe===jd){if(_e.tag===7){r(Z,_e.sibling),H=h(_e,V.props.children),H.return=Z,Z=H;break e}}else if(_e.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===Ol&&yk(pe)===_e.type){r(Z,_e.sibling),H=h(_e,V.props),H.ref=Tf(Z,_e,V),H.return=Z,Z=H;break e}r(Z,_e);break}else t(Z,_e);_e=_e.sibling}V.type===jd?(H=mu(V.props.children,Z.mode,oe,V.key),H.return=Z,Z=H):(oe=d_(V.type,V.key,V.props,null,Z.mode,oe),oe.ref=Tf(Z,H,V),oe.return=Z,Z=oe)}return x(Z);case Fd:e:{for(_e=V.key;H!==null;){if(H.key===_e)if(H.tag===4&&H.stateNode.containerInfo===V.containerInfo&&H.stateNode.implementation===V.implementation){r(Z,H.sibling),H=h(H,V.children||[]),H.return=Z,Z=H;break e}else{r(Z,H);break}else t(Z,H);H=H.sibling}H=nb(V,Z.mode,oe),H.return=Z,Z=H}return x(Z);case Ol:return _e=V._init,ne(Z,H,_e(V._payload),oe)}if(Ff(V))return W(Z,H,V,oe);if(vf(V))return G(Z,H,V,oe);Ny(Z,V)}return typeof V=="string"&&V!==""||typeof V=="number"?(V=""+V,H!==null&&H.tag===6?(r(Z,H.sibling),H=h(H,V),H.return=Z,Z=H):(r(Z,H),H=tb(V,Z.mode,oe),H.return=Z,Z=H),x(Z)):r(Z,H)}return ne}var ph=lP(!0),cP=lP(!1),W_=dc(null),G_=null,Hd=null,R2=null;function z2(){R2=Hd=G_=null}function L2(e){var t=W_.current;br(W_),e._currentValue=t}function hw(e,t,r){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===r)break;e=e.return}}function th(e,t){G_=e,R2=Hd=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(xo=!0),e.firstContext=null)}function hs(e){var t=e._currentValue;if(R2!==e)if(e={context:e,memoizedValue:t,next:null},Hd===null){if(G_===null)throw Error(_t(308));Hd=e,G_.dependencies={lanes:0,firstContext:e}}else Hd=Hd.next=e;return t}var lu=null;function D2(e){lu===null?lu=[e]:lu.push(e)}function uP(e,t,r,l){var h=t.interleaved;return h===null?(r.next=r,D2(t)):(r.next=h.next,h.next=r),t.interleaved=r,Ya(e,l)}function Ya(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Bl=!1;function O2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dP(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Xl(e,t,r){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,Ln&2){var h=l.pending;return h===null?t.next=t:(t.next=h.next,h.next=t),l.pending=t,Ya(e,r)}return h=l.interleaved,h===null?(t.next=t,D2(l)):(t.next=h.next,h.next=t),l.interleaved=t,Ya(e,r)}function o_(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var l=t.lanes;l&=e.pendingLanes,r|=l,t.lanes=r,b2(e,r)}}function _k(e,t){var r=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,r===l)){var h=null,m=null;if(r=r.firstBaseUpdate,r!==null){do{var x={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};m===null?h=m=x:m=m.next=x,r=r.next}while(r!==null);m===null?h=m=t:m=m.next=t}else h=m=t;r={baseState:l.baseState,firstBaseUpdate:h,lastBaseUpdate:m,shared:l.shared,effects:l.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function q_(e,t,r,l){var h=e.updateQueue;Bl=!1;var m=h.firstBaseUpdate,x=h.lastBaseUpdate,a=h.shared.pending;if(a!==null){h.shared.pending=null;var E=a,I=E.next;E.next=null,x===null?m=I:x.next=I,x=E;var L=e.alternate;L!==null&&(L=L.updateQueue,a=L.lastBaseUpdate,a!==x&&(a===null?L.firstBaseUpdate=I:a.next=I,L.lastBaseUpdate=E))}if(m!==null){var O=h.baseState;x=0,L=I=E=null,a=m;do{var F=a.lane,K=a.eventTime;if((l&F)===F){L!==null&&(L=L.next={eventTime:K,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var W=e,G=a;switch(F=t,K=r,G.tag){case 1:if(W=G.payload,typeof W=="function"){O=W.call(K,O,F);break e}O=W;break e;case 3:W.flags=W.flags&-65537|128;case 0:if(W=G.payload,F=typeof W=="function"?W.call(K,O,F):W,F==null)break e;O=Vr({},O,F);break e;case 2:Bl=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,F=h.effects,F===null?h.effects=[a]:F.push(a))}else K={eventTime:K,lane:F,tag:a.tag,payload:a.payload,callback:a.callback,next:null},L===null?(I=L=K,E=O):L=L.next=K,x|=F;if(a=a.next,a===null){if(a=h.shared.pending,a===null)break;F=a,a=F.next,F.next=null,h.lastBaseUpdate=F,h.shared.pending=null}}while(1);if(L===null&&(E=O),h.baseState=E,h.firstBaseUpdate=I,h.lastBaseUpdate=L,t=h.shared.interleaved,t!==null){h=t;do x|=h.lane,h=h.next;while(h!==t)}else m===null&&(h.shared.lanes=0);xu|=x,e.lanes=x,e.memoizedState=O}}function xk(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var l=e[t],h=l.callback;if(h!==null){if(l.callback=null,l=r,typeof h!="function")throw Error(_t(191,h));h.call(l)}}}var Um={},_a=dc(Um),xm=dc(Um),vm=dc(Um);function cu(e){if(e===Um)throw Error(_t(174));return e}function B2(e,t){switch(mr(vm,t),mr(xm,e),mr(_a,Um),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:qb(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=qb(t,e)}br(_a),mr(_a,t)}function fh(){br(_a),br(xm),br(vm)}function hP(e){cu(vm.current);var t=cu(_a.current),r=qb(t,e.type);t!==r&&(mr(xm,e),mr(_a,r))}function F2(e){xm.current===e&&(br(_a),br(xm))}var $r=dc(0);function H_(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var X1=[];function j2(){for(var e=0;e<X1.length;e++)X1[e]._workInProgressVersionPrimary=null;X1.length=0}var s_=el.ReactCurrentDispatcher,K1=el.ReactCurrentBatchConfig,_u=0,Ur=null,gi=null,Ei=null,Z_=!1,Jf=!1,bm=0,bB=0;function Wi(){throw Error(_t(321))}function N2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ks(e[r],t[r]))return!1;return!0}function $2(e,t,r,l,h,m){if(_u=m,Ur=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,s_.current=e===null||e.memoizedState===null?TB:CB,e=r(l,h),Jf){m=0;do{if(Jf=!1,bm=0,25<=m)throw Error(_t(301));m+=1,Ei=gi=null,t.updateQueue=null,s_.current=kB,e=r(l,h)}while(Jf)}if(s_.current=X_,t=gi!==null&&gi.next!==null,_u=0,Ei=gi=Ur=null,Z_=!1,t)throw Error(_t(300));return e}function U2(){var e=bm!==0;return bm=0,e}function ha(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ei===null?Ur.memoizedState=Ei=e:Ei=Ei.next=e,Ei}function ps(){if(gi===null){var e=Ur.alternate;e=e!==null?e.memoizedState:null}else e=gi.next;var t=Ei===null?Ur.memoizedState:Ei.next;if(t!==null)Ei=t,gi=e;else{if(e===null)throw Error(_t(310));gi=e,e={memoizedState:gi.memoizedState,baseState:gi.baseState,baseQueue:gi.baseQueue,queue:gi.queue,next:null},Ei===null?Ur.memoizedState=Ei=e:Ei=Ei.next=e}return Ei}function wm(e,t){return typeof t=="function"?t(e):t}function Y1(e){var t=ps(),r=t.queue;if(r===null)throw Error(_t(311));r.lastRenderedReducer=e;var l=gi,h=l.baseQueue,m=r.pending;if(m!==null){if(h!==null){var x=h.next;h.next=m.next,m.next=x}l.baseQueue=h=m,r.pending=null}if(h!==null){m=h.next,l=l.baseState;var a=x=null,E=null,I=m;do{var L=I.lane;if((_u&L)===L)E!==null&&(E=E.next={lane:0,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null}),l=I.hasEagerState?I.eagerState:e(l,I.action);else{var O={lane:L,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null};E===null?(a=E=O,x=l):E=E.next=O,Ur.lanes|=L,xu|=L}I=I.next}while(I!==null&&I!==m);E===null?x=l:E.next=a,Ks(l,t.memoizedState)||(xo=!0),t.memoizedState=l,t.baseState=x,t.baseQueue=E,r.lastRenderedState=l}if(e=r.interleaved,e!==null){h=e;do m=h.lane,Ur.lanes|=m,xu|=m,h=h.next;while(h!==e)}else h===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function J1(e){var t=ps(),r=t.queue;if(r===null)throw Error(_t(311));r.lastRenderedReducer=e;var l=r.dispatch,h=r.pending,m=t.memoizedState;if(h!==null){r.pending=null;var x=h=h.next;do m=e(m,x.action),x=x.next;while(x!==h);Ks(m,t.memoizedState)||(xo=!0),t.memoizedState=m,t.baseQueue===null&&(t.baseState=m),r.lastRenderedState=m}return[m,l]}function pP(){}function fP(e,t){var r=Ur,l=ps(),h=t(),m=!Ks(l.memoizedState,h);if(m&&(l.memoizedState=h,xo=!0),l=l.queue,V2(yP.bind(null,r,l,e),[e]),l.getSnapshot!==t||m||Ei!==null&&Ei.memoizedState.tag&1){if(r.flags|=2048,Sm(9,gP.bind(null,r,l,h,t),void 0,null),Ti===null)throw Error(_t(349));_u&30||mP(r,t,h)}return h}function mP(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ur.updateQueue,t===null?(t={lastEffect:null,stores:null},Ur.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function gP(e,t,r,l){t.value=r,t.getSnapshot=l,_P(t)&&xP(e)}function yP(e,t,r){return r(function(){_P(t)&&xP(e)})}function _P(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ks(e,r)}catch{return!0}}function xP(e){var t=Ya(e,1);t!==null&&Zs(t,e,1,-1)}function vk(e){var t=ha();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wm,lastRenderedState:e},t.queue=e,e=e.dispatch=EB.bind(null,Ur,e),[t.memoizedState,e]}function Sm(e,t,r,l){return e={tag:e,create:t,destroy:r,deps:l,next:null},t=Ur.updateQueue,t===null?(t={lastEffect:null,stores:null},Ur.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(l=r.next,r.next=e,e.next=l,t.lastEffect=e)),e}function vP(){return ps().memoizedState}function a_(e,t,r,l){var h=ha();Ur.flags|=e,h.memoizedState=Sm(1|t,r,void 0,l===void 0?null:l)}function M0(e,t,r,l){var h=ps();l=l===void 0?null:l;var m=void 0;if(gi!==null){var x=gi.memoizedState;if(m=x.destroy,l!==null&&N2(l,x.deps)){h.memoizedState=Sm(t,r,m,l);return}}Ur.flags|=e,h.memoizedState=Sm(1|t,r,m,l)}function bk(e,t){return a_(8390656,8,e,t)}function V2(e,t){return M0(2048,8,e,t)}function bP(e,t){return M0(4,2,e,t)}function wP(e,t){return M0(4,4,e,t)}function SP(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function EP(e,t,r){return r=r!=null?r.concat([e]):null,M0(4,4,SP.bind(null,t,e),r)}function W2(){}function TP(e,t){var r=ps();t=t===void 0?null:t;var l=r.memoizedState;return l!==null&&t!==null&&N2(t,l[1])?l[0]:(r.memoizedState=[e,t],e)}function CP(e,t){var r=ps();t=t===void 0?null:t;var l=r.memoizedState;return l!==null&&t!==null&&N2(t,l[1])?l[0]:(e=e(),r.memoizedState=[e,t],e)}function kP(e,t,r){return _u&21?(Ks(r,t)||(r=RM(),Ur.lanes|=r,xu|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,xo=!0),e.memoizedState=r)}function wB(e,t){var r=nr;nr=r!==0&&4>r?r:4,e(!0);var l=K1.transition;K1.transition={};try{e(!1),t()}finally{nr=r,K1.transition=l}}function IP(){return ps().memoizedState}function SB(e,t,r){var l=Yl(e);if(r={lane:l,action:r,hasEagerState:!1,eagerState:null,next:null},AP(e))MP(t,r);else if(r=uP(e,t,r,l),r!==null){var h=io();Zs(r,e,l,h),PP(r,t,l)}}function EB(e,t,r){var l=Yl(e),h={lane:l,action:r,hasEagerState:!1,eagerState:null,next:null};if(AP(e))MP(t,h);else{var m=e.alternate;if(e.lanes===0&&(m===null||m.lanes===0)&&(m=t.lastRenderedReducer,m!==null))try{var x=t.lastRenderedState,a=m(x,r);if(h.hasEagerState=!0,h.eagerState=a,Ks(a,x)){var E=t.interleaved;E===null?(h.next=h,D2(t)):(h.next=E.next,E.next=h),t.interleaved=h;return}}catch{}finally{}r=uP(e,t,h,l),r!==null&&(h=io(),Zs(r,e,l,h),PP(r,t,l))}}function AP(e){var t=e.alternate;return e===Ur||t!==null&&t===Ur}function MP(e,t){Jf=Z_=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function PP(e,t,r){if(r&4194240){var l=t.lanes;l&=e.pendingLanes,r|=l,t.lanes=r,b2(e,r)}}var X_={readContext:hs,useCallback:Wi,useContext:Wi,useEffect:Wi,useImperativeHandle:Wi,useInsertionEffect:Wi,useLayoutEffect:Wi,useMemo:Wi,useReducer:Wi,useRef:Wi,useState:Wi,useDebugValue:Wi,useDeferredValue:Wi,useTransition:Wi,useMutableSource:Wi,useSyncExternalStore:Wi,useId:Wi,unstable_isNewReconciler:!1},TB={readContext:hs,useCallback:function(e,t){return ha().memoizedState=[e,t===void 0?null:t],e},useContext:hs,useEffect:bk,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,a_(4194308,4,SP.bind(null,t,e),r)},useLayoutEffect:function(e,t){return a_(4194308,4,e,t)},useInsertionEffect:function(e,t){return a_(4,2,e,t)},useMemo:function(e,t){var r=ha();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var l=ha();return t=r!==void 0?r(t):t,l.memoizedState=l.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},l.queue=e,e=e.dispatch=SB.bind(null,Ur,e),[l.memoizedState,e]},useRef:function(e){var t=ha();return e={current:e},t.memoizedState=e},useState:vk,useDebugValue:W2,useDeferredValue:function(e){return ha().memoizedState=e},useTransition:function(){var e=vk(!1),t=e[0];return e=wB.bind(null,e[1]),ha().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var l=Ur,h=ha();if(Ar){if(r===void 0)throw Error(_t(407));r=r()}else{if(r=t(),Ti===null)throw Error(_t(349));_u&30||mP(l,t,r)}h.memoizedState=r;var m={value:r,getSnapshot:t};return h.queue=m,bk(yP.bind(null,l,m,e),[e]),l.flags|=2048,Sm(9,gP.bind(null,l,m,r,t),void 0,null),r},useId:function(){var e=ha(),t=Ti.identifierPrefix;if(Ar){var r=Wa,l=Va;r=(l&~(1<<32-Hs(l)-1)).toString(32)+r,t=":"+t+"R"+r,r=bm++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=bB++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},CB={readContext:hs,useCallback:TP,useContext:hs,useEffect:V2,useImperativeHandle:EP,useInsertionEffect:bP,useLayoutEffect:wP,useMemo:CP,useReducer:Y1,useRef:vP,useState:function(){return Y1(wm)},useDebugValue:W2,useDeferredValue:function(e){var t=ps();return kP(t,gi.memoizedState,e)},useTransition:function(){var e=Y1(wm)[0],t=ps().memoizedState;return[e,t]},useMutableSource:pP,useSyncExternalStore:fP,useId:IP,unstable_isNewReconciler:!1},kB={readContext:hs,useCallback:TP,useContext:hs,useEffect:V2,useImperativeHandle:EP,useInsertionEffect:bP,useLayoutEffect:wP,useMemo:CP,useReducer:J1,useRef:vP,useState:function(){return J1(wm)},useDebugValue:W2,useDeferredValue:function(e){var t=ps();return gi===null?t.memoizedState=e:kP(t,gi.memoizedState,e)},useTransition:function(){var e=J1(wm)[0],t=ps().memoizedState;return[e,t]},useMutableSource:pP,useSyncExternalStore:fP,useId:IP,unstable_isNewReconciler:!1};function Us(e,t){if(e&&e.defaultProps){t=Vr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function pw(e,t,r,l){t=e.memoizedState,r=r(l,t),r=r==null?t:Vr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var P0={isMounted:function(e){return(e=e._reactInternals)?ku(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var l=io(),h=Yl(e),m=qa(l,h);m.payload=t,r!=null&&(m.callback=r),t=Xl(e,m,h),t!==null&&(Zs(t,e,h,l),o_(t,e,h))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var l=io(),h=Yl(e),m=qa(l,h);m.tag=1,m.payload=t,r!=null&&(m.callback=r),t=Xl(e,m,h),t!==null&&(Zs(t,e,h,l),o_(t,e,h))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=io(),l=Yl(e),h=qa(r,l);h.tag=2,t!=null&&(h.callback=t),t=Xl(e,h,l),t!==null&&(Zs(t,e,l,r),o_(t,e,l))}};function wk(e,t,r,l,h,m,x){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,m,x):t.prototype&&t.prototype.isPureReactComponent?!mm(r,l)||!mm(h,m):!0}function RP(e,t,r){var l=!1,h=oc,m=t.contextType;return typeof m=="object"&&m!==null?m=hs(m):(h=bo(t)?gu:Yi.current,l=t.contextTypes,m=(l=l!=null)?dh(e,h):oc),t=new t(r,m),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=P0,e.stateNode=t,t._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=h,e.__reactInternalMemoizedMaskedChildContext=m),t}function Sk(e,t,r,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,l),t.state!==e&&P0.enqueueReplaceState(t,t.state,null)}function fw(e,t,r,l){var h=e.stateNode;h.props=r,h.state=e.memoizedState,h.refs={},O2(e);var m=t.contextType;typeof m=="object"&&m!==null?h.context=hs(m):(m=bo(t)?gu:Yi.current,h.context=dh(e,m)),h.state=e.memoizedState,m=t.getDerivedStateFromProps,typeof m=="function"&&(pw(e,t,m,r),h.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(t=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),t!==h.state&&P0.enqueueReplaceState(h,h.state,null),q_(e,r,h,l),h.state=e.memoizedState),typeof h.componentDidMount=="function"&&(e.flags|=4194308)}function mh(e,t){try{var r="",l=t;do r+=t5(l),l=l.return;while(l);var h=r}catch(m){h=`
Error generating stack: `+m.message+`
`+m.stack}return{value:e,source:t,stack:h,digest:null}}function Q1(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function mw(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var IB=typeof WeakMap=="function"?WeakMap:Map;function zP(e,t,r){r=qa(-1,r),r.tag=3,r.payload={element:null};var l=t.value;return r.callback=function(){Y_||(Y_=!0,Tw=l),mw(e,t)},r}function LP(e,t,r){r=qa(-1,r),r.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var h=t.value;r.payload=function(){return l(h)},r.callback=function(){mw(e,t)}}var m=e.stateNode;return m!==null&&typeof m.componentDidCatch=="function"&&(r.callback=function(){mw(e,t),typeof l!="function"&&(Kl===null?Kl=new Set([this]):Kl.add(this));var x=t.stack;this.componentDidCatch(t.value,{componentStack:x!==null?x:""})}),r}function Ek(e,t,r){var l=e.pingCache;if(l===null){l=e.pingCache=new IB;var h=new Set;l.set(t,h)}else h=l.get(t),h===void 0&&(h=new Set,l.set(t,h));h.has(r)||(h.add(r),e=UB.bind(null,e,t,r),t.then(e,e))}function Tk(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ck(e,t,r,l,h){return e.mode&1?(e.flags|=65536,e.lanes=h,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=qa(-1,1),t.tag=2,Xl(r,t,1))),r.lanes|=1),e)}var AB=el.ReactCurrentOwner,xo=!1;function no(e,t,r,l){t.child=e===null?cP(t,null,r,l):ph(t,e.child,r,l)}function kk(e,t,r,l,h){r=r.render;var m=t.ref;return th(t,h),l=$2(e,t,r,l,m,h),r=U2(),e!==null&&!xo?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~h,Ja(e,t,h)):(Ar&&r&&A2(t),t.flags|=1,no(e,t,l,h),t.child)}function Ik(e,t,r,l,h){if(e===null){var m=r.type;return typeof m=="function"&&!J2(m)&&m.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=m,DP(e,t,m,l,h)):(e=d_(r.type,null,l,t,t.mode,h),e.ref=t.ref,e.return=t,t.child=e)}if(m=e.child,!(e.lanes&h)){var x=m.memoizedProps;if(r=r.compare,r=r!==null?r:mm,r(x,l)&&e.ref===t.ref)return Ja(e,t,h)}return t.flags|=1,e=Jl(m,l),e.ref=t.ref,e.return=t,t.child=e}function DP(e,t,r,l,h){if(e!==null){var m=e.memoizedProps;if(mm(m,l)&&e.ref===t.ref)if(xo=!1,t.pendingProps=l=m,(e.lanes&h)!==0)e.flags&131072&&(xo=!0);else return t.lanes=e.lanes,Ja(e,t,h)}return gw(e,t,r,l,h)}function OP(e,t,r){var l=t.pendingProps,h=l.children,m=e!==null?e.memoizedState:null;if(l.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},mr(Xd,Ro),Ro|=r;else{if(!(r&1073741824))return e=m!==null?m.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,mr(Xd,Ro),Ro|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=m!==null?m.baseLanes:r,mr(Xd,Ro),Ro|=l}else m!==null?(l=m.baseLanes|r,t.memoizedState=null):l=r,mr(Xd,Ro),Ro|=l;return no(e,t,h,r),t.child}function BP(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function gw(e,t,r,l,h){var m=bo(r)?gu:Yi.current;return m=dh(t,m),th(t,h),r=$2(e,t,r,l,m,h),l=U2(),e!==null&&!xo?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~h,Ja(e,t,h)):(Ar&&l&&A2(t),t.flags|=1,no(e,t,r,h),t.child)}function Ak(e,t,r,l,h){if(bo(r)){var m=!0;$_(t)}else m=!1;if(th(t,h),t.stateNode===null)l_(e,t),RP(t,r,l),fw(t,r,l,h),l=!0;else if(e===null){var x=t.stateNode,a=t.memoizedProps;x.props=a;var E=x.context,I=r.contextType;typeof I=="object"&&I!==null?I=hs(I):(I=bo(r)?gu:Yi.current,I=dh(t,I));var L=r.getDerivedStateFromProps,O=typeof L=="function"||typeof x.getSnapshotBeforeUpdate=="function";O||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(a!==l||E!==I)&&Sk(t,x,l,I),Bl=!1;var F=t.memoizedState;x.state=F,q_(t,l,x,h),E=t.memoizedState,a!==l||F!==E||vo.current||Bl?(typeof L=="function"&&(pw(t,r,L,l),E=t.memoizedState),(a=Bl||wk(t,r,a,l,F,E,I))?(O||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(t.flags|=4194308)):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=E),x.props=l,x.state=E,x.context=I,l=a):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{x=t.stateNode,dP(e,t),a=t.memoizedProps,I=t.type===t.elementType?a:Us(t.type,a),x.props=I,O=t.pendingProps,F=x.context,E=r.contextType,typeof E=="object"&&E!==null?E=hs(E):(E=bo(r)?gu:Yi.current,E=dh(t,E));var K=r.getDerivedStateFromProps;(L=typeof K=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(a!==O||F!==E)&&Sk(t,x,l,E),Bl=!1,F=t.memoizedState,x.state=F,q_(t,l,x,h);var W=t.memoizedState;a!==O||F!==W||vo.current||Bl?(typeof K=="function"&&(pw(t,r,K,l),W=t.memoizedState),(I=Bl||wk(t,r,I,l,F,W,E)||!1)?(L||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(l,W,E),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(l,W,E)),typeof x.componentDidUpdate=="function"&&(t.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof x.componentDidUpdate!="function"||a===e.memoizedProps&&F===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&F===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=W),x.props=l,x.state=W,x.context=E,l=I):(typeof x.componentDidUpdate!="function"||a===e.memoizedProps&&F===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&F===e.memoizedState||(t.flags|=1024),l=!1)}return yw(e,t,r,l,m,h)}function yw(e,t,r,l,h,m){BP(e,t);var x=(t.flags&128)!==0;if(!l&&!x)return h&&fk(t,r,!1),Ja(e,t,m);l=t.stateNode,AB.current=t;var a=x&&typeof r.getDerivedStateFromError!="function"?null:l.render();return t.flags|=1,e!==null&&x?(t.child=ph(t,e.child,null,m),t.child=ph(t,null,a,m)):no(e,t,a,m),t.memoizedState=l.state,h&&fk(t,r,!0),t.child}function FP(e){var t=e.stateNode;t.pendingContext?pk(e,t.pendingContext,t.pendingContext!==t.context):t.context&&pk(e,t.context,!1),B2(e,t.containerInfo)}function Mk(e,t,r,l,h){return hh(),P2(h),t.flags|=256,no(e,t,r,l),t.child}var _w={dehydrated:null,treeContext:null,retryLane:0};function xw(e){return{baseLanes:e,cachePool:null,transitions:null}}function jP(e,t,r){var l=t.pendingProps,h=$r.current,m=!1,x=(t.flags&128)!==0,a;if((a=x)||(a=e!==null&&e.memoizedState===null?!1:(h&2)!==0),a?(m=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(h|=1),mr($r,h&1),e===null)return dw(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(x=l.children,e=l.fallback,m?(l=t.mode,m=t.child,x={mode:"hidden",children:x},!(l&1)&&m!==null?(m.childLanes=0,m.pendingProps=x):m=L0(x,l,0,null),e=mu(e,l,r,null),m.return=t,e.return=t,m.sibling=e,t.child=m,t.child.memoizedState=xw(r),t.memoizedState=_w,e):G2(t,x));if(h=e.memoizedState,h!==null&&(a=h.dehydrated,a!==null))return MB(e,t,x,l,a,h,r);if(m){m=l.fallback,x=t.mode,h=e.child,a=h.sibling;var E={mode:"hidden",children:l.children};return!(x&1)&&t.child!==h?(l=t.child,l.childLanes=0,l.pendingProps=E,t.deletions=null):(l=Jl(h,E),l.subtreeFlags=h.subtreeFlags&14680064),a!==null?m=Jl(a,m):(m=mu(m,x,r,null),m.flags|=2),m.return=t,l.return=t,l.sibling=m,t.child=l,l=m,m=t.child,x=e.child.memoizedState,x=x===null?xw(r):{baseLanes:x.baseLanes|r,cachePool:null,transitions:x.transitions},m.memoizedState=x,m.childLanes=e.childLanes&~r,t.memoizedState=_w,l}return m=e.child,e=m.sibling,l=Jl(m,{mode:"visible",children:l.children}),!(t.mode&1)&&(l.lanes=r),l.return=t,l.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=l,t.memoizedState=null,l}function G2(e,t){return t=L0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function $y(e,t,r,l){return l!==null&&P2(l),ph(t,e.child,null,r),e=G2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function MB(e,t,r,l,h,m,x){if(r)return t.flags&256?(t.flags&=-257,l=Q1(Error(_t(422))),$y(e,t,x,l)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(m=l.fallback,h=t.mode,l=L0({mode:"visible",children:l.children},h,0,null),m=mu(m,h,x,null),m.flags|=2,l.return=t,m.return=t,l.sibling=m,t.child=l,t.mode&1&&ph(t,e.child,null,x),t.child.memoizedState=xw(x),t.memoizedState=_w,m);if(!(t.mode&1))return $y(e,t,x,null);if(h.data==="$!"){if(l=h.nextSibling&&h.nextSibling.dataset,l)var a=l.dgst;return l=a,m=Error(_t(419)),l=Q1(m,l,void 0),$y(e,t,x,l)}if(a=(x&e.childLanes)!==0,xo||a){if(l=Ti,l!==null){switch(x&-x){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=h&(l.suspendedLanes|x)?0:h,h!==0&&h!==m.retryLane&&(m.retryLane=h,Ya(e,h),Zs(l,e,h,-1))}return Y2(),l=Q1(Error(_t(421))),$y(e,t,x,l)}return h.data==="$?"?(t.flags|=128,t.child=e.child,t=VB.bind(null,e),h._reactRetry=t,null):(e=m.treeContext,Oo=Zl(h.nextSibling),Bo=t,Ar=!0,Gs=null,e!==null&&(os[ss++]=Va,os[ss++]=Wa,os[ss++]=yu,Va=e.id,Wa=e.overflow,yu=t),t=G2(t,l.children),t.flags|=4096,t)}function Pk(e,t,r){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),hw(e.return,t,r)}function eb(e,t,r,l,h){var m=e.memoizedState;m===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:r,tailMode:h}:(m.isBackwards=t,m.rendering=null,m.renderingStartTime=0,m.last=l,m.tail=r,m.tailMode=h)}function NP(e,t,r){var l=t.pendingProps,h=l.revealOrder,m=l.tail;if(no(e,t,l.children,r),l=$r.current,l&2)l=l&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Pk(e,r,t);else if(e.tag===19)Pk(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(mr($r,l),!(t.mode&1))t.memoizedState=null;else switch(h){case"forwards":for(r=t.child,h=null;r!==null;)e=r.alternate,e!==null&&H_(e)===null&&(h=r),r=r.sibling;r=h,r===null?(h=t.child,t.child=null):(h=r.sibling,r.sibling=null),eb(t,!1,h,r,m);break;case"backwards":for(r=null,h=t.child,t.child=null;h!==null;){if(e=h.alternate,e!==null&&H_(e)===null){t.child=h;break}e=h.sibling,h.sibling=r,r=h,h=e}eb(t,!0,r,null,m);break;case"together":eb(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function l_(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ja(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),xu|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(_t(153));if(t.child!==null){for(e=t.child,r=Jl(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Jl(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function PB(e,t,r){switch(t.tag){case 3:FP(t),hh();break;case 5:hP(t);break;case 1:bo(t.type)&&$_(t);break;case 4:B2(t,t.stateNode.containerInfo);break;case 10:var l=t.type._context,h=t.memoizedProps.value;mr(W_,l._currentValue),l._currentValue=h;break;case 13:if(l=t.memoizedState,l!==null)return l.dehydrated!==null?(mr($r,$r.current&1),t.flags|=128,null):r&t.child.childLanes?jP(e,t,r):(mr($r,$r.current&1),e=Ja(e,t,r),e!==null?e.sibling:null);mr($r,$r.current&1);break;case 19:if(l=(r&t.childLanes)!==0,e.flags&128){if(l)return NP(e,t,r);t.flags|=128}if(h=t.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),mr($r,$r.current),l)break;return null;case 22:case 23:return t.lanes=0,OP(e,t,r)}return Ja(e,t,r)}var $P,vw,UP,VP;$P=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};vw=function(){};UP=function(e,t,r,l){var h=e.memoizedProps;if(h!==l){e=t.stateNode,cu(_a.current);var m=null;switch(r){case"input":h=Ub(e,h),l=Ub(e,l),m=[];break;case"select":h=Vr({},h,{value:void 0}),l=Vr({},l,{value:void 0}),m=[];break;case"textarea":h=Gb(e,h),l=Gb(e,l),m=[];break;default:typeof h.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=j_)}Hb(r,l);var x;r=null;for(I in h)if(!l.hasOwnProperty(I)&&h.hasOwnProperty(I)&&h[I]!=null)if(I==="style"){var a=h[I];for(x in a)a.hasOwnProperty(x)&&(r||(r={}),r[x]="")}else I!=="dangerouslySetInnerHTML"&&I!=="children"&&I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(lm.hasOwnProperty(I)?m||(m=[]):(m=m||[]).push(I,null));for(I in l){var E=l[I];if(a=h!=null?h[I]:void 0,l.hasOwnProperty(I)&&E!==a&&(E!=null||a!=null))if(I==="style")if(a){for(x in a)!a.hasOwnProperty(x)||E&&E.hasOwnProperty(x)||(r||(r={}),r[x]="");for(x in E)E.hasOwnProperty(x)&&a[x]!==E[x]&&(r||(r={}),r[x]=E[x])}else r||(m||(m=[]),m.push(I,r)),r=E;else I==="dangerouslySetInnerHTML"?(E=E?E.__html:void 0,a=a?a.__html:void 0,E!=null&&a!==E&&(m=m||[]).push(I,E)):I==="children"?typeof E!="string"&&typeof E!="number"||(m=m||[]).push(I,""+E):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&(lm.hasOwnProperty(I)?(E!=null&&I==="onScroll"&&xr("scroll",e),m||a===E||(m=[])):(m=m||[]).push(I,E))}r&&(m=m||[]).push("style",r);var I=m;(t.updateQueue=I)&&(t.flags|=4)}};VP=function(e,t,r,l){r!==l&&(t.flags|=4)};function Cf(e,t){if(!Ar)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function Gi(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,l=0;if(t)for(var h=e.child;h!==null;)r|=h.lanes|h.childLanes,l|=h.subtreeFlags&14680064,l|=h.flags&14680064,h.return=e,h=h.sibling;else for(h=e.child;h!==null;)r|=h.lanes|h.childLanes,l|=h.subtreeFlags,l|=h.flags,h.return=e,h=h.sibling;return e.subtreeFlags|=l,e.childLanes=r,t}function RB(e,t,r){var l=t.pendingProps;switch(M2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gi(t),null;case 1:return bo(t.type)&&N_(),Gi(t),null;case 3:return l=t.stateNode,fh(),br(vo),br(Yi),j2(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(jy(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Gs!==null&&(Iw(Gs),Gs=null))),vw(e,t),Gi(t),null;case 5:F2(t);var h=cu(vm.current);if(r=t.type,e!==null&&t.stateNode!=null)UP(e,t,r,l,h),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!l){if(t.stateNode===null)throw Error(_t(166));return Gi(t),null}if(e=cu(_a.current),jy(t)){l=t.stateNode,r=t.type;var m=t.memoizedProps;switch(l[ma]=t,l[_m]=m,e=(t.mode&1)!==0,r){case"dialog":xr("cancel",l),xr("close",l);break;case"iframe":case"object":case"embed":xr("load",l);break;case"video":case"audio":for(h=0;h<Nf.length;h++)xr(Nf[h],l);break;case"source":xr("error",l);break;case"img":case"image":case"link":xr("error",l),xr("load",l);break;case"details":xr("toggle",l);break;case"input":NC(l,m),xr("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!m.multiple},xr("invalid",l);break;case"textarea":UC(l,m),xr("invalid",l)}Hb(r,m),h=null;for(var x in m)if(m.hasOwnProperty(x)){var a=m[x];x==="children"?typeof a=="string"?l.textContent!==a&&(m.suppressHydrationWarning!==!0&&Fy(l.textContent,a,e),h=["children",a]):typeof a=="number"&&l.textContent!==""+a&&(m.suppressHydrationWarning!==!0&&Fy(l.textContent,a,e),h=["children",""+a]):lm.hasOwnProperty(x)&&a!=null&&x==="onScroll"&&xr("scroll",l)}switch(r){case"input":My(l),$C(l,m,!0);break;case"textarea":My(l),VC(l);break;case"select":case"option":break;default:typeof m.onClick=="function"&&(l.onclick=j_)}l=h,t.updateQueue=l,l!==null&&(t.flags|=4)}else{x=h.nodeType===9?h:h.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=yM(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=x.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=x.createElement(r,{is:l.is}):(e=x.createElement(r),r==="select"&&(x=e,l.multiple?x.multiple=!0:l.size&&(x.size=l.size))):e=x.createElementNS(e,r),e[ma]=t,e[_m]=l,$P(e,t,!1,!1),t.stateNode=e;e:{switch(x=Zb(r,l),r){case"dialog":xr("cancel",e),xr("close",e),h=l;break;case"iframe":case"object":case"embed":xr("load",e),h=l;break;case"video":case"audio":for(h=0;h<Nf.length;h++)xr(Nf[h],e);h=l;break;case"source":xr("error",e),h=l;break;case"img":case"image":case"link":xr("error",e),xr("load",e),h=l;break;case"details":xr("toggle",e),h=l;break;case"input":NC(e,l),h=Ub(e,l),xr("invalid",e);break;case"option":h=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},h=Vr({},l,{value:void 0}),xr("invalid",e);break;case"textarea":UC(e,l),h=Gb(e,l),xr("invalid",e);break;default:h=l}Hb(r,h),a=h;for(m in a)if(a.hasOwnProperty(m)){var E=a[m];m==="style"?vM(e,E):m==="dangerouslySetInnerHTML"?(E=E?E.__html:void 0,E!=null&&_M(e,E)):m==="children"?typeof E=="string"?(r!=="textarea"||E!=="")&&cm(e,E):typeof E=="number"&&cm(e,""+E):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(lm.hasOwnProperty(m)?E!=null&&m==="onScroll"&&xr("scroll",e):E!=null&&m2(e,m,E,x))}switch(r){case"input":My(e),$C(e,l,!1);break;case"textarea":My(e),VC(e);break;case"option":l.value!=null&&e.setAttribute("value",""+ic(l.value));break;case"select":e.multiple=!!l.multiple,m=l.value,m!=null?Yd(e,!!l.multiple,m,!1):l.defaultValue!=null&&Yd(e,!!l.multiple,l.defaultValue,!0);break;default:typeof h.onClick=="function"&&(e.onclick=j_)}switch(r){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Gi(t),null;case 6:if(e&&t.stateNode!=null)VP(e,t,e.memoizedProps,l);else{if(typeof l!="string"&&t.stateNode===null)throw Error(_t(166));if(r=cu(vm.current),cu(_a.current),jy(t)){if(l=t.stateNode,r=t.memoizedProps,l[ma]=t,(m=l.nodeValue!==r)&&(e=Bo,e!==null))switch(e.tag){case 3:Fy(l.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Fy(l.nodeValue,r,(e.mode&1)!==0)}m&&(t.flags|=4)}else l=(r.nodeType===9?r:r.ownerDocument).createTextNode(l),l[ma]=t,t.stateNode=l}return Gi(t),null;case 13:if(br($r),l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ar&&Oo!==null&&t.mode&1&&!(t.flags&128))aP(),hh(),t.flags|=98560,m=!1;else if(m=jy(t),l!==null&&l.dehydrated!==null){if(e===null){if(!m)throw Error(_t(318));if(m=t.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(_t(317));m[ma]=t}else hh(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Gi(t),m=!1}else Gs!==null&&(Iw(Gs),Gs=null),m=!0;if(!m)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(t.child.flags|=8192,t.mode&1&&(e===null||$r.current&1?yi===0&&(yi=3):Y2())),t.updateQueue!==null&&(t.flags|=4),Gi(t),null);case 4:return fh(),vw(e,t),e===null&&gm(t.stateNode.containerInfo),Gi(t),null;case 10:return L2(t.type._context),Gi(t),null;case 17:return bo(t.type)&&N_(),Gi(t),null;case 19:if(br($r),m=t.memoizedState,m===null)return Gi(t),null;if(l=(t.flags&128)!==0,x=m.rendering,x===null)if(l)Cf(m,!1);else{if(yi!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(x=H_(e),x!==null){for(t.flags|=128,Cf(m,!1),l=x.updateQueue,l!==null&&(t.updateQueue=l,t.flags|=4),t.subtreeFlags=0,l=r,r=t.child;r!==null;)m=r,e=l,m.flags&=14680066,x=m.alternate,x===null?(m.childLanes=0,m.lanes=e,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=x.childLanes,m.lanes=x.lanes,m.child=x.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=x.memoizedProps,m.memoizedState=x.memoizedState,m.updateQueue=x.updateQueue,m.type=x.type,e=x.dependencies,m.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return mr($r,$r.current&1|2),t.child}e=e.sibling}m.tail!==null&&Kr()>gh&&(t.flags|=128,l=!0,Cf(m,!1),t.lanes=4194304)}else{if(!l)if(e=H_(x),e!==null){if(t.flags|=128,l=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Cf(m,!0),m.tail===null&&m.tailMode==="hidden"&&!x.alternate&&!Ar)return Gi(t),null}else 2*Kr()-m.renderingStartTime>gh&&r!==1073741824&&(t.flags|=128,l=!0,Cf(m,!1),t.lanes=4194304);m.isBackwards?(x.sibling=t.child,t.child=x):(r=m.last,r!==null?r.sibling=x:t.child=x,m.last=x)}return m.tail!==null?(t=m.tail,m.rendering=t,m.tail=t.sibling,m.renderingStartTime=Kr(),t.sibling=null,r=$r.current,mr($r,l?r&1|2:r&1),t):(Gi(t),null);case 22:case 23:return K2(),l=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(t.flags|=8192),l&&t.mode&1?Ro&1073741824&&(Gi(t),t.subtreeFlags&6&&(t.flags|=8192)):Gi(t),null;case 24:return null;case 25:return null}throw Error(_t(156,t.tag))}function zB(e,t){switch(M2(t),t.tag){case 1:return bo(t.type)&&N_(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return fh(),br(vo),br(Yi),j2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return F2(t),null;case 13:if(br($r),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(_t(340));hh()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return br($r),null;case 4:return fh(),null;case 10:return L2(t.type._context),null;case 22:case 23:return K2(),null;case 24:return null;default:return null}}var Uy=!1,Xi=!1,LB=typeof WeakSet=="function"?WeakSet:Set,jt=null;function Zd(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(l){Xr(e,t,l)}else r.current=null}function bw(e,t,r){try{r()}catch(l){Xr(e,t,l)}}var Rk=!1;function DB(e,t){if(iw=O_,e=ZM(),I2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var l=r.getSelection&&r.getSelection();if(l&&l.rangeCount!==0){r=l.anchorNode;var h=l.anchorOffset,m=l.focusNode;l=l.focusOffset;try{r.nodeType,m.nodeType}catch{r=null;break e}var x=0,a=-1,E=-1,I=0,L=0,O=e,F=null;t:for(;;){for(var K;O!==r||h!==0&&O.nodeType!==3||(a=x+h),O!==m||l!==0&&O.nodeType!==3||(E=x+l),O.nodeType===3&&(x+=O.nodeValue.length),(K=O.firstChild)!==null;)F=O,O=K;for(;;){if(O===e)break t;if(F===r&&++I===h&&(a=x),F===m&&++L===l&&(E=x),(K=O.nextSibling)!==null)break;O=F,F=O.parentNode}O=K}r=a===-1||E===-1?null:{start:a,end:E}}else r=null}r=r||{start:0,end:0}}else r=null;for(ow={focusedElem:e,selectionRange:r},O_=!1,jt=t;jt!==null;)if(t=jt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,jt=e;else for(;jt!==null;){t=jt;try{var W=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(W!==null){var G=W.memoizedProps,ne=W.memoizedState,Z=t.stateNode,H=Z.getSnapshotBeforeUpdate(t.elementType===t.type?G:Us(t.type,G),ne);Z.__reactInternalSnapshotBeforeUpdate=H}break;case 3:var V=t.stateNode.containerInfo;V.nodeType===1?V.textContent="":V.nodeType===9&&V.documentElement&&V.removeChild(V.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_t(163))}}catch(oe){Xr(t,t.return,oe)}if(e=t.sibling,e!==null){e.return=t.return,jt=e;break}jt=t.return}return W=Rk,Rk=!1,W}function Qf(e,t,r){var l=t.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var h=l=l.next;do{if((h.tag&e)===e){var m=h.destroy;h.destroy=void 0,m!==void 0&&bw(t,r,m)}h=h.next}while(h!==l)}}function R0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var l=r.create;r.destroy=l()}r=r.next}while(r!==t)}}function ww(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function WP(e){var t=e.alternate;t!==null&&(e.alternate=null,WP(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ma],delete t[_m],delete t[lw],delete t[yB],delete t[_B])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function GP(e){return e.tag===5||e.tag===3||e.tag===4}function zk(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||GP(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Sw(e,t,r){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=j_));else if(l!==4&&(e=e.child,e!==null))for(Sw(e,t,r),e=e.sibling;e!==null;)Sw(e,t,r),e=e.sibling}function Ew(e,t,r){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(Ew(e,t,r),e=e.sibling;e!==null;)Ew(e,t,r),e=e.sibling}var Pi=null,Vs=!1;function zl(e,t,r){for(r=r.child;r!==null;)qP(e,t,r),r=r.sibling}function qP(e,t,r){if(ya&&typeof ya.onCommitFiberUnmount=="function")try{ya.onCommitFiberUnmount(E0,r)}catch{}switch(r.tag){case 5:Xi||Zd(r,t);case 6:var l=Pi,h=Vs;Pi=null,zl(e,t,r),Pi=l,Vs=h,Pi!==null&&(Vs?(e=Pi,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Pi.removeChild(r.stateNode));break;case 18:Pi!==null&&(Vs?(e=Pi,r=r.stateNode,e.nodeType===8?H1(e.parentNode,r):e.nodeType===1&&H1(e,r),pm(e)):H1(Pi,r.stateNode));break;case 4:l=Pi,h=Vs,Pi=r.stateNode.containerInfo,Vs=!0,zl(e,t,r),Pi=l,Vs=h;break;case 0:case 11:case 14:case 15:if(!Xi&&(l=r.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){h=l=l.next;do{var m=h,x=m.destroy;m=m.tag,x!==void 0&&(m&2||m&4)&&bw(r,t,x),h=h.next}while(h!==l)}zl(e,t,r);break;case 1:if(!Xi&&(Zd(r,t),l=r.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=r.memoizedProps,l.state=r.memoizedState,l.componentWillUnmount()}catch(a){Xr(r,t,a)}zl(e,t,r);break;case 21:zl(e,t,r);break;case 22:r.mode&1?(Xi=(l=Xi)||r.memoizedState!==null,zl(e,t,r),Xi=l):zl(e,t,r);break;default:zl(e,t,r)}}function Lk(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new LB),t.forEach(function(l){var h=WB.bind(null,e,l);r.has(l)||(r.add(l),l.then(h,h))})}}function $s(e,t){var r=t.deletions;if(r!==null)for(var l=0;l<r.length;l++){var h=r[l];try{var m=e,x=t,a=x;e:for(;a!==null;){switch(a.tag){case 5:Pi=a.stateNode,Vs=!1;break e;case 3:Pi=a.stateNode.containerInfo,Vs=!0;break e;case 4:Pi=a.stateNode.containerInfo,Vs=!0;break e}a=a.return}if(Pi===null)throw Error(_t(160));qP(m,x,h),Pi=null,Vs=!1;var E=h.alternate;E!==null&&(E.return=null),h.return=null}catch(I){Xr(h,t,I)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)HP(t,e),t=t.sibling}function HP(e,t){var r=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if($s(t,e),ua(e),l&4){try{Qf(3,e,e.return),R0(3,e)}catch(G){Xr(e,e.return,G)}try{Qf(5,e,e.return)}catch(G){Xr(e,e.return,G)}}break;case 1:$s(t,e),ua(e),l&512&&r!==null&&Zd(r,r.return);break;case 5:if($s(t,e),ua(e),l&512&&r!==null&&Zd(r,r.return),e.flags&32){var h=e.stateNode;try{cm(h,"")}catch(G){Xr(e,e.return,G)}}if(l&4&&(h=e.stateNode,h!=null)){var m=e.memoizedProps,x=r!==null?r.memoizedProps:m,a=e.type,E=e.updateQueue;if(e.updateQueue=null,E!==null)try{a==="input"&&m.type==="radio"&&m.name!=null&&mM(h,m),Zb(a,x);var I=Zb(a,m);for(x=0;x<E.length;x+=2){var L=E[x],O=E[x+1];L==="style"?vM(h,O):L==="dangerouslySetInnerHTML"?_M(h,O):L==="children"?cm(h,O):m2(h,L,O,I)}switch(a){case"input":Vb(h,m);break;case"textarea":gM(h,m);break;case"select":var F=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!m.multiple;var K=m.value;K!=null?Yd(h,!!m.multiple,K,!1):F!==!!m.multiple&&(m.defaultValue!=null?Yd(h,!!m.multiple,m.defaultValue,!0):Yd(h,!!m.multiple,m.multiple?[]:"",!1))}h[_m]=m}catch(G){Xr(e,e.return,G)}}break;case 6:if($s(t,e),ua(e),l&4){if(e.stateNode===null)throw Error(_t(162));h=e.stateNode,m=e.memoizedProps;try{h.nodeValue=m}catch(G){Xr(e,e.return,G)}}break;case 3:if($s(t,e),ua(e),l&4&&r!==null&&r.memoizedState.isDehydrated)try{pm(t.containerInfo)}catch(G){Xr(e,e.return,G)}break;case 4:$s(t,e),ua(e);break;case 13:$s(t,e),ua(e),h=e.child,h.flags&8192&&(m=h.memoizedState!==null,h.stateNode.isHidden=m,!m||h.alternate!==null&&h.alternate.memoizedState!==null||(Z2=Kr())),l&4&&Lk(e);break;case 22:if(L=r!==null&&r.memoizedState!==null,e.mode&1?(Xi=(I=Xi)||L,$s(t,e),Xi=I):$s(t,e),ua(e),l&8192){if(I=e.memoizedState!==null,(e.stateNode.isHidden=I)&&!L&&e.mode&1)for(jt=e,L=e.child;L!==null;){for(O=jt=L;jt!==null;){switch(F=jt,K=F.child,F.tag){case 0:case 11:case 14:case 15:Qf(4,F,F.return);break;case 1:Zd(F,F.return);var W=F.stateNode;if(typeof W.componentWillUnmount=="function"){l=F,r=F.return;try{t=l,W.props=t.memoizedProps,W.state=t.memoizedState,W.componentWillUnmount()}catch(G){Xr(l,r,G)}}break;case 5:Zd(F,F.return);break;case 22:if(F.memoizedState!==null){Ok(O);continue}}K!==null?(K.return=F,jt=K):Ok(O)}L=L.sibling}e:for(L=null,O=e;;){if(O.tag===5){if(L===null){L=O;try{h=O.stateNode,I?(m=h.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none"):(a=O.stateNode,E=O.memoizedProps.style,x=E!=null&&E.hasOwnProperty("display")?E.display:null,a.style.display=xM("display",x))}catch(G){Xr(e,e.return,G)}}}else if(O.tag===6){if(L===null)try{O.stateNode.nodeValue=I?"":O.memoizedProps}catch(G){Xr(e,e.return,G)}}else if((O.tag!==22&&O.tag!==23||O.memoizedState===null||O===e)&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===e)break e;for(;O.sibling===null;){if(O.return===null||O.return===e)break e;L===O&&(L=null),O=O.return}L===O&&(L=null),O.sibling.return=O.return,O=O.sibling}}break;case 19:$s(t,e),ua(e),l&4&&Lk(e);break;case 21:break;default:$s(t,e),ua(e)}}function ua(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(GP(r)){var l=r;break e}r=r.return}throw Error(_t(160))}switch(l.tag){case 5:var h=l.stateNode;l.flags&32&&(cm(h,""),l.flags&=-33);var m=zk(e);Ew(e,m,h);break;case 3:case 4:var x=l.stateNode.containerInfo,a=zk(e);Sw(e,a,x);break;default:throw Error(_t(161))}}catch(E){Xr(e,e.return,E)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function OB(e,t,r){jt=e,ZP(e)}function ZP(e,t,r){for(var l=(e.mode&1)!==0;jt!==null;){var h=jt,m=h.child;if(h.tag===22&&l){var x=h.memoizedState!==null||Uy;if(!x){var a=h.alternate,E=a!==null&&a.memoizedState!==null||Xi;a=Uy;var I=Xi;if(Uy=x,(Xi=E)&&!I)for(jt=h;jt!==null;)x=jt,E=x.child,x.tag===22&&x.memoizedState!==null?Bk(h):E!==null?(E.return=x,jt=E):Bk(h);for(;m!==null;)jt=m,ZP(m),m=m.sibling;jt=h,Uy=a,Xi=I}Dk(e)}else h.subtreeFlags&8772&&m!==null?(m.return=h,jt=m):Dk(e)}}function Dk(e){for(;jt!==null;){var t=jt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Xi||R0(5,t);break;case 1:var l=t.stateNode;if(t.flags&4&&!Xi)if(r===null)l.componentDidMount();else{var h=t.elementType===t.type?r.memoizedProps:Us(t.type,r.memoizedProps);l.componentDidUpdate(h,r.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var m=t.updateQueue;m!==null&&xk(t,m,l);break;case 3:var x=t.updateQueue;if(x!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}xk(t,x,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var E=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":E.autoFocus&&r.focus();break;case"img":E.src&&(r.src=E.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var I=t.alternate;if(I!==null){var L=I.memoizedState;if(L!==null){var O=L.dehydrated;O!==null&&pm(O)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_t(163))}Xi||t.flags&512&&ww(t)}catch(F){Xr(t,t.return,F)}}if(t===e){jt=null;break}if(r=t.sibling,r!==null){r.return=t.return,jt=r;break}jt=t.return}}function Ok(e){for(;jt!==null;){var t=jt;if(t===e){jt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,jt=r;break}jt=t.return}}function Bk(e){for(;jt!==null;){var t=jt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{R0(4,t)}catch(E){Xr(t,r,E)}break;case 1:var l=t.stateNode;if(typeof l.componentDidMount=="function"){var h=t.return;try{l.componentDidMount()}catch(E){Xr(t,h,E)}}var m=t.return;try{ww(t)}catch(E){Xr(t,m,E)}break;case 5:var x=t.return;try{ww(t)}catch(E){Xr(t,x,E)}}}catch(E){Xr(t,t.return,E)}if(t===e){jt=null;break}var a=t.sibling;if(a!==null){a.return=t.return,jt=a;break}jt=t.return}}var BB=Math.ceil,K_=el.ReactCurrentDispatcher,q2=el.ReactCurrentOwner,ds=el.ReactCurrentBatchConfig,Ln=0,Ti=null,ai=null,zi=0,Ro=0,Xd=dc(0),yi=0,Em=null,xu=0,z0=0,H2=0,em=null,_o=null,Z2=0,gh=1/0,Na=null,Y_=!1,Tw=null,Kl=null,Vy=!1,Vl=null,J_=0,tm=0,Cw=null,c_=-1,u_=0;function io(){return Ln&6?Kr():c_!==-1?c_:c_=Kr()}function Yl(e){return e.mode&1?Ln&2&&zi!==0?zi&-zi:vB.transition!==null?(u_===0&&(u_=RM()),u_):(e=nr,e!==0||(e=window.event,e=e===void 0?16:jM(e.type)),e):1}function Zs(e,t,r,l){if(50<tm)throw tm=0,Cw=null,Error(_t(185));jm(e,r,l),(!(Ln&2)||e!==Ti)&&(e===Ti&&(!(Ln&2)&&(z0|=r),yi===4&&jl(e,zi)),wo(e,l),r===1&&Ln===0&&!(t.mode&1)&&(gh=Kr()+500,A0&&hc()))}function wo(e,t){var r=e.callbackNode;v5(e,t);var l=D_(e,e===Ti?zi:0);if(l===0)r!==null&&qC(r),e.callbackNode=null,e.callbackPriority=0;else if(t=l&-l,e.callbackPriority!==t){if(r!=null&&qC(r),t===1)e.tag===0?xB(Fk.bind(null,e)):iP(Fk.bind(null,e)),mB(function(){!(Ln&6)&&hc()}),r=null;else{switch(zM(l)){case 1:r=v2;break;case 4:r=MM;break;case 16:r=L_;break;case 536870912:r=PM;break;default:r=L_}r=nR(r,XP.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function XP(e,t){if(c_=-1,u_=0,Ln&6)throw Error(_t(327));var r=e.callbackNode;if(nh()&&e.callbackNode!==r)return null;var l=D_(e,e===Ti?zi:0);if(l===0)return null;if(l&30||l&e.expiredLanes||t)t=Q_(e,l);else{t=l;var h=Ln;Ln|=2;var m=YP();(Ti!==e||zi!==t)&&(Na=null,gh=Kr()+500,fu(e,t));do try{NB();break}catch(a){KP(e,a)}while(1);z2(),K_.current=m,Ln=h,ai!==null?t=0:(Ti=null,zi=0,t=yi)}if(t!==0){if(t===2&&(h=Qb(e),h!==0&&(l=h,t=kw(e,h))),t===1)throw r=Em,fu(e,0),jl(e,l),wo(e,Kr()),r;if(t===6)jl(e,l);else{if(h=e.current.alternate,!(l&30)&&!FB(h)&&(t=Q_(e,l),t===2&&(m=Qb(e),m!==0&&(l=m,t=kw(e,m))),t===1))throw r=Em,fu(e,0),jl(e,l),wo(e,Kr()),r;switch(e.finishedWork=h,e.finishedLanes=l,t){case 0:case 1:throw Error(_t(345));case 2:ru(e,_o,Na);break;case 3:if(jl(e,l),(l&130023424)===l&&(t=Z2+500-Kr(),10<t)){if(D_(e,0)!==0)break;if(h=e.suspendedLanes,(h&l)!==l){io(),e.pingedLanes|=e.suspendedLanes&h;break}e.timeoutHandle=aw(ru.bind(null,e,_o,Na),t);break}ru(e,_o,Na);break;case 4:if(jl(e,l),(l&4194240)===l)break;for(t=e.eventTimes,h=-1;0<l;){var x=31-Hs(l);m=1<<x,x=t[x],x>h&&(h=x),l&=~m}if(l=h,l=Kr()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*BB(l/1960))-l,10<l){e.timeoutHandle=aw(ru.bind(null,e,_o,Na),l);break}ru(e,_o,Na);break;case 5:ru(e,_o,Na);break;default:throw Error(_t(329))}}}return wo(e,Kr()),e.callbackNode===r?XP.bind(null,e):null}function kw(e,t){var r=em;return e.current.memoizedState.isDehydrated&&(fu(e,t).flags|=256),e=Q_(e,t),e!==2&&(t=_o,_o=r,t!==null&&Iw(t)),e}function Iw(e){_o===null?_o=e:_o.push.apply(_o,e)}function FB(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var l=0;l<r.length;l++){var h=r[l],m=h.getSnapshot;h=h.value;try{if(!Ks(m(),h))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function jl(e,t){for(t&=~H2,t&=~z0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Hs(t),l=1<<r;e[r]=-1,t&=~l}}function Fk(e){if(Ln&6)throw Error(_t(327));nh();var t=D_(e,0);if(!(t&1))return wo(e,Kr()),null;var r=Q_(e,t);if(e.tag!==0&&r===2){var l=Qb(e);l!==0&&(t=l,r=kw(e,l))}if(r===1)throw r=Em,fu(e,0),jl(e,t),wo(e,Kr()),r;if(r===6)throw Error(_t(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ru(e,_o,Na),wo(e,Kr()),null}function X2(e,t){var r=Ln;Ln|=1;try{return e(t)}finally{Ln=r,Ln===0&&(gh=Kr()+500,A0&&hc())}}function vu(e){Vl!==null&&Vl.tag===0&&!(Ln&6)&&nh();var t=Ln;Ln|=1;var r=ds.transition,l=nr;try{if(ds.transition=null,nr=1,e)return e()}finally{nr=l,ds.transition=r,Ln=t,!(Ln&6)&&hc()}}function K2(){Ro=Xd.current,br(Xd)}function fu(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,fB(r)),ai!==null)for(r=ai.return;r!==null;){var l=r;switch(M2(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&N_();break;case 3:fh(),br(vo),br(Yi),j2();break;case 5:F2(l);break;case 4:fh();break;case 13:br($r);break;case 19:br($r);break;case 10:L2(l.type._context);break;case 22:case 23:K2()}r=r.return}if(Ti=e,ai=e=Jl(e.current,null),zi=Ro=t,yi=0,Em=null,H2=z0=xu=0,_o=em=null,lu!==null){for(t=0;t<lu.length;t++)if(r=lu[t],l=r.interleaved,l!==null){r.interleaved=null;var h=l.next,m=r.pending;if(m!==null){var x=m.next;m.next=h,l.next=x}r.pending=l}lu=null}return e}function KP(e,t){do{var r=ai;try{if(z2(),s_.current=X_,Z_){for(var l=Ur.memoizedState;l!==null;){var h=l.queue;h!==null&&(h.pending=null),l=l.next}Z_=!1}if(_u=0,Ei=gi=Ur=null,Jf=!1,bm=0,q2.current=null,r===null||r.return===null){yi=1,Em=t,ai=null;break}e:{var m=e,x=r.return,a=r,E=t;if(t=zi,a.flags|=32768,E!==null&&typeof E=="object"&&typeof E.then=="function"){var I=E,L=a,O=L.tag;if(!(L.mode&1)&&(O===0||O===11||O===15)){var F=L.alternate;F?(L.updateQueue=F.updateQueue,L.memoizedState=F.memoizedState,L.lanes=F.lanes):(L.updateQueue=null,L.memoizedState=null)}var K=Tk(x);if(K!==null){K.flags&=-257,Ck(K,x,a,m,t),K.mode&1&&Ek(m,I,t),t=K,E=I;var W=t.updateQueue;if(W===null){var G=new Set;G.add(E),t.updateQueue=G}else W.add(E);break e}else{if(!(t&1)){Ek(m,I,t),Y2();break e}E=Error(_t(426))}}else if(Ar&&a.mode&1){var ne=Tk(x);if(ne!==null){!(ne.flags&65536)&&(ne.flags|=256),Ck(ne,x,a,m,t),P2(mh(E,a));break e}}m=E=mh(E,a),yi!==4&&(yi=2),em===null?em=[m]:em.push(m),m=x;do{switch(m.tag){case 3:m.flags|=65536,t&=-t,m.lanes|=t;var Z=zP(m,E,t);_k(m,Z);break e;case 1:a=E;var H=m.type,V=m.stateNode;if(!(m.flags&128)&&(typeof H.getDerivedStateFromError=="function"||V!==null&&typeof V.componentDidCatch=="function"&&(Kl===null||!Kl.has(V)))){m.flags|=65536,t&=-t,m.lanes|=t;var oe=LP(m,a,t);_k(m,oe);break e}}m=m.return}while(m!==null)}QP(r)}catch(pe){t=pe,ai===r&&r!==null&&(ai=r=r.return);continue}break}while(1)}function YP(){var e=K_.current;return K_.current=X_,e===null?X_:e}function Y2(){(yi===0||yi===3||yi===2)&&(yi=4),Ti===null||!(xu&268435455)&&!(z0&268435455)||jl(Ti,zi)}function Q_(e,t){var r=Ln;Ln|=2;var l=YP();(Ti!==e||zi!==t)&&(Na=null,fu(e,t));do try{jB();break}catch(h){KP(e,h)}while(1);if(z2(),Ln=r,K_.current=l,ai!==null)throw Error(_t(261));return Ti=null,zi=0,yi}function jB(){for(;ai!==null;)JP(ai)}function NB(){for(;ai!==null&&!d5();)JP(ai)}function JP(e){var t=tR(e.alternate,e,Ro);e.memoizedProps=e.pendingProps,t===null?QP(e):ai=t,q2.current=null}function QP(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=zB(r,t),r!==null){r.flags&=32767,ai=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{yi=6,ai=null;return}}else if(r=RB(r,t,Ro),r!==null){ai=r;return}if(t=t.sibling,t!==null){ai=t;return}ai=t=e}while(t!==null);yi===0&&(yi=5)}function ru(e,t,r){var l=nr,h=ds.transition;try{ds.transition=null,nr=1,$B(e,t,r,l)}finally{ds.transition=h,nr=l}return null}function $B(e,t,r,l){do nh();while(Vl!==null);if(Ln&6)throw Error(_t(327));r=e.finishedWork;var h=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(_t(177));e.callbackNode=null,e.callbackPriority=0;var m=r.lanes|r.childLanes;if(b5(e,m),e===Ti&&(ai=Ti=null,zi=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Vy||(Vy=!0,nR(L_,function(){return nh(),null})),m=(r.flags&15990)!==0,r.subtreeFlags&15990||m){m=ds.transition,ds.transition=null;var x=nr;nr=1;var a=Ln;Ln|=4,q2.current=null,DB(e,r),HP(r,e),aB(ow),O_=!!iw,ow=iw=null,e.current=r,OB(r),h5(),Ln=a,nr=x,ds.transition=m}else e.current=r;if(Vy&&(Vy=!1,Vl=e,J_=h),m=e.pendingLanes,m===0&&(Kl=null),m5(r.stateNode),wo(e,Kr()),t!==null)for(l=e.onRecoverableError,r=0;r<t.length;r++)h=t[r],l(h.value,{componentStack:h.stack,digest:h.digest});if(Y_)throw Y_=!1,e=Tw,Tw=null,e;return J_&1&&e.tag!==0&&nh(),m=e.pendingLanes,m&1?e===Cw?tm++:(tm=0,Cw=e):tm=0,hc(),null}function nh(){if(Vl!==null){var e=zM(J_),t=ds.transition,r=nr;try{if(ds.transition=null,nr=16>e?16:e,Vl===null)var l=!1;else{if(e=Vl,Vl=null,J_=0,Ln&6)throw Error(_t(331));var h=Ln;for(Ln|=4,jt=e.current;jt!==null;){var m=jt,x=m.child;if(jt.flags&16){var a=m.deletions;if(a!==null){for(var E=0;E<a.length;E++){var I=a[E];for(jt=I;jt!==null;){var L=jt;switch(L.tag){case 0:case 11:case 15:Qf(8,L,m)}var O=L.child;if(O!==null)O.return=L,jt=O;else for(;jt!==null;){L=jt;var F=L.sibling,K=L.return;if(WP(L),L===I){jt=null;break}if(F!==null){F.return=K,jt=F;break}jt=K}}}var W=m.alternate;if(W!==null){var G=W.child;if(G!==null){W.child=null;do{var ne=G.sibling;G.sibling=null,G=ne}while(G!==null)}}jt=m}}if(m.subtreeFlags&2064&&x!==null)x.return=m,jt=x;else e:for(;jt!==null;){if(m=jt,m.flags&2048)switch(m.tag){case 0:case 11:case 15:Qf(9,m,m.return)}var Z=m.sibling;if(Z!==null){Z.return=m.return,jt=Z;break e}jt=m.return}}var H=e.current;for(jt=H;jt!==null;){x=jt;var V=x.child;if(x.subtreeFlags&2064&&V!==null)V.return=x,jt=V;else e:for(x=H;jt!==null;){if(a=jt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:R0(9,a)}}catch(pe){Xr(a,a.return,pe)}if(a===x){jt=null;break e}var oe=a.sibling;if(oe!==null){oe.return=a.return,jt=oe;break e}jt=a.return}}if(Ln=h,hc(),ya&&typeof ya.onPostCommitFiberRoot=="function")try{ya.onPostCommitFiberRoot(E0,e)}catch{}l=!0}return l}finally{nr=r,ds.transition=t}}return!1}function jk(e,t,r){t=mh(r,t),t=zP(e,t,1),e=Xl(e,t,1),t=io(),e!==null&&(jm(e,1,t),wo(e,t))}function Xr(e,t,r){if(e.tag===3)jk(e,e,r);else for(;t!==null;){if(t.tag===3){jk(t,e,r);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Kl===null||!Kl.has(l))){e=mh(r,e),e=LP(t,e,1),t=Xl(t,e,1),e=io(),t!==null&&(jm(t,1,e),wo(t,e));break}}t=t.return}}function UB(e,t,r){var l=e.pingCache;l!==null&&l.delete(t),t=io(),e.pingedLanes|=e.suspendedLanes&r,Ti===e&&(zi&r)===r&&(yi===4||yi===3&&(zi&130023424)===zi&&500>Kr()-Z2?fu(e,0):H2|=r),wo(e,t)}function eR(e,t){t===0&&(e.mode&1?(t=zy,zy<<=1,!(zy&130023424)&&(zy=4194304)):t=1);var r=io();e=Ya(e,t),e!==null&&(jm(e,t,r),wo(e,r))}function VB(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),eR(e,r)}function WB(e,t){var r=0;switch(e.tag){case 13:var l=e.stateNode,h=e.memoizedState;h!==null&&(r=h.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(_t(314))}l!==null&&l.delete(t),eR(e,r)}var tR;tR=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||vo.current)xo=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return xo=!1,PB(e,t,r);xo=!!(e.flags&131072)}else xo=!1,Ar&&t.flags&1048576&&oP(t,V_,t.index);switch(t.lanes=0,t.tag){case 2:var l=t.type;l_(e,t),e=t.pendingProps;var h=dh(t,Yi.current);th(t,r),h=$2(null,t,l,e,h,r);var m=U2();return t.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,bo(l)?(m=!0,$_(t)):m=!1,t.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,O2(t),h.updater=P0,t.stateNode=h,h._reactInternals=t,fw(t,l,e,r),t=yw(null,t,l,!0,m,r)):(t.tag=0,Ar&&m&&A2(t),no(null,t,h,r),t=t.child),t;case 16:l=t.elementType;e:{switch(l_(e,t),e=t.pendingProps,h=l._init,l=h(l._payload),t.type=l,h=t.tag=qB(l),e=Us(l,e),h){case 0:t=gw(null,t,l,e,r);break e;case 1:t=Ak(null,t,l,e,r);break e;case 11:t=kk(null,t,l,e,r);break e;case 14:t=Ik(null,t,l,Us(l.type,e),r);break e}throw Error(_t(306,l,""))}return t;case 0:return l=t.type,h=t.pendingProps,h=t.elementType===l?h:Us(l,h),gw(e,t,l,h,r);case 1:return l=t.type,h=t.pendingProps,h=t.elementType===l?h:Us(l,h),Ak(e,t,l,h,r);case 3:e:{if(FP(t),e===null)throw Error(_t(387));l=t.pendingProps,m=t.memoizedState,h=m.element,dP(e,t),q_(t,l,null,r);var x=t.memoizedState;if(l=x.element,m.isDehydrated)if(m={element:l,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},t.updateQueue.baseState=m,t.memoizedState=m,t.flags&256){h=mh(Error(_t(423)),t),t=Mk(e,t,l,r,h);break e}else if(l!==h){h=mh(Error(_t(424)),t),t=Mk(e,t,l,r,h);break e}else for(Oo=Zl(t.stateNode.containerInfo.firstChild),Bo=t,Ar=!0,Gs=null,r=cP(t,null,l,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(hh(),l===h){t=Ja(e,t,r);break e}no(e,t,l,r)}t=t.child}return t;case 5:return hP(t),e===null&&dw(t),l=t.type,h=t.pendingProps,m=e!==null?e.memoizedProps:null,x=h.children,sw(l,h)?x=null:m!==null&&sw(l,m)&&(t.flags|=32),BP(e,t),no(e,t,x,r),t.child;case 6:return e===null&&dw(t),null;case 13:return jP(e,t,r);case 4:return B2(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=ph(t,null,l,r):no(e,t,l,r),t.child;case 11:return l=t.type,h=t.pendingProps,h=t.elementType===l?h:Us(l,h),kk(e,t,l,h,r);case 7:return no(e,t,t.pendingProps,r),t.child;case 8:return no(e,t,t.pendingProps.children,r),t.child;case 12:return no(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(l=t.type._context,h=t.pendingProps,m=t.memoizedProps,x=h.value,mr(W_,l._currentValue),l._currentValue=x,m!==null)if(Ks(m.value,x)){if(m.children===h.children&&!vo.current){t=Ja(e,t,r);break e}}else for(m=t.child,m!==null&&(m.return=t);m!==null;){var a=m.dependencies;if(a!==null){x=m.child;for(var E=a.firstContext;E!==null;){if(E.context===l){if(m.tag===1){E=qa(-1,r&-r),E.tag=2;var I=m.updateQueue;if(I!==null){I=I.shared;var L=I.pending;L===null?E.next=E:(E.next=L.next,L.next=E),I.pending=E}}m.lanes|=r,E=m.alternate,E!==null&&(E.lanes|=r),hw(m.return,r,t),a.lanes|=r;break}E=E.next}}else if(m.tag===10)x=m.type===t.type?null:m.child;else if(m.tag===18){if(x=m.return,x===null)throw Error(_t(341));x.lanes|=r,a=x.alternate,a!==null&&(a.lanes|=r),hw(x,r,t),x=m.sibling}else x=m.child;if(x!==null)x.return=m;else for(x=m;x!==null;){if(x===t){x=null;break}if(m=x.sibling,m!==null){m.return=x.return,x=m;break}x=x.return}m=x}no(e,t,h.children,r),t=t.child}return t;case 9:return h=t.type,l=t.pendingProps.children,th(t,r),h=hs(h),l=l(h),t.flags|=1,no(e,t,l,r),t.child;case 14:return l=t.type,h=Us(l,t.pendingProps),h=Us(l.type,h),Ik(e,t,l,h,r);case 15:return DP(e,t,t.type,t.pendingProps,r);case 17:return l=t.type,h=t.pendingProps,h=t.elementType===l?h:Us(l,h),l_(e,t),t.tag=1,bo(l)?(e=!0,$_(t)):e=!1,th(t,r),RP(t,l,h),fw(t,l,h,r),yw(null,t,l,!0,e,r);case 19:return NP(e,t,r);case 22:return OP(e,t,r)}throw Error(_t(156,t.tag))};function nR(e,t){return AM(e,t)}function GB(e,t,r,l){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function us(e,t,r,l){return new GB(e,t,r,l)}function J2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function qB(e){if(typeof e=="function")return J2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===y2)return 11;if(e===_2)return 14}return 2}function Jl(e,t){var r=e.alternate;return r===null?(r=us(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function d_(e,t,r,l,h,m){var x=2;if(l=e,typeof e=="function")J2(e)&&(x=1);else if(typeof e=="string")x=5;else e:switch(e){case jd:return mu(r.children,h,m,t);case g2:x=8,h|=8;break;case Fb:return e=us(12,r,t,h|2),e.elementType=Fb,e.lanes=m,e;case jb:return e=us(13,r,t,h),e.elementType=jb,e.lanes=m,e;case Nb:return e=us(19,r,t,h),e.elementType=Nb,e.lanes=m,e;case hM:return L0(r,h,m,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case uM:x=10;break e;case dM:x=9;break e;case y2:x=11;break e;case _2:x=14;break e;case Ol:x=16,l=null;break e}throw Error(_t(130,e==null?e:typeof e,""))}return t=us(x,r,t,h),t.elementType=e,t.type=l,t.lanes=m,t}function mu(e,t,r,l){return e=us(7,e,l,t),e.lanes=r,e}function L0(e,t,r,l){return e=us(22,e,l,t),e.elementType=hM,e.lanes=r,e.stateNode={isHidden:!1},e}function tb(e,t,r){return e=us(6,e,null,t),e.lanes=r,e}function nb(e,t,r){return t=us(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function HB(e,t,r,l,h){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=O1(0),this.expirationTimes=O1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=O1(0),this.identifierPrefix=l,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function Q2(e,t,r,l,h,m,x,a,E){return e=new HB(e,t,r,a,E),t===1?(t=1,m===!0&&(t|=8)):t=0,m=us(3,null,null,t),e.current=m,m.stateNode=e,m.memoizedState={element:l,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},O2(m),e}function ZB(e,t,r){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fd,key:l==null?null:""+l,children:e,containerInfo:t,implementation:r}}function rR(e){if(!e)return oc;e=e._reactInternals;e:{if(ku(e)!==e||e.tag!==1)throw Error(_t(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(bo(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(_t(171))}if(e.tag===1){var r=e.type;if(bo(r))return rP(e,r,t)}return t}function iR(e,t,r,l,h,m,x,a,E){return e=Q2(r,l,!0,e,h,m,x,a,E),e.context=rR(null),r=e.current,l=io(),h=Yl(r),m=qa(l,h),m.callback=t??null,Xl(r,m,h),e.current.lanes=h,jm(e,h,l),wo(e,l),e}function D0(e,t,r,l){var h=t.current,m=io(),x=Yl(h);return r=rR(r),t.context===null?t.context=r:t.pendingContext=r,t=qa(m,x),t.payload={element:e},l=l===void 0?null:l,l!==null&&(t.callback=l),e=Xl(h,t,x),e!==null&&(Zs(e,h,x,m),o_(e,h,x)),x}function e0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Nk(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function eS(e,t){Nk(e,t),(e=e.alternate)&&Nk(e,t)}function XB(){return null}var oR=typeof reportError=="function"?reportError:function(e){console.error(e)};function tS(e){this._internalRoot=e}O0.prototype.render=tS.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(_t(409));D0(e,t,null,null)};O0.prototype.unmount=tS.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;vu(function(){D0(null,e,null,null)}),t[Ka]=null}};function O0(e){this._internalRoot=e}O0.prototype.unstable_scheduleHydration=function(e){if(e){var t=OM();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Fl.length&&t!==0&&t<Fl[r].priority;r++);Fl.splice(r,0,e),r===0&&FM(e)}};function nS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function B0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function $k(){}function KB(e,t,r,l,h){if(h){if(typeof l=="function"){var m=l;l=function(){var I=e0(x);m.call(I)}}var x=iR(t,l,e,0,null,!1,!1,"",$k);return e._reactRootContainer=x,e[Ka]=x.current,gm(e.nodeType===8?e.parentNode:e),vu(),x}for(;h=e.lastChild;)e.removeChild(h);if(typeof l=="function"){var a=l;l=function(){var I=e0(E);a.call(I)}}var E=Q2(e,0,!1,null,null,!1,!1,"",$k);return e._reactRootContainer=E,e[Ka]=E.current,gm(e.nodeType===8?e.parentNode:e),vu(function(){D0(t,E,r,l)}),E}function F0(e,t,r,l,h){var m=r._reactRootContainer;if(m){var x=m;if(typeof h=="function"){var a=h;h=function(){var E=e0(x);a.call(E)}}D0(t,x,e,h)}else x=KB(r,t,e,h,l);return e0(x)}LM=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=jf(t.pendingLanes);r!==0&&(b2(t,r|1),wo(t,Kr()),!(Ln&6)&&(gh=Kr()+500,hc()))}break;case 13:vu(function(){var l=Ya(e,1);if(l!==null){var h=io();Zs(l,e,1,h)}}),eS(e,1)}};w2=function(e){if(e.tag===13){var t=Ya(e,134217728);if(t!==null){var r=io();Zs(t,e,134217728,r)}eS(e,134217728)}};DM=function(e){if(e.tag===13){var t=Yl(e),r=Ya(e,t);if(r!==null){var l=io();Zs(r,e,t,l)}eS(e,t)}};OM=function(){return nr};BM=function(e,t){var r=nr;try{return nr=e,t()}finally{nr=r}};Kb=function(e,t,r){switch(t){case"input":if(Vb(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var l=r[t];if(l!==e&&l.form===e.form){var h=I0(l);if(!h)throw Error(_t(90));fM(l),Vb(l,h)}}}break;case"textarea":gM(e,r);break;case"select":t=r.value,t!=null&&Yd(e,!!r.multiple,t,!1)}};SM=X2;EM=vu;var YB={usingClientEntryPoint:!1,Events:[$m,Vd,I0,bM,wM,X2]},kf={findFiberByHostInstance:au,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},JB={bundleType:kf.bundleType,version:kf.version,rendererPackageName:kf.rendererPackageName,rendererConfig:kf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:el.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=kM(e),e===null?null:e.stateNode},findFiberByHostInstance:kf.findFiberByHostInstance||XB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wy.isDisabled&&Wy.supportsFiber)try{E0=Wy.inject(JB),ya=Wy}catch{}}Vo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YB;Vo.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nS(t))throw Error(_t(200));return ZB(e,t,null,r)};Vo.createRoot=function(e,t){if(!nS(e))throw Error(_t(299));var r=!1,l="",h=oR;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onRecoverableError!==void 0&&(h=t.onRecoverableError)),t=Q2(e,1,!1,null,null,r,!1,l,h),e[Ka]=t.current,gm(e.nodeType===8?e.parentNode:e),new tS(t)};Vo.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(_t(188)):(e=Object.keys(e).join(","),Error(_t(268,e)));return e=kM(t),e=e===null?null:e.stateNode,e};Vo.flushSync=function(e){return vu(e)};Vo.hydrate=function(e,t,r){if(!B0(t))throw Error(_t(200));return F0(null,e,t,!0,r)};Vo.hydrateRoot=function(e,t,r){if(!nS(e))throw Error(_t(405));var l=r!=null&&r.hydratedSources||null,h=!1,m="",x=oR;if(r!=null&&(r.unstable_strictMode===!0&&(h=!0),r.identifierPrefix!==void 0&&(m=r.identifierPrefix),r.onRecoverableError!==void 0&&(x=r.onRecoverableError)),t=iR(t,null,e,1,r??null,h,!1,m,x),e[Ka]=t.current,gm(e),l)for(e=0;e<l.length;e++)r=l[e],h=r._getVersion,h=h(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,h]:t.mutableSourceEagerHydrationData.push(r,h);return new O0(t)};Vo.render=function(e,t,r){if(!B0(t))throw Error(_t(200));return F0(null,e,t,!1,r)};Vo.unmountComponentAtNode=function(e){if(!B0(e))throw Error(_t(40));return e._reactRootContainer?(vu(function(){F0(null,null,e,!1,function(){e._reactRootContainer=null,e[Ka]=null})}),!0):!1};Vo.unstable_batchedUpdates=X2;Vo.unstable_renderSubtreeIntoContainer=function(e,t,r,l){if(!B0(r))throw Error(_t(200));if(e==null||e._reactInternals===void 0)throw Error(_t(38));return F0(e,t,r,!1,l)};Vo.version="18.3.1-next-f1338f8080-20240426";function sR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sR)}catch(e){console.error(e)}}sR(),sM.exports=Vo;var j0=sM.exports;const Gy=l2(j0);var Uk=j0;Ob.createRoot=Uk.createRoot,Ob.hydrateRoot=Uk.hydrateRoot;var aR={exports:{}},lR={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yh=J;function QB(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var e4=typeof Object.is=="function"?Object.is:QB,t4=yh.useState,n4=yh.useEffect,r4=yh.useLayoutEffect,i4=yh.useDebugValue;function o4(e,t){var r=t(),l=t4({inst:{value:r,getSnapshot:t}}),h=l[0].inst,m=l[1];return r4(function(){h.value=r,h.getSnapshot=t,rb(h)&&m({inst:h})},[e,r,t]),n4(function(){return rb(h)&&m({inst:h}),e(function(){rb(h)&&m({inst:h})})},[e]),i4(r),r}function rb(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!e4(e,r)}catch{return!0}}function s4(e,t){return t()}var a4=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?s4:o4;lR.useSyncExternalStore=yh.useSyncExternalStore!==void 0?yh.useSyncExternalStore:a4;aR.exports=lR;var l4=aR.exports,cR={exports:{}},uR={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N0=J,c4=l4;function u4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var d4=typeof Object.is=="function"?Object.is:u4,h4=c4.useSyncExternalStore,p4=N0.useRef,f4=N0.useEffect,m4=N0.useMemo,g4=N0.useDebugValue;uR.useSyncExternalStoreWithSelector=function(e,t,r,l,h){var m=p4(null);if(m.current===null){var x={hasValue:!1,value:null};m.current=x}else x=m.current;m=m4(function(){function E(K){if(!I){if(I=!0,L=K,K=l(K),h!==void 0&&x.hasValue){var W=x.value;if(h(W,K))return O=W}return O=K}if(W=O,d4(L,K))return W;var G=l(K);return h!==void 0&&h(W,G)?(L=K,W):(L=K,O=G)}var I=!1,L,O,F=r===void 0?null:r;return[function(){return E(t())},F===null?void 0:function(){return E(F())}]},[t,r,l,h]);var a=h4(e,m[0],m[1]);return f4(function(){x.hasValue=!0,x.value=a},[a]),g4(a),a};cR.exports=uR;var y4=cR.exports;function _4(e){e()}let dR=_4;const x4=e=>dR=e,v4=()=>dR,Vk=Symbol.for("react-redux-context"),Wk=typeof globalThis<"u"?globalThis:{};function b4(){var e;if(!J.createContext)return{};const t=(e=Wk[Vk])!=null?e:Wk[Vk]=new Map;let r=t.get(J.createContext);return r||(r=J.createContext(null),t.set(J.createContext,r)),r}const sc=b4();function rS(e=sc){return function(){return J.useContext(e)}}const hR=rS(),w4=()=>{throw new Error("uSES not initialized!")};let pR=w4;const S4=e=>{pR=e},E4=(e,t)=>e===t;function T4(e=sc){const t=e===sc?hR:rS(e);return function(l,h={}){const{equalityFn:m=E4,stabilityCheck:x=void 0,noopCheck:a=void 0}=typeof h=="function"?{equalityFn:h}:h,{store:E,subscription:I,getServerState:L,stabilityCheck:O,noopCheck:F}=t();J.useRef(!0);const K=J.useCallback({[l.name](G){return l(G)}}[l.name],[l,O,x]),W=pR(I.addNestedSub,E.getState,L||E.getState,K,m);return J.useDebugValue(W),W}}const $0=T4();function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var l in r)({}).hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},ce.apply(null,arguments)}function Dt(e,t){if(e==null)return{};var r={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(t.indexOf(l)!==-1)continue;r[l]=e[l]}return r}var fR={exports:{}},rr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ci=typeof Symbol=="function"&&Symbol.for,iS=Ci?Symbol.for("react.element"):60103,oS=Ci?Symbol.for("react.portal"):60106,U0=Ci?Symbol.for("react.fragment"):60107,V0=Ci?Symbol.for("react.strict_mode"):60108,W0=Ci?Symbol.for("react.profiler"):60114,G0=Ci?Symbol.for("react.provider"):60109,q0=Ci?Symbol.for("react.context"):60110,sS=Ci?Symbol.for("react.async_mode"):60111,H0=Ci?Symbol.for("react.concurrent_mode"):60111,Z0=Ci?Symbol.for("react.forward_ref"):60112,X0=Ci?Symbol.for("react.suspense"):60113,C4=Ci?Symbol.for("react.suspense_list"):60120,K0=Ci?Symbol.for("react.memo"):60115,Y0=Ci?Symbol.for("react.lazy"):60116,k4=Ci?Symbol.for("react.block"):60121,I4=Ci?Symbol.for("react.fundamental"):60117,A4=Ci?Symbol.for("react.responder"):60118,M4=Ci?Symbol.for("react.scope"):60119;function Go(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case iS:switch(e=e.type,e){case sS:case H0:case U0:case W0:case V0:case X0:return e;default:switch(e=e&&e.$$typeof,e){case q0:case Z0:case Y0:case K0:case G0:return e;default:return t}}case oS:return t}}}function mR(e){return Go(e)===H0}rr.AsyncMode=sS;rr.ConcurrentMode=H0;rr.ContextConsumer=q0;rr.ContextProvider=G0;rr.Element=iS;rr.ForwardRef=Z0;rr.Fragment=U0;rr.Lazy=Y0;rr.Memo=K0;rr.Portal=oS;rr.Profiler=W0;rr.StrictMode=V0;rr.Suspense=X0;rr.isAsyncMode=function(e){return mR(e)||Go(e)===sS};rr.isConcurrentMode=mR;rr.isContextConsumer=function(e){return Go(e)===q0};rr.isContextProvider=function(e){return Go(e)===G0};rr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===iS};rr.isForwardRef=function(e){return Go(e)===Z0};rr.isFragment=function(e){return Go(e)===U0};rr.isLazy=function(e){return Go(e)===Y0};rr.isMemo=function(e){return Go(e)===K0};rr.isPortal=function(e){return Go(e)===oS};rr.isProfiler=function(e){return Go(e)===W0};rr.isStrictMode=function(e){return Go(e)===V0};rr.isSuspense=function(e){return Go(e)===X0};rr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===U0||e===H0||e===W0||e===V0||e===X0||e===C4||typeof e=="object"&&e!==null&&(e.$$typeof===Y0||e.$$typeof===K0||e.$$typeof===G0||e.$$typeof===q0||e.$$typeof===Z0||e.$$typeof===I4||e.$$typeof===A4||e.$$typeof===M4||e.$$typeof===k4)};rr.typeOf=Go;fR.exports=rr;var P4=fR.exports,gR=P4,R4={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},z4={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},yR={};yR[gR.ForwardRef]=R4;yR[gR.Memo]=z4;var ar={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aS=Symbol.for("react.element"),lS=Symbol.for("react.portal"),J0=Symbol.for("react.fragment"),Q0=Symbol.for("react.strict_mode"),ex=Symbol.for("react.profiler"),tx=Symbol.for("react.provider"),nx=Symbol.for("react.context"),L4=Symbol.for("react.server_context"),rx=Symbol.for("react.forward_ref"),ix=Symbol.for("react.suspense"),ox=Symbol.for("react.suspense_list"),sx=Symbol.for("react.memo"),ax=Symbol.for("react.lazy"),D4=Symbol.for("react.offscreen"),_R;_R=Symbol.for("react.module.reference");function gs(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case aS:switch(e=e.type,e){case J0:case ex:case Q0:case ix:case ox:return e;default:switch(e=e&&e.$$typeof,e){case L4:case nx:case rx:case ax:case sx:case tx:return e;default:return t}}case lS:return t}}}ar.ContextConsumer=nx;ar.ContextProvider=tx;ar.Element=aS;ar.ForwardRef=rx;ar.Fragment=J0;ar.Lazy=ax;ar.Memo=sx;ar.Portal=lS;ar.Profiler=ex;ar.StrictMode=Q0;ar.Suspense=ix;ar.SuspenseList=ox;ar.isAsyncMode=function(){return!1};ar.isConcurrentMode=function(){return!1};ar.isContextConsumer=function(e){return gs(e)===nx};ar.isContextProvider=function(e){return gs(e)===tx};ar.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===aS};ar.isForwardRef=function(e){return gs(e)===rx};ar.isFragment=function(e){return gs(e)===J0};ar.isLazy=function(e){return gs(e)===ax};ar.isMemo=function(e){return gs(e)===sx};ar.isPortal=function(e){return gs(e)===lS};ar.isProfiler=function(e){return gs(e)===ex};ar.isStrictMode=function(e){return gs(e)===Q0};ar.isSuspense=function(e){return gs(e)===ix};ar.isSuspenseList=function(e){return gs(e)===ox};ar.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===J0||e===ex||e===Q0||e===ix||e===ox||e===D4||typeof e=="object"&&e!==null&&(e.$$typeof===ax||e.$$typeof===sx||e.$$typeof===tx||e.$$typeof===nx||e.$$typeof===rx||e.$$typeof===_R||e.getModuleId!==void 0)};ar.typeOf=gs;function O4(){const e=v4();let t=null,r=null;return{clear(){t=null,r=null},notify(){e(()=>{let l=t;for(;l;)l.callback(),l=l.next})},get(){let l=[],h=t;for(;h;)l.push(h),h=h.next;return l},subscribe(l){let h=!0,m=r={callback:l,next:null,prev:r};return m.prev?m.prev.next=m:t=m,function(){!h||t===null||(h=!1,m.next?m.next.prev=m.prev:r=m.prev,m.prev?m.prev.next=m.next:t=m.next)}}}}const Gk={notify(){},get:()=>[]};function B4(e,t){let r,l=Gk,h=0,m=!1;function x(G){L();const ne=l.subscribe(G);let Z=!1;return()=>{Z||(Z=!0,ne(),O())}}function a(){l.notify()}function E(){W.onStateChange&&W.onStateChange()}function I(){return m}function L(){h++,r||(r=t?t.addNestedSub(E):e.subscribe(E),l=O4())}function O(){h--,r&&h===0&&(r(),r=void 0,l.clear(),l=Gk)}function F(){m||(m=!0,L())}function K(){m&&(m=!1,O())}const W={addNestedSub:x,notifyNestedSubs:a,handleChangeWrapper:E,isSubscribed:I,trySubscribe:F,tryUnsubscribe:K,getListeners:()=>l};return W}const F4=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",j4=F4?J.useLayoutEffect:J.useEffect;function N4({store:e,context:t,children:r,serverState:l,stabilityCheck:h="once",noopCheck:m="once"}){const x=J.useMemo(()=>{const I=B4(e);return{store:e,subscription:I,getServerState:l?()=>l:void 0,stabilityCheck:h,noopCheck:m}},[e,l,h,m]),a=J.useMemo(()=>e.getState(),[e]);j4(()=>{const{subscription:I}=x;return I.onStateChange=I.notifyNestedSubs,I.trySubscribe(),a!==e.getState()&&I.notifyNestedSubs(),()=>{I.tryUnsubscribe(),I.onStateChange=void 0}},[x,a]);const E=t||sc;return J.createElement(E.Provider,{value:x},r)}function xR(e=sc){const t=e===sc?hR:rS(e);return function(){const{store:l}=t();return l}}const $4=xR();function U4(e=sc){const t=e===sc?$4:xR(e);return function(){return t().dispatch}}const lx=U4();S4(y4.useSyncExternalStoreWithSelector);x4(j0.unstable_batchedUpdates);function qs(e){for(var t=arguments.length,r=Array(t>1?t-1:0),l=1;l<t;l++)r[l-1]=arguments[l];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map(function(h){return"'"+h+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function ac(e){return!!e&&!!e[Ir]}function Qa(e){var t;return!!e&&(function(r){if(!r||typeof r!="object")return!1;var l=Object.getPrototypeOf(r);if(l===null)return!0;var h=Object.hasOwnProperty.call(l,"constructor")&&l.constructor;return h===Object||typeof h=="function"&&Function.toString.call(h)===Y4}(e)||Array.isArray(e)||!!e[Jk]||!!(!((t=e.constructor)===null||t===void 0)&&t[Jk])||cS(e)||uS(e))}function bu(e,t,r){r===void 0&&(r=!1),Mh(e)===0?(r?Object.keys:ih)(e).forEach(function(l){r&&typeof l=="symbol"||t(l,e[l],e)}):e.forEach(function(l,h){return t(h,l,e)})}function Mh(e){var t=e[Ir];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:cS(e)?2:uS(e)?3:0}function rh(e,t){return Mh(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function V4(e,t){return Mh(e)===2?e.get(t):e[t]}function vR(e,t,r){var l=Mh(e);l===2?e.set(t,r):l===3?e.add(r):e[t]=r}function bR(e,t){return e===t?e!==0||1/e==1/t:e!=e&&t!=t}function cS(e){return X4&&e instanceof Map}function uS(e){return K4&&e instanceof Set}function iu(e){return e.o||e.t}function dS(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=SR(e);delete t[Ir];for(var r=ih(t),l=0;l<r.length;l++){var h=r[l],m=t[h];m.writable===!1&&(m.writable=!0,m.configurable=!0),(m.get||m.set)&&(t[h]={configurable:!0,writable:!0,enumerable:m.enumerable,value:e[h]})}return Object.create(Object.getPrototypeOf(e),t)}function hS(e,t){return t===void 0&&(t=!1),pS(e)||ac(e)||!Qa(e)||(Mh(e)>1&&(e.set=e.add=e.clear=e.delete=W4),Object.freeze(e),t&&bu(e,function(r,l){return hS(l,!0)},!0)),e}function W4(){qs(2)}function pS(e){return e==null||typeof e!="object"||Object.isFrozen(e)}function xa(e){var t=Rw[e];return t||qs(18,e),t}function G4(e,t){Rw[e]||(Rw[e]=t)}function Aw(){return Tm}function ib(e,t){t&&(xa("Patches"),e.u=[],e.s=[],e.v=t)}function t0(e){Mw(e),e.p.forEach(q4),e.p=null}function Mw(e){e===Tm&&(Tm=e.l)}function qk(e){return Tm={p:[],l:Tm,h:e,m:!0,_:0}}function q4(e){var t=e[Ir];t.i===0||t.i===1?t.j():t.g=!0}function ob(e,t){t._=t.p.length;var r=t.p[0],l=e!==void 0&&e!==r;return t.h.O||xa("ES5").S(t,e,l),l?(r[Ir].P&&(t0(t),qs(4)),Qa(e)&&(e=n0(t,e),t.l||r0(t,e)),t.u&&xa("Patches").M(r[Ir].t,e,t.u,t.s)):e=n0(t,r,[]),t0(t),t.u&&t.v(t.u,t.s),e!==wR?e:void 0}function n0(e,t,r){if(pS(t))return t;var l=t[Ir];if(!l)return bu(t,function(a,E){return Hk(e,l,t,a,E,r)},!0),t;if(l.A!==e)return t;if(!l.P)return r0(e,l.t,!0),l.t;if(!l.I){l.I=!0,l.A._--;var h=l.i===4||l.i===5?l.o=dS(l.k):l.o,m=h,x=!1;l.i===3&&(m=new Set(h),h.clear(),x=!0),bu(m,function(a,E){return Hk(e,l,h,a,E,r,x)}),r0(e,h,!1),r&&e.u&&xa("Patches").N(l,r,e.u,e.s)}return l.o}function Hk(e,t,r,l,h,m,x){if(ac(h)){var a=n0(e,h,m&&t&&t.i!==3&&!rh(t.R,l)?m.concat(l):void 0);if(vR(r,l,a),!ac(a))return;e.m=!1}else x&&r.add(h);if(Qa(h)&&!pS(h)){if(!e.h.D&&e._<1)return;n0(e,h),t&&t.A.l||r0(e,h)}}function r0(e,t,r){r===void 0&&(r=!1),!e.l&&e.h.D&&e.m&&hS(t,r)}function sb(e,t){var r=e[Ir];return(r?iu(r):e)[t]}function Zk(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var l=Object.getOwnPropertyDescriptor(r,t);if(l)return l;r=Object.getPrototypeOf(r)}}function Nl(e){e.P||(e.P=!0,e.l&&Nl(e.l))}function ab(e){e.o||(e.o=dS(e.t))}function Pw(e,t,r){var l=cS(t)?xa("MapSet").F(t,r):uS(t)?xa("MapSet").T(t,r):e.O?function(h,m){var x=Array.isArray(h),a={i:x?1:0,A:m?m.A:Aw(),P:!1,I:!1,R:{},l:m,t:h,k:null,o:null,j:null,C:!1},E=a,I=Cm;x&&(E=[a],I=$f);var L=Proxy.revocable(E,I),O=L.revoke,F=L.proxy;return a.k=F,a.j=O,F}(t,r):xa("ES5").J(t,r);return(r?r.A:Aw()).p.push(l),l}function H4(e){return ac(e)||qs(22,e),function t(r){if(!Qa(r))return r;var l,h=r[Ir],m=Mh(r);if(h){if(!h.P&&(h.i<4||!xa("ES5").K(h)))return h.t;h.I=!0,l=Xk(r,m),h.I=!1}else l=Xk(r,m);return bu(l,function(x,a){h&&V4(h.t,x)===a||vR(l,x,t(a))}),m===3?new Set(l):l}(e)}function Xk(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return dS(e)}function Z4(){function e(m,x){var a=h[m];return a?a.enumerable=x:h[m]=a={configurable:!0,enumerable:x,get:function(){var E=this[Ir];return Cm.get(E,m)},set:function(E){var I=this[Ir];Cm.set(I,m,E)}},a}function t(m){for(var x=m.length-1;x>=0;x--){var a=m[x][Ir];if(!a.P)switch(a.i){case 5:l(a)&&Nl(a);break;case 4:r(a)&&Nl(a)}}}function r(m){for(var x=m.t,a=m.k,E=ih(a),I=E.length-1;I>=0;I--){var L=E[I];if(L!==Ir){var O=x[L];if(O===void 0&&!rh(x,L))return!0;var F=a[L],K=F&&F[Ir];if(K?K.t!==O:!bR(F,O))return!0}}var W=!!x[Ir];return E.length!==ih(x).length+(W?0:1)}function l(m){var x=m.k;if(x.length!==m.t.length)return!0;var a=Object.getOwnPropertyDescriptor(x,x.length-1);if(a&&!a.get)return!0;for(var E=0;E<x.length;E++)if(!x.hasOwnProperty(E))return!0;return!1}var h={};G4("ES5",{J:function(m,x){var a=Array.isArray(m),E=function(L,O){if(L){for(var F=Array(O.length),K=0;K<O.length;K++)Object.defineProperty(F,""+K,e(K,!0));return F}var W=SR(O);delete W[Ir];for(var G=ih(W),ne=0;ne<G.length;ne++){var Z=G[ne];W[Z]=e(Z,L||!!W[Z].enumerable)}return Object.create(Object.getPrototypeOf(O),W)}(a,m),I={i:a?5:4,A:x?x.A:Aw(),P:!1,I:!1,R:{},l:x,t:m,k:E,o:null,g:!1,C:!1};return Object.defineProperty(E,Ir,{value:I,writable:!0}),E},S:function(m,x,a){a?ac(x)&&x[Ir].A===m&&t(m.p):(m.u&&function E(I){if(I&&typeof I=="object"){var L=I[Ir];if(L){var O=L.t,F=L.k,K=L.R,W=L.i;if(W===4)bu(F,function(V){V!==Ir&&(O[V]!==void 0||rh(O,V)?K[V]||E(F[V]):(K[V]=!0,Nl(L)))}),bu(O,function(V){F[V]!==void 0||rh(F,V)||(K[V]=!1,Nl(L))});else if(W===5){if(l(L)&&(Nl(L),K.length=!0),F.length<O.length)for(var G=F.length;G<O.length;G++)K[G]=!1;else for(var ne=O.length;ne<F.length;ne++)K[ne]=!0;for(var Z=Math.min(F.length,O.length),H=0;H<Z;H++)F.hasOwnProperty(H)||(K[H]=!0),K[H]===void 0&&E(F[H])}}}}(m.p[0]),t(m.p))},K:function(m){return m.i===4?r(m):l(m)}})}var Kk,Tm,fS=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",X4=typeof Map<"u",K4=typeof Set<"u",Yk=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",wR=fS?Symbol.for("immer-nothing"):((Kk={})["immer-nothing"]=!0,Kk),Jk=fS?Symbol.for("immer-draftable"):"__$immer_draftable",Ir=fS?Symbol.for("immer-state"):"__$immer_state",Y4=""+Object.prototype.constructor,ih=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,SR=Object.getOwnPropertyDescriptors||function(e){var t={};return ih(e).forEach(function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)}),t},Rw={},Cm={get:function(e,t){if(t===Ir)return e;var r=iu(e);if(!rh(r,t))return function(h,m,x){var a,E=Zk(m,x);return E?"value"in E?E.value:(a=E.get)===null||a===void 0?void 0:a.call(h.k):void 0}(e,r,t);var l=r[t];return e.I||!Qa(l)?l:l===sb(e.t,t)?(ab(e),e.o[t]=Pw(e.A.h,l,e)):l},has:function(e,t){return t in iu(e)},ownKeys:function(e){return Reflect.ownKeys(iu(e))},set:function(e,t,r){var l=Zk(iu(e),t);if(l!=null&&l.set)return l.set.call(e.k,r),!0;if(!e.P){var h=sb(iu(e),t),m=h==null?void 0:h[Ir];if(m&&m.t===r)return e.o[t]=r,e.R[t]=!1,!0;if(bR(r,h)&&(r!==void 0||rh(e.t,t)))return!0;ab(e),Nl(e)}return e.o[t]===r&&(r!==void 0||t in e.o)||Number.isNaN(r)&&Number.isNaN(e.o[t])||(e.o[t]=r,e.R[t]=!0),!0},deleteProperty:function(e,t){return sb(e.t,t)!==void 0||t in e.t?(e.R[t]=!1,ab(e),Nl(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=iu(e),l=Reflect.getOwnPropertyDescriptor(r,t);return l&&{writable:!0,configurable:e.i!==1||t!=="length",enumerable:l.enumerable,value:r[t]}},defineProperty:function(){qs(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){qs(12)}},$f={};bu(Cm,function(e,t){$f[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),$f.deleteProperty=function(e,t){return $f.set.call(this,e,t,void 0)},$f.set=function(e,t,r){return Cm.set.call(this,e[0],t,r,e[0])};var J4=function(){function e(r){var l=this;this.O=Yk,this.D=!0,this.produce=function(h,m,x){if(typeof h=="function"&&typeof m!="function"){var a=m;m=h;var E=l;return function(G){var ne=this;G===void 0&&(G=a);for(var Z=arguments.length,H=Array(Z>1?Z-1:0),V=1;V<Z;V++)H[V-1]=arguments[V];return E.produce(G,function(oe){var pe;return(pe=m).call.apply(pe,[ne,oe].concat(H))})}}var I;if(typeof m!="function"&&qs(6),x!==void 0&&typeof x!="function"&&qs(7),Qa(h)){var L=qk(l),O=Pw(l,h,void 0),F=!0;try{I=m(O),F=!1}finally{F?t0(L):Mw(L)}return typeof Promise<"u"&&I instanceof Promise?I.then(function(G){return ib(L,x),ob(G,L)},function(G){throw t0(L),G}):(ib(L,x),ob(I,L))}if(!h||typeof h!="object"){if((I=m(h))===void 0&&(I=h),I===wR&&(I=void 0),l.D&&hS(I,!0),x){var K=[],W=[];xa("Patches").M(h,I,K,W),x(K,W)}return I}qs(21,h)},this.produceWithPatches=function(h,m){if(typeof h=="function")return function(I){for(var L=arguments.length,O=Array(L>1?L-1:0),F=1;F<L;F++)O[F-1]=arguments[F];return l.produceWithPatches(I,function(K){return h.apply(void 0,[K].concat(O))})};var x,a,E=l.produce(h,m,function(I,L){x=I,a=L});return typeof Promise<"u"&&E instanceof Promise?E.then(function(I){return[I,x,a]}):[E,x,a]},typeof(r==null?void 0:r.useProxies)=="boolean"&&this.setUseProxies(r.useProxies),typeof(r==null?void 0:r.autoFreeze)=="boolean"&&this.setAutoFreeze(r.autoFreeze)}var t=e.prototype;return t.createDraft=function(r){Qa(r)||qs(8),ac(r)&&(r=H4(r));var l=qk(this),h=Pw(this,r,void 0);return h[Ir].C=!0,Mw(l),h},t.finishDraft=function(r,l){var h=r&&r[Ir],m=h.A;return ib(m,l),ob(void 0,m)},t.setAutoFreeze=function(r){this.D=r},t.setUseProxies=function(r){r&&!Yk&&qs(20),this.O=r},t.applyPatches=function(r,l){var h;for(h=l.length-1;h>=0;h--){var m=l[h];if(m.path.length===0&&m.op==="replace"){r=m.value;break}}h>-1&&(l=l.slice(h+1));var x=xa("Patches").$;return ac(r)?x(r,l):this.produce(r,function(a){return x(a,l)})},e}(),Uo=new J4,ER=Uo.produce;Uo.produceWithPatches.bind(Uo);Uo.setAutoFreeze.bind(Uo);Uo.setUseProxies.bind(Uo);Uo.applyPatches.bind(Uo);Uo.createDraft.bind(Uo);Uo.finishDraft.bind(Uo);function km(e){"@babel/helpers - typeof";return km=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},km(e)}function Q4(e,t){if(km(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var l=r.call(e,t||"default");if(km(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eF(e){var t=Q4(e,"string");return km(t)=="symbol"?t:t+""}function tF(e,t,r){return(t=eF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),r.push.apply(r,l)}return r}function eI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qk(Object(r),!0).forEach(function(l){tF(e,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qk(Object(r)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(r,l))})}return e}function Hi(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var tI=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),lb=function(){return Math.random().toString(36).substring(7).split("").join(".")},i0={INIT:"@@redux/INIT"+lb(),REPLACE:"@@redux/REPLACE"+lb(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+lb()}};function nF(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function TR(e,t,r){var l;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Hi(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Hi(1));return r(TR)(e,t)}if(typeof e!="function")throw new Error(Hi(2));var h=e,m=t,x=[],a=x,E=!1;function I(){a===x&&(a=x.slice())}function L(){if(E)throw new Error(Hi(3));return m}function O(G){if(typeof G!="function")throw new Error(Hi(4));if(E)throw new Error(Hi(5));var ne=!0;return I(),a.push(G),function(){if(ne){if(E)throw new Error(Hi(6));ne=!1,I();var H=a.indexOf(G);a.splice(H,1),x=null}}}function F(G){if(!nF(G))throw new Error(Hi(7));if(typeof G.type>"u")throw new Error(Hi(8));if(E)throw new Error(Hi(9));try{E=!0,m=h(m,G)}finally{E=!1}for(var ne=x=a,Z=0;Z<ne.length;Z++){var H=ne[Z];H()}return G}function K(G){if(typeof G!="function")throw new Error(Hi(10));h=G,F({type:i0.REPLACE})}function W(){var G,ne=O;return G={subscribe:function(H){if(typeof H!="object"||H===null)throw new Error(Hi(11));function V(){H.next&&H.next(L())}V();var oe=ne(V);return{unsubscribe:oe}}},G[tI]=function(){return this},G}return F({type:i0.INIT}),l={dispatch:F,subscribe:O,getState:L,replaceReducer:K},l[tI]=W,l}function rF(e){Object.keys(e).forEach(function(t){var r=e[t],l=r(void 0,{type:i0.INIT});if(typeof l>"u")throw new Error(Hi(12));if(typeof r(void 0,{type:i0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Hi(13))})}function iF(e){for(var t=Object.keys(e),r={},l=0;l<t.length;l++){var h=t[l];typeof e[h]=="function"&&(r[h]=e[h])}var m=Object.keys(r),x;try{rF(r)}catch(a){x=a}return function(E,I){if(E===void 0&&(E={}),x)throw x;for(var L=!1,O={},F=0;F<m.length;F++){var K=m[F],W=r[K],G=E[K],ne=W(G,I);if(typeof ne>"u")throw I&&I.type,new Error(Hi(14));O[K]=ne,L=L||ne!==G}return L=L||m.length!==Object.keys(E).length,L?O:E}}function o0(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length===0?function(l){return l}:t.length===1?t[0]:t.reduce(function(l,h){return function(){return l(h.apply(void 0,arguments))}})}function oF(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(l){return function(){var h=l.apply(void 0,arguments),m=function(){throw new Error(Hi(15))},x={getState:h.getState,dispatch:function(){return m.apply(void 0,arguments)}},a=t.map(function(E){return E(x)});return m=o0.apply(void 0,a)(h.dispatch),eI(eI({},h),{},{dispatch:m})}}}function CR(e){var t=function(l){var h=l.dispatch,m=l.getState;return function(x){return function(a){return typeof a=="function"?a(h,m,e):x(a)}}};return t}var kR=CR();kR.withExtraArgument=CR;const nI=kR;var IR=globalThis&&globalThis.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,h){l.__proto__=h}||function(l,h){for(var m in h)Object.prototype.hasOwnProperty.call(h,m)&&(l[m]=h[m])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function l(){this.constructor=t}t.prototype=r===null?Object.create(r):(l.prototype=r.prototype,new l)}}(),sF=globalThis&&globalThis.__generator||function(e,t){var r={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},l,h,m,x;return x={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function a(I){return function(L){return E([I,L])}}function E(I){if(l)throw new TypeError("Generator is already executing.");for(;r;)try{if(l=1,h&&(m=I[0]&2?h.return:I[0]?h.throw||((m=h.return)&&m.call(h),0):h.next)&&!(m=m.call(h,I[1])).done)return m;switch(h=0,m&&(I=[I[0]&2,m.value]),I[0]){case 0:case 1:m=I;break;case 4:return r.label++,{value:I[1],done:!1};case 5:r.label++,h=I[1],I=[0];continue;case 7:I=r.ops.pop(),r.trys.pop();continue;default:if(m=r.trys,!(m=m.length>0&&m[m.length-1])&&(I[0]===6||I[0]===2)){r=0;continue}if(I[0]===3&&(!m||I[1]>m[0]&&I[1]<m[3])){r.label=I[1];break}if(I[0]===6&&r.label<m[1]){r.label=m[1],m=I;break}if(m&&r.label<m[2]){r.label=m[2],r.ops.push(I);break}m[2]&&r.ops.pop(),r.trys.pop();continue}I=t.call(e,r)}catch(L){I=[6,L],h=0}finally{l=m=0}if(I[0]&5)throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}},_h=globalThis&&globalThis.__spreadArray||function(e,t){for(var r=0,l=t.length,h=e.length;r<l;r++,h++)e[h]=t[r];return e},aF=Object.defineProperty,lF=Object.defineProperties,cF=Object.getOwnPropertyDescriptors,rI=Object.getOwnPropertySymbols,uF=Object.prototype.hasOwnProperty,dF=Object.prototype.propertyIsEnumerable,iI=function(e,t,r){return t in e?aF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Ql=function(e,t){for(var r in t||(t={}))uF.call(t,r)&&iI(e,r,t[r]);if(rI)for(var l=0,h=rI(t);l<h.length;l++){var r=h[l];dF.call(t,r)&&iI(e,r,t[r])}return e},cb=function(e,t){return lF(e,cF(t))},hF=function(e,t,r){return new Promise(function(l,h){var m=function(E){try{a(r.next(E))}catch(I){h(I)}},x=function(E){try{a(r.throw(E))}catch(I){h(I)}},a=function(E){return E.done?l(E.value):Promise.resolve(E.value).then(m,x)};a((r=r.apply(e,t)).next())})},pF=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?o0:o0.apply(null,arguments)};function fF(e){if(typeof e!="object"||e===null)return!1;var t=Object.getPrototypeOf(e);if(t===null)return!0;for(var r=t;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return t===r}function ec(e,t){function r(){for(var l=[],h=0;h<arguments.length;h++)l[h]=arguments[h];if(t){var m=t.apply(void 0,l);if(!m)throw new Error("prepareAction did not return an object");return Ql(Ql({type:e,payload:m.payload},"meta"in m&&{meta:m.meta}),"error"in m&&{error:m.error})}return{type:e,payload:l[0]}}return r.toString=function(){return""+e},r.type=e,r.match=function(l){return l.type===e},r}var mF=function(e){IR(t,e);function t(){for(var r=[],l=0;l<arguments.length;l++)r[l]=arguments[l];var h=e.apply(this,r)||this;return Object.setPrototypeOf(h,t.prototype),h}return Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var r=[],l=0;l<arguments.length;l++)r[l]=arguments[l];return e.prototype.concat.apply(this,r)},t.prototype.prepend=function(){for(var r=[],l=0;l<arguments.length;l++)r[l]=arguments[l];return r.length===1&&Array.isArray(r[0])?new(t.bind.apply(t,_h([void 0],r[0].concat(this)))):new(t.bind.apply(t,_h([void 0],r.concat(this))))},t}(Array),gF=function(e){IR(t,e);function t(){for(var r=[],l=0;l<arguments.length;l++)r[l]=arguments[l];var h=e.apply(this,r)||this;return Object.setPrototypeOf(h,t.prototype),h}return Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var r=[],l=0;l<arguments.length;l++)r[l]=arguments[l];return e.prototype.concat.apply(this,r)},t.prototype.prepend=function(){for(var r=[],l=0;l<arguments.length;l++)r[l]=arguments[l];return r.length===1&&Array.isArray(r[0])?new(t.bind.apply(t,_h([void 0],r[0].concat(this)))):new(t.bind.apply(t,_h([void 0],r.concat(this))))},t}(Array);function zw(e){return Qa(e)?ER(e,function(){}):e}function yF(e){return typeof e=="boolean"}function _F(){return function(t){return xF(t)}}function xF(e){e===void 0&&(e={});var t=e.thunk,r=t===void 0?!0:t;e.immutableCheck,e.serializableCheck,e.actionCreatorCheck;var l=new mF;return r&&(yF(r)?l.push(nI):l.push(nI.withExtraArgument(r.extraArgument))),l}var vF=!0;function bF(e){var t=_F(),r=e||{},l=r.reducer,h=l===void 0?void 0:l,m=r.middleware,x=m===void 0?t():m,a=r.devTools,E=a===void 0?!0:a,I=r.preloadedState,L=I===void 0?void 0:I,O=r.enhancers,F=O===void 0?void 0:O,K;if(typeof h=="function")K=h;else if(fF(h))K=iF(h);else throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var W=x;typeof W=="function"&&(W=W(t));var G=oF.apply(void 0,W),ne=o0;E&&(ne=pF(Ql({trace:!vF},typeof E=="object"&&E)));var Z=new gF(G),H=Z;Array.isArray(F)?H=_h([G],F):typeof F=="function"&&(H=F(Z));var V=ne.apply(void 0,H);return TR(K,L,V)}function AR(e){var t={},r=[],l,h={addCase:function(m,x){var a=typeof m=="string"?m:m.type;if(!a)throw new Error("`builder.addCase` cannot be called with an empty action type");if(a in t)throw new Error("`builder.addCase` cannot be called with two reducers for the same action type");return t[a]=x,h},addMatcher:function(m,x){return r.push({matcher:m,reducer:x}),h},addDefaultCase:function(m){return l=m,h}};return e(h),[t,r,l]}function wF(e){return typeof e=="function"}function SF(e,t,r,l){r===void 0&&(r=[]);var h=typeof t=="function"?AR(t):[t,r,l],m=h[0],x=h[1],a=h[2],E;if(wF(e))E=function(){return zw(e())};else{var I=zw(e);E=function(){return I}}function L(O,F){O===void 0&&(O=E());var K=_h([m[F.type]],x.filter(function(W){var G=W.matcher;return G(F)}).map(function(W){var G=W.reducer;return G}));return K.filter(function(W){return!!W}).length===0&&(K=[a]),K.reduce(function(W,G){if(G)if(ac(W)){var ne=W,Z=G(ne,F);return Z===void 0?W:Z}else{if(Qa(W))return ER(W,function(H){return G(H,F)});var Z=G(W,F);if(Z===void 0){if(W===null)return W;throw Error("A case reducer on a non-draftable value must not return undefined")}return Z}return W},O)}return L.getInitialState=E,L}function EF(e,t){return e+"/"+t}function cx(e){var t=e.name;if(!t)throw new Error("`name` is a required option for createSlice");typeof process<"u";var r=typeof e.initialState=="function"?e.initialState:zw(e.initialState),l=e.reducers||{},h=Object.keys(l),m={},x={},a={};h.forEach(function(L){var O=l[L],F=EF(t,L),K,W;"reducer"in O?(K=O.reducer,W=O.prepare):K=O,m[L]=K,x[F]=K,a[L]=W?ec(F,W):ec(F)});function E(){var L=typeof e.extraReducers=="function"?AR(e.extraReducers):[e.extraReducers],O=L[0],F=O===void 0?{}:O,K=L[1],W=K===void 0?[]:K,G=L[2],ne=G===void 0?void 0:G,Z=Ql(Ql({},F),x);return SF(r,function(H){for(var V in Z)H.addCase(V,Z[V]);for(var oe=0,pe=W;oe<pe.length;oe++){var _e=pe[oe];H.addMatcher(_e.matcher,_e.reducer)}ne&&H.addDefaultCase(ne)})}var I;return{name:t,reducer:function(L,O){return I||(I=E()),I(L,O)},actions:a,caseReducers:m,getInitialState:function(){return I||(I=E()),I.getInitialState()}}}var TF="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",CF=function(e){e===void 0&&(e=21);for(var t="",r=e;r--;)t+=TF[Math.random()*64|0];return t},kF=["name","message","stack","code"],ub=function(){function e(t,r){this.payload=t,this.meta=r}return e}(),oI=function(){function e(t,r){this.payload=t,this.meta=r}return e}(),IF=function(e){if(typeof e=="object"&&e!==null){for(var t={},r=0,l=kF;r<l.length;r++){var h=l[r];typeof e[h]=="string"&&(t[h]=e[h])}return t}return{message:String(e)}},Iu=function(){function e(t,r,l){var h=ec(t+"/fulfilled",function(I,L,O,F){return{payload:I,meta:cb(Ql({},F||{}),{arg:O,requestId:L,requestStatus:"fulfilled"})}}),m=ec(t+"/pending",function(I,L,O){return{payload:void 0,meta:cb(Ql({},O||{}),{arg:L,requestId:I,requestStatus:"pending"})}}),x=ec(t+"/rejected",function(I,L,O,F,K){return{payload:F,error:(l&&l.serializeError||IF)(I||"Rejected"),meta:cb(Ql({},K||{}),{arg:O,requestId:L,rejectedWithValue:!!F,requestStatus:"rejected",aborted:(I==null?void 0:I.name)==="AbortError",condition:(I==null?void 0:I.name)==="ConditionError"})}}),a=typeof AbortController<"u"?AbortController:function(){function I(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return I.prototype.abort=function(){},I}();function E(I){return function(L,O,F){var K=l!=null&&l.idGenerator?l.idGenerator(I):CF(),W=new a,G;function ne(H){G=H,W.abort()}var Z=function(){return hF(this,null,function(){var H,V,oe,pe,_e,xe,De;return sF(this,function(ye){switch(ye.label){case 0:return ye.trys.push([0,4,,5]),pe=(H=l==null?void 0:l.condition)==null?void 0:H.call(l,I,{getState:O,extra:F}),MF(pe)?[4,pe]:[3,2];case 1:pe=ye.sent(),ye.label=2;case 2:if(pe===!1||W.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return _e=new Promise(function(Ae,ft){return W.signal.addEventListener("abort",function(){return ft({name:"AbortError",message:G||"Aborted"})})}),L(m(K,I,(V=l==null?void 0:l.getPendingMeta)==null?void 0:V.call(l,{requestId:K,arg:I},{getState:O,extra:F}))),[4,Promise.race([_e,Promise.resolve(r(I,{dispatch:L,getState:O,extra:F,requestId:K,signal:W.signal,abort:ne,rejectWithValue:function(Ae,ft){return new ub(Ae,ft)},fulfillWithValue:function(Ae,ft){return new oI(Ae,ft)}})).then(function(Ae){if(Ae instanceof ub)throw Ae;return Ae instanceof oI?h(Ae.payload,K,I,Ae.meta):h(Ae,K,I)})])];case 3:return oe=ye.sent(),[3,5];case 4:return xe=ye.sent(),oe=xe instanceof ub?x(null,K,I,xe.payload,xe.meta):x(xe,K,I),[3,5];case 5:return De=l&&!l.dispatchConditionRejection&&x.match(oe)&&oe.meta.condition,De||L(oe),[2,oe]}})})}();return Object.assign(Z,{abort:ne,requestId:K,arg:I,unwrap:function(){return Z.then(AF)}})}}return Object.assign(E,{pending:m,rejected:x,fulfilled:h,typePrefix:t})}return e.withTypes=function(){return e},e}();function AF(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function MF(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var mS="listenerMiddleware";ec(mS+"/add");ec(mS+"/removeAll");ec(mS+"/remove");var sI;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:globalThis);Z4();function MR(e,t){return function(){return e.apply(t,arguments)}}const{toString:PF}=Object.prototype,{getPrototypeOf:gS}=Object,{iterator:ux,toStringTag:PR}=Symbol,dx=(e=>t=>{const r=PF.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Js=e=>(e=e.toLowerCase(),t=>dx(t)===e),hx=e=>t=>typeof t===e,{isArray:Ph}=Array,Im=hx("undefined");function Vm(e){return e!==null&&!Im(e)&&e.constructor!==null&&!Im(e.constructor)&&So(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const RR=Js("ArrayBuffer");function RF(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&RR(e.buffer),t}const zF=hx("string"),So=hx("function"),zR=hx("number"),Wm=e=>e!==null&&typeof e=="object",LF=e=>e===!0||e===!1,h_=e=>{if(dx(e)!=="object")return!1;const t=gS(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(PR in e)&&!(ux in e)},DF=e=>{if(!Wm(e)||Vm(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},OF=Js("Date"),BF=Js("File"),FF=Js("Blob"),jF=Js("FileList"),NF=e=>Wm(e)&&So(e.pipe),$F=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||So(e.append)&&((t=dx(e))==="formdata"||t==="object"&&So(e.toString)&&e.toString()==="[object FormData]"))},UF=Js("URLSearchParams"),[VF,WF,GF,qF]=["ReadableStream","Request","Response","Headers"].map(Js),HF=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Gm(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let l,h;if(typeof e!="object"&&(e=[e]),Ph(e))for(l=0,h=e.length;l<h;l++)t.call(null,e[l],l,e);else{if(Vm(e))return;const m=r?Object.getOwnPropertyNames(e):Object.keys(e),x=m.length;let a;for(l=0;l<x;l++)a=m[l],t.call(null,e[a],a,e)}}function LR(e,t){if(Vm(e))return null;t=t.toLowerCase();const r=Object.keys(e);let l=r.length,h;for(;l-- >0;)if(h=r[l],t===h.toLowerCase())return h;return null}const uu=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:globalThis)(),DR=e=>!Im(e)&&e!==uu;function Lw(){const{caseless:e}=DR(this)&&this||{},t={},r=(l,h)=>{const m=e&&LR(t,h)||h;h_(t[m])&&h_(l)?t[m]=Lw(t[m],l):h_(l)?t[m]=Lw({},l):Ph(l)?t[m]=l.slice():t[m]=l};for(let l=0,h=arguments.length;l<h;l++)arguments[l]&&Gm(arguments[l],r);return t}const ZF=(e,t,r,{allOwnKeys:l}={})=>(Gm(t,(h,m)=>{r&&So(h)?e[m]=MR(h,r):e[m]=h},{allOwnKeys:l}),e),XF=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),KF=(e,t,r,l)=>{e.prototype=Object.create(t.prototype,l),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},YF=(e,t,r,l)=>{let h,m,x;const a={};if(t=t||{},e==null)return t;do{for(h=Object.getOwnPropertyNames(e),m=h.length;m-- >0;)x=h[m],(!l||l(x,e,t))&&!a[x]&&(t[x]=e[x],a[x]=!0);e=r!==!1&&gS(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},JF=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const l=e.indexOf(t,r);return l!==-1&&l===r},QF=e=>{if(!e)return null;if(Ph(e))return e;let t=e.length;if(!zR(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},ej=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&gS(Uint8Array)),tj=(e,t)=>{const l=(e&&e[ux]).call(e);let h;for(;(h=l.next())&&!h.done;){const m=h.value;t.call(e,m[0],m[1])}},nj=(e,t)=>{let r;const l=[];for(;(r=e.exec(t))!==null;)l.push(r);return l},rj=Js("HTMLFormElement"),ij=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,l,h){return l.toUpperCase()+h}),aI=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),oj=Js("RegExp"),OR=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),l={};Gm(r,(h,m)=>{let x;(x=t(h,m,e))!==!1&&(l[m]=x||h)}),Object.defineProperties(e,l)},sj=e=>{OR(e,(t,r)=>{if(So(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const l=e[r];if(So(l)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},aj=(e,t)=>{const r={},l=h=>{h.forEach(m=>{r[m]=!0})};return Ph(e)?l(e):l(String(e).split(t)),r},lj=()=>{},cj=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function uj(e){return!!(e&&So(e.append)&&e[PR]==="FormData"&&e[ux])}const dj=e=>{const t=new Array(10),r=(l,h)=>{if(Wm(l)){if(t.indexOf(l)>=0)return;if(Vm(l))return l;if(!("toJSON"in l)){t[h]=l;const m=Ph(l)?[]:{};return Gm(l,(x,a)=>{const E=r(x,h+1);!Im(E)&&(m[a]=E)}),t[h]=void 0,m}}return l};return r(e,0)},hj=Js("AsyncFunction"),pj=e=>e&&(Wm(e)||So(e))&&So(e.then)&&So(e.catch),BR=((e,t)=>e?setImmediate:t?((r,l)=>(uu.addEventListener("message",({source:h,data:m})=>{h===uu&&m===r&&l.length&&l.shift()()},!1),h=>{l.push(h),uu.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",So(uu.postMessage)),fj=typeof queueMicrotask<"u"?queueMicrotask.bind(uu):typeof process<"u"&&process.nextTick||BR,mj=e=>e!=null&&So(e[ux]),Xe={isArray:Ph,isArrayBuffer:RR,isBuffer:Vm,isFormData:$F,isArrayBufferView:RF,isString:zF,isNumber:zR,isBoolean:LF,isObject:Wm,isPlainObject:h_,isEmptyObject:DF,isReadableStream:VF,isRequest:WF,isResponse:GF,isHeaders:qF,isUndefined:Im,isDate:OF,isFile:BF,isBlob:FF,isRegExp:oj,isFunction:So,isStream:NF,isURLSearchParams:UF,isTypedArray:ej,isFileList:jF,forEach:Gm,merge:Lw,extend:ZF,trim:HF,stripBOM:XF,inherits:KF,toFlatObject:YF,kindOf:dx,kindOfTest:Js,endsWith:JF,toArray:QF,forEachEntry:tj,matchAll:nj,isHTMLForm:rj,hasOwnProperty:aI,hasOwnProp:aI,reduceDescriptors:OR,freezeMethods:sj,toObjectSet:aj,toCamelCase:ij,noop:lj,toFiniteNumber:cj,findKey:LR,globalThis:uu,isContextDefined:DR,isSpecCompliantForm:uj,toJSONObject:dj,isAsyncFn:hj,isThenable:pj,setImmediate:BR,asap:fj,isIterable:mj};function fn(e,t,r,l,h){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),l&&(this.request=l),h&&(this.response=h,this.status=h.status?h.status:null)}Xe.inherits(fn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Xe.toJSONObject(this.config),code:this.code,status:this.status}}});const FR=fn.prototype,jR={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{jR[e]={value:e}});Object.defineProperties(fn,jR);Object.defineProperty(FR,"isAxiosError",{value:!0});fn.from=(e,t,r,l,h,m)=>{const x=Object.create(FR);return Xe.toFlatObject(e,x,function(E){return E!==Error.prototype},a=>a!=="isAxiosError"),fn.call(x,e.message,t,r,l,h),x.cause=e,x.name=e.name,m&&Object.assign(x,m),x};const gj=null;function Dw(e){return Xe.isPlainObject(e)||Xe.isArray(e)}function NR(e){return Xe.endsWith(e,"[]")?e.slice(0,-2):e}function lI(e,t,r){return e?e.concat(t).map(function(h,m){return h=NR(h),!r&&m?"["+h+"]":h}).join(r?".":""):t}function yj(e){return Xe.isArray(e)&&!e.some(Dw)}const _j=Xe.toFlatObject(Xe,{},null,function(t){return/^is[A-Z]/.test(t)});function px(e,t,r){if(!Xe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Xe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(G,ne){return!Xe.isUndefined(ne[G])});const l=r.metaTokens,h=r.visitor||L,m=r.dots,x=r.indexes,E=(r.Blob||typeof Blob<"u"&&Blob)&&Xe.isSpecCompliantForm(t);if(!Xe.isFunction(h))throw new TypeError("visitor must be a function");function I(W){if(W===null)return"";if(Xe.isDate(W))return W.toISOString();if(Xe.isBoolean(W))return W.toString();if(!E&&Xe.isBlob(W))throw new fn("Blob is not supported. Use a Buffer instead.");return Xe.isArrayBuffer(W)||Xe.isTypedArray(W)?E&&typeof Blob=="function"?new Blob([W]):Buffer.from(W):W}function L(W,G,ne){let Z=W;if(W&&!ne&&typeof W=="object"){if(Xe.endsWith(G,"{}"))G=l?G:G.slice(0,-2),W=JSON.stringify(W);else if(Xe.isArray(W)&&yj(W)||(Xe.isFileList(W)||Xe.endsWith(G,"[]"))&&(Z=Xe.toArray(W)))return G=NR(G),Z.forEach(function(V,oe){!(Xe.isUndefined(V)||V===null)&&t.append(x===!0?lI([G],oe,m):x===null?G:G+"[]",I(V))}),!1}return Dw(W)?!0:(t.append(lI(ne,G,m),I(W)),!1)}const O=[],F=Object.assign(_j,{defaultVisitor:L,convertValue:I,isVisitable:Dw});function K(W,G){if(!Xe.isUndefined(W)){if(O.indexOf(W)!==-1)throw Error("Circular reference detected in "+G.join("."));O.push(W),Xe.forEach(W,function(Z,H){(!(Xe.isUndefined(Z)||Z===null)&&h.call(t,Z,Xe.isString(H)?H.trim():H,G,F))===!0&&K(Z,G?G.concat(H):[H])}),O.pop()}}if(!Xe.isObject(e))throw new TypeError("data must be an object");return K(e),t}function cI(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(l){return t[l]})}function yS(e,t){this._pairs=[],e&&px(e,this,t)}const $R=yS.prototype;$R.append=function(t,r){this._pairs.push([t,r])};$R.toString=function(t){const r=t?function(l){return t.call(this,l,cI)}:cI;return this._pairs.map(function(h){return r(h[0])+"="+r(h[1])},"").join("&")};function xj(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function UR(e,t,r){if(!t)return e;const l=r&&r.encode||xj;Xe.isFunction(r)&&(r={serialize:r});const h=r&&r.serialize;let m;if(h?m=h(t,r):m=Xe.isURLSearchParams(t)?t.toString():new yS(t,r).toString(l),m){const x=e.indexOf("#");x!==-1&&(e=e.slice(0,x)),e+=(e.indexOf("?")===-1?"?":"&")+m}return e}class vj{constructor(){this.handlers=[]}use(t,r,l){return this.handlers.push({fulfilled:t,rejected:r,synchronous:l?l.synchronous:!1,runWhen:l?l.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Xe.forEach(this.handlers,function(l){l!==null&&t(l)})}}const uI=vj,VR={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},bj=typeof URLSearchParams<"u"?URLSearchParams:yS,wj=typeof FormData<"u"?FormData:null,Sj=typeof Blob<"u"?Blob:null,Ej={isBrowser:!0,classes:{URLSearchParams:bj,FormData:wj,Blob:Sj},protocols:["http","https","file","blob","url","data"]},_S=typeof window<"u"&&typeof document<"u",Ow=typeof navigator=="object"&&navigator||void 0,Tj=_S&&(!Ow||["ReactNative","NativeScript","NS"].indexOf(Ow.product)<0),Cj=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),kj=_S&&window.location.href||"http://localhost",Ij=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:_S,hasStandardBrowserEnv:Tj,hasStandardBrowserWebWorkerEnv:Cj,navigator:Ow,origin:kj},Symbol.toStringTag,{value:"Module"})),Ki={...Ij,...Ej};function Aj(e,t){return px(e,new Ki.classes.URLSearchParams,{visitor:function(r,l,h,m){return Ki.isNode&&Xe.isBuffer(r)?(this.append(l,r.toString("base64")),!1):m.defaultVisitor.apply(this,arguments)},...t})}function Mj(e){return Xe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Pj(e){const t={},r=Object.keys(e);let l;const h=r.length;let m;for(l=0;l<h;l++)m=r[l],t[m]=e[m];return t}function WR(e){function t(r,l,h,m){let x=r[m++];if(x==="__proto__")return!0;const a=Number.isFinite(+x),E=m>=r.length;return x=!x&&Xe.isArray(h)?h.length:x,E?(Xe.hasOwnProp(h,x)?h[x]=[h[x],l]:h[x]=l,!a):((!h[x]||!Xe.isObject(h[x]))&&(h[x]=[]),t(r,l,h[x],m)&&Xe.isArray(h[x])&&(h[x]=Pj(h[x])),!a)}if(Xe.isFormData(e)&&Xe.isFunction(e.entries)){const r={};return Xe.forEachEntry(e,(l,h)=>{t(Mj(l),h,r,0)}),r}return null}function Rj(e,t,r){if(Xe.isString(e))try{return(t||JSON.parse)(e),Xe.trim(e)}catch(l){if(l.name!=="SyntaxError")throw l}return(r||JSON.stringify)(e)}const xS={transitional:VR,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const l=r.getContentType()||"",h=l.indexOf("application/json")>-1,m=Xe.isObject(t);if(m&&Xe.isHTMLForm(t)&&(t=new FormData(t)),Xe.isFormData(t))return h?JSON.stringify(WR(t)):t;if(Xe.isArrayBuffer(t)||Xe.isBuffer(t)||Xe.isStream(t)||Xe.isFile(t)||Xe.isBlob(t)||Xe.isReadableStream(t))return t;if(Xe.isArrayBufferView(t))return t.buffer;if(Xe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(m){if(l.indexOf("application/x-www-form-urlencoded")>-1)return Aj(t,this.formSerializer).toString();if((a=Xe.isFileList(t))||l.indexOf("multipart/form-data")>-1){const E=this.env&&this.env.FormData;return px(a?{"files[]":t}:t,E&&new E,this.formSerializer)}}return m||h?(r.setContentType("application/json",!1),Rj(t)):t}],transformResponse:[function(t){const r=this.transitional||xS.transitional,l=r&&r.forcedJSONParsing,h=this.responseType==="json";if(Xe.isResponse(t)||Xe.isReadableStream(t))return t;if(t&&Xe.isString(t)&&(l&&!this.responseType||h)){const x=!(r&&r.silentJSONParsing)&&h;try{return JSON.parse(t)}catch(a){if(x)throw a.name==="SyntaxError"?fn.from(a,fn.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ki.classes.FormData,Blob:Ki.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Xe.forEach(["delete","get","head","post","put","patch"],e=>{xS.headers[e]={}});const vS=xS,zj=Xe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Lj=e=>{const t={};let r,l,h;return e&&e.split(`
`).forEach(function(x){h=x.indexOf(":"),r=x.substring(0,h).trim().toLowerCase(),l=x.substring(h+1).trim(),!(!r||t[r]&&zj[r])&&(r==="set-cookie"?t[r]?t[r].push(l):t[r]=[l]:t[r]=t[r]?t[r]+", "+l:l)}),t},dI=Symbol("internals");function If(e){return e&&String(e).trim().toLowerCase()}function p_(e){return e===!1||e==null?e:Xe.isArray(e)?e.map(p_):String(e)}function Dj(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let l;for(;l=r.exec(e);)t[l[1]]=l[2];return t}const Oj=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function db(e,t,r,l,h){if(Xe.isFunction(l))return l.call(this,t,r);if(h&&(t=r),!!Xe.isString(t)){if(Xe.isString(l))return t.indexOf(l)!==-1;if(Xe.isRegExp(l))return l.test(t)}}function Bj(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,l)=>r.toUpperCase()+l)}function Fj(e,t){const r=Xe.toCamelCase(" "+t);["get","set","has"].forEach(l=>{Object.defineProperty(e,l+r,{value:function(h,m,x){return this[l].call(this,t,h,m,x)},configurable:!0})})}class fx{constructor(t){t&&this.set(t)}set(t,r,l){const h=this;function m(a,E,I){const L=If(E);if(!L)throw new Error("header name must be a non-empty string");const O=Xe.findKey(h,L);(!O||h[O]===void 0||I===!0||I===void 0&&h[O]!==!1)&&(h[O||E]=p_(a))}const x=(a,E)=>Xe.forEach(a,(I,L)=>m(I,L,E));if(Xe.isPlainObject(t)||t instanceof this.constructor)x(t,r);else if(Xe.isString(t)&&(t=t.trim())&&!Oj(t))x(Lj(t),r);else if(Xe.isObject(t)&&Xe.isIterable(t)){let a={},E,I;for(const L of t){if(!Xe.isArray(L))throw TypeError("Object iterator must return a key-value pair");a[I=L[0]]=(E=a[I])?Xe.isArray(E)?[...E,L[1]]:[E,L[1]]:L[1]}x(a,r)}else t!=null&&m(r,t,l);return this}get(t,r){if(t=If(t),t){const l=Xe.findKey(this,t);if(l){const h=this[l];if(!r)return h;if(r===!0)return Dj(h);if(Xe.isFunction(r))return r.call(this,h,l);if(Xe.isRegExp(r))return r.exec(h);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=If(t),t){const l=Xe.findKey(this,t);return!!(l&&this[l]!==void 0&&(!r||db(this,this[l],l,r)))}return!1}delete(t,r){const l=this;let h=!1;function m(x){if(x=If(x),x){const a=Xe.findKey(l,x);a&&(!r||db(l,l[a],a,r))&&(delete l[a],h=!0)}}return Xe.isArray(t)?t.forEach(m):m(t),h}clear(t){const r=Object.keys(this);let l=r.length,h=!1;for(;l--;){const m=r[l];(!t||db(this,this[m],m,t,!0))&&(delete this[m],h=!0)}return h}normalize(t){const r=this,l={};return Xe.forEach(this,(h,m)=>{const x=Xe.findKey(l,m);if(x){r[x]=p_(h),delete r[m];return}const a=t?Bj(m):String(m).trim();a!==m&&delete r[m],r[a]=p_(h),l[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Xe.forEach(this,(l,h)=>{l!=null&&l!==!1&&(r[h]=t&&Xe.isArray(l)?l.join(", "):l)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const l=new this(t);return r.forEach(h=>l.set(h)),l}static accessor(t){const l=(this[dI]=this[dI]={accessors:{}}).accessors,h=this.prototype;function m(x){const a=If(x);l[a]||(Fj(h,x),l[a]=!0)}return Xe.isArray(t)?t.forEach(m):m(t),this}}fx.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Xe.reduceDescriptors(fx.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(l){this[r]=l}}});Xe.freezeMethods(fx);const Xs=fx;function hb(e,t){const r=this||vS,l=t||r,h=Xs.from(l.headers);let m=l.data;return Xe.forEach(e,function(a){m=a.call(r,m,h.normalize(),t?t.status:void 0)}),h.normalize(),m}function GR(e){return!!(e&&e.__CANCEL__)}function Rh(e,t,r){fn.call(this,e??"canceled",fn.ERR_CANCELED,t,r),this.name="CanceledError"}Xe.inherits(Rh,fn,{__CANCEL__:!0});function qR(e,t,r){const l=r.config.validateStatus;!r.status||!l||l(r.status)?e(r):t(new fn("Request failed with status code "+r.status,[fn.ERR_BAD_REQUEST,fn.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function jj(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Nj(e,t){e=e||10;const r=new Array(e),l=new Array(e);let h=0,m=0,x;return t=t!==void 0?t:1e3,function(E){const I=Date.now(),L=l[m];x||(x=I),r[h]=E,l[h]=I;let O=m,F=0;for(;O!==h;)F+=r[O++],O=O%e;if(h=(h+1)%e,h===m&&(m=(m+1)%e),I-x<t)return;const K=L&&I-L;return K?Math.round(F*1e3/K):void 0}}function $j(e,t){let r=0,l=1e3/t,h,m;const x=(I,L=Date.now())=>{r=L,h=null,m&&(clearTimeout(m),m=null),e(...I)};return[(...I)=>{const L=Date.now(),O=L-r;O>=l?x(I,L):(h=I,m||(m=setTimeout(()=>{m=null,x(h)},l-O)))},()=>h&&x(h)]}const s0=(e,t,r=3)=>{let l=0;const h=Nj(50,250);return $j(m=>{const x=m.loaded,a=m.lengthComputable?m.total:void 0,E=x-l,I=h(E),L=x<=a;l=x;const O={loaded:x,total:a,progress:a?x/a:void 0,bytes:E,rate:I||void 0,estimated:I&&a&&L?(a-x)/I:void 0,event:m,lengthComputable:a!=null,[t?"download":"upload"]:!0};e(O)},r)},hI=(e,t)=>{const r=e!=null;return[l=>t[0]({lengthComputable:r,total:e,loaded:l}),t[1]]},pI=e=>(...t)=>Xe.asap(()=>e(...t)),Uj=Ki.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Ki.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Ki.origin),Ki.navigator&&/(msie|trident)/i.test(Ki.navigator.userAgent)):()=>!0,Vj=Ki.hasStandardBrowserEnv?{write(e,t,r,l,h,m){const x=[e+"="+encodeURIComponent(t)];Xe.isNumber(r)&&x.push("expires="+new Date(r).toGMTString()),Xe.isString(l)&&x.push("path="+l),Xe.isString(h)&&x.push("domain="+h),m===!0&&x.push("secure"),document.cookie=x.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Wj(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Gj(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function HR(e,t,r){let l=!Wj(t);return e&&(l||r==!1)?Gj(e,t):t}const fI=e=>e instanceof Xs?{...e}:e;function wu(e,t){t=t||{};const r={};function l(I,L,O,F){return Xe.isPlainObject(I)&&Xe.isPlainObject(L)?Xe.merge.call({caseless:F},I,L):Xe.isPlainObject(L)?Xe.merge({},L):Xe.isArray(L)?L.slice():L}function h(I,L,O,F){if(Xe.isUndefined(L)){if(!Xe.isUndefined(I))return l(void 0,I,O,F)}else return l(I,L,O,F)}function m(I,L){if(!Xe.isUndefined(L))return l(void 0,L)}function x(I,L){if(Xe.isUndefined(L)){if(!Xe.isUndefined(I))return l(void 0,I)}else return l(void 0,L)}function a(I,L,O){if(O in t)return l(I,L);if(O in e)return l(void 0,I)}const E={url:m,method:m,data:m,baseURL:x,transformRequest:x,transformResponse:x,paramsSerializer:x,timeout:x,timeoutMessage:x,withCredentials:x,withXSRFToken:x,adapter:x,responseType:x,xsrfCookieName:x,xsrfHeaderName:x,onUploadProgress:x,onDownloadProgress:x,decompress:x,maxContentLength:x,maxBodyLength:x,beforeRedirect:x,transport:x,httpAgent:x,httpsAgent:x,cancelToken:x,socketPath:x,responseEncoding:x,validateStatus:a,headers:(I,L,O)=>h(fI(I),fI(L),O,!0)};return Xe.forEach(Object.keys({...e,...t}),function(L){const O=E[L]||h,F=O(e[L],t[L],L);Xe.isUndefined(F)&&O!==a||(r[L]=F)}),r}const ZR=e=>{const t=wu({},e);let{data:r,withXSRFToken:l,xsrfHeaderName:h,xsrfCookieName:m,headers:x,auth:a}=t;t.headers=x=Xs.from(x),t.url=UR(HR(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),a&&x.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let E;if(Xe.isFormData(r)){if(Ki.hasStandardBrowserEnv||Ki.hasStandardBrowserWebWorkerEnv)x.setContentType(void 0);else if((E=x.getContentType())!==!1){const[I,...L]=E?E.split(";").map(O=>O.trim()).filter(Boolean):[];x.setContentType([I||"multipart/form-data",...L].join("; "))}}if(Ki.hasStandardBrowserEnv&&(l&&Xe.isFunction(l)&&(l=l(t)),l||l!==!1&&Uj(t.url))){const I=h&&m&&Vj.read(m);I&&x.set(h,I)}return t},qj=typeof XMLHttpRequest<"u",Hj=qj&&function(e){return new Promise(function(r,l){const h=ZR(e);let m=h.data;const x=Xs.from(h.headers).normalize();let{responseType:a,onUploadProgress:E,onDownloadProgress:I}=h,L,O,F,K,W;function G(){K&&K(),W&&W(),h.cancelToken&&h.cancelToken.unsubscribe(L),h.signal&&h.signal.removeEventListener("abort",L)}let ne=new XMLHttpRequest;ne.open(h.method.toUpperCase(),h.url,!0),ne.timeout=h.timeout;function Z(){if(!ne)return;const V=Xs.from("getAllResponseHeaders"in ne&&ne.getAllResponseHeaders()),pe={data:!a||a==="text"||a==="json"?ne.responseText:ne.response,status:ne.status,statusText:ne.statusText,headers:V,config:e,request:ne};qR(function(xe){r(xe),G()},function(xe){l(xe),G()},pe),ne=null}"onloadend"in ne?ne.onloadend=Z:ne.onreadystatechange=function(){!ne||ne.readyState!==4||ne.status===0&&!(ne.responseURL&&ne.responseURL.indexOf("file:")===0)||setTimeout(Z)},ne.onabort=function(){ne&&(l(new fn("Request aborted",fn.ECONNABORTED,e,ne)),ne=null)},ne.onerror=function(){l(new fn("Network Error",fn.ERR_NETWORK,e,ne)),ne=null},ne.ontimeout=function(){let oe=h.timeout?"timeout of "+h.timeout+"ms exceeded":"timeout exceeded";const pe=h.transitional||VR;h.timeoutErrorMessage&&(oe=h.timeoutErrorMessage),l(new fn(oe,pe.clarifyTimeoutError?fn.ETIMEDOUT:fn.ECONNABORTED,e,ne)),ne=null},m===void 0&&x.setContentType(null),"setRequestHeader"in ne&&Xe.forEach(x.toJSON(),function(oe,pe){ne.setRequestHeader(pe,oe)}),Xe.isUndefined(h.withCredentials)||(ne.withCredentials=!!h.withCredentials),a&&a!=="json"&&(ne.responseType=h.responseType),I&&([F,W]=s0(I,!0),ne.addEventListener("progress",F)),E&&ne.upload&&([O,K]=s0(E),ne.upload.addEventListener("progress",O),ne.upload.addEventListener("loadend",K)),(h.cancelToken||h.signal)&&(L=V=>{ne&&(l(!V||V.type?new Rh(null,e,ne):V),ne.abort(),ne=null)},h.cancelToken&&h.cancelToken.subscribe(L),h.signal&&(h.signal.aborted?L():h.signal.addEventListener("abort",L)));const H=jj(h.url);if(H&&Ki.protocols.indexOf(H)===-1){l(new fn("Unsupported protocol "+H+":",fn.ERR_BAD_REQUEST,e));return}ne.send(m||null)})},Zj=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let l=new AbortController,h;const m=function(I){if(!h){h=!0,a();const L=I instanceof Error?I:this.reason;l.abort(L instanceof fn?L:new Rh(L instanceof Error?L.message:L))}};let x=t&&setTimeout(()=>{x=null,m(new fn(`timeout ${t} of ms exceeded`,fn.ETIMEDOUT))},t);const a=()=>{e&&(x&&clearTimeout(x),x=null,e.forEach(I=>{I.unsubscribe?I.unsubscribe(m):I.removeEventListener("abort",m)}),e=null)};e.forEach(I=>I.addEventListener("abort",m));const{signal:E}=l;return E.unsubscribe=()=>Xe.asap(a),E}},Xj=Zj,Kj=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let l=0,h;for(;l<r;)h=l+t,yield e.slice(l,h),l=h},Yj=async function*(e,t){for await(const r of Jj(e))yield*Kj(r,t)},Jj=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:l}=await t.read();if(r)break;yield l}}finally{await t.cancel()}},mI=(e,t,r,l)=>{const h=Yj(e,t);let m=0,x,a=E=>{x||(x=!0,l&&l(E))};return new ReadableStream({async pull(E){try{const{done:I,value:L}=await h.next();if(I){a(),E.close();return}let O=L.byteLength;if(r){let F=m+=O;r(F)}E.enqueue(new Uint8Array(L))}catch(I){throw a(I),I}},cancel(E){return a(E),h.return()}},{highWaterMark:2})},mx=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",XR=mx&&typeof ReadableStream=="function",Qj=mx&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),KR=(e,...t)=>{try{return!!e(...t)}catch{return!1}},eN=XR&&KR(()=>{let e=!1;const t=new Request(Ki.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),gI=64*1024,Bw=XR&&KR(()=>Xe.isReadableStream(new Response("").body)),a0={stream:Bw&&(e=>e.body)};mx&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!a0[t]&&(a0[t]=Xe.isFunction(e[t])?r=>r[t]():(r,l)=>{throw new fn(`Response type '${t}' is not supported`,fn.ERR_NOT_SUPPORT,l)})})})(new Response);const tN=async e=>{if(e==null)return 0;if(Xe.isBlob(e))return e.size;if(Xe.isSpecCompliantForm(e))return(await new Request(Ki.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Xe.isArrayBufferView(e)||Xe.isArrayBuffer(e))return e.byteLength;if(Xe.isURLSearchParams(e)&&(e=e+""),Xe.isString(e))return(await Qj(e)).byteLength},nN=async(e,t)=>{const r=Xe.toFiniteNumber(e.getContentLength());return r??tN(t)},rN=mx&&(async e=>{let{url:t,method:r,data:l,signal:h,cancelToken:m,timeout:x,onDownloadProgress:a,onUploadProgress:E,responseType:I,headers:L,withCredentials:O="same-origin",fetchOptions:F}=ZR(e);I=I?(I+"").toLowerCase():"text";let K=Xj([h,m&&m.toAbortSignal()],x),W;const G=K&&K.unsubscribe&&(()=>{K.unsubscribe()});let ne;try{if(E&&eN&&r!=="get"&&r!=="head"&&(ne=await nN(L,l))!==0){let pe=new Request(t,{method:"POST",body:l,duplex:"half"}),_e;if(Xe.isFormData(l)&&(_e=pe.headers.get("content-type"))&&L.setContentType(_e),pe.body){const[xe,De]=hI(ne,s0(pI(E)));l=mI(pe.body,gI,xe,De)}}Xe.isString(O)||(O=O?"include":"omit");const Z="credentials"in Request.prototype;W=new Request(t,{...F,signal:K,method:r.toUpperCase(),headers:L.normalize().toJSON(),body:l,duplex:"half",credentials:Z?O:void 0});let H=await fetch(W,F);const V=Bw&&(I==="stream"||I==="response");if(Bw&&(a||V&&G)){const pe={};["status","statusText","headers"].forEach(ye=>{pe[ye]=H[ye]});const _e=Xe.toFiniteNumber(H.headers.get("content-length")),[xe,De]=a&&hI(_e,s0(pI(a),!0))||[];H=new Response(mI(H.body,gI,xe,()=>{De&&De(),G&&G()}),pe)}I=I||"text";let oe=await a0[Xe.findKey(a0,I)||"text"](H,e);return!V&&G&&G(),await new Promise((pe,_e)=>{qR(pe,_e,{data:oe,headers:Xs.from(H.headers),status:H.status,statusText:H.statusText,config:e,request:W})})}catch(Z){throw G&&G(),Z&&Z.name==="TypeError"&&/Load failed|fetch/i.test(Z.message)?Object.assign(new fn("Network Error",fn.ERR_NETWORK,e,W),{cause:Z.cause||Z}):fn.from(Z,Z&&Z.code,e,W)}}),Fw={http:gj,xhr:Hj,fetch:rN};Xe.forEach(Fw,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const yI=e=>`- ${e}`,iN=e=>Xe.isFunction(e)||e===null||e===!1,YR={getAdapter:e=>{e=Xe.isArray(e)?e:[e];const{length:t}=e;let r,l;const h={};for(let m=0;m<t;m++){r=e[m];let x;if(l=r,!iN(r)&&(l=Fw[(x=String(r)).toLowerCase()],l===void 0))throw new fn(`Unknown adapter '${x}'`);if(l)break;h[x||"#"+m]=l}if(!l){const m=Object.entries(h).map(([a,E])=>`adapter ${a} `+(E===!1?"is not supported by the environment":"is not available in the build"));let x=t?m.length>1?`since :
`+m.map(yI).join(`
`):" "+yI(m[0]):"as no adapter specified";throw new fn("There is no suitable adapter to dispatch the request "+x,"ERR_NOT_SUPPORT")}return l},adapters:Fw};function pb(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Rh(null,e)}function _I(e){return pb(e),e.headers=Xs.from(e.headers),e.data=hb.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),YR.getAdapter(e.adapter||vS.adapter)(e).then(function(l){return pb(e),l.data=hb.call(e,e.transformResponse,l),l.headers=Xs.from(l.headers),l},function(l){return GR(l)||(pb(e),l&&l.response&&(l.response.data=hb.call(e,e.transformResponse,l.response),l.response.headers=Xs.from(l.response.headers))),Promise.reject(l)})}const JR="1.11.0",gx={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{gx[e]=function(l){return typeof l===e||"a"+(t<1?"n ":" ")+e}});const xI={};gx.transitional=function(t,r,l){function h(m,x){return"[Axios v"+JR+"] Transitional option '"+m+"'"+x+(l?". "+l:"")}return(m,x,a)=>{if(t===!1)throw new fn(h(x," has been removed"+(r?" in "+r:"")),fn.ERR_DEPRECATED);return r&&!xI[x]&&(xI[x]=!0,console.warn(h(x," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(m,x,a):!0}};gx.spelling=function(t){return(r,l)=>(console.warn(`${l} is likely a misspelling of ${t}`),!0)};function oN(e,t,r){if(typeof e!="object")throw new fn("options must be an object",fn.ERR_BAD_OPTION_VALUE);const l=Object.keys(e);let h=l.length;for(;h-- >0;){const m=l[h],x=t[m];if(x){const a=e[m],E=a===void 0||x(a,m,e);if(E!==!0)throw new fn("option "+m+" must be "+E,fn.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new fn("Unknown option "+m,fn.ERR_BAD_OPTION)}}const f_={assertOptions:oN,validators:gx},da=f_.validators;class l0{constructor(t){this.defaults=t||{},this.interceptors={request:new uI,response:new uI}}async request(t,r){try{return await this._request(t,r)}catch(l){if(l instanceof Error){let h={};Error.captureStackTrace?Error.captureStackTrace(h):h=new Error;const m=h.stack?h.stack.replace(/^.+\n/,""):"";try{l.stack?m&&!String(l.stack).endsWith(m.replace(/^.+\n.+\n/,""))&&(l.stack+=`
`+m):l.stack=m}catch{}}throw l}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=wu(this.defaults,r);const{transitional:l,paramsSerializer:h,headers:m}=r;l!==void 0&&f_.assertOptions(l,{silentJSONParsing:da.transitional(da.boolean),forcedJSONParsing:da.transitional(da.boolean),clarifyTimeoutError:da.transitional(da.boolean)},!1),h!=null&&(Xe.isFunction(h)?r.paramsSerializer={serialize:h}:f_.assertOptions(h,{encode:da.function,serialize:da.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),f_.assertOptions(r,{baseUrl:da.spelling("baseURL"),withXsrfToken:da.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let x=m&&Xe.merge(m.common,m[r.method]);m&&Xe.forEach(["delete","get","head","post","put","patch","common"],W=>{delete m[W]}),r.headers=Xs.concat(x,m);const a=[];let E=!0;this.interceptors.request.forEach(function(G){typeof G.runWhen=="function"&&G.runWhen(r)===!1||(E=E&&G.synchronous,a.unshift(G.fulfilled,G.rejected))});const I=[];this.interceptors.response.forEach(function(G){I.push(G.fulfilled,G.rejected)});let L,O=0,F;if(!E){const W=[_I.bind(this),void 0];for(W.unshift(...a),W.push(...I),F=W.length,L=Promise.resolve(r);O<F;)L=L.then(W[O++],W[O++]);return L}F=a.length;let K=r;for(O=0;O<F;){const W=a[O++],G=a[O++];try{K=W(K)}catch(ne){G.call(this,ne);break}}try{L=_I.call(this,K)}catch(W){return Promise.reject(W)}for(O=0,F=I.length;O<F;)L=L.then(I[O++],I[O++]);return L}getUri(t){t=wu(this.defaults,t);const r=HR(t.baseURL,t.url,t.allowAbsoluteUrls);return UR(r,t.params,t.paramsSerializer)}}Xe.forEach(["delete","get","head","options"],function(t){l0.prototype[t]=function(r,l){return this.request(wu(l||{},{method:t,url:r,data:(l||{}).data}))}});Xe.forEach(["post","put","patch"],function(t){function r(l){return function(m,x,a){return this.request(wu(a||{},{method:t,headers:l?{"Content-Type":"multipart/form-data"}:{},url:m,data:x}))}}l0.prototype[t]=r(),l0.prototype[t+"Form"]=r(!0)});const m_=l0;class bS{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(m){r=m});const l=this;this.promise.then(h=>{if(!l._listeners)return;let m=l._listeners.length;for(;m-- >0;)l._listeners[m](h);l._listeners=null}),this.promise.then=h=>{let m;const x=new Promise(a=>{l.subscribe(a),m=a}).then(h);return x.cancel=function(){l.unsubscribe(m)},x},t(function(m,x,a){l.reason||(l.reason=new Rh(m,x,a),r(l.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=l=>{t.abort(l)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new bS(function(h){t=h}),cancel:t}}}const sN=bS;function aN(e){return function(r){return e.apply(null,r)}}function lN(e){return Xe.isObject(e)&&e.isAxiosError===!0}const jw={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(jw).forEach(([e,t])=>{jw[t]=e});const cN=jw;function QR(e){const t=new m_(e),r=MR(m_.prototype.request,t);return Xe.extend(r,m_.prototype,t,{allOwnKeys:!0}),Xe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(h){return QR(wu(e,h))},r}const ui=QR(vS);ui.Axios=m_;ui.CanceledError=Rh;ui.CancelToken=sN;ui.isCancel=GR;ui.VERSION=JR;ui.toFormData=px;ui.AxiosError=fn;ui.Cancel=ui.CanceledError;ui.all=function(t){return Promise.all(t)};ui.spread=aN;ui.isAxiosError=lN;ui.mergeConfig=wu;ui.AxiosHeaders=Xs;ui.formToJSON=e=>WR(Xe.isHTMLForm(e)?new FormData(e):e);ui.getAdapter=YR.getAdapter;ui.HttpStatusCode=cN;ui.default=ui;const uN=ui,tl=uN.create({baseURL:"https://cebot-api.vercel.app",timeout:15e3,headers:{"Content-Type":"application/json"}});tl.interceptors.request.use(e=>(console.log(`Making API request to: ${e.baseURL}${e.url}`),console.log("Request config:",{method:e.method,url:e.url,baseURL:e.baseURL,headers:e.headers}),e),e=>(console.error("Request interceptor error:",e),Promise.reject(e)));tl.interceptors.response.use(e=>(console.log(`API response from ${e.config.url}:`,{status:e.status,statusText:e.statusText,data:e.data}),e),e=>{var t,r,l,h,m;return console.error("API Error Details:",{message:e.message,status:(t=e.response)==null?void 0:t.status,statusText:(r=e.response)==null?void 0:r.statusText,data:(l=e.response)==null?void 0:l.data,url:(h=e.config)==null?void 0:h.url,method:(m=e.config)==null?void 0:m.method}),e.message==="Network Error"&&console.error("This is likely a CORS issue or the server is not running"),Promise.reject(e)});const g_=Iu("chat/sendMessage",async({message:e,sessionId:t},{rejectWithValue:r})=>{var l;try{return(await tl.post("/api/chat/message",{message:e,sessionId:t})).data}catch(h){return r(((l=h.response)==null?void 0:l.data)||"Failed to send message")}}),fb=Iu("chat/getHistory",async(e,{rejectWithValue:t})=>{var r;try{return(await tl.get("/api/chat/history")).data}catch(l){return t(((r=l.response)==null?void 0:r.data)||"Failed to get chat history")}}),dN={messages:[{id:1,message:"Hello! I'm CeBot, your Cebu transport assistant. How can I help you today?",timestamp:new Date().toISOString(),sender:"bot"}],isTyping:!1,isLoading:!1,error:null,socket:null,isConnected:!1,searchResults:null,suggestions:[]},ez=cx({name:"chat",initialState:dN,reducers:{addMessage:(e,t)=>{e.messages.push(t.payload)},setTyping:(e,t)=>{e.isTyping=t.payload},setSocket:(e,t)=>{e.socket=t.payload},setConnectionStatus:(e,t)=>{e.isConnected=t.payload},setSearchResults:(e,t)=>{e.searchResults=t.payload},setSuggestions:(e,t)=>{e.suggestions=t.payload},clearChat:e=>{e.messages=[{id:Date.now(),message:"Hello! I'm CeBot, your Cebu transport assistant. How can I help you today?",timestamp:new Date().toISOString(),sender:"bot"}],e.searchResults=null,e.suggestions=[]},addUserMessage:(e,t)=>{e.messages.push({id:Date.now(),message:t.payload,timestamp:new Date().toISOString(),sender:"user"})},addBotMessage:(e,t)=>{e.messages.push({id:Date.now(),message:t.payload,timestamp:new Date().toISOString(),sender:"bot"})}},extraReducers:e=>{e.addCase(g_.pending,t=>{t.isLoading=!0,t.error=null}).addCase(g_.fulfilled,(t,r)=>{t.isLoading=!1,r.payload.data.routes&&(t.searchResults=r.payload.data),r.payload.data.suggestions&&(t.suggestions=r.payload.data.suggestions)}).addCase(g_.rejected,(t,r)=>{t.isLoading=!1,t.error=r.payload}).addCase(fb.pending,t=>{t.isLoading=!0}).addCase(fb.fulfilled,(t,r)=>{t.isLoading=!1,r.payload.data&&r.payload.data.length>0&&(t.messages=r.payload.data)}).addCase(fb.rejected,(t,r)=>{t.isLoading=!1,t.error=r.payload})}}),{addMessage:UX,setTyping:VX,setSocket:WX,setConnectionStatus:hN,setSearchResults:GX,setSuggestions:qX,clearChat:HX,addUserMessage:pN,addBotMessage:mb}=ez.actions,fN=ez.reducer,ga=Iu("routes/fetchAll",async(e,{rejectWithValue:t})=>{var r;try{return(await tl.get("/api/routes")).data}catch(l){return t(((r=l.response)==null?void 0:r.data)||"Failed to fetch routes")}}),nm=Iu("routes/search",async({origin:e,destination:t},{rejectWithValue:r})=>{var l;try{return(await tl.post("/api/routes/search",{origin:e,destination:t})).data}catch(h){return r(((l=h.response)==null?void 0:l.data)||"Failed to search routes")}}),y_=Iu("routes/getByCode",async(e,{rejectWithValue:t})=>{var r;try{return(await tl.get(`/api/routes/${e}`)).data}catch(l){return t(((r=l.response)==null?void 0:r.data)||"Failed to get route")}}),__=Iu("routes/getByType",async(e,{rejectWithValue:t})=>{var r;try{return(await tl.get(`/api/routes/type/${e}`)).data}catch(l){return t(((r=l.response)==null?void 0:r.data)||"Failed to get routes by type")}}),x_=Iu("routes/getStats",async(e,{rejectWithValue:t})=>{var r;try{return(await tl.get("/api/routes/stats/summary")).data}catch(l){return t(((r=l.response)==null?void 0:r.data)||"Failed to get route stats")}}),mN={allRoutes:[],filteredRoutes:[],currentRoute:null,searchResults:null,stats:null,isLoading:!1,error:null,searchQuery:{origin:"",destination:""},filters:{type:"all",sortBy:"route_code"}},tz=cx({name:"routes",initialState:mN,reducers:{setSearchQuery:(e,t)=>{e.searchQuery={...e.searchQuery,...t.payload}},setFilters:(e,t)=>{e.filters={...e.filters,...t.payload}},setFilteredRoutes:(e,t)=>{e.filteredRoutes=t.payload},clearSearchResults:e=>{e.searchResults=null,e.filteredRoutes=[]},setCurrentRoute:(e,t)=>{e.currentRoute=t.payload},filterRoutes:(e,t)=>{const{type:r,sortBy:l}=e.filters;let h=[...e.allRoutes];r!=="all"&&(h=h.filter(m=>m.type===r)),l==="route_code"?h.sort((m,x)=>m.route_code.localeCompare(x.route_code)):l==="origin"?h.sort((m,x)=>m.origin.localeCompare(x.origin)):l==="destination"&&h.sort((m,x)=>m.destination.localeCompare(x.destination)),e.filteredRoutes=h},filterRoutesByType:(e,t)=>{const r=t.payload;r==="all"?e.filteredRoutes=[...e.allRoutes]:e.filteredRoutes=e.allRoutes.filter(l=>l.type===r),e.filters.type=r},resetRoutes:e=>{e.filteredRoutes=[],e.currentRoute=null,e.searchResults=null,e.searchQuery={origin:"",destination:""}}},extraReducers:e=>{e.addCase(ga.pending,t=>{t.isLoading=!0,t.error=null}).addCase(ga.fulfilled,(t,r)=>{t.isLoading=!1,t.allRoutes=r.payload.data,t.filteredRoutes=r.payload.data}).addCase(ga.rejected,(t,r)=>{t.isLoading=!1,t.error=r.payload}).addCase(nm.pending,t=>{t.isLoading=!0,t.error=null}).addCase(nm.fulfilled,(t,r)=>{t.isLoading=!1,t.searchResults=r.payload,r.payload.data&&(t.filteredRoutes=r.payload.data)}).addCase(nm.rejected,(t,r)=>{t.isLoading=!1,t.error=r.payload}).addCase(y_.pending,t=>{t.isLoading=!0,t.error=null}).addCase(y_.fulfilled,(t,r)=>{t.isLoading=!1,t.currentRoute=r.payload.data,r.payload.data&&(t.filteredRoutes=Array.isArray(r.payload.data)?r.payload.data:[r.payload.data])}).addCase(y_.rejected,(t,r)=>{t.isLoading=!1,t.error=r.payload}).addCase(__.pending,t=>{t.isLoading=!0,t.error=null}).addCase(__.fulfilled,(t,r)=>{t.isLoading=!1,t.filteredRoutes=r.payload.data}).addCase(__.rejected,(t,r)=>{t.isLoading=!1,t.error=r.payload}).addCase(x_.pending,t=>{t.isLoading=!0,t.error=null}).addCase(x_.fulfilled,(t,r)=>{t.isLoading=!1,t.stats=r.payload}).addCase(x_.rejected,(t,r)=>{t.isLoading=!1,t.error=r.payload})}}),{setSearchQuery:ZX,setFilters:XX,setFilteredRoutes:KX,clearSearchResults:YX,setCurrentRoute:JX,filterRoutes:QX,filterRoutesByType:gN,resetRoutes:eK}=tz.actions,yN=tz.reducer,_N={user:null,preferences:{language:"en",theme:"light",notifications:!0},recentSearches:[],favorites:[]},xN=cx({name:"user",initialState:_N,reducers:{setUser:(e,t)=>{e.user=t.payload},updatePreferences:(e,t)=>{e.preferences={...e.preferences,...t.payload}},addRecentSearch:(e,t)=>{const r=t.payload,l=e.recentSearches.findIndex(h=>h.origin===r.origin&&h.destination===r.destination);l!==-1&&e.recentSearches.splice(l,1),e.recentSearches.unshift({...r,timestamp:new Date().toISOString()}),e.recentSearches=e.recentSearches.slice(0,10)},addFavorite:(e,t)=>{const r=t.payload;e.favorites.findIndex(h=>h.route_code===r.route_code)===-1&&e.favorites.push({...r,addedAt:new Date().toISOString()})},removeFavorite:(e,t)=>{const r=t.payload;e.favorites=e.favorites.filter(l=>l.route_code!==r)},clearRecentSearches:e=>{e.recentSearches=[]},clearFavorites:e=>{e.favorites=[]}}}),vN=xN.reducer,bN={center:[123.8854,10.3157],zoom:12,selectedRoute:null,highlightedRoutes:[],mapStyle:"mapbox://styles/mapbox/streets-v11",showRouteLines:!0,showMarkers:!0,showPopups:!0},nz=cx({name:"map",initialState:bN,reducers:{setMapCenter:(e,t)=>{e.center=t.payload},setMapZoom:(e,t)=>{e.zoom=t.payload},setSelectedRoute:(e,t)=>{e.selectedRoute=t.payload},setHighlightedRoutes:(e,t)=>{e.highlightedRoutes=t.payload},addHighlightedRoute:(e,t)=>{e.highlightedRoutes.find(r=>r.route_code===t.payload.route_code)||e.highlightedRoutes.push(t.payload)},removeHighlightedRoute:(e,t)=>{e.highlightedRoutes=e.highlightedRoutes.filter(r=>r.route_code!==t.payload)},setMapStyle:(e,t)=>{e.mapStyle=t.payload},toggleRouteLines:e=>{e.showRouteLines=!e.showRouteLines},toggleMarkers:e=>{e.showMarkers=!e.showMarkers},togglePopups:e=>{e.showPopups=!e.showPopups},resetMap:e=>{e.center=[123.8854,10.3157],e.zoom=12,e.selectedRoute=null,e.highlightedRoutes=[]}}}),{setMapCenter:tK,setMapZoom:nK,setSelectedRoute:gb,setHighlightedRoutes:rK,addHighlightedRoute:wN,removeHighlightedRoute:iK,setMapStyle:oK,toggleRouteLines:sK,toggleMarkers:aK,togglePopups:lK,resetMap:cK}=nz.actions,SN=nz.reducer,EN=bF({reducer:{chat:fN,routes:yN,user:vN,map:SN},middleware:e=>e({serializableCheck:{ignoredActions:["chat/setSocket"],ignoredPaths:["chat.socket"]}})});/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Am(){return Am=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},Am.apply(this,arguments)}var Wl;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Wl||(Wl={}));const vI="popstate";function TN(e){e===void 0&&(e={});function t(l,h){let{pathname:m,search:x,hash:a}=l.location;return Nw("",{pathname:m,search:x,hash:a},h.state&&h.state.usr||null,h.state&&h.state.key||"default")}function r(l,h){return typeof h=="string"?h:c0(h)}return kN(t,r,null,e)}function ci(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function rz(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function CN(){return Math.random().toString(36).substr(2,8)}function bI(e,t){return{usr:e.state,key:e.key,idx:t}}function Nw(e,t,r,l){return r===void 0&&(r=null),Am({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?zh(t):t,{state:r,key:t&&t.key||l||CN()})}function c0(e){let{pathname:t="/",search:r="",hash:l=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),l&&l!=="#"&&(t+=l.charAt(0)==="#"?l:"#"+l),t}function zh(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let l=e.indexOf("?");l>=0&&(t.search=e.substr(l),e=e.substr(0,l)),e&&(t.pathname=e)}return t}function kN(e,t,r,l){l===void 0&&(l={});let{window:h=document.defaultView,v5Compat:m=!1}=l,x=h.history,a=Wl.Pop,E=null,I=L();I==null&&(I=0,x.replaceState(Am({},x.state,{idx:I}),""));function L(){return(x.state||{idx:null}).idx}function O(){a=Wl.Pop;let ne=L(),Z=ne==null?null:ne-I;I=ne,E&&E({action:a,location:G.location,delta:Z})}function F(ne,Z){a=Wl.Push;let H=Nw(G.location,ne,Z);r&&r(H,ne),I=L()+1;let V=bI(H,I),oe=G.createHref(H);try{x.pushState(V,"",oe)}catch(pe){if(pe instanceof DOMException&&pe.name==="DataCloneError")throw pe;h.location.assign(oe)}m&&E&&E({action:a,location:G.location,delta:1})}function K(ne,Z){a=Wl.Replace;let H=Nw(G.location,ne,Z);r&&r(H,ne),I=L();let V=bI(H,I),oe=G.createHref(H);x.replaceState(V,"",oe),m&&E&&E({action:a,location:G.location,delta:0})}function W(ne){let Z=h.location.origin!=="null"?h.location.origin:h.location.href,H=typeof ne=="string"?ne:c0(ne);return H=H.replace(/ $/,"%20"),ci(Z,"No window.location.(origin|href) available to create URL for href: "+H),new URL(H,Z)}let G={get action(){return a},get location(){return e(h,x)},listen(ne){if(E)throw new Error("A history only accepts one active listener");return h.addEventListener(vI,O),E=ne,()=>{h.removeEventListener(vI,O),E=null}},createHref(ne){return t(h,ne)},createURL:W,encodeLocation(ne){let Z=W(ne);return{pathname:Z.pathname,search:Z.search,hash:Z.hash}},push:F,replace:K,go(ne){return x.go(ne)}};return G}var wI;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(wI||(wI={}));function IN(e,t,r){return r===void 0&&(r="/"),AN(e,t,r,!1)}function AN(e,t,r,l){let h=typeof t=="string"?zh(t):t,m=wS(h.pathname||"/",r);if(m==null)return null;let x=iz(e);MN(x);let a=null;for(let E=0;a==null&&E<x.length;++E){let I=$N(m);a=jN(x[E],I,l)}return a}function iz(e,t,r,l){t===void 0&&(t=[]),r===void 0&&(r=[]),l===void 0&&(l="");let h=(m,x,a)=>{let E={relativePath:a===void 0?m.path||"":a,caseSensitive:m.caseSensitive===!0,childrenIndex:x,route:m};E.relativePath.startsWith("/")&&(ci(E.relativePath.startsWith(l),'Absolute route path "'+E.relativePath+'" nested under path '+('"'+l+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),E.relativePath=E.relativePath.slice(l.length));let I=tc([l,E.relativePath]),L=r.concat(E);m.children&&m.children.length>0&&(ci(m.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+I+'".')),iz(m.children,t,L,I)),!(m.path==null&&!m.index)&&t.push({path:I,score:BN(I,m.index),routesMeta:L})};return e.forEach((m,x)=>{var a;if(m.path===""||!((a=m.path)!=null&&a.includes("?")))h(m,x);else for(let E of oz(m.path))h(m,x,E)}),t}function oz(e){let t=e.split("/");if(t.length===0)return[];let[r,...l]=t,h=r.endsWith("?"),m=r.replace(/\?$/,"");if(l.length===0)return h?[m,""]:[m];let x=oz(l.join("/")),a=[];return a.push(...x.map(E=>E===""?m:[m,E].join("/"))),h&&a.push(...x),a.map(E=>e.startsWith("/")&&E===""?"/":E)}function MN(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:FN(t.routesMeta.map(l=>l.childrenIndex),r.routesMeta.map(l=>l.childrenIndex)))}const PN=/^:[\w-]+$/,RN=3,zN=2,LN=1,DN=10,ON=-2,SI=e=>e==="*";function BN(e,t){let r=e.split("/"),l=r.length;return r.some(SI)&&(l+=ON),t&&(l+=zN),r.filter(h=>!SI(h)).reduce((h,m)=>h+(PN.test(m)?RN:m===""?LN:DN),l)}function FN(e,t){return e.length===t.length&&e.slice(0,-1).every((l,h)=>l===t[h])?e[e.length-1]-t[t.length-1]:0}function jN(e,t,r){r===void 0&&(r=!1);let{routesMeta:l}=e,h={},m="/",x=[];for(let a=0;a<l.length;++a){let E=l[a],I=a===l.length-1,L=m==="/"?t:t.slice(m.length)||"/",O=EI({path:E.relativePath,caseSensitive:E.caseSensitive,end:I},L),F=E.route;if(!O&&I&&r&&!l[l.length-1].route.index&&(O=EI({path:E.relativePath,caseSensitive:E.caseSensitive,end:!1},L)),!O)return null;Object.assign(h,O.params),x.push({params:h,pathname:tc([m,O.pathname]),pathnameBase:GN(tc([m,O.pathnameBase])),route:F}),O.pathnameBase!=="/"&&(m=tc([m,O.pathnameBase]))}return x}function EI(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,l]=NN(e.path,e.caseSensitive,e.end),h=t.match(r);if(!h)return null;let m=h[0],x=m.replace(/(.)\/+$/,"$1"),a=h.slice(1);return{params:l.reduce((I,L,O)=>{let{paramName:F,isOptional:K}=L;if(F==="*"){let G=a[O]||"";x=m.slice(0,m.length-G.length).replace(/(.)\/+$/,"$1")}const W=a[O];return K&&!W?I[F]=void 0:I[F]=(W||"").replace(/%2F/g,"/"),I},{}),pathname:m,pathnameBase:x,pattern:e}}function NN(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),rz(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let l=[],h="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(x,a,E)=>(l.push({paramName:a,isOptional:E!=null}),E?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(l.push({paramName:"*"}),h+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?h+="\\/*$":e!==""&&e!=="/"&&(h+="(?:(?=\\/|$))"),[new RegExp(h,t?void 0:"i"),l]}function $N(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return rz(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function wS(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,l=e.charAt(r);return l&&l!=="/"?null:e.slice(r)||"/"}function UN(e,t){t===void 0&&(t="/");let{pathname:r,search:l="",hash:h=""}=typeof e=="string"?zh(e):e;return{pathname:r?r.startsWith("/")?r:VN(r,t):t,search:qN(l),hash:HN(h)}}function VN(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(h=>{h===".."?r.length>1&&r.pop():h!=="."&&r.push(h)}),r.length>1?r.join("/"):"/"}function yb(e,t,r,l){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(l)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function WN(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function sz(e,t){let r=WN(e);return t?r.map((l,h)=>h===r.length-1?l.pathname:l.pathnameBase):r.map(l=>l.pathnameBase)}function az(e,t,r,l){l===void 0&&(l=!1);let h;typeof e=="string"?h=zh(e):(h=Am({},e),ci(!h.pathname||!h.pathname.includes("?"),yb("?","pathname","search",h)),ci(!h.pathname||!h.pathname.includes("#"),yb("#","pathname","hash",h)),ci(!h.search||!h.search.includes("#"),yb("#","search","hash",h)));let m=e===""||h.pathname==="",x=m?"/":h.pathname,a;if(x==null)a=r;else{let O=t.length-1;if(!l&&x.startsWith("..")){let F=x.split("/");for(;F[0]==="..";)F.shift(),O-=1;h.pathname=F.join("/")}a=O>=0?t[O]:"/"}let E=UN(h,a),I=x&&x!=="/"&&x.endsWith("/"),L=(m||x===".")&&r.endsWith("/");return!E.pathname.endsWith("/")&&(I||L)&&(E.pathname+="/"),E}const tc=e=>e.join("/").replace(/\/\/+/g,"/"),GN=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),qN=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,HN=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ZN(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const lz=["post","put","patch","delete"];new Set(lz);const XN=["get",...lz];new Set(XN);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mm(){return Mm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},Mm.apply(this,arguments)}const SS=J.createContext(null),KN=J.createContext(null),Au=J.createContext(null),yx=J.createContext(null),Mu=J.createContext({outlet:null,matches:[],isDataRoute:!1}),cz=J.createContext(null);function YN(e,t){let{relative:r}=t===void 0?{}:t;qm()||ci(!1);let{basename:l,navigator:h}=J.useContext(Au),{hash:m,pathname:x,search:a}=dz(e,{relative:r}),E=x;return l!=="/"&&(E=x==="/"?l:tc([l,x])),h.createHref({pathname:E,search:a,hash:m})}function qm(){return J.useContext(yx)!=null}function Hm(){return qm()||ci(!1),J.useContext(yx).location}function uz(e){J.useContext(Au).static||J.useLayoutEffect(e)}function JN(){let{isDataRoute:e}=J.useContext(Mu);return e?d$():QN()}function QN(){qm()||ci(!1);let e=J.useContext(SS),{basename:t,future:r,navigator:l}=J.useContext(Au),{matches:h}=J.useContext(Mu),{pathname:m}=Hm(),x=JSON.stringify(sz(h,r.v7_relativeSplatPath)),a=J.useRef(!1);return uz(()=>{a.current=!0}),J.useCallback(function(I,L){if(L===void 0&&(L={}),!a.current)return;if(typeof I=="number"){l.go(I);return}let O=az(I,JSON.parse(x),m,L.relative==="path");e==null&&t!=="/"&&(O.pathname=O.pathname==="/"?t:tc([t,O.pathname])),(L.replace?l.replace:l.push)(O,L.state,L)},[t,l,x,m,e])}function dz(e,t){let{relative:r}=t===void 0?{}:t,{future:l}=J.useContext(Au),{matches:h}=J.useContext(Mu),{pathname:m}=Hm(),x=JSON.stringify(sz(h,l.v7_relativeSplatPath));return J.useMemo(()=>az(e,JSON.parse(x),m,r==="path"),[e,x,m,r])}function e$(e,t){return t$(e,t)}function t$(e,t,r,l){qm()||ci(!1);let{navigator:h}=J.useContext(Au),{matches:m}=J.useContext(Mu),x=m[m.length-1],a=x?x.params:{};x&&x.pathname;let E=x?x.pathnameBase:"/";x&&x.route;let I=Hm(),L;if(t){var O;let ne=typeof t=="string"?zh(t):t;E==="/"||(O=ne.pathname)!=null&&O.startsWith(E)||ci(!1),L=ne}else L=I;let F=L.pathname||"/",K=F;if(E!=="/"){let ne=E.replace(/^\//,"").split("/");K="/"+F.replace(/^\//,"").split("/").slice(ne.length).join("/")}let W=IN(e,{pathname:K}),G=s$(W&&W.map(ne=>Object.assign({},ne,{params:Object.assign({},a,ne.params),pathname:tc([E,h.encodeLocation?h.encodeLocation(ne.pathname).pathname:ne.pathname]),pathnameBase:ne.pathnameBase==="/"?E:tc([E,h.encodeLocation?h.encodeLocation(ne.pathnameBase).pathname:ne.pathnameBase])})),m,r,l);return t&&G?J.createElement(yx.Provider,{value:{location:Mm({pathname:"/",search:"",hash:"",state:null,key:"default"},L),navigationType:Wl.Pop}},G):G}function n$(){let e=u$(),t=ZN(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,h={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},m=null;return J.createElement(J.Fragment,null,J.createElement("h2",null,"Unexpected Application Error!"),J.createElement("h3",{style:{fontStyle:"italic"}},t),r?J.createElement("pre",{style:h},r):null,m)}const r$=J.createElement(n$,null);class i$ extends J.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?J.createElement(Mu.Provider,{value:this.props.routeContext},J.createElement(cz.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function o$(e){let{routeContext:t,match:r,children:l}=e,h=J.useContext(SS);return h&&h.static&&h.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(h.staticContext._deepestRenderedBoundaryId=r.route.id),J.createElement(Mu.Provider,{value:t},l)}function s$(e,t,r,l){var h;if(t===void 0&&(t=[]),r===void 0&&(r=null),l===void 0&&(l=null),e==null){var m;if(!r)return null;if(r.errors)e=r.matches;else if((m=l)!=null&&m.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let x=e,a=(h=r)==null?void 0:h.errors;if(a!=null){let L=x.findIndex(O=>O.route.id&&(a==null?void 0:a[O.route.id])!==void 0);L>=0||ci(!1),x=x.slice(0,Math.min(x.length,L+1))}let E=!1,I=-1;if(r&&l&&l.v7_partialHydration)for(let L=0;L<x.length;L++){let O=x[L];if((O.route.HydrateFallback||O.route.hydrateFallbackElement)&&(I=L),O.route.id){let{loaderData:F,errors:K}=r,W=O.route.loader&&F[O.route.id]===void 0&&(!K||K[O.route.id]===void 0);if(O.route.lazy||W){E=!0,I>=0?x=x.slice(0,I+1):x=[x[0]];break}}}return x.reduceRight((L,O,F)=>{let K,W=!1,G=null,ne=null;r&&(K=a&&O.route.id?a[O.route.id]:void 0,G=O.route.errorElement||r$,E&&(I<0&&F===0?(h$("route-fallback",!1),W=!0,ne=null):I===F&&(W=!0,ne=O.route.hydrateFallbackElement||null)));let Z=t.concat(x.slice(0,F+1)),H=()=>{let V;return K?V=G:W?V=ne:O.route.Component?V=J.createElement(O.route.Component,null):O.route.element?V=O.route.element:V=L,J.createElement(o$,{match:O,routeContext:{outlet:L,matches:Z,isDataRoute:r!=null},children:V})};return r&&(O.route.ErrorBoundary||O.route.errorElement||F===0)?J.createElement(i$,{location:r.location,revalidation:r.revalidation,component:G,error:K,children:H(),routeContext:{outlet:null,matches:Z,isDataRoute:!0}}):H()},null)}var hz=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(hz||{}),u0=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(u0||{});function a$(e){let t=J.useContext(SS);return t||ci(!1),t}function l$(e){let t=J.useContext(KN);return t||ci(!1),t}function c$(e){let t=J.useContext(Mu);return t||ci(!1),t}function pz(e){let t=c$(),r=t.matches[t.matches.length-1];return r.route.id||ci(!1),r.route.id}function u$(){var e;let t=J.useContext(cz),r=l$(u0.UseRouteError),l=pz(u0.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[l]}function d$(){let{router:e}=a$(hz.UseNavigateStable),t=pz(u0.UseNavigateStable),r=J.useRef(!1);return uz(()=>{r.current=!0}),J.useCallback(function(h,m){m===void 0&&(m={}),r.current&&(typeof h=="number"?e.navigate(h):e.navigate(h,Mm({fromRouteId:t},m)))},[e,t])}const TI={};function h$(e,t,r){!t&&!TI[e]&&(TI[e]=!0)}function p$(e,t){e==null||e.v7_startTransition,(e==null?void 0:e.v7_relativeSplatPath)===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function Uf(e){ci(!1)}function f$(e){let{basename:t="/",children:r=null,location:l,navigationType:h=Wl.Pop,navigator:m,static:x=!1,future:a}=e;qm()&&ci(!1);let E=t.replace(/^\/*/,"/"),I=J.useMemo(()=>({basename:E,navigator:m,static:x,future:Mm({v7_relativeSplatPath:!1},a)}),[E,a,m,x]);typeof l=="string"&&(l=zh(l));let{pathname:L="/",search:O="",hash:F="",state:K=null,key:W="default"}=l,G=J.useMemo(()=>{let ne=wS(L,E);return ne==null?null:{location:{pathname:ne,search:O,hash:F,state:K,key:W},navigationType:h}},[E,L,O,F,K,W,h]);return G==null?null:J.createElement(Au.Provider,{value:I},J.createElement(yx.Provider,{children:r,value:G}))}function m$(e){let{children:t,location:r}=e;return e$($w(t),r)}new Promise(()=>{});function $w(e,t){t===void 0&&(t=[]);let r=[];return J.Children.forEach(e,(l,h)=>{if(!J.isValidElement(l))return;let m=[...t,h];if(l.type===J.Fragment){r.push.apply(r,$w(l.props.children,m));return}l.type!==Uf&&ci(!1),!l.props.index||!l.props.children||ci(!1);let x={id:l.props.id||m.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,loader:l.props.loader,action:l.props.action,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:l.props.ErrorBoundary!=null||l.props.errorElement!=null,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(x.children=$w(l.props.children,m)),r.push(x)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Uw(){return Uw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e},Uw.apply(this,arguments)}function g$(e,t){if(e==null)return{};var r={},l=Object.keys(e),h,m;for(m=0;m<l.length;m++)h=l[m],!(t.indexOf(h)>=0)&&(r[h]=e[h]);return r}function y$(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function _$(e,t){return e.button===0&&(!t||t==="_self")&&!y$(e)}const x$=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],v$="6";try{window.__reactRouterVersion=v$}catch{}const b$="startTransition",CI=am[b$];function w$(e){let{basename:t,children:r,future:l,window:h}=e,m=J.useRef();m.current==null&&(m.current=TN({window:h,v5Compat:!0}));let x=m.current,[a,E]=J.useState({action:x.action,location:x.location}),{v7_startTransition:I}=l||{},L=J.useCallback(O=>{I&&CI?CI(()=>E(O)):E(O)},[E,I]);return J.useLayoutEffect(()=>x.listen(L),[x,L]),J.useEffect(()=>p$(l),[l]),J.createElement(f$,{basename:t,children:r,location:a.location,navigationType:a.action,navigator:x,future:l})}const S$=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",E$=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$l=J.forwardRef(function(t,r){let{onClick:l,relative:h,reloadDocument:m,replace:x,state:a,target:E,to:I,preventScrollReset:L,viewTransition:O}=t,F=g$(t,x$),{basename:K}=J.useContext(Au),W,G=!1;if(typeof I=="string"&&E$.test(I)&&(W=I,S$))try{let V=new URL(window.location.href),oe=I.startsWith("//")?new URL(V.protocol+I):new URL(I),pe=wS(oe.pathname,K);oe.origin===V.origin&&pe!=null?I=pe+oe.search+oe.hash:G=!0}catch{}let ne=YN(I,{relative:h}),Z=T$(I,{replace:x,state:a,target:E,preventScrollReset:L,relative:h,viewTransition:O});function H(V){l&&l(V),V.defaultPrevented||Z(V)}return J.createElement("a",Uw({},F,{href:W||ne,onClick:G||m?l:H,ref:r,target:E}))});var kI;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(kI||(kI={}));var II;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(II||(II={}));function T$(e,t){let{target:r,replace:l,state:h,preventScrollReset:m,relative:x,viewTransition:a}=t===void 0?{}:t,E=JN(),I=Hm(),L=dz(e,{relative:x});return J.useCallback(O=>{if(_$(O,r)){O.preventDefault();let F=l!==void 0?l:c0(I)===c0(L);E(e,{replace:F,state:h,preventScrollReset:m,relative:x,viewTransition:a})}},[I,E,L,l,h,r,e,m,x,a])}function Su(e){let t="https://mui.com/production-error/?code="+e;for(let r=1;r<arguments.length;r+=1)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}const C$=Object.freeze(Object.defineProperty({__proto__:null,default:Su},Symbol.toStringTag,{value:"Module"})),xh="$$material";var k$=!1;function I$(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function A$(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var M$=function(){function e(r){var l=this;this._insertTag=function(h){var m;l.tags.length===0?l.insertionPoint?m=l.insertionPoint.nextSibling:l.prepend?m=l.container.firstChild:m=l.before:m=l.tags[l.tags.length-1].nextSibling,l.container.insertBefore(h,m),l.tags.push(h)},this.isSpeedy=r.speedy===void 0?!k$:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(l){l.forEach(this._insertTag)},t.insert=function(l){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(A$(this));var h=this.tags[this.tags.length-1];if(this.isSpeedy){var m=I$(h);try{m.insertRule(l,m.cssRules.length)}catch{}}else h.appendChild(document.createTextNode(l));this.ctr++},t.flush=function(){this.tags.forEach(function(l){var h;return(h=l.parentNode)==null?void 0:h.removeChild(l)}),this.tags=[],this.ctr=0},e}(),qi="-ms-",d0="-moz-",Yn="-webkit-",fz="comm",ES="rule",TS="decl",P$="@import",mz="@keyframes",R$="@layer",z$=Math.abs,_x=String.fromCharCode,L$=Object.assign;function D$(e,t){return Ri(e,0)^45?(((t<<2^Ri(e,0))<<2^Ri(e,1))<<2^Ri(e,2))<<2^Ri(e,3):0}function gz(e){return e.trim()}function O$(e,t){return(e=t.exec(e))?e[0]:e}function Jn(e,t,r){return e.replace(t,r)}function Vw(e,t){return e.indexOf(t)}function Ri(e,t){return e.charCodeAt(t)|0}function Pm(e,t,r){return e.slice(t,r)}function pa(e){return e.length}function CS(e){return e.length}function qy(e,t){return t.push(e),e}function B$(e,t){return e.map(t).join("")}var xx=1,vh=1,yz=0,Eo=0,si=0,Lh="";function vx(e,t,r,l,h,m,x){return{value:e,root:t,parent:r,type:l,props:h,children:m,line:xx,column:vh,length:x,return:""}}function Af(e,t){return L$(vx("",null,null,"",null,null,0),e,{length:-e.length},t)}function F$(){return si}function j$(){return si=Eo>0?Ri(Lh,--Eo):0,vh--,si===10&&(vh=1,xx--),si}function Fo(){return si=Eo<yz?Ri(Lh,Eo++):0,vh++,si===10&&(vh=1,xx++),si}function va(){return Ri(Lh,Eo)}function v_(){return Eo}function Zm(e,t){return Pm(Lh,e,t)}function Rm(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function _z(e){return xx=vh=1,yz=pa(Lh=e),Eo=0,[]}function xz(e){return Lh="",e}function b_(e){return gz(Zm(Eo-1,Ww(e===91?e+2:e===40?e+1:e)))}function N$(e){for(;(si=va())&&si<33;)Fo();return Rm(e)>2||Rm(si)>3?"":" "}function $$(e,t){for(;--t&&Fo()&&!(si<48||si>102||si>57&&si<65||si>70&&si<97););return Zm(e,v_()+(t<6&&va()==32&&Fo()==32))}function Ww(e){for(;Fo();)switch(si){case e:return Eo;case 34:case 39:e!==34&&e!==39&&Ww(si);break;case 40:e===41&&Ww(e);break;case 92:Fo();break}return Eo}function U$(e,t){for(;Fo()&&e+si!==47+10;)if(e+si===42+42&&va()===47)break;return"/*"+Zm(t,Eo-1)+"*"+_x(e===47?e:Fo())}function V$(e){for(;!Rm(va());)Fo();return Zm(e,Eo)}function W$(e){return xz(w_("",null,null,null,[""],e=_z(e),0,[0],e))}function w_(e,t,r,l,h,m,x,a,E){for(var I=0,L=0,O=x,F=0,K=0,W=0,G=1,ne=1,Z=1,H=0,V="",oe=h,pe=m,_e=l,xe=V;ne;)switch(W=H,H=Fo()){case 40:if(W!=108&&Ri(xe,O-1)==58){Vw(xe+=Jn(b_(H),"&","&\f"),"&\f")!=-1&&(Z=-1);break}case 34:case 39:case 91:xe+=b_(H);break;case 9:case 10:case 13:case 32:xe+=N$(W);break;case 92:xe+=$$(v_()-1,7);continue;case 47:switch(va()){case 42:case 47:qy(G$(U$(Fo(),v_()),t,r),E);break;default:xe+="/"}break;case 123*G:a[I++]=pa(xe)*Z;case 125*G:case 59:case 0:switch(H){case 0:case 125:ne=0;case 59+L:Z==-1&&(xe=Jn(xe,/\f/g,"")),K>0&&pa(xe)-O&&qy(K>32?MI(xe+";",l,r,O-1):MI(Jn(xe," ","")+";",l,r,O-2),E);break;case 59:xe+=";";default:if(qy(_e=AI(xe,t,r,I,L,h,a,V,oe=[],pe=[],O),m),H===123)if(L===0)w_(xe,t,_e,_e,oe,m,O,a,pe);else switch(F===99&&Ri(xe,3)===110?100:F){case 100:case 108:case 109:case 115:w_(e,_e,_e,l&&qy(AI(e,_e,_e,0,0,h,a,V,h,oe=[],O),pe),h,pe,O,a,l?oe:pe);break;default:w_(xe,_e,_e,_e,[""],pe,0,a,pe)}}I=L=K=0,G=Z=1,V=xe="",O=x;break;case 58:O=1+pa(xe),K=W;default:if(G<1){if(H==123)--G;else if(H==125&&G++==0&&j$()==125)continue}switch(xe+=_x(H),H*G){case 38:Z=L>0?1:(xe+="\f",-1);break;case 44:a[I++]=(pa(xe)-1)*Z,Z=1;break;case 64:va()===45&&(xe+=b_(Fo())),F=va(),L=O=pa(V=xe+=V$(v_())),H++;break;case 45:W===45&&pa(xe)==2&&(G=0)}}return m}function AI(e,t,r,l,h,m,x,a,E,I,L){for(var O=h-1,F=h===0?m:[""],K=CS(F),W=0,G=0,ne=0;W<l;++W)for(var Z=0,H=Pm(e,O+1,O=z$(G=x[W])),V=e;Z<K;++Z)(V=gz(G>0?F[Z]+" "+H:Jn(H,/&\f/g,F[Z])))&&(E[ne++]=V);return vx(e,t,r,h===0?ES:a,E,I,L)}function G$(e,t,r){return vx(e,t,r,fz,_x(F$()),Pm(e,2,-2),0)}function MI(e,t,r,l){return vx(e,t,r,TS,Pm(e,0,l),Pm(e,l+1,-1),l)}function oh(e,t){for(var r="",l=CS(e),h=0;h<l;h++)r+=t(e[h],h,e,t)||"";return r}function q$(e,t,r,l){switch(e.type){case R$:if(e.children.length)break;case P$:case TS:return e.return=e.return||e.value;case fz:return"";case mz:return e.return=e.value+"{"+oh(e.children,l)+"}";case ES:e.value=e.props.join(",")}return pa(r=oh(e.children,l))?e.return=e.value+"{"+r+"}":""}function H$(e){var t=CS(e);return function(r,l,h,m){for(var x="",a=0;a<t;a++)x+=e[a](r,l,h,m)||"";return x}}function Z$(e){return function(t){t.root||(t=t.return)&&e(t)}}function vz(e){var t=Object.create(null);return function(r){return t[r]===void 0&&(t[r]=e(r)),t[r]}}var X$=function(t,r,l){for(var h=0,m=0;h=m,m=va(),h===38&&m===12&&(r[l]=1),!Rm(m);)Fo();return Zm(t,Eo)},K$=function(t,r){var l=-1,h=44;do switch(Rm(h)){case 0:h===38&&va()===12&&(r[l]=1),t[l]+=X$(Eo-1,r,l);break;case 2:t[l]+=b_(h);break;case 4:if(h===44){t[++l]=va()===58?"&\f":"",r[l]=t[l].length;break}default:t[l]+=_x(h)}while(h=Fo());return t},Y$=function(t,r){return xz(K$(_z(t),r))},PI=new WeakMap,J$=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var r=t.value,l=t.parent,h=t.column===l.column&&t.line===l.line;l.type!=="rule";)if(l=l.parent,!l)return;if(!(t.props.length===1&&r.charCodeAt(0)!==58&&!PI.get(l))&&!h){PI.set(t,!0);for(var m=[],x=Y$(r,m),a=l.props,E=0,I=0;E<x.length;E++)for(var L=0;L<a.length;L++,I++)t.props[I]=m[E]?x[E].replace(/&\f/g,a[L]):a[L]+" "+x[E]}}},Q$=function(t){if(t.type==="decl"){var r=t.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(t.return="",t.value="")}};function bz(e,t){switch(D$(e,t)){case 5103:return Yn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Yn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Yn+e+d0+e+qi+e+e;case 6828:case 4268:return Yn+e+qi+e+e;case 6165:return Yn+e+qi+"flex-"+e+e;case 5187:return Yn+e+Jn(e,/(\w+).+(:[^]+)/,Yn+"box-$1$2"+qi+"flex-$1$2")+e;case 5443:return Yn+e+qi+"flex-item-"+Jn(e,/flex-|-self/,"")+e;case 4675:return Yn+e+qi+"flex-line-pack"+Jn(e,/align-content|flex-|-self/,"")+e;case 5548:return Yn+e+qi+Jn(e,"shrink","negative")+e;case 5292:return Yn+e+qi+Jn(e,"basis","preferred-size")+e;case 6060:return Yn+"box-"+Jn(e,"-grow","")+Yn+e+qi+Jn(e,"grow","positive")+e;case 4554:return Yn+Jn(e,/([^-])(transform)/g,"$1"+Yn+"$2")+e;case 6187:return Jn(Jn(Jn(e,/(zoom-|grab)/,Yn+"$1"),/(image-set)/,Yn+"$1"),e,"")+e;case 5495:case 3959:return Jn(e,/(image-set\([^]*)/,Yn+"$1$`$1");case 4968:return Jn(Jn(e,/(.+:)(flex-)?(.*)/,Yn+"box-pack:$3"+qi+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Yn+e+e;case 4095:case 3583:case 4068:case 2532:return Jn(e,/(.+)-inline(.+)/,Yn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(pa(e)-1-t>6)switch(Ri(e,t+1)){case 109:if(Ri(e,t+4)!==45)break;case 102:return Jn(e,/(.+:)(.+)-([^]+)/,"$1"+Yn+"$2-$3$1"+d0+(Ri(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~Vw(e,"stretch")?bz(Jn(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Ri(e,t+1)!==115)break;case 6444:switch(Ri(e,pa(e)-3-(~Vw(e,"!important")&&10))){case 107:return Jn(e,":",":"+Yn)+e;case 101:return Jn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Yn+(Ri(e,14)===45?"inline-":"")+"box$3$1"+Yn+"$2$3$1"+qi+"$2box$3")+e}break;case 5936:switch(Ri(e,t+11)){case 114:return Yn+e+qi+Jn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Yn+e+qi+Jn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Yn+e+qi+Jn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Yn+e+qi+e+e}return e}var e6=function(t,r,l,h){if(t.length>-1&&!t.return)switch(t.type){case TS:t.return=bz(t.value,t.length);break;case mz:return oh([Af(t,{value:Jn(t.value,"@","@"+Yn)})],h);case ES:if(t.length)return B$(t.props,function(m){switch(O$(m,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return oh([Af(t,{props:[Jn(m,/:(read-\w+)/,":"+d0+"$1")]})],h);case"::placeholder":return oh([Af(t,{props:[Jn(m,/:(plac\w+)/,":"+Yn+"input-$1")]}),Af(t,{props:[Jn(m,/:(plac\w+)/,":"+d0+"$1")]}),Af(t,{props:[Jn(m,/:(plac\w+)/,qi+"input-$1")]})],h)}return""})}},t6=[e6],wz=function(t){var r=t.key;if(r==="css"){var l=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(l,function(G){var ne=G.getAttribute("data-emotion");ne.indexOf(" ")!==-1&&(document.head.appendChild(G),G.setAttribute("data-s",""))})}var h=t.stylisPlugins||t6,m={},x,a=[];x=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(G){for(var ne=G.getAttribute("data-emotion").split(" "),Z=1;Z<ne.length;Z++)m[ne[Z]]=!0;a.push(G)});var E,I=[J$,Q$];{var L,O=[q$,Z$(function(G){L.insert(G)})],F=H$(I.concat(h,O)),K=function(ne){return oh(W$(ne),F)};E=function(ne,Z,H,V){L=H,K(ne?ne+"{"+Z.styles+"}":Z.styles),V&&(W.inserted[Z.name]=!0)}}var W={key:r,sheet:new M$({key:r,container:x,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:m,registered:{},insert:E};return W.sheet.hydrate(a),W},n6=!0;function Sz(e,t,r){var l="";return r.split(" ").forEach(function(h){e[h]!==void 0?t.push(e[h]+";"):h&&(l+=h+" ")}),l}var kS=function(t,r,l){var h=t.key+"-"+r.name;(l===!1||n6===!1)&&t.registered[h]===void 0&&(t.registered[h]=r.styles)},IS=function(t,r,l){kS(t,r,l);var h=t.key+"-"+r.name;if(t.inserted[r.name]===void 0){var m=r;do t.insert(r===m?"."+h:"",m,t.sheet,!0),m=m.next;while(m!==void 0)}};function r6(e){for(var t=0,r,l=0,h=e.length;h>=4;++l,h-=4)r=e.charCodeAt(l)&255|(e.charCodeAt(++l)&255)<<8|(e.charCodeAt(++l)&255)<<16|(e.charCodeAt(++l)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,t=(r&65535)*1540483477+((r>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(h){case 3:t^=(e.charCodeAt(l+2)&255)<<16;case 2:t^=(e.charCodeAt(l+1)&255)<<8;case 1:t^=e.charCodeAt(l)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var i6={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},o6=!1,s6=/[A-Z]|^ms/g,a6=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Ez=function(t){return t.charCodeAt(1)===45},RI=function(t){return t!=null&&typeof t!="boolean"},_b=vz(function(e){return Ez(e)?e:e.replace(s6,"-$&").toLowerCase()}),zI=function(t,r){switch(t){case"animation":case"animationName":if(typeof r=="string")return r.replace(a6,function(l,h,m){return fa={name:h,styles:m,next:fa},h})}return i6[t]!==1&&!Ez(t)&&typeof r=="number"&&r!==0?r+"px":r},l6="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function zm(e,t,r){if(r==null)return"";var l=r;if(l.__emotion_styles!==void 0)return l;switch(typeof r){case"boolean":return"";case"object":{var h=r;if(h.anim===1)return fa={name:h.name,styles:h.styles,next:fa},h.name;var m=r;if(m.styles!==void 0){var x=m.next;if(x!==void 0)for(;x!==void 0;)fa={name:x.name,styles:x.styles,next:fa},x=x.next;var a=m.styles+";";return a}return c6(e,t,r)}case"function":{if(e!==void 0){var E=fa,I=r(e);return fa=E,zm(e,t,I)}break}}var L=r;if(t==null)return L;var O=t[L];return O!==void 0?O:L}function c6(e,t,r){var l="";if(Array.isArray(r))for(var h=0;h<r.length;h++)l+=zm(e,t,r[h])+";";else for(var m in r){var x=r[m];if(typeof x!="object"){var a=x;t!=null&&t[a]!==void 0?l+=m+"{"+t[a]+"}":RI(a)&&(l+=_b(m)+":"+zI(m,a)+";")}else{if(m==="NO_COMPONENT_SELECTOR"&&o6)throw new Error(l6);if(Array.isArray(x)&&typeof x[0]=="string"&&(t==null||t[x[0]]===void 0))for(var E=0;E<x.length;E++)RI(x[E])&&(l+=_b(m)+":"+zI(m,x[E])+";");else{var I=zm(e,t,x);switch(m){case"animation":case"animationName":{l+=_b(m)+":"+I+";";break}default:l+=m+"{"+I+"}"}}}}return l}var LI=/label:\s*([^\s;{]+)\s*(;|$)/g,fa;function Xm(e,t,r){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var l=!0,h="";fa=void 0;var m=e[0];if(m==null||m.raw===void 0)l=!1,h+=zm(r,t,m);else{var x=m;h+=x[0]}for(var a=1;a<e.length;a++)if(h+=zm(r,t,e[a]),l){var E=m;h+=E[a]}LI.lastIndex=0;for(var I="",L;(L=LI.exec(h))!==null;)I+="-"+L[1];var O=r6(h)+I;return{name:O,styles:h,next:fa}}var u6=function(t){return t()},Tz=am["useInsertionEffect"]?am["useInsertionEffect"]:!1,Cz=Tz||u6,DI=Tz||J.useLayoutEffect,d6=!1,kz=J.createContext(typeof HTMLElement<"u"?wz({key:"css"}):null),h6=kz.Provider,AS=function(t){return J.forwardRef(function(r,l){var h=J.useContext(kz);return t(r,h,l)})},Dh=J.createContext({}),MS={}.hasOwnProperty,Gw="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",p6=function(t,r){var l={};for(var h in r)MS.call(r,h)&&(l[h]=r[h]);return l[Gw]=t,l},f6=function(t){var r=t.cache,l=t.serialized,h=t.isStringTag;return kS(r,l,h),Cz(function(){return IS(r,l,h)}),null},m6=AS(function(e,t,r){var l=e.css;typeof l=="string"&&t.registered[l]!==void 0&&(l=t.registered[l]);var h=e[Gw],m=[l],x="";typeof e.className=="string"?x=Sz(t.registered,m,e.className):e.className!=null&&(x=e.className+" ");var a=Xm(m,void 0,J.useContext(Dh));x+=t.key+"-"+a.name;var E={};for(var I in e)MS.call(e,I)&&I!=="css"&&I!==Gw&&!d6&&(E[I]=e[I]);return E.className=x,r&&(E.ref=r),J.createElement(J.Fragment,null,J.createElement(f6,{cache:t,serialized:a,isStringTag:typeof h=="string"}),J.createElement(h,E))}),g6=m6,xb={exports:{}},OI;function Iz(){return OI||(OI=1,function(e){function t(){return e.exports=t=Object.assign?Object.assign.bind():function(r){for(var l=1;l<arguments.length;l++){var h=arguments[l];for(var m in h)({}).hasOwnProperty.call(h,m)&&(r[m]=h[m])}return r},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(xb)),xb.exports}Iz();var BI=function(t,r){var l=arguments;if(r==null||!MS.call(r,"css"))return J.createElement.apply(void 0,l);var h=l.length,m=new Array(h);m[0]=g6,m[1]=p6(t,r);for(var x=2;x<h;x++)m[x]=l[x];return J.createElement.apply(null,m)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(BI||(BI={}));var y6=AS(function(e,t){var r=e.styles,l=Xm([r],void 0,J.useContext(Dh)),h=J.useRef();return DI(function(){var m=t.key+"-globalThis",x=new t.sheet.constructor({key:m,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),a=!1,E=document.querySelector('style[data-emotion="'+m+" "+l.name+'"]');return t.sheet.tags.length&&(x.before=t.sheet.tags[0]),E!==null&&(a=!0,E.setAttribute("data-emotion",m),x.hydrate([E])),h.current=[x,a],function(){x.flush()}},[t]),DI(function(){var m=h.current,x=m[0],a=m[1];if(a){m[1]=!1;return}if(l.next!==void 0&&IS(t,l.next,!0),x.tags.length){var E=x.tags[x.tags.length-1].nextElementSibling;x.before=E,x.flush()}t.insert("",l,x,!1)},[t,l.name]),null});function bx(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Xm(t)}function Oh(){var e=bx.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var _6=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,x6=vz(function(e){return _6.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),v6=!1,b6=x6,w6=function(t){return t!=="theme"},FI=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?b6:w6},jI=function(t,r,l){var h;if(r){var m=r.shouldForwardProp;h=t.__emotion_forwardProp&&m?function(x){return t.__emotion_forwardProp(x)&&m(x)}:m}return typeof h!="function"&&l&&(h=t.__emotion_forwardProp),h},S6=function(t){var r=t.cache,l=t.serialized,h=t.isStringTag;return kS(r,l,h),Cz(function(){return IS(r,l,h)}),null},E6=function e(t,r){var l=t.__emotion_real===t,h=l&&t.__emotion_base||t,m,x;r!==void 0&&(m=r.label,x=r.target);var a=jI(t,r,l),E=a||FI(h),I=!E("as");return function(){var L=arguments,O=l&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(m!==void 0&&O.push("label:"+m+";"),L[0]==null||L[0].raw===void 0)O.push.apply(O,L);else{var F=L[0];O.push(F[0]);for(var K=L.length,W=1;W<K;W++)O.push(L[W],F[W])}var G=AS(function(ne,Z,H){var V=I&&ne.as||h,oe="",pe=[],_e=ne;if(ne.theme==null){_e={};for(var xe in ne)_e[xe]=ne[xe];_e.theme=J.useContext(Dh)}typeof ne.className=="string"?oe=Sz(Z.registered,pe,ne.className):ne.className!=null&&(oe=ne.className+" ");var De=Xm(O.concat(pe),Z.registered,_e);oe+=Z.key+"-"+De.name,x!==void 0&&(oe+=" "+x);var ye=I&&a===void 0?FI(V):E,Ae={};for(var ft in ne)I&&ft==="as"||ye(ft)&&(Ae[ft]=ne[ft]);return Ae.className=oe,H&&(Ae.ref=H),J.createElement(J.Fragment,null,J.createElement(S6,{cache:Z,serialized:De,isStringTag:typeof V=="string"}),J.createElement(V,Ae))});return G.displayName=m!==void 0?m:"Styled("+(typeof h=="string"?h:h.displayName||h.name||"Component")+")",G.defaultProps=t.defaultProps,G.__emotion_real=G,G.__emotion_base=h,G.__emotion_styles=O,G.__emotion_forwardProp=a,Object.defineProperty(G,"toString",{value:function(){return x===void 0&&v6?"NO_COMPONENT_SELECTOR":"."+x}}),G.withComponent=function(ne,Z){var H=e(ne,ce({},r,Z,{shouldForwardProp:jI(G,Z,!0)}));return H.apply(void 0,O)},G}},T6=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],qw=E6.bind(null);T6.forEach(function(e){qw[e]=qw(e)});function C6(e,t){const r=wz({key:"css",prepend:e});if(t){const l=r.insert;r.insert=(...h)=>(h[1].styles.match(/^@layer\s+[^{]*$/)||(h[1].styles=`@layer mui {${h[1].styles}}`),l(...h))}return r}const vb=new Map;function k6(e){const{injectFirst:t,enableCssLayer:r,children:l}=e,h=J.useMemo(()=>{const m=`${t}-${r}`;if(typeof document=="object"&&vb.has(m))return vb.get(m);const x=C6(t,r);return vb.set(m,x),x},[t,r]);return t||r?D.jsx(h6,{value:h,children:l}):l}function I6(e){return e==null||Object.keys(e).length===0}function Az(e){const{styles:t,defaultTheme:r={}}=e,l=typeof t=="function"?h=>t(I6(h)?r:h):t;return D.jsx(y6,{styles:l})}/**
 * @mui/styled-engine v5.18.0
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function PS(e,t){return qw(e,t)}const Mz=(e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))},NI=[];function h0(e){return NI[0]=e,Xm(NI)}const A6=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:Az,StyledEngineProvider:k6,ThemeContext:Dh,css:bx,default:PS,internal_processStyles:Mz,internal_serializeStyles:h0,keyframes:Oh},Symbol.toStringTag,{value:"Module"}));function Ua(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function Pz(e){if(J.isValidElement(e)||!Ua(e))return e;const t={};return Object.keys(e).forEach(r=>{t[r]=Pz(e[r])}),t}function jo(e,t,r={clone:!0}){const l=r.clone?ce({},e):e;return Ua(e)&&Ua(t)&&Object.keys(t).forEach(h=>{J.isValidElement(t[h])?l[h]=t[h]:Ua(t[h])&&Object.prototype.hasOwnProperty.call(e,h)&&Ua(e[h])?l[h]=jo(e[h],t[h],r):r.clone?l[h]=Ua(t[h])?Pz(t[h]):t[h]:l[h]=t[h]}),l}const M6=Object.freeze(Object.defineProperty({__proto__:null,default:jo,isPlainObject:Ua},Symbol.toStringTag,{value:"Module"})),P6=["values","unit","step"],R6=e=>{const t=Object.keys(e).map(r=>({key:r,val:e[r]}))||[];return t.sort((r,l)=>r.val-l.val),t.reduce((r,l)=>ce({},r,{[l.key]:l.val}),{})};function Rz(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:l=5}=e,h=Dt(e,P6),m=R6(t),x=Object.keys(m);function a(F){return`@media (min-width:${typeof t[F]=="number"?t[F]:F}${r})`}function E(F){return`@media (max-width:${(typeof t[F]=="number"?t[F]:F)-l/100}${r})`}function I(F,K){const W=x.indexOf(K);return`@media (min-width:${typeof t[F]=="number"?t[F]:F}${r}) and (max-width:${(W!==-1&&typeof t[x[W]]=="number"?t[x[W]]:K)-l/100}${r})`}function L(F){return x.indexOf(F)+1<x.length?I(F,x[x.indexOf(F)+1]):a(F)}function O(F){const K=x.indexOf(F);return K===0?a(x[1]):K===x.length-1?E(x[K]):I(F,x[x.indexOf(F)+1]).replace("@media","@media not all and")}return ce({keys:x,values:m,up:a,down:E,between:I,only:L,not:O,unit:r},h)}const z6={borderRadius:4},L6=z6;function rm(e,t){return t?jo(e,t,{clone:!1}):e}const RS={xs:0,sm:600,md:900,lg:1200,xl:1536},$I={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${RS[e]}px)`};function fs(e,t,r){const l=e.theme||{};if(Array.isArray(t)){const m=l.breakpoints||$I;return t.reduce((x,a,E)=>(x[m.up(m.keys[E])]=r(t[E]),x),{})}if(typeof t=="object"){const m=l.breakpoints||$I;return Object.keys(t).reduce((x,a)=>{if(Object.keys(m.values||RS).indexOf(a)!==-1){const E=m.up(a);x[E]=r(t[a],a)}else{const E=a;x[E]=t[E]}return x},{})}return r(t)}function D6(e={}){var t;return((t=e.keys)==null?void 0:t.reduce((l,h)=>{const m=e.up(h);return l[m]={},l},{}))||{}}function UI(e,t){return e.reduce((r,l)=>{const h=r[l];return(!h||Object.keys(h).length===0)&&delete r[l],r},t)}function O6(e,t){if(typeof e!="object")return{};const r={},l=Object.keys(t);return Array.isArray(e)?l.forEach((h,m)=>{m<e.length&&(r[h]=!0)}):l.forEach(h=>{e[h]!=null&&(r[h]=!0)}),r}function wx({values:e,breakpoints:t,base:r}){const l=r||O6(e,t),h=Object.keys(l);if(h.length===0)return e;let m;return h.reduce((x,a,E)=>(Array.isArray(e)?(x[a]=e[E]!=null?e[E]:e[m],m=E):typeof e=="object"?(x[a]=e[a]!=null?e[a]:e[m],m=a):x[a]=e,x),{})}function Ct(e){if(typeof e!="string")throw new Error(Su(7));return e.charAt(0).toUpperCase()+e.slice(1)}const B6=Object.freeze(Object.defineProperty({__proto__:null,default:Ct},Symbol.toStringTag,{value:"Module"}));function bh(e,t,r=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&r){const l=`vars.${t}`.split(".").reduce((h,m)=>h&&h[m]?h[m]:null,e);if(l!=null)return l}return t.split(".").reduce((l,h)=>l&&l[h]!=null?l[h]:null,e)}function p0(e,t,r,l=r){let h;return typeof e=="function"?h=e(r):Array.isArray(e)?h=e[r]||l:h=bh(e,r)||l,t&&(h=t(h,l,e)),h}function Yr(e){const{prop:t,cssProperty:r=e.prop,themeKey:l,transform:h}=e,m=x=>{if(x[t]==null)return null;const a=x[t],E=x.theme,I=bh(E,l)||{};return fs(x,a,O=>{let F=p0(I,h,O);return O===F&&typeof O=="string"&&(F=p0(I,h,`${t}${O==="default"?"":Ct(O)}`,O)),r===!1?F:{[r]:F}})};return m.propTypes={},m.filterProps=[t],m}function F6(e){const t={};return r=>(t[r]===void 0&&(t[r]=e(r)),t[r])}const j6={m:"margin",p:"padding"},N6={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},VI={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},$6=F6(e=>{if(e.length>2)if(VI[e])e=VI[e];else return[e];const[t,r]=e.split(""),l=j6[t],h=N6[r]||"";return Array.isArray(h)?h.map(m=>l+m):[l+h]}),zS=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],LS=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...zS,...LS];function Km(e,t,r,l){var h;const m=(h=bh(e,t,!1))!=null?h:r;return typeof m=="number"?x=>typeof x=="string"?x:m*x:Array.isArray(m)?x=>typeof x=="string"?x:m[x]:typeof m=="function"?m:()=>{}}function zz(e){return Km(e,"spacing",8)}function Ym(e,t){if(typeof t=="string"||t==null)return t;const r=Math.abs(t),l=e(r);return t>=0?l:typeof l=="number"?-l:`-${l}`}function U6(e,t){return r=>e.reduce((l,h)=>(l[h]=Ym(t,r),l),{})}function V6(e,t,r,l){if(t.indexOf(r)===-1)return null;const h=$6(r),m=U6(h,l),x=e[r];return fs(e,x,m)}function Lz(e,t){const r=zz(e.theme);return Object.keys(e).map(l=>V6(e,t,l,r)).reduce(rm,{})}function Hr(e){return Lz(e,zS)}Hr.propTypes={};Hr.filterProps=zS;function Zr(e){return Lz(e,LS)}Zr.propTypes={};Zr.filterProps=LS;function W6(e=8){if(e.mui)return e;const t=zz({spacing:e}),r=(...l)=>(l.length===0?[1]:l).map(m=>{const x=t(m);return typeof x=="number"?`${x}px`:x}).join(" ");return r.mui=!0,r}function Sx(...e){const t=e.reduce((l,h)=>(h.filterProps.forEach(m=>{l[m]=h}),l),{}),r=l=>Object.keys(l).reduce((h,m)=>t[m]?rm(h,t[m](l)):h,{});return r.propTypes={},r.filterProps=e.reduce((l,h)=>l.concat(h.filterProps),[]),r}function as(e){return typeof e!="number"?e:`${e}px solid`}function ys(e,t){return Yr({prop:e,themeKey:"borders",transform:t})}const G6=ys("border",as),q6=ys("borderTop",as),H6=ys("borderRight",as),Z6=ys("borderBottom",as),X6=ys("borderLeft",as),K6=ys("borderColor"),Y6=ys("borderTopColor"),J6=ys("borderRightColor"),Q6=ys("borderBottomColor"),eU=ys("borderLeftColor"),tU=ys("outline",as),nU=ys("outlineColor"),Ex=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=Km(e.theme,"shape.borderRadius",4),r=l=>({borderRadius:Ym(t,l)});return fs(e,e.borderRadius,r)}return null};Ex.propTypes={};Ex.filterProps=["borderRadius"];Sx(G6,q6,H6,Z6,X6,K6,Y6,J6,Q6,eU,Ex,tU,nU);const Tx=e=>{if(e.gap!==void 0&&e.gap!==null){const t=Km(e.theme,"spacing",8),r=l=>({gap:Ym(t,l)});return fs(e,e.gap,r)}return null};Tx.propTypes={};Tx.filterProps=["gap"];const Cx=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=Km(e.theme,"spacing",8),r=l=>({columnGap:Ym(t,l)});return fs(e,e.columnGap,r)}return null};Cx.propTypes={};Cx.filterProps=["columnGap"];const kx=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=Km(e.theme,"spacing",8),r=l=>({rowGap:Ym(t,l)});return fs(e,e.rowGap,r)}return null};kx.propTypes={};kx.filterProps=["rowGap"];const rU=Yr({prop:"gridColumn"}),iU=Yr({prop:"gridRow"}),oU=Yr({prop:"gridAutoFlow"}),sU=Yr({prop:"gridAutoColumns"}),aU=Yr({prop:"gridAutoRows"}),lU=Yr({prop:"gridTemplateColumns"}),cU=Yr({prop:"gridTemplateRows"}),uU=Yr({prop:"gridTemplateAreas"}),dU=Yr({prop:"gridArea"});Sx(Tx,Cx,kx,rU,iU,oU,sU,aU,lU,cU,uU,dU);function sh(e,t){return t==="grey"?t:e}const hU=Yr({prop:"color",themeKey:"palette",transform:sh}),pU=Yr({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:sh}),fU=Yr({prop:"backgroundColor",themeKey:"palette",transform:sh});Sx(hU,pU,fU);function Lo(e){return e<=1&&e!==0?`${e*100}%`:e}const mU=Yr({prop:"width",transform:Lo}),DS=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=r=>{var l,h;const m=((l=e.theme)==null||(l=l.breakpoints)==null||(l=l.values)==null?void 0:l[r])||RS[r];return m?((h=e.theme)==null||(h=h.breakpoints)==null?void 0:h.unit)!=="px"?{maxWidth:`${m}${e.theme.breakpoints.unit}`}:{maxWidth:m}:{maxWidth:Lo(r)}};return fs(e,e.maxWidth,t)}return null};DS.filterProps=["maxWidth"];const gU=Yr({prop:"minWidth",transform:Lo}),yU=Yr({prop:"height",transform:Lo}),_U=Yr({prop:"maxHeight",transform:Lo}),xU=Yr({prop:"minHeight",transform:Lo});Yr({prop:"size",cssProperty:"width",transform:Lo});Yr({prop:"size",cssProperty:"height",transform:Lo});const vU=Yr({prop:"boxSizing"});Sx(mU,DS,gU,yU,_U,xU,vU);const bU={border:{themeKey:"borders",transform:as},borderTop:{themeKey:"borders",transform:as},borderRight:{themeKey:"borders",transform:as},borderBottom:{themeKey:"borders",transform:as},borderLeft:{themeKey:"borders",transform:as},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:as},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Ex},color:{themeKey:"palette",transform:sh},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:sh},backgroundColor:{themeKey:"palette",transform:sh},p:{style:Zr},pt:{style:Zr},pr:{style:Zr},pb:{style:Zr},pl:{style:Zr},px:{style:Zr},py:{style:Zr},padding:{style:Zr},paddingTop:{style:Zr},paddingRight:{style:Zr},paddingBottom:{style:Zr},paddingLeft:{style:Zr},paddingX:{style:Zr},paddingY:{style:Zr},paddingInline:{style:Zr},paddingInlineStart:{style:Zr},paddingInlineEnd:{style:Zr},paddingBlock:{style:Zr},paddingBlockStart:{style:Zr},paddingBlockEnd:{style:Zr},m:{style:Hr},mt:{style:Hr},mr:{style:Hr},mb:{style:Hr},ml:{style:Hr},mx:{style:Hr},my:{style:Hr},margin:{style:Hr},marginTop:{style:Hr},marginRight:{style:Hr},marginBottom:{style:Hr},marginLeft:{style:Hr},marginX:{style:Hr},marginY:{style:Hr},marginInline:{style:Hr},marginInlineStart:{style:Hr},marginInlineEnd:{style:Hr},marginBlock:{style:Hr},marginBlockStart:{style:Hr},marginBlockEnd:{style:Hr},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Tx},rowGap:{style:kx},columnGap:{style:Cx},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Lo},maxWidth:{style:DS},minWidth:{transform:Lo},height:{transform:Lo},maxHeight:{transform:Lo},minHeight:{transform:Lo},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},Jm=bU;function wU(...e){const t=e.reduce((l,h)=>l.concat(Object.keys(h)),[]),r=new Set(t);return e.every(l=>r.size===Object.keys(l).length)}function SU(e,t){return typeof e=="function"?e(t):e}function Dz(){function e(r,l,h,m){const x={[r]:l,theme:h},a=m[r];if(!a)return{[r]:l};const{cssProperty:E=r,themeKey:I,transform:L,style:O}=a;if(l==null)return null;if(I==="typography"&&l==="inherit")return{[r]:l};const F=bh(h,I)||{};return O?O(x):fs(x,l,W=>{let G=p0(F,L,W);return W===G&&typeof W=="string"&&(G=p0(F,L,`${r}${W==="default"?"":Ct(W)}`,W)),E===!1?G:{[E]:G}})}function t(r){var l;const{sx:h,theme:m={},nested:x}=r||{};if(!h)return null;const a=(l=m.unstable_sxConfig)!=null?l:Jm;function E(I){let L=I;if(typeof I=="function")L=I(m);else if(typeof I!="object")return I;if(!L)return null;const O=D6(m.breakpoints),F=Object.keys(O);let K=O;return Object.keys(L).forEach(W=>{const G=SU(L[W],m);if(G!=null)if(typeof G=="object")if(a[W])K=rm(K,e(W,G,m,a));else{const ne=fs({theme:m},G,Z=>({[W]:Z}));wU(ne,G)?K[W]=t({sx:G,theme:m,nested:!0}):K=rm(K,ne)}else K=rm(K,e(W,G,m,a))}),!x&&m.modularCssLayers?{"@layer sx":UI(F,K)}:UI(F,K)}return Array.isArray(h)?h.map(E):E(h)}return t}const Oz=Dz();Oz.filterProps=["sx"];const Qm=Oz;function Bz(e,t){const r=this;return r.vars&&typeof r.getColorSchemeSelector=="function"?{[r.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)")]:t}:r.palette.mode===e?t:{}}const EU=["breakpoints","palette","spacing","shape"];function eg(e={},...t){const{breakpoints:r={},palette:l={},spacing:h,shape:m={}}=e,x=Dt(e,EU),a=Rz(r),E=W6(h);let I=jo({breakpoints:a,direction:"ltr",components:{},palette:ce({mode:"light"},l),spacing:E,shape:ce({},L6,m)},x);return I.applyStyles=Bz,I=t.reduce((L,O)=>jo(L,O),I),I.unstable_sxConfig=ce({},Jm,x==null?void 0:x.unstable_sxConfig),I.unstable_sx=function(O){return Qm({sx:O,theme:this})},I}const TU=Object.freeze(Object.defineProperty({__proto__:null,default:eg,private_createBreakpoints:Rz,unstable_applyStyles:Bz},Symbol.toStringTag,{value:"Module"}));function CU(e){return Object.keys(e).length===0}function Ix(e=null){const t=J.useContext(Dh);return!t||CU(t)?e:t}const kU=eg();function Ax(e=kU){return Ix(e)}function bb(e){const t=h0(e);return e!==t&&t.styles?(t.styles.match(/^@layer\s+[^{]*$/)||(t.styles=`@layer globalThis{${t.styles}}`),t):e}function Fz({styles:e,themeId:t,defaultTheme:r={}}){const l=Ax(r),h=t&&l[t]||l;let m=typeof e=="function"?e(h):e;return h.modularCssLayers&&(Array.isArray(m)?m=m.map(x=>bb(typeof x=="function"?x(h):x)):m=bb(m)),D.jsx(Az,{styles:m})}const IU=["sx"],AU=e=>{var t,r;const l={systemProps:{},otherProps:{}},h=(t=e==null||(r=e.theme)==null?void 0:r.unstable_sxConfig)!=null?t:Jm;return Object.keys(e).forEach(m=>{h[m]?l.systemProps[m]=e[m]:l.otherProps[m]=e[m]}),l};function Mx(e){const{sx:t}=e,r=Dt(e,IU),{systemProps:l,otherProps:h}=AU(r);let m;return Array.isArray(t)?m=[l,...t]:typeof t=="function"?m=(...x)=>{const a=t(...x);return Ua(a)?ce({},l,a):l}:m=ce({},l,t),ce({},h,{sx:m})}const MU=Object.freeze(Object.defineProperty({__proto__:null,default:Qm,extendSxProp:Mx,unstable_createStyleFunctionSx:Dz,unstable_defaultSxConfig:Jm},Symbol.toStringTag,{value:"Module"})),WI=e=>e,PU=()=>{let e=WI;return{configure(t){e=t},generate(t){return e(t)},reset(){e=WI}}},RU=PU(),jz=RU;function Nz(e){var t,r,l="";if(typeof e=="string"||typeof e=="number")l+=e;else if(typeof e=="object")if(Array.isArray(e)){var h=e.length;for(t=0;t<h;t++)e[t]&&(r=Nz(e[t]))&&(l&&(l+=" "),l+=r)}else for(r in e)e[r]&&(l&&(l+=" "),l+=r);return l}function Wt(){for(var e,t,r=0,l="",h=arguments.length;r<h;r++)(e=arguments[r])&&(t=Nz(e))&&(l&&(l+=" "),l+=t);return l}const zU=["className","component"];function LU(e={}){const{themeId:t,defaultTheme:r,defaultClassName:l="MuiBox-root",generateClassName:h}=e,m=PS("div",{shouldForwardProp:a=>a!=="theme"&&a!=="sx"&&a!=="as"})(Qm);return J.forwardRef(function(E,I){const L=Ax(r),O=Mx(E),{className:F,component:K="div"}=O,W=Dt(O,zU);return D.jsx(m,ce({as:K,ref:I,className:Wt(F,h?h(l):l),theme:t&&L[t]||L},W))})}const DU={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function yn(e,t,r="Mui"){const l=DU[t];return l?`${r}-${l}`:`${jz.generate(e)}-${t}`}function mn(e,t,r="Mui"){const l={};return t.forEach(h=>{l[h]=yn(e,h,r)}),l}var $z={exports:{}},hr={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OS=Symbol.for("react.transitional.element"),BS=Symbol.for("react.portal"),Px=Symbol.for("react.fragment"),Rx=Symbol.for("react.strict_mode"),zx=Symbol.for("react.profiler"),Lx=Symbol.for("react.consumer"),Dx=Symbol.for("react.context"),Ox=Symbol.for("react.forward_ref"),Bx=Symbol.for("react.suspense"),Fx=Symbol.for("react.suspense_list"),jx=Symbol.for("react.memo"),Nx=Symbol.for("react.lazy"),OU=Symbol.for("react.view_transition"),BU=Symbol.for("react.client.reference");function _s(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case OS:switch(e=e.type,e){case Px:case zx:case Rx:case Bx:case Fx:case OU:return e;default:switch(e=e&&e.$$typeof,e){case Dx:case Ox:case Nx:case jx:return e;case Lx:return e;default:return t}}case BS:return t}}}hr.ContextConsumer=Lx;hr.ContextProvider=Dx;hr.Element=OS;hr.ForwardRef=Ox;hr.Fragment=Px;hr.Lazy=Nx;hr.Memo=jx;hr.Portal=BS;hr.Profiler=zx;hr.StrictMode=Rx;hr.Suspense=Bx;hr.SuspenseList=Fx;hr.isContextConsumer=function(e){return _s(e)===Lx};hr.isContextProvider=function(e){return _s(e)===Dx};hr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===OS};hr.isForwardRef=function(e){return _s(e)===Ox};hr.isFragment=function(e){return _s(e)===Px};hr.isLazy=function(e){return _s(e)===Nx};hr.isMemo=function(e){return _s(e)===jx};hr.isPortal=function(e){return _s(e)===BS};hr.isProfiler=function(e){return _s(e)===zx};hr.isStrictMode=function(e){return _s(e)===Rx};hr.isSuspense=function(e){return _s(e)===Bx};hr.isSuspenseList=function(e){return _s(e)===Fx};hr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Px||e===zx||e===Rx||e===Bx||e===Fx||typeof e=="object"&&e!==null&&(e.$$typeof===Nx||e.$$typeof===jx||e.$$typeof===Dx||e.$$typeof===Lx||e.$$typeof===Ox||e.$$typeof===BU||e.getModuleId!==void 0)};hr.typeOf=_s;$z.exports=hr;var GI=$z.exports;const FU=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function Uz(e){const t=`${e}`.match(FU);return t&&t[1]||""}function Vz(e,t=""){return e.displayName||e.name||Uz(e)||t}function qI(e,t,r){const l=Vz(t);return e.displayName||(l!==""?`${r}(${l})`:r)}function jU(e){if(e!=null){if(typeof e=="string")return e;if(typeof e=="function")return Vz(e,"Component");if(typeof e=="object")switch(e.$$typeof){case GI.ForwardRef:return qI(e,e.render,"ForwardRef");case GI.Memo:return qI(e,e.type,"memo");default:return}}}const NU=Object.freeze(Object.defineProperty({__proto__:null,default:jU,getFunctionName:Uz},Symbol.toStringTag,{value:"Module"})),$U=["ownerState"],UU=["variants"],VU=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function WU(e){return Object.keys(e).length===0}function GU(e){return typeof e=="string"&&e.charCodeAt(0)>96}function wb(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function HI(e,t){return t&&e&&typeof e=="object"&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles=`@layer ${t}{${String(e.styles)}}`),e}const qU=eg(),HU=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function Hy({defaultTheme:e,theme:t,themeId:r}){return WU(t)?e:t[r]||t}function ZU(e){return e?(t,r)=>r[e]:null}function S_(e,t,r){let{ownerState:l}=t,h=Dt(t,$U);const m=typeof e=="function"?e(ce({ownerState:l},h)):e;if(Array.isArray(m))return m.flatMap(x=>S_(x,ce({ownerState:l},h),r));if(m&&typeof m=="object"&&Array.isArray(m.variants)){const{variants:x=[]}=m;let E=Dt(m,UU);return x.forEach(I=>{let L=!0;if(typeof I.props=="function"?L=I.props(ce({ownerState:l},h,l)):Object.keys(I.props).forEach(O=>{(l==null?void 0:l[O])!==I.props[O]&&h[O]!==I.props[O]&&(L=!1)}),L){Array.isArray(E)||(E=[E]);const O=typeof I.style=="function"?I.style(ce({ownerState:l},h,l)):I.style;E.push(r?HI(h0(O),r):O)}}),E}return r?HI(h0(m),r):m}function XU(e={}){const{themeId:t,defaultTheme:r=qU,rootShouldForwardProp:l=wb,slotShouldForwardProp:h=wb}=e,m=x=>Qm(ce({},x,{theme:Hy(ce({},x,{defaultTheme:r,themeId:t}))}));return m.__mui_systemSx=!0,(x,a={})=>{Mz(x,_e=>_e.filter(xe=>!(xe!=null&&xe.__mui_systemSx)));const{name:E,slot:I,skipVariantsResolver:L,skipSx:O,overridesResolver:F=ZU(HU(I))}=a,K=Dt(a,VU),W=E&&E.startsWith("Mui")||I?"components":"custom",G=L!==void 0?L:I&&I!=="Root"&&I!=="root"||!1,ne=O||!1;let Z,H=wb;I==="Root"||I==="root"?H=l:I?H=h:GU(x)&&(H=void 0);const V=PS(x,ce({shouldForwardProp:H,label:Z},K)),oe=_e=>typeof _e=="function"&&_e.__emotion_real!==_e||Ua(_e)?xe=>{const De=Hy({theme:xe.theme,defaultTheme:r,themeId:t});return S_(_e,ce({},xe,{theme:De}),De.modularCssLayers?W:void 0)}:_e,pe=(_e,...xe)=>{let De=oe(_e);const ye=xe?xe.map(oe):[];E&&F&&ye.push(Ge=>{const et=Hy(ce({},Ge,{defaultTheme:r,themeId:t}));if(!et.components||!et.components[E]||!et.components[E].styleOverrides)return null;const lt=et.components[E].styleOverrides,gt={};return Object.entries(lt).forEach(([St,It])=>{gt[St]=S_(It,ce({},Ge,{theme:et}),et.modularCssLayers?"theme":void 0)}),F(Ge,gt)}),E&&!G&&ye.push(Ge=>{var et;const lt=Hy(ce({},Ge,{defaultTheme:r,themeId:t})),gt=lt==null||(et=lt.components)==null||(et=et[E])==null?void 0:et.variants;return S_({variants:gt},ce({},Ge,{theme:lt}),lt.modularCssLayers?"theme":void 0)}),ne||ye.push(m);const Ae=ye.length-xe.length;if(Array.isArray(_e)&&Ae>0){const Ge=new Array(Ae).fill("");De=[..._e,...Ge],De.raw=[..._e.raw,...Ge]}const ft=V(De,...ye);return x.muiName&&(ft.muiName=x.muiName),ft};return V.withConfig&&(pe.withConfig=V.withConfig),pe}}const KU=XU(),YU=KU;function Lm(e,t){const r=ce({},t);return Object.keys(e).forEach(l=>{if(l.toString().match(/^(components|slots)$/))r[l]=ce({},e[l],r[l]);else if(l.toString().match(/^(componentsProps|slotProps)$/)){const h=e[l]||{},m=t[l];r[l]={},!m||!Object.keys(m)?r[l]=h:!h||!Object.keys(h)?r[l]=m:(r[l]=ce({},m),Object.keys(h).forEach(x=>{r[l][x]=Lm(h[x],m[x])}))}else r[l]===void 0&&(r[l]=e[l])}),r}function Wz(e){const{theme:t,name:r,props:l}=e;return!t||!t.components||!t.components[r]||!t.components[r].defaultProps?l:Lm(t.components[r].defaultProps,l)}function JU({props:e,name:t,defaultTheme:r,themeId:l}){let h=Ax(r);return l&&(h=h[l]||h),Wz({theme:h,name:t,props:e})}const QU=typeof window<"u"?J.useLayoutEffect:J.useEffect,Ys=QU;function e8(e,t,r,l,h){const[m,x]=J.useState(()=>h&&r?r(e).matches:l?l(e).matches:t);return Ys(()=>{let a=!0;if(!r)return;const E=r(e),I=()=>{a&&x(E.matches)};return I(),E.addListener(I),()=>{a=!1,E.removeListener(I)}},[e,r]),m}const Gz=am["useSyncExternalStore"];function t8(e,t,r,l,h){const m=J.useCallback(()=>t,[t]),x=J.useMemo(()=>{if(h&&r)return()=>r(e).matches;if(l!==null){const{matches:L}=l(e);return()=>L}return m},[m,e,l,h,r]),[a,E]=J.useMemo(()=>{if(r===null)return[m,()=>()=>{}];const L=r(e);return[()=>L.matches,O=>(L.addListener(O),()=>{L.removeListener(O)})]},[m,r,e]);return Gz(E,a,x)}function n8(e,t={}){const r=Ix(),l=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:h=!1,matchMedia:m=l?window.matchMedia:null,ssrMatchMedia:x=null,noSsr:a=!1}=Wz({name:"MuiUseMediaQuery",props:t,theme:r});let E=typeof e=="function"?e(r):e;return E=E.replace(/^@media( ?)/m,""),(Gz!==void 0?t8:e8)(E,h,m,x,a)}function r8(e,t=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,r))}const i8=Object.freeze(Object.defineProperty({__proto__:null,default:r8},Symbol.toStringTag,{value:"Module"}));function ZI(...e){return e.reduce((t,r)=>r==null?t:function(...h){t.apply(this,h),r.apply(this,h)},()=>{})}function qz(e,t=166){let r;function l(...h){const m=()=>{e.apply(this,h)};clearTimeout(r),r=setTimeout(m,t)}return l.clear=()=>{clearTimeout(r)},l}function E_(e,t){var r,l;return J.isValidElement(e)&&t.indexOf((r=e.type.muiName)!=null?r:(l=e.type)==null||(l=l._payload)==null||(l=l.value)==null?void 0:l.muiName)!==-1}function No(e){return e&&e.ownerDocument||document}function Eu(e){return No(e).defaultView||window}function Hw(e,t){typeof e=="function"?e(t):e&&(e.current=t)}let XI=0;function o8(e){const[t,r]=J.useState(e),l=e||t;return J.useEffect(()=>{t==null&&(XI+=1,r(`mui-${XI}`))},[t]),l}const KI=am["useId".toString()];function FS(e){if(KI!==void 0){const t=KI();return e??t}return o8(e)}function YI({controlled:e,default:t,name:r,state:l="value"}){const{current:h}=J.useRef(e!==void 0),[m,x]=J.useState(t),a=h?e:m,E=J.useCallback(I=>{h||x(I)},[]);return[a,E]}function du(e){const t=J.useRef(e);return Ys(()=>{t.current=e}),J.useRef((...r)=>(0,t.current)(...r)).current}function _i(...e){return J.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(r=>{Hw(r,t)})},e)}const JI={};function s8(e,t){const r=J.useRef(JI);return r.current===JI&&(r.current=e(t)),r}const a8=[];function l8(e){J.useEffect(e,a8)}class $x{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new $x}start(t,r){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,r()},t)}}function Hz(){const e=s8($x.create).current;return l8(e.disposeEffect),e}let Ux=!0,Zw=!1;const c8=new $x,u8={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function d8(e){const{type:t,tagName:r}=e;return!!(r==="INPUT"&&u8[t]&&!e.readOnly||r==="TEXTAREA"&&!e.readOnly||e.isContentEditable)}function h8(e){e.metaKey||e.altKey||e.ctrlKey||(Ux=!0)}function Sb(){Ux=!1}function p8(){this.visibilityState==="hidden"&&Zw&&(Ux=!0)}function f8(e){e.addEventListener("keydown",h8,!0),e.addEventListener("mousedown",Sb,!0),e.addEventListener("pointerdown",Sb,!0),e.addEventListener("touchstart",Sb,!0),e.addEventListener("visibilitychange",p8,!0)}function m8(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch{}return Ux||d8(t)}function Zz(){const e=J.useCallback(h=>{h!=null&&f8(h.ownerDocument)},[]),t=J.useRef(!1);function r(){return t.current?(Zw=!0,c8.start(100,()=>{Zw=!1}),t.current=!1,!0):!1}function l(h){return m8(h)?(t.current=!0,!0):!1}return{isFocusVisibleRef:t,onFocus:l,onBlur:r,ref:e}}function Xz(e){const t=e.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}function bn(e,t,r=void 0){const l={};return Object.keys(e).forEach(h=>{l[h]=e[h].reduce((m,x)=>{if(x){const a=t(x);a!==""&&m.push(a),r&&r[x]&&m.push(r[x])}return m},[]).join(" ")}),l}function wh(e){return typeof e=="string"}function Kz(e,t,r){return e===void 0||wh(e)?t:ce({},t,{ownerState:ce({},t.ownerState,r)})}function Yz(e,t=[]){if(e===void 0)return{};const r={};return Object.keys(e).filter(l=>l.match(/^on[A-Z]/)&&typeof e[l]=="function"&&!t.includes(l)).forEach(l=>{r[l]=e[l]}),r}function QI(e){if(e===void 0)return{};const t={};return Object.keys(e).filter(r=>!(r.match(/^on[A-Z]/)&&typeof e[r]=="function")).forEach(r=>{t[r]=e[r]}),t}function Jz(e){const{getSlotProps:t,additionalProps:r,externalSlotProps:l,externalForwardedProps:h,className:m}=e;if(!t){const K=Wt(r==null?void 0:r.className,m,h==null?void 0:h.className,l==null?void 0:l.className),W=ce({},r==null?void 0:r.style,h==null?void 0:h.style,l==null?void 0:l.style),G=ce({},r,h,l);return K.length>0&&(G.className=K),Object.keys(W).length>0&&(G.style=W),{props:G,internalRef:void 0}}const x=Yz(ce({},h,l)),a=QI(l),E=QI(h),I=t(x),L=Wt(I==null?void 0:I.className,r==null?void 0:r.className,m,h==null?void 0:h.className,l==null?void 0:l.className),O=ce({},I==null?void 0:I.style,r==null?void 0:r.style,h==null?void 0:h.style,l==null?void 0:l.style),F=ce({},I,r,E,a);return L.length>0&&(F.className=L),Object.keys(O).length>0&&(F.style=O),{props:F,internalRef:I.ref}}function Qz(e,t,r){return typeof e=="function"?e(t,r):e}const g8=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function Sh(e){var t;const{elementType:r,externalSlotProps:l,ownerState:h,skipResolvingSlotProps:m=!1}=e,x=Dt(e,g8),a=m?{}:Qz(l,h),{props:E,internalRef:I}=Jz(ce({},x,{externalSlotProps:a})),L=_i(I,a==null?void 0:a.ref,(t=e.additionalProps)==null?void 0:t.ref);return Kz(r,ce({},E,{ref:L}),h)}function tg(e){if(parseInt(J.version,10)>=19){var t;return(e==null||(t=e.props)==null?void 0:t.ref)||null}return(e==null?void 0:e.ref)||null}const y8=J.createContext(null),eL=y8;function tL(){return J.useContext(eL)}const _8=typeof Symbol=="function"&&Symbol.for,x8=_8?Symbol.for("mui.nested"):"__THEME_NESTED__";function v8(e,t){return typeof t=="function"?t(e):ce({},e,t)}function b8(e){const{children:t,theme:r}=e,l=tL(),h=J.useMemo(()=>{const m=l===null?r:v8(l,r);return m!=null&&(m[x8]=l!==null),m},[r,l]);return D.jsx(eL.Provider,{value:h,children:t})}const w8=["value"],nL=J.createContext();function S8(e){let{value:t}=e,r=Dt(e,w8);return D.jsx(nL.Provider,ce({value:t??!0},r))}const E8=()=>{const e=J.useContext(nL);return e??!1},rL=J.createContext(void 0);function T8({value:e,children:t}){return D.jsx(rL.Provider,{value:e,children:t})}function C8(e){const{theme:t,name:r,props:l}=e;if(!t||!t.components||!t.components[r])return l;const h=t.components[r];return h.defaultProps?Lm(h.defaultProps,l):!h.styleOverrides&&!h.variants?Lm(h,l):l}function k8({props:e,name:t}){const r=J.useContext(rL);return C8({props:e,name:t,theme:{components:r}})}function I8(e){const t=Ix(),r=FS()||"",{modularCssLayers:l}=e;let h="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!l||t!==null?h="":typeof l=="string"?h=l.replace(/mui(?!\.)/g,h):h=`@layer ${h};`,Ys(()=>{const m=document.querySelector("head");if(!m)return;const x=m.firstChild;if(h){var a;if(x&&(a=x.hasAttribute)!=null&&a.call(x,"data-mui-layer-order")&&x.getAttribute("data-mui-layer-order")===r)return;const I=document.createElement("style");I.setAttribute("data-mui-layer-order",r),I.textContent=h,m.prepend(I)}else{var E;(E=m.querySelector(`style[data-mui-layer-order="${r}"]`))==null||E.remove()}},[h,r]),h?D.jsx(Fz,{styles:h}):null}const eA={};function tA(e,t,r,l=!1){return J.useMemo(()=>{const h=e&&t[e]||t;if(typeof r=="function"){const m=r(h),x=e?ce({},t,{[e]:m}):m;return l?()=>x:x}return e?ce({},t,{[e]:r}):ce({},t,r)},[e,t,r,l])}function A8(e){const{children:t,theme:r,themeId:l}=e,h=Ix(eA),m=tL()||eA,x=tA(l,h,r),a=tA(l,m,r,!0),E=x.direction==="rtl",I=I8(x);return D.jsx(b8,{theme:a,children:D.jsx(Dh.Provider,{value:x,children:D.jsx(S8,{value:E,children:D.jsxs(T8,{value:x==null?void 0:x.components,children:[I,t]})})})})}const M8=["className","component","disableGutters","fixed","maxWidth","classes"],P8=eg(),R8=YU("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[`maxWidth${Ct(String(r.maxWidth))}`],r.fixed&&t.fixed,r.disableGutters&&t.disableGutters]}}),z8=e=>JU({props:e,name:"MuiContainer",defaultTheme:P8}),L8=(e,t)=>{const r=E=>yn(t,E),{classes:l,fixed:h,disableGutters:m,maxWidth:x}=e,a={root:["root",x&&`maxWidth${Ct(String(x))}`,h&&"fixed",m&&"disableGutters"]};return bn(a,r,l)};function D8(e={}){const{createStyledComponent:t=R8,useThemeProps:r=z8,componentName:l="MuiContainer"}=e,h=t(({theme:x,ownerState:a})=>ce({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!a.disableGutters&&{paddingLeft:x.spacing(2),paddingRight:x.spacing(2),[x.breakpoints.up("sm")]:{paddingLeft:x.spacing(3),paddingRight:x.spacing(3)}}),({theme:x,ownerState:a})=>a.fixed&&Object.keys(x.breakpoints.values).reduce((E,I)=>{const L=I,O=x.breakpoints.values[L];return O!==0&&(E[x.breakpoints.up(L)]={maxWidth:`${O}${x.breakpoints.unit}`}),E},{}),({theme:x,ownerState:a})=>ce({},a.maxWidth==="xs"&&{[x.breakpoints.up("xs")]:{maxWidth:Math.max(x.breakpoints.values.xs,444)}},a.maxWidth&&a.maxWidth!=="xs"&&{[x.breakpoints.up(a.maxWidth)]:{maxWidth:`${x.breakpoints.values[a.maxWidth]}${x.breakpoints.unit}`}}));return J.forwardRef(function(a,E){const I=r(a),{className:L,component:O="div",disableGutters:F=!1,fixed:K=!1,maxWidth:W="lg"}=I,G=Dt(I,M8),ne=ce({},I,{component:O,disableGutters:F,fixed:K,maxWidth:W}),Z=L8(ne,l);return D.jsx(h,ce({as:O,ownerState:ne,className:Wt(Z.root,L),ref:E},G))})}function O8(e,t){return ce({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},t)}var Jr={},iL={exports:{}};(function(e){function t(r){return r&&r.__esModule?r:{default:r}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(iL);var oL=iL.exports;const B8=cc(C$),F8=cc(i8);var sL=oL;Object.defineProperty(Jr,"__esModule",{value:!0});var sr=Jr.alpha=uL;Jr.blend=X8;Jr.colorChannel=void 0;var Xw=Jr.darken=NS;Jr.decomposeColor=ms;Jr.emphasize=dL;var j8=Jr.getContrastRatio=W8;Jr.getLuminance=f0;Jr.hexToRgb=aL;Jr.hslToRgb=cL;var Kw=Jr.lighten=$S;Jr.private_safeAlpha=G8;Jr.private_safeColorChannel=void 0;Jr.private_safeDarken=q8;Jr.private_safeEmphasize=Z8;Jr.private_safeLighten=H8;Jr.recomposeColor=Bh;Jr.rgbToHex=V8;var nA=sL(B8),N8=sL(F8);function jS(e,t=0,r=1){return(0,N8.default)(e,t,r)}function aL(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let r=e.match(t);return r&&r[0].length===1&&(r=r.map(l=>l+l)),r?`rgb${r.length===4?"a":""}(${r.map((l,h)=>h<3?parseInt(l,16):Math.round(parseInt(l,16)/255*1e3)/1e3).join(", ")})`:""}function $8(e){const t=e.toString(16);return t.length===1?`0${t}`:t}function ms(e){if(e.type)return e;if(e.charAt(0)==="#")return ms(aL(e));const t=e.indexOf("("),r=e.substring(0,t);if(["rgb","rgba","hsl","hsla","color"].indexOf(r)===-1)throw new Error((0,nA.default)(9,e));let l=e.substring(t+1,e.length-1),h;if(r==="color"){if(l=l.split(" "),h=l.shift(),l.length===4&&l[3].charAt(0)==="/"&&(l[3]=l[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(h)===-1)throw new Error((0,nA.default)(10,h))}else l=l.split(",");return l=l.map(m=>parseFloat(m)),{type:r,values:l,colorSpace:h}}const lL=e=>{const t=ms(e);return t.values.slice(0,3).map((r,l)=>t.type.indexOf("hsl")!==-1&&l!==0?`${r}%`:r).join(" ")};Jr.colorChannel=lL;const U8=(e,t)=>{try{return lL(e)}catch{return e}};Jr.private_safeColorChannel=U8;function Bh(e){const{type:t,colorSpace:r}=e;let{values:l}=e;return t.indexOf("rgb")!==-1?l=l.map((h,m)=>m<3?parseInt(h,10):h):t.indexOf("hsl")!==-1&&(l[1]=`${l[1]}%`,l[2]=`${l[2]}%`),t.indexOf("color")!==-1?l=`${r} ${l.join(" ")}`:l=`${l.join(", ")}`,`${t}(${l})`}function V8(e){if(e.indexOf("#")===0)return e;const{values:t}=ms(e);return`#${t.map((r,l)=>$8(l===3?Math.round(255*r):r)).join("")}`}function cL(e){e=ms(e);const{values:t}=e,r=t[0],l=t[1]/100,h=t[2]/100,m=l*Math.min(h,1-h),x=(I,L=(I+r/30)%12)=>h-m*Math.max(Math.min(L-3,9-L,1),-1);let a="rgb";const E=[Math.round(x(0)*255),Math.round(x(8)*255),Math.round(x(4)*255)];return e.type==="hsla"&&(a+="a",E.push(t[3])),Bh({type:a,values:E})}function f0(e){e=ms(e);let t=e.type==="hsl"||e.type==="hsla"?ms(cL(e)).values:e.values;return t=t.map(r=>(e.type!=="color"&&(r/=255),r<=.03928?r/12.92:((r+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function W8(e,t){const r=f0(e),l=f0(t);return(Math.max(r,l)+.05)/(Math.min(r,l)+.05)}function uL(e,t){return e=ms(e),t=jS(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,Bh(e)}function G8(e,t,r){try{return uL(e,t)}catch{return e}}function NS(e,t){if(e=ms(e),t=jS(t),e.type.indexOf("hsl")!==-1)e.values[2]*=1-t;else if(e.type.indexOf("rgb")!==-1||e.type.indexOf("color")!==-1)for(let r=0;r<3;r+=1)e.values[r]*=1-t;return Bh(e)}function q8(e,t,r){try{return NS(e,t)}catch{return e}}function $S(e,t){if(e=ms(e),t=jS(t),e.type.indexOf("hsl")!==-1)e.values[2]+=(100-e.values[2])*t;else if(e.type.indexOf("rgb")!==-1)for(let r=0;r<3;r+=1)e.values[r]+=(255-e.values[r])*t;else if(e.type.indexOf("color")!==-1)for(let r=0;r<3;r+=1)e.values[r]+=(1-e.values[r])*t;return Bh(e)}function H8(e,t,r){try{return $S(e,t)}catch{return e}}function dL(e,t=.15){return f0(e)>.5?NS(e,t):$S(e,t)}function Z8(e,t,r){try{return dL(e,t)}catch{return e}}function X8(e,t,r,l=1){const h=(E,I)=>Math.round((E**(1/l)*(1-r)+I**(1/l)*r)**l),m=ms(e),x=ms(t),a=[h(m.values[0],x.values[0]),h(m.values[1],x.values[1]),h(m.values[2],x.values[2])];return Bh({type:"rgb",values:a})}const K8={black:"#000",white:"#fff"},Dm=K8,Y8={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},J8=Y8,Q8={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Md=Q8,eV={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Pd=eV,tV={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Mf=tV,nV={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Rd=nV,rV={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},zd=rV,iV={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Ld=iV,oV=["mode","contrastThreshold","tonalOffset"],rA={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Dm.white,default:Dm.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Eb={text:{primary:Dm.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Dm.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function iA(e,t,r,l){const h=l.light||l,m=l.dark||l*1.5;e[t]||(e.hasOwnProperty(r)?e[t]=e[r]:t==="light"?e.light=Kw(e.main,h):t==="dark"&&(e.dark=Xw(e.main,m)))}function sV(e="light"){return e==="dark"?{main:Rd[200],light:Rd[50],dark:Rd[400]}:{main:Rd[700],light:Rd[400],dark:Rd[800]}}function aV(e="light"){return e==="dark"?{main:Md[200],light:Md[50],dark:Md[400]}:{main:Md[500],light:Md[300],dark:Md[700]}}function lV(e="light"){return e==="dark"?{main:Pd[500],light:Pd[300],dark:Pd[700]}:{main:Pd[700],light:Pd[400],dark:Pd[800]}}function cV(e="light"){return e==="dark"?{main:zd[400],light:zd[300],dark:zd[700]}:{main:zd[700],light:zd[500],dark:zd[900]}}function uV(e="light"){return e==="dark"?{main:Ld[400],light:Ld[300],dark:Ld[700]}:{main:Ld[800],light:Ld[500],dark:Ld[900]}}function dV(e="light"){return e==="dark"?{main:Mf[400],light:Mf[300],dark:Mf[700]}:{main:"#ed6c02",light:Mf[500],dark:Mf[900]}}function hV(e){const{mode:t="light",contrastThreshold:r=3,tonalOffset:l=.2}=e,h=Dt(e,oV),m=e.primary||sV(t),x=e.secondary||aV(t),a=e.error||lV(t),E=e.info||cV(t),I=e.success||uV(t),L=e.warning||dV(t);function O(G){return j8(G,Eb.text.primary)>=r?Eb.text.primary:rA.text.primary}const F=({color:G,name:ne,mainShade:Z=500,lightShade:H=300,darkShade:V=700})=>{if(G=ce({},G),!G.main&&G[Z]&&(G.main=G[Z]),!G.hasOwnProperty("main"))throw new Error(Su(11,ne?` (${ne})`:"",Z));if(typeof G.main!="string")throw new Error(Su(12,ne?` (${ne})`:"",JSON.stringify(G.main)));return iA(G,"light",H,l),iA(G,"dark",V,l),G.contrastText||(G.contrastText=O(G.main)),G},K={dark:Eb,light:rA};return jo(ce({common:ce({},Dm),mode:t,primary:F({color:m,name:"primary"}),secondary:F({color:x,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:F({color:a,name:"error"}),warning:F({color:L,name:"warning"}),info:F({color:E,name:"info"}),success:F({color:I,name:"success"}),grey:J8,contrastThreshold:r,getContrastText:O,augmentColor:F,tonalOffset:l},K[t]),h)}const pV=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function fV(e){return Math.round(e*1e5)/1e5}const oA={textTransform:"uppercase"},sA='"Roboto", "Helvetica", "Arial", sans-serif';function mV(e,t){const r=typeof t=="function"?t(e):t,{fontFamily:l=sA,fontSize:h=14,fontWeightLight:m=300,fontWeightRegular:x=400,fontWeightMedium:a=500,fontWeightBold:E=700,htmlFontSize:I=16,allVariants:L,pxToRem:O}=r,F=Dt(r,pV),K=h/14,W=O||(Z=>`${Z/I*K}rem`),G=(Z,H,V,oe,pe)=>ce({fontFamily:l,fontWeight:Z,fontSize:W(H),lineHeight:V},l===sA?{letterSpacing:`${fV(oe/H)}em`}:{},pe,L),ne={h1:G(m,96,1.167,-1.5),h2:G(m,60,1.2,-.5),h3:G(x,48,1.167,0),h4:G(x,34,1.235,.25),h5:G(x,24,1.334,0),h6:G(a,20,1.6,.15),subtitle1:G(x,16,1.75,.15),subtitle2:G(a,14,1.57,.1),body1:G(x,16,1.5,.15),body2:G(x,14,1.43,.15),button:G(a,14,1.75,.4,oA),caption:G(x,12,1.66,.4),overline:G(x,12,2.66,1,oA),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return jo(ce({htmlFontSize:I,pxToRem:W,fontFamily:l,fontSize:h,fontWeightLight:m,fontWeightRegular:x,fontWeightMedium:a,fontWeightBold:E},ne),F,{clone:!1})}const gV=.2,yV=.14,_V=.12;function kr(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${gV})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${yV})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${_V})`].join(",")}const xV=["none",kr(0,2,1,-1,0,1,1,0,0,1,3,0),kr(0,3,1,-2,0,2,2,0,0,1,5,0),kr(0,3,3,-2,0,3,4,0,0,1,8,0),kr(0,2,4,-1,0,4,5,0,0,1,10,0),kr(0,3,5,-1,0,5,8,0,0,1,14,0),kr(0,3,5,-1,0,6,10,0,0,1,18,0),kr(0,4,5,-2,0,7,10,1,0,2,16,1),kr(0,5,5,-3,0,8,10,1,0,3,14,2),kr(0,5,6,-3,0,9,12,1,0,3,16,2),kr(0,6,6,-3,0,10,14,1,0,4,18,3),kr(0,6,7,-4,0,11,15,1,0,4,20,3),kr(0,7,8,-4,0,12,17,2,0,5,22,4),kr(0,7,8,-4,0,13,19,2,0,5,24,4),kr(0,7,9,-4,0,14,21,2,0,5,26,4),kr(0,8,9,-5,0,15,22,2,0,6,28,5),kr(0,8,10,-5,0,16,24,2,0,6,30,5),kr(0,8,11,-5,0,17,26,2,0,6,32,5),kr(0,9,11,-5,0,18,28,2,0,7,34,6),kr(0,9,12,-6,0,19,29,2,0,7,36,6),kr(0,10,13,-6,0,20,31,3,0,8,38,7),kr(0,10,13,-6,0,21,33,3,0,8,40,7),kr(0,10,14,-6,0,22,35,3,0,8,42,7),kr(0,11,14,-7,0,23,36,3,0,9,44,8),kr(0,11,15,-7,0,24,38,3,0,9,46,8)],vV=xV,bV=["duration","easing","delay"],wV={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},SV={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function aA(e){return`${Math.round(e)}ms`}function EV(e){if(!e)return 0;const t=e/36;return Math.round((4+15*t**.25+t/5)*10)}function TV(e){const t=ce({},wV,e.easing),r=ce({},SV,e.duration);return ce({getAutoHeightDuration:EV,create:(h=["all"],m={})=>{const{duration:x=r.standard,easing:a=t.easeInOut,delay:E=0}=m;return Dt(m,bV),(Array.isArray(h)?h:[h]).map(I=>`${I} ${typeof x=="string"?x:aA(x)} ${a} ${typeof E=="string"?E:aA(E)}`).join(",")}},e,{easing:t,duration:r})}const CV={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},kV=CV,IV=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function US(e={},...t){const{mixins:r={},palette:l={},transitions:h={},typography:m={}}=e,x=Dt(e,IV);if(e.vars&&e.generateCssVars===void 0)throw new Error(Su(18));const a=hV(l),E=eg(e);let I=jo(E,{mixins:O8(E.breakpoints,r),palette:a,shadows:vV.slice(),typography:mV(a,m),transitions:TV(h),zIndex:ce({},kV)});return I=jo(I,x),I=t.reduce((L,O)=>jo(L,O),I),I.unstable_sxConfig=ce({},Jm,x==null?void 0:x.unstable_sxConfig),I.unstable_sx=function(O){return Qm({sx:O,theme:this})},I}const AV=US(),VS=AV;function Vx(){const e=Ax(VS);return e[xh]||e}var ng={},Tb={exports:{}},lA;function MV(){return lA||(lA=1,function(e){function t(r,l){if(r==null)return{};var h={};for(var m in r)if({}.hasOwnProperty.call(r,m)){if(l.indexOf(m)!==-1)continue;h[m]=r[m]}return h}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(Tb)),Tb.exports}const PV=cc(A6),RV=cc(M6),zV=cc(B6),LV=cc(NU),DV=cc(TU),OV=cc(MU);var Fh=oL;Object.defineProperty(ng,"__esModule",{value:!0});var BV=ng.default=KV;ng.shouldForwardProp=T_;ng.systemDefaultTheme=void 0;var rs=Fh(Iz()),Yw=Fh(MV()),m0=WV(PV),FV=RV;Fh(zV);Fh(LV);var jV=Fh(DV),NV=Fh(OV);const $V=["ownerState"],UV=["variants"],VV=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function hL(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(hL=function(l){return l?r:t})(e)}function WV(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=hL(t);if(r&&r.has(e))return r.get(e);var l={__proto__:null},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in e)if(m!=="default"&&Object.prototype.hasOwnProperty.call(e,m)){var x=h?Object.getOwnPropertyDescriptor(e,m):null;x&&(x.get||x.set)?Object.defineProperty(l,m,x):l[m]=e[m]}return l.default=e,r&&r.set(e,l),l}function GV(e){return Object.keys(e).length===0}function qV(e){return typeof e=="string"&&e.charCodeAt(0)>96}function T_(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function cA(e,t){return t&&e&&typeof e=="object"&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles=`@layer ${t}{${String(e.styles)}}`),e}const HV=ng.systemDefaultTheme=(0,jV.default)(),ZV=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function Zy({defaultTheme:e,theme:t,themeId:r}){return GV(t)?e:t[r]||t}function XV(e){return e?(t,r)=>r[e]:null}function C_(e,t,r){let{ownerState:l}=t,h=(0,Yw.default)(t,$V);const m=typeof e=="function"?e((0,rs.default)({ownerState:l},h)):e;if(Array.isArray(m))return m.flatMap(x=>C_(x,(0,rs.default)({ownerState:l},h),r));if(m&&typeof m=="object"&&Array.isArray(m.variants)){const{variants:x=[]}=m;let E=(0,Yw.default)(m,UV);return x.forEach(I=>{let L=!0;if(typeof I.props=="function"?L=I.props((0,rs.default)({ownerState:l},h,l)):Object.keys(I.props).forEach(O=>{(l==null?void 0:l[O])!==I.props[O]&&h[O]!==I.props[O]&&(L=!1)}),L){Array.isArray(E)||(E=[E]);const O=typeof I.style=="function"?I.style((0,rs.default)({ownerState:l},h,l)):I.style;E.push(r?cA((0,m0.internal_serializeStyles)(O),r):O)}}),E}return r?cA((0,m0.internal_serializeStyles)(m),r):m}function KV(e={}){const{themeId:t,defaultTheme:r=HV,rootShouldForwardProp:l=T_,slotShouldForwardProp:h=T_}=e,m=x=>(0,NV.default)((0,rs.default)({},x,{theme:Zy((0,rs.default)({},x,{defaultTheme:r,themeId:t}))}));return m.__mui_systemSx=!0,(x,a={})=>{(0,m0.internal_processStyles)(x,_e=>_e.filter(xe=>!(xe!=null&&xe.__mui_systemSx)));const{name:E,slot:I,skipVariantsResolver:L,skipSx:O,overridesResolver:F=XV(ZV(I))}=a,K=(0,Yw.default)(a,VV),W=E&&E.startsWith("Mui")||I?"components":"custom",G=L!==void 0?L:I&&I!=="Root"&&I!=="root"||!1,ne=O||!1;let Z,H=T_;I==="Root"||I==="root"?H=l:I?H=h:qV(x)&&(H=void 0);const V=(0,m0.default)(x,(0,rs.default)({shouldForwardProp:H,label:Z},K)),oe=_e=>typeof _e=="function"&&_e.__emotion_real!==_e||(0,FV.isPlainObject)(_e)?xe=>{const De=Zy({theme:xe.theme,defaultTheme:r,themeId:t});return C_(_e,(0,rs.default)({},xe,{theme:De}),De.modularCssLayers?W:void 0)}:_e,pe=(_e,...xe)=>{let De=oe(_e);const ye=xe?xe.map(oe):[];E&&F&&ye.push(Ge=>{const et=Zy((0,rs.default)({},Ge,{defaultTheme:r,themeId:t}));if(!et.components||!et.components[E]||!et.components[E].styleOverrides)return null;const lt=et.components[E].styleOverrides,gt={};return Object.entries(lt).forEach(([St,It])=>{gt[St]=C_(It,(0,rs.default)({},Ge,{theme:et}),et.modularCssLayers?"theme":void 0)}),F(Ge,gt)}),E&&!G&&ye.push(Ge=>{var et;const lt=Zy((0,rs.default)({},Ge,{defaultTheme:r,themeId:t})),gt=lt==null||(et=lt.components)==null||(et=et[E])==null?void 0:et.variants;return C_({variants:gt},(0,rs.default)({},Ge,{theme:lt}),lt.modularCssLayers?"theme":void 0)}),ne||ye.push(m);const Ae=ye.length-xe.length;if(Array.isArray(_e)&&Ae>0){const Ge=new Array(Ae).fill("");De=[..._e,...Ge],De.raw=[..._e.raw,...Ge]}const ft=V(De,...ye);return x.muiName&&(ft.muiName=x.muiName),ft};return V.withConfig&&(pe.withConfig=V.withConfig),pe}}function pL(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const YV=e=>pL(e)&&e!=="classes",xs=YV,JV=BV({themeId:xh,defaultTheme:VS,rootShouldForwardProp:xs}),Bt=JV,QV=["theme"];function e9(e){let{theme:t}=e,r=Dt(e,QV);const l=t[xh];let h=l||t;return typeof t!="function"&&(l&&!l.vars?h=ce({},l,{vars:null}):t&&!t.vars&&(h=ce({},t,{vars:null}))),D.jsx(A8,ce({},r,{themeId:l?xh:void 0,theme:h}))}const t9=e=>{let t;return e<1?t=5.11916*e**2:t=4.5*Math.log(e+1)+2,(t/100).toFixed(2)},uA=t9;function _n(e){return k8(e)}function fL(e){return D.jsx(Fz,ce({},e,{defaultTheme:VS,themeId:xh}))}const n9=(e,t)=>ce({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},t&&!e.vars&&{colorScheme:e.palette.mode}),r9=e=>ce({color:(e.vars||e).palette.text.primary},e.typography.body1,{backgroundColor:(e.vars||e).palette.background.default,"@media print":{backgroundColor:(e.vars||e).palette.common.white}}),i9=(e,t=!1)=>{var r;const l={};t&&e.colorSchemes&&Object.entries(e.colorSchemes).forEach(([x,a])=>{var E;l[e.getColorSchemeSelector(x).replace(/\s*&/,"")]={colorScheme:(E=a.palette)==null?void 0:E.mode}});let h=ce({html:n9(e,t),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:e.typography.fontWeightBold},body:ce({margin:0},r9(e),{"&::backdrop":{backgroundColor:(e.vars||e).palette.background.default}})},l);const m=(r=e.components)==null||(r=r.MuiCssBaseline)==null?void 0:r.styleOverrides;return m&&(h=[h,m]),h};function o9(e){const t=_n({props:e,name:"MuiCssBaseline"}),{children:r,enableColorScheme:l=!1}=t;return D.jsxs(J.Fragment,{children:[D.jsx(fL,{styles:h=>i9(h,l)}),r]})}function s9(e){return yn("MuiSvgIcon",e)}mn("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const a9=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],l9=e=>{const{color:t,fontSize:r,classes:l}=e,h={root:["root",t!=="inherit"&&`color${Ct(t)}`,`fontSize${Ct(r)}`]};return bn(h,s9,l)},c9=Bt("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.color!=="inherit"&&t[`color${Ct(r.color)}`],t[`fontSize${Ct(r.fontSize)}`]]}})(({theme:e,ownerState:t})=>{var r,l,h,m,x,a,E,I,L,O,F,K,W;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:t.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(r=e.transitions)==null||(l=r.create)==null?void 0:l.call(r,"fill",{duration:(h=e.transitions)==null||(h=h.duration)==null?void 0:h.shorter}),fontSize:{inherit:"inherit",small:((m=e.typography)==null||(x=m.pxToRem)==null?void 0:x.call(m,20))||"1.25rem",medium:((a=e.typography)==null||(E=a.pxToRem)==null?void 0:E.call(a,24))||"1.5rem",large:((I=e.typography)==null||(L=I.pxToRem)==null?void 0:L.call(I,35))||"2.1875rem"}[t.fontSize],color:(O=(F=(e.vars||e).palette)==null||(F=F[t.color])==null?void 0:F.main)!=null?O:{action:(K=(e.vars||e).palette)==null||(K=K.action)==null?void 0:K.active,disabled:(W=(e.vars||e).palette)==null||(W=W.action)==null?void 0:W.disabled,inherit:void 0}[t.color]}}),mL=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiSvgIcon"}),{children:h,className:m,color:x="inherit",component:a="svg",fontSize:E="medium",htmlColor:I,inheritViewBox:L=!1,titleAccess:O,viewBox:F="0 0 24 24"}=l,K=Dt(l,a9),W=J.isValidElement(h)&&h.type==="svg",G=ce({},l,{color:x,component:a,fontSize:E,instanceFontSize:t.fontSize,inheritViewBox:L,viewBox:F,hasSvgAsChild:W}),ne={};L||(ne.viewBox=F);const Z=l9(G);return D.jsxs(c9,ce({as:a,className:Wt(Z.root,m),focusable:"false",color:I,"aria-hidden":O?void 0:!0,role:O?"img":void 0,ref:r},ne,K,W&&h.props,{ownerState:G,children:[W?h.props.children:h,O?D.jsx("title",{children:O}):null]}))});mL.muiName="SvgIcon";const dA=mL;function wr(e,t){function r(l,h){return D.jsx(dA,ce({"data-testid":`${t}Icon`,ref:h},l,{children:e}))}return r.muiName=dA.muiName,J.memo(J.forwardRef(r))}function Jw(e,t){return Jw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,l){return r.__proto__=l,r},Jw(e,t)}function gL(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Jw(e,t)}const hA={disabled:!1},g0=Do.createContext(null);var u9=function(t){return t.scrollTop},Vf="unmounted",ou="exited",su="entering",Od="entered",Qw="exiting",nl=function(e){gL(t,e);function t(l,h){var m;m=e.call(this,l,h)||this;var x=h,a=x&&!x.isMounting?l.enter:l.appear,E;return m.appearStatus=null,l.in?a?(E=ou,m.appearStatus=su):E=Od:l.unmountOnExit||l.mountOnEnter?E=Vf:E=ou,m.state={status:E},m.nextCallback=null,m}t.getDerivedStateFromProps=function(h,m){var x=h.in;return x&&m.status===Vf?{status:ou}:null};var r=t.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(h){var m=null;if(h!==this.props){var x=this.state.status;this.props.in?x!==su&&x!==Od&&(m=su):(x===su||x===Od)&&(m=Qw)}this.updateStatus(!1,m)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var h=this.props.timeout,m,x,a;return m=x=a=h,h!=null&&typeof h!="number"&&(m=h.exit,x=h.enter,a=h.appear!==void 0?h.appear:x),{exit:m,enter:x,appear:a}},r.updateStatus=function(h,m){if(h===void 0&&(h=!1),m!==null)if(this.cancelNextCallback(),m===su){if(this.props.unmountOnExit||this.props.mountOnEnter){var x=this.props.nodeRef?this.props.nodeRef.current:Gy.findDOMNode(this);x&&u9(x)}this.performEnter(h)}else this.performExit();else this.props.unmountOnExit&&this.state.status===ou&&this.setState({status:Vf})},r.performEnter=function(h){var m=this,x=this.props.enter,a=this.context?this.context.isMounting:h,E=this.props.nodeRef?[a]:[Gy.findDOMNode(this),a],I=E[0],L=E[1],O=this.getTimeouts(),F=a?O.appear:O.enter;if(!h&&!x||hA.disabled){this.safeSetState({status:Od},function(){m.props.onEntered(I)});return}this.props.onEnter(I,L),this.safeSetState({status:su},function(){m.props.onEntering(I,L),m.onTransitionEnd(F,function(){m.safeSetState({status:Od},function(){m.props.onEntered(I,L)})})})},r.performExit=function(){var h=this,m=this.props.exit,x=this.getTimeouts(),a=this.props.nodeRef?void 0:Gy.findDOMNode(this);if(!m||hA.disabled){this.safeSetState({status:ou},function(){h.props.onExited(a)});return}this.props.onExit(a),this.safeSetState({status:Qw},function(){h.props.onExiting(a),h.onTransitionEnd(x.exit,function(){h.safeSetState({status:ou},function(){h.props.onExited(a)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(h,m){m=this.setNextCallback(m),this.setState(h,m)},r.setNextCallback=function(h){var m=this,x=!0;return this.nextCallback=function(a){x&&(x=!1,m.nextCallback=null,h(a))},this.nextCallback.cancel=function(){x=!1},this.nextCallback},r.onTransitionEnd=function(h,m){this.setNextCallback(m);var x=this.props.nodeRef?this.props.nodeRef.current:Gy.findDOMNode(this),a=h==null&&!this.props.addEndListener;if(!x||a){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var E=this.props.nodeRef?[this.nextCallback]:[x,this.nextCallback],I=E[0],L=E[1];this.props.addEndListener(I,L)}h!=null&&setTimeout(this.nextCallback,h)},r.render=function(){var h=this.state.status;if(h===Vf)return null;var m=this.props,x=m.children;m.in,m.mountOnEnter,m.unmountOnExit,m.appear,m.enter,m.exit,m.timeout,m.addEndListener,m.onEnter,m.onEntering,m.onEntered,m.onExit,m.onExiting,m.onExited,m.nodeRef;var a=Dt(m,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Do.createElement(g0.Provider,{value:null},typeof x=="function"?x(h,a):Do.cloneElement(Do.Children.only(x),a))},t}(Do.Component);nl.contextType=g0;nl.propTypes={};function Dd(){}nl.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Dd,onEntering:Dd,onEntered:Dd,onExit:Dd,onExiting:Dd,onExited:Dd};nl.UNMOUNTED=Vf;nl.EXITED=ou;nl.ENTERING=su;nl.ENTERED=Od;nl.EXITING=Qw;const yL=nl;function d9(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WS(e,t){var r=function(m){return t&&J.isValidElement(m)?t(m):m},l=Object.create(null);return e&&J.Children.map(e,function(h){return h}).forEach(function(h){l[h.key]=r(h)}),l}function h9(e,t){e=e||{},t=t||{};function r(L){return L in t?t[L]:e[L]}var l=Object.create(null),h=[];for(var m in e)m in t?h.length&&(l[m]=h,h=[]):h.push(m);var x,a={};for(var E in t){if(l[E])for(x=0;x<l[E].length;x++){var I=l[E][x];a[l[E][x]]=r(I)}a[E]=r(E)}for(x=0;x<h.length;x++)a[h[x]]=r(h[x]);return a}function hu(e,t,r){return r[t]!=null?r[t]:e.props[t]}function p9(e,t){return WS(e.children,function(r){return J.cloneElement(r,{onExited:t.bind(null,r),in:!0,appear:hu(r,"appear",e),enter:hu(r,"enter",e),exit:hu(r,"exit",e)})})}function f9(e,t,r){var l=WS(e.children),h=h9(t,l);return Object.keys(h).forEach(function(m){var x=h[m];if(J.isValidElement(x)){var a=m in t,E=m in l,I=t[m],L=J.isValidElement(I)&&!I.props.in;E&&(!a||L)?h[m]=J.cloneElement(x,{onExited:r.bind(null,x),in:!0,exit:hu(x,"exit",e),enter:hu(x,"enter",e)}):!E&&a&&!L?h[m]=J.cloneElement(x,{in:!1}):E&&a&&J.isValidElement(I)&&(h[m]=J.cloneElement(x,{onExited:r.bind(null,x),in:I.props.in,exit:hu(x,"exit",e),enter:hu(x,"enter",e)}))}}),h}var m9=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},g9={component:"div",childFactory:function(t){return t}},GS=function(e){gL(t,e);function t(l,h){var m;m=e.call(this,l,h)||this;var x=m.handleExited.bind(d9(m));return m.state={contextValue:{isMounting:!0},handleExited:x,firstRender:!0},m}var r=t.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(h,m){var x=m.children,a=m.handleExited,E=m.firstRender;return{children:E?p9(h,a):f9(h,x,a),firstRender:!1}},r.handleExited=function(h,m){var x=WS(this.props.children);h.key in x||(h.props.onExited&&h.props.onExited(m),this.mounted&&this.setState(function(a){var E=ce({},a.children);return delete E[h.key],{children:E}}))},r.render=function(){var h=this.props,m=h.component,x=h.childFactory,a=Dt(h,["component","childFactory"]),E=this.state.contextValue,I=m9(this.state.children).map(x);return delete a.appear,delete a.enter,delete a.exit,m===null?Do.createElement(g0.Provider,{value:E},I):Do.createElement(g0.Provider,{value:E},Do.createElement(m,a,I))},t}(Do.Component);GS.propTypes={};GS.defaultProps=g9;const y9=GS,_L=e=>e.scrollTop;function y0(e,t){var r,l;const{timeout:h,easing:m,style:x={}}=e;return{duration:(r=x.transitionDuration)!=null?r:typeof h=="number"?h:h[t.mode]||0,easing:(l=x.transitionTimingFunction)!=null?l:typeof m=="object"?m[t.mode]:m,delay:x.transitionDelay}}function _9(e){return yn("MuiPaper",e)}mn("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const x9=["className","component","elevation","square","variant"],v9=e=>{const{square:t,elevation:r,variant:l,classes:h}=e,m={root:["root",l,!t&&"rounded",l==="elevation"&&`elevation${r}`]};return bn(m,_9,h)},b9=Bt("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],!r.square&&t.rounded,r.variant==="elevation"&&t[`elevation${r.elevation}`]]}})(({theme:e,ownerState:t})=>{var r;return ce({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow")},!t.square&&{borderRadius:e.shape.borderRadius},t.variant==="outlined"&&{border:`1px solid ${(e.vars||e).palette.divider}`},t.variant==="elevation"&&ce({boxShadow:(e.vars||e).shadows[t.elevation]},!e.vars&&e.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${sr("#fff",uA(t.elevation))}, ${sr("#fff",uA(t.elevation))})`},e.vars&&{backgroundImage:(r=e.vars.overlays)==null?void 0:r[t.elevation]}))}),w9=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiPaper"}),{className:h,component:m="div",elevation:x=1,square:a=!1,variant:E="elevation"}=l,I=Dt(l,x9),L=ce({},l,{component:m,elevation:x,square:a,variant:E}),O=v9(L);return D.jsx(b9,ce({as:m,ownerState:L,className:Wt(O.root,h),ref:r},I))}),lc=w9,S9=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],E9=["component","slots","slotProps"],T9=["component"];function pA(e,t){const{className:r,elementType:l,ownerState:h,externalForwardedProps:m,getSlotOwnerState:x,internalForwardedProps:a}=t,E=Dt(t,S9),{component:I,slots:L={[e]:void 0},slotProps:O={[e]:void 0}}=m,F=Dt(m,E9),K=L[e]||l,W=Qz(O[e],h),G=Jz(ce({className:r},E,{externalForwardedProps:e==="root"?F:void 0,externalSlotProps:W})),{props:{component:ne},internalRef:Z}=G,H=Dt(G.props,T9),V=_i(Z,W==null?void 0:W.ref,t.ref),oe=x?x(H):{},pe=ce({},h,oe),_e=e==="root"?ne||I:ne,xe=Kz(K,ce({},e==="root"&&!I&&!L[e]&&a,e!=="root"&&!L[e]&&a,H,_e&&{as:_e},{ref:V}),pe);return Object.keys(oe).forEach(De=>{delete xe[De]}),[K,xe]}function C9(e){const{className:t,classes:r,pulsate:l=!1,rippleX:h,rippleY:m,rippleSize:x,in:a,onExited:E,timeout:I}=e,[L,O]=J.useState(!1),F=Wt(t,r.ripple,r.rippleVisible,l&&r.ripplePulsate),K={width:x,height:x,top:-(x/2)+m,left:-(x/2)+h},W=Wt(r.child,L&&r.childLeaving,l&&r.childPulsate);return!a&&!L&&O(!0),J.useEffect(()=>{if(!a&&E!=null){const G=setTimeout(E,I);return()=>{clearTimeout(G)}}},[E,a,I]),D.jsx("span",{className:F,style:K,children:D.jsx("span",{className:W})})}const k9=mn("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),is=k9,I9=["center","classes","className"];let Wx=e=>e,fA,mA,gA,yA;const e2=550,A9=80,M9=Oh(fA||(fA=Wx`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),P9=Oh(mA||(mA=Wx`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),R9=Oh(gA||(gA=Wx`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),z9=Bt("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),L9=Bt(C9,{name:"MuiTouchRipple",slot:"Ripple"})(yA||(yA=Wx`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),is.rippleVisible,M9,e2,({theme:e})=>e.transitions.easing.easeInOut,is.ripplePulsate,({theme:e})=>e.transitions.duration.shorter,is.child,is.childLeaving,P9,e2,({theme:e})=>e.transitions.easing.easeInOut,is.childPulsate,R9,({theme:e})=>e.transitions.easing.easeInOut),D9=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiTouchRipple"}),{center:h=!1,classes:m={},className:x}=l,a=Dt(l,I9),[E,I]=J.useState([]),L=J.useRef(0),O=J.useRef(null);J.useEffect(()=>{O.current&&(O.current(),O.current=null)},[E]);const F=J.useRef(!1),K=Hz(),W=J.useRef(null),G=J.useRef(null),ne=J.useCallback(oe=>{const{pulsate:pe,rippleX:_e,rippleY:xe,rippleSize:De,cb:ye}=oe;I(Ae=>[...Ae,D.jsx(L9,{classes:{ripple:Wt(m.ripple,is.ripple),rippleVisible:Wt(m.rippleVisible,is.rippleVisible),ripplePulsate:Wt(m.ripplePulsate,is.ripplePulsate),child:Wt(m.child,is.child),childLeaving:Wt(m.childLeaving,is.childLeaving),childPulsate:Wt(m.childPulsate,is.childPulsate)},timeout:e2,pulsate:pe,rippleX:_e,rippleY:xe,rippleSize:De},L.current)]),L.current+=1,O.current=ye},[m]),Z=J.useCallback((oe={},pe={},_e=()=>{})=>{const{pulsate:xe=!1,center:De=h||pe.pulsate,fakeElement:ye=!1}=pe;if((oe==null?void 0:oe.type)==="mousedown"&&F.current){F.current=!1;return}(oe==null?void 0:oe.type)==="touchstart"&&(F.current=!0);const Ae=ye?null:G.current,ft=Ae?Ae.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Ge,et,lt;if(De||oe===void 0||oe.clientX===0&&oe.clientY===0||!oe.clientX&&!oe.touches)Ge=Math.round(ft.width/2),et=Math.round(ft.height/2);else{const{clientX:gt,clientY:St}=oe.touches&&oe.touches.length>0?oe.touches[0]:oe;Ge=Math.round(gt-ft.left),et=Math.round(St-ft.top)}if(De)lt=Math.sqrt((2*ft.width**2+ft.height**2)/3),lt%2===0&&(lt+=1);else{const gt=Math.max(Math.abs((Ae?Ae.clientWidth:0)-Ge),Ge)*2+2,St=Math.max(Math.abs((Ae?Ae.clientHeight:0)-et),et)*2+2;lt=Math.sqrt(gt**2+St**2)}oe!=null&&oe.touches?W.current===null&&(W.current=()=>{ne({pulsate:xe,rippleX:Ge,rippleY:et,rippleSize:lt,cb:_e})},K.start(A9,()=>{W.current&&(W.current(),W.current=null)})):ne({pulsate:xe,rippleX:Ge,rippleY:et,rippleSize:lt,cb:_e})},[h,ne,K]),H=J.useCallback(()=>{Z({},{pulsate:!0})},[Z]),V=J.useCallback((oe,pe)=>{if(K.clear(),(oe==null?void 0:oe.type)==="touchend"&&W.current){W.current(),W.current=null,K.start(0,()=>{V(oe,pe)});return}W.current=null,I(_e=>_e.length>0?_e.slice(1):_e),O.current=pe},[K]);return J.useImperativeHandle(r,()=>({pulsate:H,start:Z,stop:V}),[H,Z,V]),D.jsx(z9,ce({className:Wt(is.root,m.root,x),ref:G},a,{children:D.jsx(y9,{component:null,exit:!0,children:E})}))}),O9=D9;function B9(e){return yn("MuiButtonBase",e)}const F9=mn("MuiButtonBase",["root","disabled","focusVisible"]),j9=F9,N9=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],$9=e=>{const{disabled:t,focusVisible:r,focusVisibleClassName:l,classes:h}=e,x=bn({root:["root",t&&"disabled",r&&"focusVisible"]},B9,h);return r&&l&&(x.root+=` ${l}`),x},U9=Bt("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${j9.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),V9=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiButtonBase"}),{action:h,centerRipple:m=!1,children:x,className:a,component:E="button",disabled:I=!1,disableRipple:L=!1,disableTouchRipple:O=!1,focusRipple:F=!1,LinkComponent:K="a",onBlur:W,onClick:G,onContextMenu:ne,onDragLeave:Z,onFocus:H,onFocusVisible:V,onKeyDown:oe,onKeyUp:pe,onMouseDown:_e,onMouseLeave:xe,onMouseUp:De,onTouchEnd:ye,onTouchMove:Ae,onTouchStart:ft,tabIndex:Ge=0,TouchRippleProps:et,touchRippleRef:lt,type:gt}=l,St=Dt(l,N9),It=J.useRef(null),Re=J.useRef(null),ct=_i(Re,lt),{isFocusVisibleRef:Ie,onFocus:st,onBlur:Tt,ref:zt}=Zz(),[Nt,en]=J.useState(!1);I&&Nt&&en(!1),J.useImperativeHandle(h,()=>({focusVisible:()=>{en(!0),It.current.focus()}}),[]);const[Zt,Mn]=J.useState(!1);J.useEffect(()=>{Mn(!0)},[]);const Wr=Zt&&!L&&!I;J.useEffect(()=>{Nt&&F&&!L&&Zt&&Re.current.pulsate()},[L,F,Nt,Zt]);function qn(qt,hi,ao=O){return du(To=>(hi&&hi(To),!ao&&Re.current&&Re.current[qt](To),!0))}const Mr=qn("start",_e),Rt=qn("stop",ne),Dn=qn("stop",Z),Xt=qn("stop",De),Cn=qn("stop",qt=>{Nt&&qt.preventDefault(),xe&&xe(qt)}),Kt=qn("start",ft),Pr=qn("stop",ye),di=qn("stop",Ae),Sr=qn("stop",qt=>{Tt(qt),Ie.current===!1&&en(!1),W&&W(qt)},!1),lr=du(qt=>{It.current||(It.current=qt.currentTarget),st(qt),Ie.current===!0&&(en(!0),V&&V(qt)),H&&H(qt)}),Qr=()=>{const qt=It.current;return E&&E!=="button"&&!(qt.tagName==="A"&&qt.href)},On=J.useRef(!1),ki=du(qt=>{F&&!On.current&&Nt&&Re.current&&qt.key===" "&&(On.current=!0,Re.current.stop(qt,()=>{Re.current.start(qt)})),qt.target===qt.currentTarget&&Qr()&&qt.key===" "&&qt.preventDefault(),oe&&oe(qt),qt.target===qt.currentTarget&&Qr()&&qt.key==="Enter"&&!I&&(qt.preventDefault(),G&&G(qt))}),gr=du(qt=>{F&&qt.key===" "&&Re.current&&Nt&&!qt.defaultPrevented&&(On.current=!1,Re.current.stop(qt,()=>{Re.current.pulsate(qt)})),pe&&pe(qt),G&&qt.target===qt.currentTarget&&Qr()&&qt.key===" "&&!qt.defaultPrevented&&G(qt)});let zn=E;zn==="button"&&(St.href||St.to)&&(zn=K);const Ii={};zn==="button"?(Ii.type=gt===void 0?"button":gt,Ii.disabled=I):(!St.href&&!St.to&&(Ii.role="button"),I&&(Ii["aria-disabled"]=I));const Ji=_i(r,zt,It),Er=ce({},l,{centerRipple:m,component:E,disabled:I,disableRipple:L,disableTouchRipple:O,focusRipple:F,tabIndex:Ge,focusVisible:Nt}),wn=$9(Er);return D.jsxs(U9,ce({as:zn,className:Wt(wn.root,a),ownerState:Er,onBlur:Sr,onClick:G,onContextMenu:Rt,onFocus:lr,onKeyDown:ki,onKeyUp:gr,onMouseDown:Mr,onMouseLeave:Cn,onMouseUp:Xt,onDragLeave:Dn,onTouchEnd:Pr,onTouchMove:di,onTouchStart:Kt,ref:Ji,tabIndex:I?-1:Ge,type:gt},Ii,St,{children:[x,Wr?D.jsx(O9,ce({ref:ct,center:m},et)):null]}))}),Eh=V9;function W9(e){return yn("MuiAlert",e)}const G9=mn("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),_A=G9;function q9(e){return yn("MuiIconButton",e)}const H9=mn("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),Z9=H9,X9=["edge","children","className","color","disabled","disableFocusRipple","size"],K9=e=>{const{classes:t,disabled:r,color:l,edge:h,size:m}=e,x={root:["root",r&&"disabled",l!=="default"&&`color${Ct(l)}`,h&&`edge${Ct(h)}`,`size${Ct(m)}`]};return bn(x,q9,t)},Y9=Bt(Eh,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.color!=="default"&&t[`color${Ct(r.color)}`],r.edge&&t[`edge${Ct(r.edge)}`],t[`size${Ct(r.size)}`]]}})(({theme:e,ownerState:t})=>ce({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest})},!t.disableRipple&&{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:sr(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},t.edge==="start"&&{marginLeft:t.size==="small"?-3:-12},t.edge==="end"&&{marginRight:t.size==="small"?-3:-12}),({theme:e,ownerState:t})=>{var r;const l=(r=(e.vars||e).palette)==null?void 0:r[t.color];return ce({},t.color==="inherit"&&{color:"inherit"},t.color!=="inherit"&&t.color!=="default"&&ce({color:l==null?void 0:l.main},!t.disableRipple&&{"&:hover":ce({},l&&{backgroundColor:e.vars?`rgba(${l.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:sr(l.main,e.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),t.size==="small"&&{padding:5,fontSize:e.typography.pxToRem(18)},t.size==="large"&&{padding:12,fontSize:e.typography.pxToRem(28)},{[`&.${Z9.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled}})}),J9=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiIconButton"}),{edge:h=!1,children:m,className:x,color:a="default",disabled:E=!1,disableFocusRipple:I=!1,size:L="medium"}=l,O=Dt(l,X9),F=ce({},l,{edge:h,color:a,disabled:E,disableFocusRipple:I,size:L}),K=K9(F);return D.jsx(Y9,ce({className:Wt(K.root,x),centerRipple:!0,focusRipple:!I,disabled:E,ref:r},O,{ownerState:F,children:m}))}),Th=J9,Q9=wr(D.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),e7=wr(D.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),t7=wr(D.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),n7=wr(D.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),r7=wr(D.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),i7=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],o7=e=>{const{variant:t,color:r,severity:l,classes:h}=e,m={root:["root",`color${Ct(r||l)}`,`${t}${Ct(r||l)}`,`${t}`],icon:["icon"],message:["message"],action:["action"]};return bn(m,W9,h)},s7=Bt(lc,{name:"MuiAlert",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],t[`${r.variant}${Ct(r.color||r.severity)}`]]}})(({theme:e})=>{const t=e.palette.mode==="light"?Xw:Kw,r=e.palette.mode==="light"?Kw:Xw;return ce({},e.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(e.palette).filter(([,l])=>l.main&&l.light).map(([l])=>({props:{colorSeverity:l,variant:"standard"},style:{color:e.vars?e.vars.palette.Alert[`${l}Color`]:t(e.palette[l].light,.6),backgroundColor:e.vars?e.vars.palette.Alert[`${l}StandardBg`]:r(e.palette[l].light,.9),[`& .${_A.icon}`]:e.vars?{color:e.vars.palette.Alert[`${l}IconColor`]}:{color:e.palette[l].main}}})),...Object.entries(e.palette).filter(([,l])=>l.main&&l.light).map(([l])=>({props:{colorSeverity:l,variant:"outlined"},style:{color:e.vars?e.vars.palette.Alert[`${l}Color`]:t(e.palette[l].light,.6),border:`1px solid ${(e.vars||e).palette[l].light}`,[`& .${_A.icon}`]:e.vars?{color:e.vars.palette.Alert[`${l}IconColor`]}:{color:e.palette[l].main}}})),...Object.entries(e.palette).filter(([,l])=>l.main&&l.dark).map(([l])=>({props:{colorSeverity:l,variant:"filled"},style:ce({fontWeight:e.typography.fontWeightMedium},e.vars?{color:e.vars.palette.Alert[`${l}FilledColor`],backgroundColor:e.vars.palette.Alert[`${l}FilledBg`]}:{backgroundColor:e.palette.mode==="dark"?e.palette[l].dark:e.palette[l].main,color:e.palette.getContrastText(e.palette[l].main)})}))]})}),a7=Bt("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(e,t)=>t.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),l7=Bt("div",{name:"MuiAlert",slot:"Message",overridesResolver:(e,t)=>t.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),xA=Bt("div",{name:"MuiAlert",slot:"Action",overridesResolver:(e,t)=>t.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),vA={success:D.jsx(Q9,{fontSize:"inherit"}),warning:D.jsx(e7,{fontSize:"inherit"}),error:D.jsx(t7,{fontSize:"inherit"}),info:D.jsx(n7,{fontSize:"inherit"})},c7=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiAlert"}),{action:h,children:m,className:x,closeText:a="Close",color:E,components:I={},componentsProps:L={},icon:O,iconMapping:F=vA,onClose:K,role:W="alert",severity:G="success",slotProps:ne={},slots:Z={},variant:H="standard"}=l,V=Dt(l,i7),oe=ce({},l,{color:E,severity:G,variant:H,colorSeverity:E||G}),pe=o7(oe),_e={slots:ce({closeButton:I.CloseButton,closeIcon:I.CloseIcon},Z),slotProps:ce({},L,ne)},[xe,De]=pA("closeButton",{elementType:Th,externalForwardedProps:_e,ownerState:oe}),[ye,Ae]=pA("closeIcon",{elementType:r7,externalForwardedProps:_e,ownerState:oe});return D.jsxs(s7,ce({role:W,elevation:0,ownerState:oe,className:Wt(pe.root,x),ref:r},V,{children:[O!==!1?D.jsx(a7,{ownerState:oe,className:pe.icon,children:O||F[G]||vA[G]}):null,D.jsx(l7,{ownerState:oe,className:pe.message,children:m}),h!=null?D.jsx(xA,{ownerState:oe,className:pe.action,children:h}):null,h==null&&K?D.jsx(xA,{ownerState:oe,className:pe.action,children:D.jsx(xe,ce({size:"small","aria-label":a,title:a,color:"inherit",onClick:K},De,{children:D.jsx(ye,ce({fontSize:"small"},Ae))}))}):null]}))}),im=c7;function u7(e){return yn("MuiTypography",e)}mn("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const d7=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],h7=e=>{const{align:t,gutterBottom:r,noWrap:l,paragraph:h,variant:m,classes:x}=e,a={root:["root",m,e.align!=="inherit"&&`align${Ct(t)}`,r&&"gutterBottom",l&&"noWrap",h&&"paragraph"]};return bn(a,u7,x)},p7=Bt("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.variant&&t[r.variant],r.align!=="inherit"&&t[`align${Ct(r.align)}`],r.noWrap&&t.noWrap,r.gutterBottom&&t.gutterBottom,r.paragraph&&t.paragraph]}})(({theme:e,ownerState:t})=>ce({margin:0},t.variant==="inherit"&&{font:"inherit"},t.variant!=="inherit"&&e.typography[t.variant],t.align!=="inherit"&&{textAlign:t.align},t.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t.gutterBottom&&{marginBottom:"0.35em"},t.paragraph&&{marginBottom:16})),bA={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},f7={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},m7=e=>f7[e]||e,g7=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiTypography"}),h=m7(l.color),m=Mx(ce({},l,{color:h})),{align:x="inherit",className:a,component:E,gutterBottom:I=!1,noWrap:L=!1,paragraph:O=!1,variant:F="body1",variantMapping:K=bA}=m,W=Dt(m,d7),G=ce({},m,{align:x,color:h,className:a,component:E,gutterBottom:I,noWrap:L,paragraph:O,variant:F,variantMapping:K}),ne=E||(O?"p":K[F]||bA[F])||"span",Z=h7(G);return D.jsx(p7,ce({as:ne,ref:r,ownerState:G,className:Wt(Z.root,a)},W))}),yt=g7;function y7(e){return yn("MuiAppBar",e)}mn("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const _7=["className","color","enableColorOnDark","position"],x7=e=>{const{color:t,position:r,classes:l}=e,h={root:["root",`color${Ct(t)}`,`position${Ct(r)}`]};return bn(h,y7,l)},Xy=(e,t)=>e?`${e==null?void 0:e.replace(")","")}, ${t})`:t,v7=Bt(lc,{name:"MuiAppBar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[`position${Ct(r.position)}`],t[`color${Ct(r.color)}`]]}})(({theme:e,ownerState:t})=>{const r=e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[900];return ce({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},t.position==="fixed"&&{position:"fixed",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},t.position==="absolute"&&{position:"absolute",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0},t.position==="sticky"&&{position:"sticky",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0},t.position==="static"&&{position:"static"},t.position==="relative"&&{position:"relative"},!e.vars&&ce({},t.color==="default"&&{backgroundColor:r,color:e.palette.getContrastText(r)},t.color&&t.color!=="default"&&t.color!=="inherit"&&t.color!=="transparent"&&{backgroundColor:e.palette[t.color].main,color:e.palette[t.color].contrastText},t.color==="inherit"&&{color:"inherit"},e.palette.mode==="dark"&&!t.enableColorOnDark&&{backgroundColor:null,color:null},t.color==="transparent"&&ce({backgroundColor:"transparent",color:"inherit"},e.palette.mode==="dark"&&{backgroundImage:"none"})),e.vars&&ce({},t.color==="default"&&{"--AppBar-background":t.enableColorOnDark?e.vars.palette.AppBar.defaultBg:Xy(e.vars.palette.AppBar.darkBg,e.vars.palette.AppBar.defaultBg),"--AppBar-color":t.enableColorOnDark?e.vars.palette.text.primary:Xy(e.vars.palette.AppBar.darkColor,e.vars.palette.text.primary)},t.color&&!t.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":t.enableColorOnDark?e.vars.palette[t.color].main:Xy(e.vars.palette.AppBar.darkBg,e.vars.palette[t.color].main),"--AppBar-color":t.enableColorOnDark?e.vars.palette[t.color].contrastText:Xy(e.vars.palette.AppBar.darkColor,e.vars.palette[t.color].contrastText)},!["inherit","transparent"].includes(t.color)&&{backgroundColor:"var(--AppBar-background)"},{color:t.color==="inherit"?"inherit":"var(--AppBar-color)"},t.color==="transparent"&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))}),b7=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiAppBar"}),{className:h,color:m="primary",enableColorOnDark:x=!1,position:a="fixed"}=l,E=Dt(l,_7),I=ce({},l,{color:m,position:a,enableColorOnDark:x}),L=x7(I);return D.jsx(v7,ce({square:!0,component:"header",ownerState:I,elevation:4,className:Wt(L.root,h,a==="fixed"&&"mui-fixed"),ref:r},E))}),w7=b7;function S7(e){return typeof e=="function"?e():e}const E7=J.forwardRef(function(t,r){const{children:l,container:h,disablePortal:m=!1}=t,[x,a]=J.useState(null),E=_i(J.isValidElement(l)?tg(l):null,r);if(Ys(()=>{m||a(S7(h)||document.body)},[h,m]),Ys(()=>{if(x&&!m)return Hw(r,x),()=>{Hw(r,null)}},[r,x,m]),m){if(J.isValidElement(l)){const I={ref:E};return J.cloneElement(l,I)}return D.jsx(J.Fragment,{children:l})}return D.jsx(J.Fragment,{children:x&&j0.createPortal(l,x)})}),T7=E7,C7=wr(D.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function k7(e){return yn("MuiChip",e)}const I7=mn("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),Gn=I7,A7=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],M7=e=>{const{classes:t,disabled:r,size:l,color:h,iconColor:m,onDelete:x,clickable:a,variant:E}=e,I={root:["root",E,r&&"disabled",`size${Ct(l)}`,`color${Ct(h)}`,a&&"clickable",a&&`clickableColor${Ct(h)}`,x&&"deletable",x&&`deletableColor${Ct(h)}`,`${E}${Ct(h)}`],label:["label",`label${Ct(l)}`],avatar:["avatar",`avatar${Ct(l)}`,`avatarColor${Ct(h)}`],icon:["icon",`icon${Ct(l)}`,`iconColor${Ct(m)}`],deleteIcon:["deleteIcon",`deleteIcon${Ct(l)}`,`deleteIconColor${Ct(h)}`,`deleteIcon${Ct(E)}Color${Ct(h)}`]};return bn(I,k7,t)},P7=Bt("div",{name:"MuiChip",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e,{color:l,iconColor:h,clickable:m,onDelete:x,size:a,variant:E}=r;return[{[`& .${Gn.avatar}`]:t.avatar},{[`& .${Gn.avatar}`]:t[`avatar${Ct(a)}`]},{[`& .${Gn.avatar}`]:t[`avatarColor${Ct(l)}`]},{[`& .${Gn.icon}`]:t.icon},{[`& .${Gn.icon}`]:t[`icon${Ct(a)}`]},{[`& .${Gn.icon}`]:t[`iconColor${Ct(h)}`]},{[`& .${Gn.deleteIcon}`]:t.deleteIcon},{[`& .${Gn.deleteIcon}`]:t[`deleteIcon${Ct(a)}`]},{[`& .${Gn.deleteIcon}`]:t[`deleteIconColor${Ct(l)}`]},{[`& .${Gn.deleteIcon}`]:t[`deleteIcon${Ct(E)}Color${Ct(l)}`]},t.root,t[`size${Ct(a)}`],t[`color${Ct(l)}`],m&&t.clickable,m&&l!=="default"&&t[`clickableColor${Ct(l)})`],x&&t.deletable,x&&l!=="default"&&t[`deletableColor${Ct(l)}`],t[E],t[`${E}${Ct(l)}`]]}})(({theme:e,ownerState:t})=>{const r=e.palette.mode==="light"?e.palette.grey[700]:e.palette.grey[300];return ce({maxWidth:"100%",fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(e.vars||e).palette.text.primary,backgroundColor:(e.vars||e).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:e.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${Gn.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${Gn.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:e.vars?e.vars.palette.Chip.defaultAvatarColor:r,fontSize:e.typography.pxToRem(12)},[`& .${Gn.avatarColorPrimary}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.dark},[`& .${Gn.avatarColorSecondary}`]:{color:(e.vars||e).palette.secondary.contrastText,backgroundColor:(e.vars||e).palette.secondary.dark},[`& .${Gn.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:e.typography.pxToRem(10)},[`& .${Gn.icon}`]:ce({marginLeft:5,marginRight:-6},t.size==="small"&&{fontSize:18,marginLeft:4,marginRight:-4},t.iconColor===t.color&&ce({color:e.vars?e.vars.palette.Chip.defaultIconColor:r},t.color!=="default"&&{color:"inherit"})),[`& .${Gn.deleteIcon}`]:ce({WebkitTapHighlightColor:"transparent",color:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.26)`:sr(e.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.4)`:sr(e.palette.text.primary,.4)}},t.size==="small"&&{fontSize:16,marginRight:4,marginLeft:-4},t.color!=="default"&&{color:e.vars?`rgba(${e.vars.palette[t.color].contrastTextChannel} / 0.7)`:sr(e.palette[t.color].contrastText,.7),"&:hover, &:active":{color:(e.vars||e).palette[t.color].contrastText}})},t.size==="small"&&{height:24},t.color!=="default"&&{backgroundColor:(e.vars||e).palette[t.color].main,color:(e.vars||e).palette[t.color].contrastText},t.onDelete&&{[`&.${Gn.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:sr(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},t.onDelete&&t.color!=="default"&&{[`&.${Gn.focusVisible}`]:{backgroundColor:(e.vars||e).palette[t.color].dark}})},({theme:e,ownerState:t})=>ce({},t.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:sr(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity)},[`&.${Gn.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:sr(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)},"&:active":{boxShadow:(e.vars||e).shadows[1]}},t.clickable&&t.color!=="default"&&{[`&:hover, &.${Gn.focusVisible}`]:{backgroundColor:(e.vars||e).palette[t.color].dark}}),({theme:e,ownerState:t})=>ce({},t.variant==="outlined"&&{backgroundColor:"transparent",border:e.vars?`1px solid ${e.vars.palette.Chip.defaultBorder}`:`1px solid ${e.palette.mode==="light"?e.palette.grey[400]:e.palette.grey[700]}`,[`&.${Gn.clickable}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${Gn.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`& .${Gn.avatar}`]:{marginLeft:4},[`& .${Gn.avatarSmall}`]:{marginLeft:2},[`& .${Gn.icon}`]:{marginLeft:4},[`& .${Gn.iconSmall}`]:{marginLeft:2},[`& .${Gn.deleteIcon}`]:{marginRight:5},[`& .${Gn.deleteIconSmall}`]:{marginRight:3}},t.variant==="outlined"&&t.color!=="default"&&{color:(e.vars||e).palette[t.color].main,border:`1px solid ${e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / 0.7)`:sr(e.palette[t.color].main,.7)}`,[`&.${Gn.clickable}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:sr(e.palette[t.color].main,e.palette.action.hoverOpacity)},[`&.${Gn.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.focusOpacity})`:sr(e.palette[t.color].main,e.palette.action.focusOpacity)},[`& .${Gn.deleteIcon}`]:{color:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / 0.7)`:sr(e.palette[t.color].main,.7),"&:hover, &:active":{color:(e.vars||e).palette[t.color].main}}})),R7=Bt("span",{name:"MuiChip",slot:"Label",overridesResolver:(e,t)=>{const{ownerState:r}=e,{size:l}=r;return[t.label,t[`label${Ct(l)}`]]}})(({ownerState:e})=>ce({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},e.variant==="outlined"&&{paddingLeft:11,paddingRight:11},e.size==="small"&&{paddingLeft:8,paddingRight:8},e.size==="small"&&e.variant==="outlined"&&{paddingLeft:7,paddingRight:7}));function wA(e){return e.key==="Backspace"||e.key==="Delete"}const z7=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiChip"}),{avatar:h,className:m,clickable:x,color:a="default",component:E,deleteIcon:I,disabled:L=!1,icon:O,label:F,onClick:K,onDelete:W,onKeyDown:G,onKeyUp:ne,size:Z="medium",variant:H="filled",tabIndex:V,skipFocusWhenDisabled:oe=!1}=l,pe=Dt(l,A7),_e=J.useRef(null),xe=_i(_e,r),De=ct=>{ct.stopPropagation(),W&&W(ct)},ye=ct=>{ct.currentTarget===ct.target&&wA(ct)&&ct.preventDefault(),G&&G(ct)},Ae=ct=>{ct.currentTarget===ct.target&&(W&&wA(ct)?W(ct):ct.key==="Escape"&&_e.current&&_e.current.blur()),ne&&ne(ct)},ft=x!==!1&&K?!0:x,Ge=ft||W?Eh:E||"div",et=ce({},l,{component:Ge,disabled:L,size:Z,color:a,iconColor:J.isValidElement(O)&&O.props.color||a,onDelete:!!W,clickable:ft,variant:H}),lt=M7(et),gt=Ge===Eh?ce({component:E||"div",focusVisibleClassName:lt.focusVisible},W&&{disableRipple:!0}):{};let St=null;W&&(St=I&&J.isValidElement(I)?J.cloneElement(I,{className:Wt(I.props.className,lt.deleteIcon),onClick:De}):D.jsx(C7,{className:Wt(lt.deleteIcon),onClick:De}));let It=null;h&&J.isValidElement(h)&&(It=J.cloneElement(h,{className:Wt(lt.avatar,h.props.className)}));let Re=null;return O&&J.isValidElement(O)&&(Re=J.cloneElement(O,{className:Wt(lt.icon,O.props.className)})),D.jsxs(P7,ce({as:Ge,className:Wt(lt.root,m),disabled:ft&&L?!0:void 0,onClick:K,onKeyDown:ye,onKeyUp:Ae,ref:xe,tabIndex:oe&&L?-1:V,ownerState:et},gt,pe,{children:[It||Re,D.jsx(R7,{className:Wt(lt.label),ownerState:et,children:F}),St]}))}),Zi=z7,L7=["onChange","maxRows","minRows","style","value"];function Ky(e){return parseInt(e,10)||0}const D7={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function O7(e){for(const t in e)return!1;return!0}function SA(e){return O7(e)||e.outerHeightStyle===0&&!e.overflowing}const B7=J.forwardRef(function(t,r){const{onChange:l,maxRows:h,minRows:m=1,style:x,value:a}=t,E=Dt(t,L7),{current:I}=J.useRef(a!=null),L=J.useRef(null),O=_i(r,L),F=J.useRef(null),K=J.useRef(null),W=J.useCallback(()=>{const V=L.current,oe=K.current;if(!V||!oe)return;const _e=Eu(V).getComputedStyle(V);if(_e.width==="0px")return{outerHeightStyle:0,overflowing:!1};oe.style.width=_e.width,oe.value=V.value||t.placeholder||"x",oe.value.slice(-1)===`
`&&(oe.value+=" ");const xe=_e.boxSizing,De=Ky(_e.paddingBottom)+Ky(_e.paddingTop),ye=Ky(_e.borderBottomWidth)+Ky(_e.borderTopWidth),Ae=oe.scrollHeight;oe.value="x";const ft=oe.scrollHeight;let Ge=Ae;m&&(Ge=Math.max(Number(m)*ft,Ge)),h&&(Ge=Math.min(Number(h)*ft,Ge)),Ge=Math.max(Ge,ft);const et=Ge+(xe==="border-box"?De+ye:0),lt=Math.abs(Ge-Ae)<=1;return{outerHeightStyle:et,overflowing:lt}},[h,m,t.placeholder]),G=du(()=>{const V=L.current,oe=W();if(!V||!oe||SA(oe))return!1;const pe=oe.outerHeightStyle;return F.current!=null&&F.current!==pe}),ne=J.useCallback(()=>{const V=L.current,oe=W();if(!V||!oe||SA(oe))return;const pe=oe.outerHeightStyle;F.current!==pe&&(F.current=pe,V.style.height=`${pe}px`),V.style.overflow=oe.overflowing?"hidden":""},[W]),Z=J.useRef(-1);Ys(()=>{const V=qz(ne),oe=L==null?void 0:L.current;if(!oe)return;const pe=Eu(oe);pe.addEventListener("resize",V);let _e;return typeof ResizeObserver<"u"&&(_e=new ResizeObserver(()=>{G()&&(_e.unobserve(oe),cancelAnimationFrame(Z.current),ne(),Z.current=requestAnimationFrame(()=>{_e.observe(oe)}))}),_e.observe(oe)),()=>{V.clear(),cancelAnimationFrame(Z.current),pe.removeEventListener("resize",V),_e&&_e.disconnect()}},[W,ne,G]),Ys(()=>{ne()});const H=V=>{I||ne(),l&&l(V)};return D.jsxs(J.Fragment,{children:[D.jsx("textarea",ce({value:a,onChange:H,ref:O,rows:m,style:x},E)),D.jsx("textarea",{"aria-hidden":!0,className:t.className,readOnly:!0,ref:K,tabIndex:-1,style:ce({},D7.shadow,x,{paddingTop:0,paddingBottom:0})})]})}),F7=B7;function jh({props:e,states:t,muiFormControl:r}){return t.reduce((l,h)=>(l[h]=e[h],r&&typeof e[h]>"u"&&(l[h]=r[h]),l),{})}const j7=J.createContext(void 0),qS=j7;function Nh(){return J.useContext(qS)}function EA(e){return e!=null&&!(Array.isArray(e)&&e.length===0)}function _0(e,t=!1){return e&&(EA(e.value)&&e.value!==""||t&&EA(e.defaultValue)&&e.defaultValue!=="")}function N7(e){return e.startAdornment}function $7(e){return yn("MuiInputBase",e)}const U7=mn("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),Ch=U7,V7=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],Gx=(e,t)=>{const{ownerState:r}=e;return[t.root,r.formControl&&t.formControl,r.startAdornment&&t.adornedStart,r.endAdornment&&t.adornedEnd,r.error&&t.error,r.size==="small"&&t.sizeSmall,r.multiline&&t.multiline,r.color&&t[`color${Ct(r.color)}`],r.fullWidth&&t.fullWidth,r.hiddenLabel&&t.hiddenLabel]},qx=(e,t)=>{const{ownerState:r}=e;return[t.input,r.size==="small"&&t.inputSizeSmall,r.multiline&&t.inputMultiline,r.type==="search"&&t.inputTypeSearch,r.startAdornment&&t.inputAdornedStart,r.endAdornment&&t.inputAdornedEnd,r.hiddenLabel&&t.inputHiddenLabel]},W7=e=>{const{classes:t,color:r,disabled:l,error:h,endAdornment:m,focused:x,formControl:a,fullWidth:E,hiddenLabel:I,multiline:L,readOnly:O,size:F,startAdornment:K,type:W}=e,G={root:["root",`color${Ct(r)}`,l&&"disabled",h&&"error",E&&"fullWidth",x&&"focused",a&&"formControl",F&&F!=="medium"&&`size${Ct(F)}`,L&&"multiline",K&&"adornedStart",m&&"adornedEnd",I&&"hiddenLabel",O&&"readOnly"],input:["input",l&&"disabled",W==="search"&&"inputTypeSearch",L&&"inputMultiline",F==="small"&&"inputSizeSmall",I&&"inputHiddenLabel",K&&"inputAdornedStart",m&&"inputAdornedEnd",O&&"readOnly"]};return bn(G,$7,t)},Hx=Bt("div",{name:"MuiInputBase",slot:"Root",overridesResolver:Gx})(({theme:e,ownerState:t})=>ce({},e.typography.body1,{color:(e.vars||e).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${Ch.disabled}`]:{color:(e.vars||e).palette.text.disabled,cursor:"default"}},t.multiline&&ce({padding:"4px 0 5px"},t.size==="small"&&{paddingTop:1}),t.fullWidth&&{width:"100%"})),Zx=Bt("input",{name:"MuiInputBase",slot:"Input",overridesResolver:qx})(({theme:e,ownerState:t})=>{const r=e.palette.mode==="light",l=ce({color:"currentColor"},e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5},{transition:e.transitions.create("opacity",{duration:e.transitions.duration.shorter})}),h={opacity:"0 !important"},m=e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5};return ce({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":l,"&::-moz-placeholder":l,"&:-ms-input-placeholder":l,"&::-ms-input-placeholder":l,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${Ch.formControl} &`]:{"&::-webkit-input-placeholder":h,"&::-moz-placeholder":h,"&:-ms-input-placeholder":h,"&::-ms-input-placeholder":h,"&:focus::-webkit-input-placeholder":m,"&:focus::-moz-placeholder":m,"&:focus:-ms-input-placeholder":m,"&:focus::-ms-input-placeholder":m},[`&.${Ch.disabled}`]:{opacity:1,WebkitTextFillColor:(e.vars||e).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},t.size==="small"&&{paddingTop:1},t.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},t.type==="search"&&{MozAppearance:"textfield"})}),G7=D.jsx(fL,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),q7=J.forwardRef(function(t,r){var l;const h=_n({props:t,name:"MuiInputBase"}),{"aria-describedby":m,autoComplete:x,autoFocus:a,className:E,components:I={},componentsProps:L={},defaultValue:O,disabled:F,disableInjectingGlobalStyles:K,endAdornment:W,fullWidth:G=!1,id:ne,inputComponent:Z="input",inputProps:H={},inputRef:V,maxRows:oe,minRows:pe,multiline:_e=!1,name:xe,onBlur:De,onChange:ye,onClick:Ae,onFocus:ft,onKeyDown:Ge,onKeyUp:et,placeholder:lt,readOnly:gt,renderSuffix:St,rows:It,slotProps:Re={},slots:ct={},startAdornment:Ie,type:st="text",value:Tt}=h,zt=Dt(h,V7),Nt=H.value!=null?H.value:Tt,{current:en}=J.useRef(Nt!=null),Zt=J.useRef(),Mn=J.useCallback(wn=>{},[]),Wr=_i(Zt,V,H.ref,Mn),[qn,Mr]=J.useState(!1),Rt=Nh(),Dn=jh({props:h,muiFormControl:Rt,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Dn.focused=Rt?Rt.focused:qn,J.useEffect(()=>{!Rt&&F&&qn&&(Mr(!1),De&&De())},[Rt,F,qn,De]);const Xt=Rt&&Rt.onFilled,Cn=Rt&&Rt.onEmpty,Kt=J.useCallback(wn=>{_0(wn)?Xt&&Xt():Cn&&Cn()},[Xt,Cn]);Ys(()=>{en&&Kt({value:Nt})},[Nt,Kt,en]);const Pr=wn=>{if(Dn.disabled){wn.stopPropagation();return}ft&&ft(wn),H.onFocus&&H.onFocus(wn),Rt&&Rt.onFocus?Rt.onFocus(wn):Mr(!0)},di=wn=>{De&&De(wn),H.onBlur&&H.onBlur(wn),Rt&&Rt.onBlur?Rt.onBlur(wn):Mr(!1)},Sr=(wn,...qt)=>{if(!en){const hi=wn.target||Zt.current;if(hi==null)throw new Error(Su(1));Kt({value:hi.value})}H.onChange&&H.onChange(wn,...qt),ye&&ye(wn,...qt)};J.useEffect(()=>{Kt(Zt.current)},[]);const lr=wn=>{Zt.current&&wn.currentTarget===wn.target&&Zt.current.focus(),Ae&&Ae(wn)};let Qr=Z,On=H;_e&&Qr==="input"&&(It?On=ce({type:void 0,minRows:It,maxRows:It},On):On=ce({type:void 0,maxRows:oe,minRows:pe},On),Qr=F7);const ki=wn=>{Kt(wn.animationName==="mui-auto-fill-cancel"?Zt.current:{value:"x"})};J.useEffect(()=>{Rt&&Rt.setAdornedStart(!!Ie)},[Rt,Ie]);const gr=ce({},h,{color:Dn.color||"primary",disabled:Dn.disabled,endAdornment:W,error:Dn.error,focused:Dn.focused,formControl:Rt,fullWidth:G,hiddenLabel:Dn.hiddenLabel,multiline:_e,size:Dn.size,startAdornment:Ie,type:st}),zn=W7(gr),Ii=ct.root||I.Root||Hx,Ji=Re.root||L.root||{},Er=ct.input||I.Input||Zx;return On=ce({},On,(l=Re.input)!=null?l:L.input),D.jsxs(J.Fragment,{children:[!K&&G7,D.jsxs(Ii,ce({},Ji,!wh(Ii)&&{ownerState:ce({},gr,Ji.ownerState)},{ref:r,onClick:lr},zt,{className:Wt(zn.root,Ji.className,E,gt&&"MuiInputBase-readOnly"),children:[Ie,D.jsx(qS.Provider,{value:null,children:D.jsx(Er,ce({ownerState:gr,"aria-invalid":Dn.error,"aria-describedby":m,autoComplete:x,autoFocus:a,defaultValue:O,disabled:Dn.disabled,id:ne,onAnimationStart:ki,name:xe,placeholder:lt,readOnly:gt,required:Dn.required,rows:It,value:Nt,onKeyDown:Ge,onKeyUp:et,type:st},On,!wh(Er)&&{as:Qr,ownerState:ce({},gr,On.ownerState)},{ref:Wr,className:Wt(zn.input,On.className,gt&&"MuiInputBase-readOnly"),onBlur:di,onChange:Sr,onFocus:Pr}))}),W,St?St(ce({},Dn,{startAdornment:Ie})):null]}))]})}),HS=q7;function H7(e){return yn("MuiInput",e)}const Z7=ce({},Ch,mn("MuiInput",["root","underline","input"])),Pf=Z7;function X7(e){return yn("MuiOutlinedInput",e)}const K7=ce({},Ch,mn("MuiOutlinedInput",["root","notchedOutline","input"])),Ll=K7;function Y7(e){return yn("MuiFilledInput",e)}const J7=ce({},Ch,mn("MuiFilledInput",["root","underline","input"])),eu=J7,Q7=wr(D.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),eW=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],tW={entering:{opacity:1},entered:{opacity:1}},nW=J.forwardRef(function(t,r){const l=Vx(),h={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{addEndListener:m,appear:x=!0,children:a,easing:E,in:I,onEnter:L,onEntered:O,onEntering:F,onExit:K,onExited:W,onExiting:G,style:ne,timeout:Z=h,TransitionComponent:H=yL}=t,V=Dt(t,eW),oe=J.useRef(null),pe=_i(oe,tg(a),r),_e=lt=>gt=>{if(lt){const St=oe.current;gt===void 0?lt(St):lt(St,gt)}},xe=_e(F),De=_e((lt,gt)=>{_L(lt);const St=y0({style:ne,timeout:Z,easing:E},{mode:"enter"});lt.style.webkitTransition=l.transitions.create("opacity",St),lt.style.transition=l.transitions.create("opacity",St),L&&L(lt,gt)}),ye=_e(O),Ae=_e(G),ft=_e(lt=>{const gt=y0({style:ne,timeout:Z,easing:E},{mode:"exit"});lt.style.webkitTransition=l.transitions.create("opacity",gt),lt.style.transition=l.transitions.create("opacity",gt),K&&K(lt)}),Ge=_e(W),et=lt=>{m&&m(oe.current,lt)};return D.jsx(H,ce({appear:x,in:I,nodeRef:oe,onEnter:De,onEntered:ye,onEntering:xe,onExit:ft,onExited:Ge,onExiting:Ae,addEndListener:et,timeout:Z},V,{children:(lt,gt)=>J.cloneElement(a,ce({style:ce({opacity:0,visibility:lt==="exited"&&!I?"hidden":void 0},tW[lt],ne,a.props.style),ref:pe},gt))}))}),rW=nW;function iW(e){return yn("MuiBackdrop",e)}mn("MuiBackdrop",["root","invisible"]);const oW=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],sW=e=>{const{classes:t,invisible:r}=e;return bn({root:["root",r&&"invisible"]},iW,t)},aW=Bt("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.invisible&&t.invisible]}})(({ownerState:e})=>ce({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},e.invisible&&{backgroundColor:"transparent"})),lW=J.forwardRef(function(t,r){var l,h,m;const x=_n({props:t,name:"MuiBackdrop"}),{children:a,className:E,component:I="div",components:L={},componentsProps:O={},invisible:F=!1,open:K,slotProps:W={},slots:G={},TransitionComponent:ne=rW,transitionDuration:Z}=x,H=Dt(x,oW),V=ce({},x,{component:I,invisible:F}),oe=sW(V),pe=(l=W.root)!=null?l:O.root;return D.jsx(ne,ce({in:K,timeout:Z},H,{children:D.jsx(aW,ce({"aria-hidden":!0},pe,{as:(h=(m=G.root)!=null?m:L.Root)!=null?h:I,className:Wt(oe.root,E,pe==null?void 0:pe.className),ownerState:ce({},V,pe==null?void 0:pe.ownerState),classes:oe,ref:r,children:a}))}))}),cW=lW,uW=mn("MuiBox",["root"]),dW=uW,hW=US(),pW=LU({themeId:xh,defaultTheme:hW,defaultClassName:dW.root,generateClassName:jz.generate}),Pt=pW;function fW(e){return yn("MuiButton",e)}const mW=mn("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),Yy=mW,gW=J.createContext({}),yW=gW,_W=J.createContext(void 0),xW=_W,vW=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],bW=e=>{const{color:t,disableElevation:r,fullWidth:l,size:h,variant:m,classes:x}=e,a={root:["root",m,`${m}${Ct(t)}`,`size${Ct(h)}`,`${m}Size${Ct(h)}`,`color${Ct(t)}`,r&&"disableElevation",l&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${Ct(h)}`],endIcon:["icon","endIcon",`iconSize${Ct(h)}`]},E=bn(a,fW,x);return ce({},x,E)},xL=e=>ce({},e.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},e.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},e.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),wW=Bt(Eh,{shouldForwardProp:e=>xs(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],t[`${r.variant}${Ct(r.color)}`],t[`size${Ct(r.size)}`],t[`${r.variant}Size${Ct(r.size)}`],r.color==="inherit"&&t.colorInherit,r.disableElevation&&t.disableElevation,r.fullWidth&&t.fullWidth]}})(({theme:e,ownerState:t})=>{var r,l;const h=e.palette.mode==="light"?e.palette.grey[300]:e.palette.grey[800],m=e.palette.mode==="light"?e.palette.grey.A100:e.palette.grey[700];return ce({},e.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":ce({textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:sr(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},t.variant==="text"&&t.color!=="inherit"&&{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:sr(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},t.variant==="outlined"&&t.color!=="inherit"&&{border:`1px solid ${(e.vars||e).palette[t.color].main}`,backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:sr(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},t.variant==="contained"&&{backgroundColor:e.vars?e.vars.palette.Button.inheritContainedHoverBg:m,boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2],backgroundColor:(e.vars||e).palette.grey[300]}},t.variant==="contained"&&t.color!=="inherit"&&{backgroundColor:(e.vars||e).palette[t.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[t.color].main}}),"&:active":ce({},t.variant==="contained"&&{boxShadow:(e.vars||e).shadows[8]}),[`&.${Yy.focusVisible}`]:ce({},t.variant==="contained"&&{boxShadow:(e.vars||e).shadows[6]}),[`&.${Yy.disabled}`]:ce({color:(e.vars||e).palette.action.disabled},t.variant==="outlined"&&{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},t.variant==="contained"&&{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground})},t.variant==="text"&&{padding:"6px 8px"},t.variant==="text"&&t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].main},t.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},t.variant==="outlined"&&t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].main,border:e.vars?`1px solid rgba(${e.vars.palette[t.color].mainChannel} / 0.5)`:`1px solid ${sr(e.palette[t.color].main,.5)}`},t.variant==="contained"&&{color:e.vars?e.vars.palette.text.primary:(r=(l=e.palette).getContrastText)==null?void 0:r.call(l,e.palette.grey[300]),backgroundColor:e.vars?e.vars.palette.Button.inheritContainedBg:h,boxShadow:(e.vars||e).shadows[2]},t.variant==="contained"&&t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].contrastText,backgroundColor:(e.vars||e).palette[t.color].main},t.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},t.size==="small"&&t.variant==="text"&&{padding:"4px 5px",fontSize:e.typography.pxToRem(13)},t.size==="large"&&t.variant==="text"&&{padding:"8px 11px",fontSize:e.typography.pxToRem(15)},t.size==="small"&&t.variant==="outlined"&&{padding:"3px 9px",fontSize:e.typography.pxToRem(13)},t.size==="large"&&t.variant==="outlined"&&{padding:"7px 21px",fontSize:e.typography.pxToRem(15)},t.size==="small"&&t.variant==="contained"&&{padding:"4px 10px",fontSize:e.typography.pxToRem(13)},t.size==="large"&&t.variant==="contained"&&{padding:"8px 22px",fontSize:e.typography.pxToRem(15)},t.fullWidth&&{width:"100%"})},({ownerState:e})=>e.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Yy.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Yy.disabled}`]:{boxShadow:"none"}}),SW=Bt("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.startIcon,t[`iconSize${Ct(r.size)}`]]}})(({ownerState:e})=>ce({display:"inherit",marginRight:8,marginLeft:-4},e.size==="small"&&{marginLeft:-2},xL(e))),EW=Bt("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.endIcon,t[`iconSize${Ct(r.size)}`]]}})(({ownerState:e})=>ce({display:"inherit",marginRight:-4,marginLeft:8},e.size==="small"&&{marginRight:-2},xL(e))),TW=J.forwardRef(function(t,r){const l=J.useContext(yW),h=J.useContext(xW),m=Lm(l,t),x=_n({props:m,name:"MuiButton"}),{children:a,color:E="primary",component:I="button",className:L,disabled:O=!1,disableElevation:F=!1,disableFocusRipple:K=!1,endIcon:W,focusVisibleClassName:G,fullWidth:ne=!1,size:Z="medium",startIcon:H,type:V,variant:oe="text"}=x,pe=Dt(x,vW),_e=ce({},x,{color:E,component:I,disabled:O,disableElevation:F,disableFocusRipple:K,fullWidth:ne,size:Z,type:V,variant:oe}),xe=bW(_e),De=H&&D.jsx(SW,{className:xe.startIcon,ownerState:_e,children:H}),ye=W&&D.jsx(EW,{className:xe.endIcon,ownerState:_e,children:W}),Ae=h||"";return D.jsxs(wW,ce({ownerState:_e,className:Wt(l.className,xe.root,L,Ae),component:I,disabled:O,focusRipple:!K,focusVisibleClassName:Wt(xe.focusVisible,G),ref:r,type:V},pe,{classes:xe,children:[De,a,ye]}))}),ro=TW;function CW(e){return yn("MuiCard",e)}mn("MuiCard",["root"]);const kW=["className","raised"],IW=e=>{const{classes:t}=e;return bn({root:["root"]},CW,t)},AW=Bt(lc,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({overflow:"hidden"})),MW=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiCard"}),{className:h,raised:m=!1}=l,x=Dt(l,kW),a=ce({},l,{raised:m}),E=IW(a);return D.jsx(AW,ce({className:Wt(E.root,h),elevation:m?8:void 0,ref:r,ownerState:a},x))}),fr=MW;function PW(e){return yn("MuiCardContent",e)}mn("MuiCardContent",["root"]);const RW=["className","component"],zW=e=>{const{classes:t}=e;return bn({root:["root"]},PW,t)},LW=Bt("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),DW=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiCardContent"}),{className:h,component:m="div"}=l,x=Dt(l,RW),a=ce({},l,{component:m}),E=zW(a);return D.jsx(LW,ce({as:m,className:Wt(E.root,h),ownerState:a,ref:r},x))}),vr=DW;function OW(e){return yn("MuiCircularProgress",e)}mn("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const BW=["className","color","disableShrink","size","style","thickness","value","variant"];let Xx=e=>e,TA,CA,kA,IA;const Dl=44,FW=Oh(TA||(TA=Xx`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),jW=Oh(CA||(CA=Xx`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),NW=e=>{const{classes:t,variant:r,color:l,disableShrink:h}=e,m={root:["root",r,`color${Ct(l)}`],svg:["svg"],circle:["circle",`circle${Ct(r)}`,h&&"circleDisableShrink"]};return bn(m,OW,t)},$W=Bt("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[r.variant],t[`color${Ct(r.color)}`]]}})(({ownerState:e,theme:t})=>ce({display:"inline-block"},e.variant==="determinate"&&{transition:t.transitions.create("transform")},e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main}),({ownerState:e})=>e.variant==="indeterminate"&&bx(kA||(kA=Xx`
      animation: ${0} 1.4s linear infinite;
    `),FW)),UW=Bt("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({display:"block"}),VW=Bt("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.circle,t[`circle${Ct(r.variant)}`],r.disableShrink&&t.circleDisableShrink]}})(({ownerState:e,theme:t})=>ce({stroke:"currentColor"},e.variant==="determinate"&&{transition:t.transitions.create("stroke-dashoffset")},e.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink&&bx(IA||(IA=Xx`
      animation: ${0} 1.4s ease-in-out infinite;
    `),jW)),WW=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiCircularProgress"}),{className:h,color:m="primary",disableShrink:x=!1,size:a=40,style:E,thickness:I=3.6,value:L=0,variant:O="indeterminate"}=l,F=Dt(l,BW),K=ce({},l,{color:m,disableShrink:x,size:a,thickness:I,value:L,variant:O}),W=NW(K),G={},ne={},Z={};if(O==="determinate"){const H=2*Math.PI*((Dl-I)/2);G.strokeDasharray=H.toFixed(3),Z["aria-valuenow"]=Math.round(L),G.strokeDashoffset=`${((100-L)/100*H).toFixed(3)}px`,ne.transform="rotate(-90deg)"}return D.jsx($W,ce({className:Wt(W.root,h),style:ce({width:a,height:a},ne,E),ownerState:K,ref:r,role:"progressbar"},Z,F,{children:D.jsx(UW,{className:W.svg,ownerState:K,viewBox:`${Dl/2} ${Dl/2} ${Dl} ${Dl}`,children:D.jsx(VW,{className:W.circle,style:G,ownerState:K,cx:Dl,cy:Dl,r:(Dl-I)/2,fill:"none",strokeWidth:I})})}))}),Om=WW,GW=D8({createStyledComponent:Bt("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[`maxWidth${Ct(String(r.maxWidth))}`],r.fixed&&t.fixed,r.disableGutters&&t.disableGutters]}}),useThemeProps:e=>_n({props:e,name:"MuiContainer"})}),ZS=GW;function qW(e){const t=No(e);return t.body===e?Eu(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}function om(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function AA(e){return parseInt(Eu(e).getComputedStyle(e).paddingRight,10)||0}function HW(e){const r=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(e.tagName)!==-1,l=e.tagName==="INPUT"&&e.getAttribute("type")==="hidden";return r||l}function MA(e,t,r,l,h){const m=[t,r,...l];[].forEach.call(e.children,x=>{const a=m.indexOf(x)===-1,E=!HW(x);a&&E&&om(x,h)})}function Cb(e,t){let r=-1;return e.some((l,h)=>t(l)?(r=h,!0):!1),r}function ZW(e,t){const r=[],l=e.container;if(!t.disableScrollLock){if(qW(l)){const x=Xz(No(l));r.push({value:l.style.paddingRight,property:"padding-right",el:l}),l.style.paddingRight=`${AA(l)+x}px`;const a=No(l).querySelectorAll(".mui-fixed");[].forEach.call(a,E=>{r.push({value:E.style.paddingRight,property:"padding-right",el:E}),E.style.paddingRight=`${AA(E)+x}px`})}let m;if(l.parentNode instanceof DocumentFragment)m=No(l).body;else{const x=l.parentElement,a=Eu(l);m=(x==null?void 0:x.nodeName)==="HTML"&&a.getComputedStyle(x).overflowY==="scroll"?x:l}r.push({value:m.style.overflow,property:"overflow",el:m},{value:m.style.overflowX,property:"overflow-x",el:m},{value:m.style.overflowY,property:"overflow-y",el:m}),m.style.overflow="hidden"}return()=>{r.forEach(({value:m,el:x,property:a})=>{m?x.style.setProperty(a,m):x.style.removeProperty(a)})}}function XW(e){const t=[];return[].forEach.call(e.children,r=>{r.getAttribute("aria-hidden")==="true"&&t.push(r)}),t}class KW{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(t,r){let l=this.modals.indexOf(t);if(l!==-1)return l;l=this.modals.length,this.modals.push(t),t.modalRef&&om(t.modalRef,!1);const h=XW(r);MA(r,t.mount,t.modalRef,h,!0);const m=Cb(this.containers,x=>x.container===r);return m!==-1?(this.containers[m].modals.push(t),l):(this.containers.push({modals:[t],container:r,restore:null,hiddenSiblings:h}),l)}mount(t,r){const l=Cb(this.containers,m=>m.modals.indexOf(t)!==-1),h=this.containers[l];h.restore||(h.restore=ZW(h,r))}remove(t,r=!0){const l=this.modals.indexOf(t);if(l===-1)return l;const h=Cb(this.containers,x=>x.modals.indexOf(t)!==-1),m=this.containers[h];if(m.modals.splice(m.modals.indexOf(t),1),this.modals.splice(l,1),m.modals.length===0)m.restore&&m.restore(),t.modalRef&&om(t.modalRef,r),MA(m.container,t.mount,t.modalRef,m.hiddenSiblings,!1),this.containers.splice(h,1);else{const x=m.modals[m.modals.length-1];x.modalRef&&om(x.modalRef,!1)}return l}isTopModal(t){return this.modals.length>0&&this.modals[this.modals.length-1]===t}}const YW=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function JW(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?e.contentEditable==="true"||(e.nodeName==="AUDIO"||e.nodeName==="VIDEO"||e.nodeName==="DETAILS")&&e.getAttribute("tabindex")===null?0:e.tabIndex:t}function QW(e){if(e.tagName!=="INPUT"||e.type!=="radio"||!e.name)return!1;const t=l=>e.ownerDocument.querySelector(`input[type="radio"]${l}`);let r=t(`[name="${e.name}"]:checked`);return r||(r=t(`[name="${e.name}"]`)),r!==e}function eG(e){return!(e.disabled||e.tagName==="INPUT"&&e.type==="hidden"||QW(e))}function tG(e){const t=[],r=[];return Array.from(e.querySelectorAll(YW)).forEach((l,h)=>{const m=JW(l);m===-1||!eG(l)||(m===0?t.push(l):r.push({documentOrder:h,tabIndex:m,node:l}))}),r.sort((l,h)=>l.tabIndex===h.tabIndex?l.documentOrder-h.documentOrder:l.tabIndex-h.tabIndex).map(l=>l.node).concat(t)}function nG(){return!0}function rG(e){const{children:t,disableAutoFocus:r=!1,disableEnforceFocus:l=!1,disableRestoreFocus:h=!1,getTabbable:m=tG,isEnabled:x=nG,open:a}=e,E=J.useRef(!1),I=J.useRef(null),L=J.useRef(null),O=J.useRef(null),F=J.useRef(null),K=J.useRef(!1),W=J.useRef(null),G=_i(tg(t),W),ne=J.useRef(null);J.useEffect(()=>{!a||!W.current||(K.current=!r)},[r,a]),J.useEffect(()=>{if(!a||!W.current)return;const V=No(W.current);return W.current.contains(V.activeElement)||(W.current.hasAttribute("tabIndex")||W.current.setAttribute("tabIndex","-1"),K.current&&W.current.focus()),()=>{h||(O.current&&O.current.focus&&(E.current=!0,O.current.focus()),O.current=null)}},[a]),J.useEffect(()=>{if(!a||!W.current)return;const V=No(W.current),oe=xe=>{ne.current=xe,!(l||!x()||xe.key!=="Tab")&&V.activeElement===W.current&&xe.shiftKey&&(E.current=!0,L.current&&L.current.focus())},pe=()=>{const xe=W.current;if(xe===null)return;if(!V.hasFocus()||!x()||E.current){E.current=!1;return}if(xe.contains(V.activeElement)||l&&V.activeElement!==I.current&&V.activeElement!==L.current)return;if(V.activeElement!==F.current)F.current=null;else if(F.current!==null)return;if(!K.current)return;let De=[];if((V.activeElement===I.current||V.activeElement===L.current)&&(De=m(W.current)),De.length>0){var ye,Ae;const ft=!!((ye=ne.current)!=null&&ye.shiftKey&&((Ae=ne.current)==null?void 0:Ae.key)==="Tab"),Ge=De[0],et=De[De.length-1];typeof Ge!="string"&&typeof et!="string"&&(ft?et.focus():Ge.focus())}else xe.focus()};V.addEventListener("focusin",pe),V.addEventListener("keydown",oe,!0);const _e=setInterval(()=>{V.activeElement&&V.activeElement.tagName==="BODY"&&pe()},50);return()=>{clearInterval(_e),V.removeEventListener("focusin",pe),V.removeEventListener("keydown",oe,!0)}},[r,l,h,x,a,m]);const Z=V=>{O.current===null&&(O.current=V.relatedTarget),K.current=!0,F.current=V.target;const oe=t.props.onFocus;oe&&oe(V)},H=V=>{O.current===null&&(O.current=V.relatedTarget),K.current=!0};return D.jsxs(J.Fragment,{children:[D.jsx("div",{tabIndex:a?0:-1,onFocus:H,ref:I,"data-testid":"sentinelStart"}),J.cloneElement(t,{ref:G,onFocus:Z}),D.jsx("div",{tabIndex:a?0:-1,onFocus:H,ref:L,"data-testid":"sentinelEnd"})]})}function iG(e){return typeof e=="function"?e():e}function oG(e){return e?e.props.hasOwnProperty("in"):!1}const sG=new KW;function aG(e){const{container:t,disableEscapeKeyDown:r=!1,disableScrollLock:l=!1,manager:h=sG,closeAfterTransition:m=!1,onTransitionEnter:x,onTransitionExited:a,children:E,onClose:I,open:L,rootRef:O}=e,F=J.useRef({}),K=J.useRef(null),W=J.useRef(null),G=_i(W,O),[ne,Z]=J.useState(!L),H=oG(E);let V=!0;(e["aria-hidden"]==="false"||e["aria-hidden"]===!1)&&(V=!1);const oe=()=>No(K.current),pe=()=>(F.current.modalRef=W.current,F.current.mount=K.current,F.current),_e=()=>{h.mount(pe(),{disableScrollLock:l}),W.current&&(W.current.scrollTop=0)},xe=du(()=>{const St=iG(t)||oe().body;h.add(pe(),St),W.current&&_e()}),De=J.useCallback(()=>h.isTopModal(pe()),[h]),ye=du(St=>{K.current=St,St&&(L&&De()?_e():W.current&&om(W.current,V))}),Ae=J.useCallback(()=>{h.remove(pe(),V)},[V,h]);J.useEffect(()=>()=>{Ae()},[Ae]),J.useEffect(()=>{L?xe():(!H||!m)&&Ae()},[L,Ae,H,m,xe]);const ft=St=>It=>{var Re;(Re=St.onKeyDown)==null||Re.call(St,It),!(It.key!=="Escape"||It.which===229||!De())&&(r||(It.stopPropagation(),I&&I(It,"escapeKeyDown")))},Ge=St=>It=>{var Re;(Re=St.onClick)==null||Re.call(St,It),It.target===It.currentTarget&&I&&I(It,"backdropClick")};return{getRootProps:(St={})=>{const It=Yz(e);delete It.onTransitionEnter,delete It.onTransitionExited;const Re=ce({},It,St);return ce({role:"presentation"},Re,{onKeyDown:ft(Re),ref:G})},getBackdropProps:(St={})=>{const It=St;return ce({"aria-hidden":!0},It,{onClick:Ge(It),open:L})},getTransitionProps:()=>{const St=()=>{Z(!1),x&&x()},It=()=>{Z(!0),a&&a(),m&&Ae()};return{onEnter:ZI(St,E==null?void 0:E.props.onEnter),onExited:ZI(It,E==null?void 0:E.props.onExited)}},rootRef:G,portalRef:ye,isTopModal:De,exited:ne,hasTransition:H}}function lG(e){return yn("MuiModal",e)}mn("MuiModal",["root","hidden","backdrop"]);const cG=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],uG=e=>{const{open:t,exited:r,classes:l}=e;return bn({root:["root",!t&&r&&"hidden"],backdrop:["backdrop"]},lG,l)},dG=Bt("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.open&&r.exited&&t.hidden]}})(({theme:e,ownerState:t})=>ce({position:"fixed",zIndex:(e.vars||e).zIndex.modal,right:0,bottom:0,top:0,left:0},!t.open&&t.exited&&{visibility:"hidden"})),hG=Bt(cW,{name:"MuiModal",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})({zIndex:-1}),pG=J.forwardRef(function(t,r){var l,h,m,x,a,E;const I=_n({name:"MuiModal",props:t}),{BackdropComponent:L=hG,BackdropProps:O,className:F,closeAfterTransition:K=!1,children:W,container:G,component:ne,components:Z={},componentsProps:H={},disableAutoFocus:V=!1,disableEnforceFocus:oe=!1,disableEscapeKeyDown:pe=!1,disablePortal:_e=!1,disableRestoreFocus:xe=!1,disableScrollLock:De=!1,hideBackdrop:ye=!1,keepMounted:Ae=!1,onBackdropClick:ft,open:Ge,slotProps:et,slots:lt}=I,gt=Dt(I,cG),St=ce({},I,{closeAfterTransition:K,disableAutoFocus:V,disableEnforceFocus:oe,disableEscapeKeyDown:pe,disablePortal:_e,disableRestoreFocus:xe,disableScrollLock:De,hideBackdrop:ye,keepMounted:Ae}),{getRootProps:It,getBackdropProps:Re,getTransitionProps:ct,portalRef:Ie,isTopModal:st,exited:Tt,hasTransition:zt}=aG(ce({},St,{rootRef:r})),Nt=ce({},St,{exited:Tt}),en=uG(Nt),Zt={};if(W.props.tabIndex===void 0&&(Zt.tabIndex="-1"),zt){const{onEnter:Xt,onExited:Cn}=ct();Zt.onEnter=Xt,Zt.onExited=Cn}const Mn=(l=(h=lt==null?void 0:lt.root)!=null?h:Z.Root)!=null?l:dG,Wr=(m=(x=lt==null?void 0:lt.backdrop)!=null?x:Z.Backdrop)!=null?m:L,qn=(a=et==null?void 0:et.root)!=null?a:H.root,Mr=(E=et==null?void 0:et.backdrop)!=null?E:H.backdrop,Rt=Sh({elementType:Mn,externalSlotProps:qn,externalForwardedProps:gt,getSlotProps:It,additionalProps:{ref:r,as:ne},ownerState:Nt,className:Wt(F,qn==null?void 0:qn.className,en==null?void 0:en.root,!Nt.open&&Nt.exited&&(en==null?void 0:en.hidden))}),Dn=Sh({elementType:Wr,externalSlotProps:Mr,additionalProps:O,getSlotProps:Xt=>Re(ce({},Xt,{onClick:Cn=>{ft&&ft(Cn),Xt!=null&&Xt.onClick&&Xt.onClick(Cn)}})),className:Wt(Mr==null?void 0:Mr.className,O==null?void 0:O.className,en==null?void 0:en.backdrop),ownerState:Nt});return!Ae&&!Ge&&(!zt||Tt)?null:D.jsx(T7,{ref:Ie,container:G,disablePortal:_e,children:D.jsxs(Mn,ce({},Rt,{children:[!ye&&L?D.jsx(Wr,ce({},Dn)):null,D.jsx(rG,{disableEnforceFocus:oe,disableAutoFocus:V,disableRestoreFocus:xe,isEnabled:st,open:Ge,children:J.cloneElement(W,Zt)})]}))})}),fG=pG;function mG(e){return yn("MuiDivider",e)}const gG=mn("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),PA=gG,yG=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],_G=e=>{const{absolute:t,children:r,classes:l,flexItem:h,light:m,orientation:x,textAlign:a,variant:E}=e;return bn({root:["root",t&&"absolute",E,m&&"light",x==="vertical"&&"vertical",h&&"flexItem",r&&"withChildren",r&&x==="vertical"&&"withChildrenVertical",a==="right"&&x!=="vertical"&&"textAlignRight",a==="left"&&x!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",x==="vertical"&&"wrapperVertical"]},mG,l)},xG=Bt("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.absolute&&t.absolute,t[r.variant],r.light&&t.light,r.orientation==="vertical"&&t.vertical,r.flexItem&&t.flexItem,r.children&&t.withChildren,r.children&&r.orientation==="vertical"&&t.withChildrenVertical,r.textAlign==="right"&&r.orientation!=="vertical"&&t.textAlignRight,r.textAlign==="left"&&r.orientation!=="vertical"&&t.textAlignLeft]}})(({theme:e,ownerState:t})=>ce({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(e.vars||e).palette.divider,borderBottomWidth:"thin"},t.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},t.light&&{borderColor:e.vars?`rgba(${e.vars.palette.dividerChannel} / 0.08)`:sr(e.palette.divider,.08)},t.variant==="inset"&&{marginLeft:72},t.variant==="middle"&&t.orientation==="horizontal"&&{marginLeft:e.spacing(2),marginRight:e.spacing(2)},t.variant==="middle"&&t.orientation==="vertical"&&{marginTop:e.spacing(1),marginBottom:e.spacing(1)},t.orientation==="vertical"&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},t.flexItem&&{alignSelf:"stretch",height:"auto"}),({ownerState:e})=>ce({},e.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}),({theme:e,ownerState:t})=>ce({},t.children&&t.orientation!=="vertical"&&{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(e.vars||e).palette.divider}`,borderTopStyle:"inherit"}}),({theme:e,ownerState:t})=>ce({},t.children&&t.orientation==="vertical"&&{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(e.vars||e).palette.divider}`,borderLeftStyle:"inherit"}}),({ownerState:e})=>ce({},e.textAlign==="right"&&e.orientation!=="vertical"&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},e.textAlign==="left"&&e.orientation!=="vertical"&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})),vG=Bt("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.wrapper,r.orientation==="vertical"&&t.wrapperVertical]}})(({theme:e,ownerState:t})=>ce({display:"inline-block",paddingLeft:`calc(${e.spacing(1)} * 1.2)`,paddingRight:`calc(${e.spacing(1)} * 1.2)`},t.orientation==="vertical"&&{paddingTop:`calc(${e.spacing(1)} * 1.2)`,paddingBottom:`calc(${e.spacing(1)} * 1.2)`})),vL=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiDivider"}),{absolute:h=!1,children:m,className:x,component:a=m?"div":"hr",flexItem:E=!1,light:I=!1,orientation:L="horizontal",role:O=a!=="hr"?"separator":void 0,textAlign:F="center",variant:K="fullWidth"}=l,W=Dt(l,yG),G=ce({},l,{absolute:h,component:a,flexItem:E,light:I,orientation:L,role:O,textAlign:F,variant:K}),ne=_G(G);return D.jsx(xG,ce({as:a,className:Wt(ne.root,x),role:O,ref:r,ownerState:G},W,{children:m?D.jsx(vG,{className:ne.wrapper,ownerState:G,children:m}):null}))});vL.muiSkipListHighlight=!0;const XS=vL,bG=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],wG=e=>{const{classes:t,disableUnderline:r}=e,h=bn({root:["root",!r&&"underline"],input:["input"]},Y7,t);return ce({},t,h)},SG=Bt(Hx,{shouldForwardProp:e=>xs(e)||e==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[...Gx(e,t),!r.disableUnderline&&t.underline]}})(({theme:e,ownerState:t})=>{var r;const l=e.palette.mode==="light",h=l?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",m=l?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",x=l?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",a=l?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return ce({position:"relative",backgroundColor:e.vars?e.vars.palette.FilledInput.bg:m,borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:e.vars?e.vars.palette.FilledInput.hoverBg:x,"@media (hover: none)":{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:m}},[`&.${eu.focused}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:m},[`&.${eu.disabled}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.disabledBg:a}},!t.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(r=(e.vars||e).palette[t.color||"primary"])==null?void 0:r.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${eu.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${eu.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`:h}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${eu.disabled}, .${eu.error}):before`]:{borderBottom:`1px solid ${(e.vars||e).palette.text.primary}`},[`&.${eu.disabled}:before`]:{borderBottomStyle:"dotted"}},t.startAdornment&&{paddingLeft:12},t.endAdornment&&{paddingRight:12},t.multiline&&ce({padding:"25px 12px 8px"},t.size==="small"&&{paddingTop:21,paddingBottom:4},t.hiddenLabel&&{paddingTop:16,paddingBottom:17},t.hiddenLabel&&t.size==="small"&&{paddingTop:8,paddingBottom:9}))}),EG=Bt(Zx,{name:"MuiFilledInput",slot:"Input",overridesResolver:qx})(({theme:e,ownerState:t})=>ce({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},e.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},t.size==="small"&&{paddingTop:21,paddingBottom:4},t.hiddenLabel&&{paddingTop:16,paddingBottom:17},t.startAdornment&&{paddingLeft:0},t.endAdornment&&{paddingRight:0},t.hiddenLabel&&t.size==="small"&&{paddingTop:8,paddingBottom:9},t.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})),bL=J.forwardRef(function(t,r){var l,h,m,x;const a=_n({props:t,name:"MuiFilledInput"}),{components:E={},componentsProps:I,fullWidth:L=!1,inputComponent:O="input",multiline:F=!1,slotProps:K,slots:W={},type:G="text"}=a,ne=Dt(a,bG),Z=ce({},a,{fullWidth:L,inputComponent:O,multiline:F,type:G}),H=wG(a),V={root:{ownerState:Z},input:{ownerState:Z}},oe=K??I?jo(V,K??I):V,pe=(l=(h=W.root)!=null?h:E.Root)!=null?l:SG,_e=(m=(x=W.input)!=null?x:E.Input)!=null?m:EG;return D.jsx(HS,ce({slots:{root:pe,input:_e},componentsProps:oe,fullWidth:L,inputComponent:O,multiline:F,ref:r,type:G},ne,{classes:H}))});bL.muiName="Input";const wL=bL;function TG(e){return yn("MuiFormControl",e)}mn("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const CG=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],kG=e=>{const{classes:t,margin:r,fullWidth:l}=e,h={root:["root",r!=="none"&&`margin${Ct(r)}`,l&&"fullWidth"]};return bn(h,TG,t)},IG=Bt("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:e},t)=>ce({},t.root,t[`margin${Ct(e.margin)}`],e.fullWidth&&t.fullWidth)})(({ownerState:e})=>ce({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},e.margin==="normal"&&{marginTop:16,marginBottom:8},e.margin==="dense"&&{marginTop:8,marginBottom:4},e.fullWidth&&{width:"100%"})),AG=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiFormControl"}),{children:h,className:m,color:x="primary",component:a="div",disabled:E=!1,error:I=!1,focused:L,fullWidth:O=!1,hiddenLabel:F=!1,margin:K="none",required:W=!1,size:G="medium",variant:ne="outlined"}=l,Z=Dt(l,CG),H=ce({},l,{color:x,component:a,disabled:E,error:I,fullWidth:O,hiddenLabel:F,margin:K,required:W,size:G,variant:ne}),V=kG(H),[oe,pe]=J.useState(()=>{let et=!1;return h&&J.Children.forEach(h,lt=>{if(!E_(lt,["Input","Select"]))return;const gt=E_(lt,["Select"])?lt.props.input:lt;gt&&N7(gt.props)&&(et=!0)}),et}),[_e,xe]=J.useState(()=>{let et=!1;return h&&J.Children.forEach(h,lt=>{E_(lt,["Input","Select"])&&(_0(lt.props,!0)||_0(lt.props.inputProps,!0))&&(et=!0)}),et}),[De,ye]=J.useState(!1);E&&De&&ye(!1);const Ae=L!==void 0&&!E?L:De;let ft;const Ge=J.useMemo(()=>({adornedStart:oe,setAdornedStart:pe,color:x,disabled:E,error:I,filled:_e,focused:Ae,fullWidth:O,hiddenLabel:F,size:G,onBlur:()=>{ye(!1)},onEmpty:()=>{xe(!1)},onFilled:()=>{xe(!0)},onFocus:()=>{ye(!0)},registerEffect:ft,required:W,variant:ne}),[oe,x,E,I,_e,Ae,O,F,ft,W,G,ne]);return D.jsx(qS.Provider,{value:Ge,children:D.jsx(IG,ce({as:a,ownerState:H,className:Wt(V.root,m),ref:r},Z,{children:h}))})}),x0=AG;function MG(e){return yn("MuiFormHelperText",e)}const PG=mn("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),RA=PG;var zA;const RG=["children","className","component","disabled","error","filled","focused","margin","required","variant"],zG=e=>{const{classes:t,contained:r,size:l,disabled:h,error:m,filled:x,focused:a,required:E}=e,I={root:["root",h&&"disabled",m&&"error",l&&`size${Ct(l)}`,r&&"contained",a&&"focused",x&&"filled",E&&"required"]};return bn(I,MG,t)},LG=Bt("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.size&&t[`size${Ct(r.size)}`],r.contained&&t.contained,r.filled&&t.filled]}})(({theme:e,ownerState:t})=>ce({color:(e.vars||e).palette.text.secondary},e.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${RA.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${RA.error}`]:{color:(e.vars||e).palette.error.main}},t.size==="small"&&{marginTop:4},t.contained&&{marginLeft:14,marginRight:14})),DG=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiFormHelperText"}),{children:h,className:m,component:x="p"}=l,a=Dt(l,RG),E=Nh(),I=jh({props:l,muiFormControl:E,states:["variant","size","disabled","error","filled","focused","required"]}),L=ce({},l,{component:x,contained:I.variant==="filled"||I.variant==="outlined",variant:I.variant,size:I.size,disabled:I.disabled,error:I.error,filled:I.filled,focused:I.focused,required:I.required}),O=zG(L);return D.jsx(LG,ce({as:x,ownerState:L,className:Wt(O.root,m),ref:r},a,{children:h===" "?zA||(zA=D.jsx("span",{className:"notranslate",children:""})):h}))}),OG=DG;function BG(e){return yn("MuiFormLabel",e)}const FG=mn("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),sm=FG,jG=["children","className","color","component","disabled","error","filled","focused","required"],NG=e=>{const{classes:t,color:r,focused:l,disabled:h,error:m,filled:x,required:a}=e,E={root:["root",`color${Ct(r)}`,h&&"disabled",m&&"error",x&&"filled",l&&"focused",a&&"required"],asterisk:["asterisk",m&&"error"]};return bn(E,BG,t)},$G=Bt("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:e},t)=>ce({},t.root,e.color==="secondary"&&t.colorSecondary,e.filled&&t.filled)})(({theme:e,ownerState:t})=>ce({color:(e.vars||e).palette.text.secondary},e.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${sm.focused}`]:{color:(e.vars||e).palette[t.color].main},[`&.${sm.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${sm.error}`]:{color:(e.vars||e).palette.error.main}})),UG=Bt("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})(({theme:e})=>({[`&.${sm.error}`]:{color:(e.vars||e).palette.error.main}})),VG=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiFormLabel"}),{children:h,className:m,component:x="label"}=l,a=Dt(l,jG),E=Nh(),I=jh({props:l,muiFormControl:E,states:["color","required","focused","disabled","error","filled"]}),L=ce({},l,{color:I.color||"primary",component:x,disabled:I.disabled,error:I.error,filled:I.filled,focused:I.focused,required:I.required}),O=NG(L);return D.jsxs($G,ce({as:x,ownerState:L,className:Wt(O.root,m),ref:r},a,{children:[h,I.required&&D.jsxs(UG,{ownerState:L,"aria-hidden":!0,className:O.asterisk,children:["","*"]})]}))}),WG=VG,GG=J.createContext(),LA=GG;function qG(e){return yn("MuiGrid",e)}const HG=[0,1,2,3,4,5,6,7,8,9,10],ZG=["column-reverse","column","row-reverse","row"],XG=["nowrap","wrap-reverse","wrap"],Rf=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],KG=mn("MuiGrid",["root","container","item","zeroMinWidth",...HG.map(e=>`spacing-xs-${e}`),...ZG.map(e=>`direction-xs-${e}`),...XG.map(e=>`wrap-xs-${e}`),...Rf.map(e=>`grid-xs-${e}`),...Rf.map(e=>`grid-sm-${e}`),...Rf.map(e=>`grid-md-${e}`),...Rf.map(e=>`grid-lg-${e}`),...Rf.map(e=>`grid-xl-${e}`)]),Bm=KG,YG=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function ah(e){const t=parseFloat(e);return`${t}${String(e).replace(String(t),"")||"px"}`}function JG({theme:e,ownerState:t}){let r;return e.breakpoints.keys.reduce((l,h)=>{let m={};if(t[h]&&(r=t[h]),!r)return l;if(r===!0)m={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if(r==="auto")m={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const x=wx({values:t.columns,breakpoints:e.breakpoints.values}),a=typeof x=="object"?x[h]:x;if(a==null)return l;const E=`${Math.round(r/a*1e8)/1e6}%`;let I={};if(t.container&&t.item&&t.columnSpacing!==0){const L=e.spacing(t.columnSpacing);if(L!=="0px"){const O=`calc(${E} + ${ah(L)})`;I={flexBasis:O,maxWidth:O}}}m=ce({flexBasis:E,flexGrow:0,maxWidth:E},I)}return e.breakpoints.values[h]===0?Object.assign(l,m):l[e.breakpoints.up(h)]=m,l},{})}function QG({theme:e,ownerState:t}){const r=wx({values:t.direction,breakpoints:e.breakpoints.values});return fs({theme:e},r,l=>{const h={flexDirection:l};return l.indexOf("column")===0&&(h[`& > .${Bm.item}`]={maxWidth:"none"}),h})}function SL({breakpoints:e,values:t}){let r="";Object.keys(t).forEach(h=>{r===""&&t[h]!==0&&(r=h)});const l=Object.keys(e).sort((h,m)=>e[h]-e[m]);return l.slice(0,l.indexOf(r))}function eq({theme:e,ownerState:t}){const{container:r,rowSpacing:l}=t;let h={};if(r&&l!==0){const m=wx({values:l,breakpoints:e.breakpoints.values});let x;typeof m=="object"&&(x=SL({breakpoints:e.breakpoints.values,values:m})),h=fs({theme:e},m,(a,E)=>{var I;const L=e.spacing(a);return L!=="0px"?{marginTop:`-${ah(L)}`,[`& > .${Bm.item}`]:{paddingTop:ah(L)}}:(I=x)!=null&&I.includes(E)?{}:{marginTop:0,[`& > .${Bm.item}`]:{paddingTop:0}}})}return h}function tq({theme:e,ownerState:t}){const{container:r,columnSpacing:l}=t;let h={};if(r&&l!==0){const m=wx({values:l,breakpoints:e.breakpoints.values});let x;typeof m=="object"&&(x=SL({breakpoints:e.breakpoints.values,values:m})),h=fs({theme:e},m,(a,E)=>{var I;const L=e.spacing(a);return L!=="0px"?{width:`calc(100% + ${ah(L)})`,marginLeft:`-${ah(L)}`,[`& > .${Bm.item}`]:{paddingLeft:ah(L)}}:(I=x)!=null&&I.includes(E)?{}:{width:"100%",marginLeft:0,[`& > .${Bm.item}`]:{paddingLeft:0}}})}return h}function nq(e,t,r={}){if(!e||e<=0)return[];if(typeof e=="string"&&!Number.isNaN(Number(e))||typeof e=="number")return[r[`spacing-xs-${String(e)}`]];const l=[];return t.forEach(h=>{const m=e[h];Number(m)>0&&l.push(r[`spacing-${h}-${String(m)}`])}),l}const rq=Bt("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e,{container:l,direction:h,item:m,spacing:x,wrap:a,zeroMinWidth:E,breakpoints:I}=r;let L=[];l&&(L=nq(x,I,t));const O=[];return I.forEach(F=>{const K=r[F];K&&O.push(t[`grid-${F}-${String(K)}`])}),[t.root,l&&t.container,m&&t.item,E&&t.zeroMinWidth,...L,h!=="row"&&t[`direction-xs-${String(h)}`],a!=="wrap"&&t[`wrap-xs-${String(a)}`],...O]}})(({ownerState:e})=>ce({boxSizing:"border-box"},e.container&&{display:"flex",flexWrap:"wrap",width:"100%"},e.item&&{margin:0},e.zeroMinWidth&&{minWidth:0},e.wrap!=="wrap"&&{flexWrap:e.wrap}),QG,eq,tq,JG);function iq(e,t){if(!e||e<=0)return[];if(typeof e=="string"&&!Number.isNaN(Number(e))||typeof e=="number")return[`spacing-xs-${String(e)}`];const r=[];return t.forEach(l=>{const h=e[l];if(Number(h)>0){const m=`spacing-${l}-${String(h)}`;r.push(m)}}),r}const oq=e=>{const{classes:t,container:r,direction:l,item:h,spacing:m,wrap:x,zeroMinWidth:a,breakpoints:E}=e;let I=[];r&&(I=iq(m,E));const L=[];E.forEach(F=>{const K=e[F];K&&L.push(`grid-${F}-${String(K)}`)});const O={root:["root",r&&"container",h&&"item",a&&"zeroMinWidth",...I,l!=="row"&&`direction-xs-${String(l)}`,x!=="wrap"&&`wrap-xs-${String(x)}`,...L]};return bn(O,qG,t)},sq=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiGrid"}),{breakpoints:h}=Vx(),m=Mx(l),{className:x,columns:a,columnSpacing:E,component:I="div",container:L=!1,direction:O="row",item:F=!1,rowSpacing:K,spacing:W=0,wrap:G="wrap",zeroMinWidth:ne=!1}=m,Z=Dt(m,YG),H=K||W,V=E||W,oe=J.useContext(LA),pe=L?a||12:oe,_e={},xe=ce({},Z);h.keys.forEach(Ae=>{Z[Ae]!=null&&(_e[Ae]=Z[Ae],delete xe[Ae])});const De=ce({},m,{columns:pe,container:L,direction:O,item:F,rowSpacing:H,columnSpacing:V,wrap:G,zeroMinWidth:ne,spacing:W},_e,{breakpoints:h.keys}),ye=oq(De);return D.jsx(LA.Provider,{value:pe,children:D.jsx(rq,ce({ownerState:De,className:Wt(ye.root,x),as:I,ref:r},xe))})}),er=sq,aq=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function t2(e){return`scale(${e}, ${e**2})`}const lq={entering:{opacity:1,transform:t2(1)},entered:{opacity:1,transform:"none"}},kb=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),EL=J.forwardRef(function(t,r){const{addEndListener:l,appear:h=!0,children:m,easing:x,in:a,onEnter:E,onEntered:I,onEntering:L,onExit:O,onExited:F,onExiting:K,style:W,timeout:G="auto",TransitionComponent:ne=yL}=t,Z=Dt(t,aq),H=Hz(),V=J.useRef(),oe=Vx(),pe=J.useRef(null),_e=_i(pe,tg(m),r),xe=gt=>St=>{if(gt){const It=pe.current;St===void 0?gt(It):gt(It,St)}},De=xe(L),ye=xe((gt,St)=>{_L(gt);const{duration:It,delay:Re,easing:ct}=y0({style:W,timeout:G,easing:x},{mode:"enter"});let Ie;G==="auto"?(Ie=oe.transitions.getAutoHeightDuration(gt.clientHeight),V.current=Ie):Ie=It,gt.style.transition=[oe.transitions.create("opacity",{duration:Ie,delay:Re}),oe.transitions.create("transform",{duration:kb?Ie:Ie*.666,delay:Re,easing:ct})].join(","),E&&E(gt,St)}),Ae=xe(I),ft=xe(K),Ge=xe(gt=>{const{duration:St,delay:It,easing:Re}=y0({style:W,timeout:G,easing:x},{mode:"exit"});let ct;G==="auto"?(ct=oe.transitions.getAutoHeightDuration(gt.clientHeight),V.current=ct):ct=St,gt.style.transition=[oe.transitions.create("opacity",{duration:ct,delay:It}),oe.transitions.create("transform",{duration:kb?ct:ct*.666,delay:kb?It:It||ct*.333,easing:Re})].join(","),gt.style.opacity=0,gt.style.transform=t2(.75),O&&O(gt)}),et=xe(F),lt=gt=>{G==="auto"&&H.start(V.current||0,gt),l&&l(pe.current,gt)};return D.jsx(ne,ce({appear:h,in:a,nodeRef:pe,onEnter:ye,onEntered:Ae,onEntering:De,onExit:Ge,onExited:et,onExiting:ft,addEndListener:lt,timeout:G==="auto"?null:G},Z,{children:(gt,St)=>J.cloneElement(m,ce({style:ce({opacity:0,transform:t2(.75),visibility:gt==="exited"&&!a?"hidden":void 0},lq[gt],W,m.props.style),ref:_e},St))}))});EL.muiSupportAuto=!0;const cq=EL,uq=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],dq=e=>{const{classes:t,disableUnderline:r}=e,h=bn({root:["root",!r&&"underline"],input:["input"]},H7,t);return ce({},t,h)},hq=Bt(Hx,{shouldForwardProp:e=>xs(e)||e==="classes",name:"MuiInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[...Gx(e,t),!r.disableUnderline&&t.underline]}})(({theme:e,ownerState:t})=>{let l=e.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return e.vars&&(l=`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`),ce({position:"relative"},t.formControl&&{"label + &":{marginTop:16}},!t.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[t.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Pf.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Pf.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${l}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Pf.disabled}, .${Pf.error}):before`]:{borderBottom:`2px solid ${(e.vars||e).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${l}`}},[`&.${Pf.disabled}:before`]:{borderBottomStyle:"dotted"}})}),pq=Bt(Zx,{name:"MuiInput",slot:"Input",overridesResolver:qx})({}),TL=J.forwardRef(function(t,r){var l,h,m,x;const a=_n({props:t,name:"MuiInput"}),{disableUnderline:E,components:I={},componentsProps:L,fullWidth:O=!1,inputComponent:F="input",multiline:K=!1,slotProps:W,slots:G={},type:ne="text"}=a,Z=Dt(a,uq),H=dq(a),oe={root:{ownerState:{disableUnderline:E}}},pe=W??L?jo(W??L,oe):oe,_e=(l=(h=G.root)!=null?h:I.Root)!=null?l:hq,xe=(m=(x=G.input)!=null?x:I.Input)!=null?m:pq;return D.jsx(HS,ce({slots:{root:_e,input:xe},slotProps:pe,fullWidth:O,inputComponent:F,multiline:K,ref:r,type:ne},Z,{classes:H}))});TL.muiName="Input";const CL=TL;function fq(e){return yn("MuiInputLabel",e)}mn("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const mq=["disableAnimation","margin","shrink","variant","className"],gq=e=>{const{classes:t,formControl:r,size:l,shrink:h,disableAnimation:m,variant:x,required:a}=e,E={root:["root",r&&"formControl",!m&&"animated",h&&"shrink",l&&l!=="normal"&&`size${Ct(l)}`,x],asterisk:[a&&"asterisk"]},I=bn(E,fq,t);return ce({},t,I)},yq=Bt(WG,{shouldForwardProp:e=>xs(e)||e==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{[`& .${sm.asterisk}`]:t.asterisk},t.root,r.formControl&&t.formControl,r.size==="small"&&t.sizeSmall,r.shrink&&t.shrink,!r.disableAnimation&&t.animated,r.focused&&t.focused,t[r.variant]]}})(({theme:e,ownerState:t})=>ce({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},t.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},t.size==="small"&&{transform:"translate(0, 17px) scale(1)"},t.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!t.disableAnimation&&{transition:e.transitions.create(["color","transform","max-width"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut})},t.variant==="filled"&&ce({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},t.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},t.shrink&&ce({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},t.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),t.variant==="outlined"&&ce({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},t.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},t.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),_q=J.forwardRef(function(t,r){const l=_n({name:"MuiInputLabel",props:t}),{disableAnimation:h=!1,shrink:m,className:x}=l,a=Dt(l,mq),E=Nh();let I=m;typeof I>"u"&&E&&(I=E.filled||E.focused||E.adornedStart);const L=jh({props:l,muiFormControl:E,states:["size","variant","required","focused"]}),O=ce({},l,{disableAnimation:h,formControl:E,shrink:I,size:L.size,variant:L.variant,required:L.required,focused:L.focused}),F=gq(O);return D.jsx(yq,ce({"data-shrink":I,ownerState:O,ref:r,className:Wt(F.root,x)},a,{classes:F}))}),v0=_q;function xq(e){return yn("MuiLink",e)}const vq=mn("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),bq=vq,kL={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},wq=e=>kL[e]||e,Sq=({theme:e,ownerState:t})=>{const r=wq(t.color),l=bh(e,`palette.${r}`,!1)||t.color,h=bh(e,`palette.${r}Channel`);return"vars"in e&&h?`rgba(${h} / 0.4)`:sr(l,.4)},Eq=Sq,Tq=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],Cq=e=>{const{classes:t,component:r,focusVisible:l,underline:h}=e,m={root:["root",`underline${Ct(h)}`,r==="button"&&"button",l&&"focusVisible"]};return bn(m,xq,t)},kq=Bt(yt,{name:"MuiLink",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[`underline${Ct(r.underline)}`],r.component==="button"&&t.button]}})(({theme:e,ownerState:t})=>ce({},t.underline==="none"&&{textDecoration:"none"},t.underline==="hover"&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},t.underline==="always"&&ce({textDecoration:"underline"},t.color!=="inherit"&&{textDecorationColor:Eq({theme:e,ownerState:t})},{"&:hover":{textDecorationColor:"inherit"}}),t.component==="button"&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${bq.focusVisible}`]:{outline:"auto"}})),Iq=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiLink"}),{className:h,color:m="primary",component:x="a",onBlur:a,onFocus:E,TypographyClasses:I,underline:L="always",variant:O="inherit",sx:F}=l,K=Dt(l,Tq),{isFocusVisibleRef:W,onBlur:G,onFocus:ne,ref:Z}=Zz(),[H,V]=J.useState(!1),oe=_i(r,Z),pe=ye=>{G(ye),W.current===!1&&V(!1),a&&a(ye)},_e=ye=>{ne(ye),W.current===!0&&V(!0),E&&E(ye)},xe=ce({},l,{color:m,component:x,focusVisible:H,underline:L,variant:O}),De=Cq(xe);return D.jsx(kq,ce({color:m,className:Wt(De.root,h),classes:I,component:x,onBlur:pe,onFocus:_e,ref:oe,ownerState:xe,variant:O,sx:[...Object.keys(kL).includes(m)?[]:[{color:m}],...Array.isArray(F)?F:[F]]},K))}),tu=Iq,Aq=J.createContext({}),Ha=Aq;function Mq(e){return yn("MuiList",e)}mn("MuiList",["root","padding","dense","subheader"]);const Pq=["children","className","component","dense","disablePadding","subheader"],Rq=e=>{const{classes:t,disablePadding:r,dense:l,subheader:h}=e;return bn({root:["root",!r&&"padding",l&&"dense",h&&"subheader"]},Mq,t)},zq=Bt("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.disablePadding&&t.padding,r.dense&&t.dense,r.subheader&&t.subheader]}})(({ownerState:e})=>ce({listStyle:"none",margin:0,padding:0,position:"relative"},!e.disablePadding&&{paddingTop:8,paddingBottom:8},e.subheader&&{paddingTop:0})),Lq=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiList"}),{children:h,className:m,component:x="ul",dense:a=!1,disablePadding:E=!1,subheader:I}=l,L=Dt(l,Pq),O=J.useMemo(()=>({dense:a}),[a]),F=ce({},l,{component:x,dense:a,disablePadding:E}),K=Rq(F);return D.jsx(Ha.Provider,{value:O,children:D.jsxs(zq,ce({as:x,className:Wt(K.root,m),ref:r,ownerState:F},L,{children:[I,h]}))})}),Tu=Lq;function Dq(e){return yn("MuiListItem",e)}const Oq=mn("MuiListItem",["root","container","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","padding","button","secondaryAction","selected"]),Bd=Oq,Bq=mn("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]),Fq=Bq;function jq(e){return yn("MuiListItemSecondaryAction",e)}mn("MuiListItemSecondaryAction",["root","disableGutters"]);const Nq=["className"],$q=e=>{const{disableGutters:t,classes:r}=e;return bn({root:["root",t&&"disableGutters"]},jq,r)},Uq=Bt("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.disableGutters&&t.disableGutters]}})(({ownerState:e})=>ce({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)"},e.disableGutters&&{right:0})),IL=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiListItemSecondaryAction"}),{className:h}=l,m=Dt(l,Nq),x=J.useContext(Ha),a=ce({},l,{disableGutters:x.disableGutters}),E=$q(a);return D.jsx(Uq,ce({className:Wt(E.root,h),ownerState:a,ref:r},m))});IL.muiName="ListItemSecondaryAction";const Vq=IL,Wq=["className"],Gq=["alignItems","autoFocus","button","children","className","component","components","componentsProps","ContainerComponent","ContainerProps","dense","disabled","disableGutters","disablePadding","divider","focusVisibleClassName","secondaryAction","selected","slotProps","slots"],qq=(e,t)=>{const{ownerState:r}=e;return[t.root,r.dense&&t.dense,r.alignItems==="flex-start"&&t.alignItemsFlexStart,r.divider&&t.divider,!r.disableGutters&&t.gutters,!r.disablePadding&&t.padding,r.button&&t.button,r.hasSecondaryAction&&t.secondaryAction]},Hq=e=>{const{alignItems:t,button:r,classes:l,dense:h,disabled:m,disableGutters:x,disablePadding:a,divider:E,hasSecondaryAction:I,selected:L}=e;return bn({root:["root",h&&"dense",!x&&"gutters",!a&&"padding",E&&"divider",m&&"disabled",r&&"button",t==="flex-start"&&"alignItemsFlexStart",I&&"secondaryAction",L&&"selected"],container:["container"]},Dq,l)},Zq=Bt("div",{name:"MuiListItem",slot:"Root",overridesResolver:qq})(({theme:e,ownerState:t})=>ce({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left"},!t.disablePadding&&ce({paddingTop:8,paddingBottom:8},t.dense&&{paddingTop:4,paddingBottom:4},!t.disableGutters&&{paddingLeft:16,paddingRight:16},!!t.secondaryAction&&{paddingRight:48}),!!t.secondaryAction&&{[`& > .${Fq.root}`]:{paddingRight:48}},{[`&.${Bd.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${Bd.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:sr(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${Bd.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:sr(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${Bd.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},t.alignItems==="flex-start"&&{alignItems:"flex-start"},t.divider&&{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"},t.button&&{transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Bd.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:sr(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:sr(e.palette.primary.main,e.palette.action.selectedOpacity)}}},t.hasSecondaryAction&&{paddingRight:48})),Xq=Bt("li",{name:"MuiListItem",slot:"Container",overridesResolver:(e,t)=>t.container})({position:"relative"}),Kq=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiListItem"}),{alignItems:h="center",autoFocus:m=!1,button:x=!1,children:a,className:E,component:I,components:L={},componentsProps:O={},ContainerComponent:F="li",ContainerProps:{className:K}={},dense:W=!1,disabled:G=!1,disableGutters:ne=!1,disablePadding:Z=!1,divider:H=!1,focusVisibleClassName:V,secondaryAction:oe,selected:pe=!1,slotProps:_e={},slots:xe={}}=l,De=Dt(l.ContainerProps,Wq),ye=Dt(l,Gq),Ae=J.useContext(Ha),ft=J.useMemo(()=>({dense:W||Ae.dense||!1,alignItems:h,disableGutters:ne}),[h,Ae.dense,W,ne]),Ge=J.useRef(null);Ys(()=>{m&&Ge.current&&Ge.current.focus()},[m]);const et=J.Children.toArray(a),lt=et.length&&E_(et[et.length-1],["ListItemSecondaryAction"]),gt=ce({},l,{alignItems:h,autoFocus:m,button:x,dense:ft.dense,disabled:G,disableGutters:ne,disablePadding:Z,divider:H,hasSecondaryAction:lt,selected:pe}),St=Hq(gt),It=_i(Ge,r),Re=xe.root||L.Root||Zq,ct=_e.root||O.root||{},Ie=ce({className:Wt(St.root,ct.className,E),disabled:G},ye);let st=I||"li";return x&&(Ie.component=I||"div",Ie.focusVisibleClassName=Wt(Bd.focusVisible,V),st=Eh),lt?(st=!Ie.component&&!I?"div":st,F==="li"&&(st==="li"?st="div":Ie.component==="li"&&(Ie.component="div")),D.jsx(Ha.Provider,{value:ft,children:D.jsxs(Xq,ce({as:F,className:Wt(St.container,K),ref:It,ownerState:gt},De,{children:[D.jsx(Re,ce({},ct,!wh(Re)&&{as:st,ownerState:ce({},gt,ct.ownerState)},Ie,{children:et})),et.pop()]}))})):D.jsx(Ha.Provider,{value:ft,children:D.jsxs(Re,ce({},ct,{as:st,ref:It},!wh(Re)&&{ownerState:ce({},gt,ct.ownerState)},Ie,{children:[et,oe&&D.jsx(Vq,{children:oe})]}))})}),Ga=Kq;function Yq(e){return yn("MuiListItemIcon",e)}const Jq=mn("MuiListItemIcon",["root","alignItemsFlexStart"]),DA=Jq,Qq=["className"],eH=e=>{const{alignItems:t,classes:r}=e;return bn({root:["root",t==="flex-start"&&"alignItemsFlexStart"]},Yq,r)},tH=Bt("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.alignItems==="flex-start"&&t.alignItemsFlexStart]}})(({theme:e,ownerState:t})=>ce({minWidth:56,color:(e.vars||e).palette.action.active,flexShrink:0,display:"inline-flex"},t.alignItems==="flex-start"&&{marginTop:8})),nH=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiListItemIcon"}),{className:h}=l,m=Dt(l,Qq),x=J.useContext(Ha),a=ce({},l,{alignItems:x.alignItems}),E=eH(a);return D.jsx(tH,ce({className:Wt(E.root,h),ownerState:a,ref:r},m))}),Wf=nH;function rH(e){return yn("MuiListItemText",e)}const iH=mn("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),b0=iH,oH=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],sH=e=>{const{classes:t,inset:r,primary:l,secondary:h,dense:m}=e;return bn({root:["root",r&&"inset",m&&"dense",l&&h&&"multiline"],primary:["primary"],secondary:["secondary"]},rH,t)},aH=Bt("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{[`& .${b0.primary}`]:t.primary},{[`& .${b0.secondary}`]:t.secondary},t.root,r.inset&&t.inset,r.primary&&r.secondary&&t.multiline,r.dense&&t.dense]}})(({ownerState:e})=>ce({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},e.primary&&e.secondary&&{marginTop:6,marginBottom:6},e.inset&&{paddingLeft:56})),lH=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiListItemText"}),{children:h,className:m,disableTypography:x=!1,inset:a=!1,primary:E,primaryTypographyProps:I,secondary:L,secondaryTypographyProps:O}=l,F=Dt(l,oH),{dense:K}=J.useContext(Ha);let W=E??h,G=L;const ne=ce({},l,{disableTypography:x,inset:a,primary:!!W,secondary:!!G,dense:K}),Z=sH(ne);return W!=null&&W.type!==yt&&!x&&(W=D.jsx(yt,ce({variant:K?"body2":"body1",className:Z.primary,component:I!=null&&I.variant?void 0:"span",display:"block"},I,{children:W}))),G!=null&&G.type!==yt&&!x&&(G=D.jsx(yt,ce({variant:"body2",className:Z.secondary,color:"text.secondary",display:"block"},O,{children:G}))),D.jsxs(aH,ce({className:Wt(Z.root,m),ownerState:ne,ref:r},F,{children:[W,G]}))}),pu=lH,cH=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function Ib(e,t,r){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:r?null:e.firstChild}function OA(e,t,r){return e===t?r?e.firstChild:e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:r?null:e.lastChild}function AL(e,t){if(t===void 0)return!0;let r=e.innerText;return r===void 0&&(r=e.textContent),r=r.trim().toLowerCase(),r.length===0?!1:t.repeating?r[0]===t.keys[0]:r.indexOf(t.keys.join(""))===0}function zf(e,t,r,l,h,m){let x=!1,a=h(e,t,t?r:!1);for(;a;){if(a===e.firstChild){if(x)return!1;x=!0}const E=l?!1:a.disabled||a.getAttribute("aria-disabled")==="true";if(!a.hasAttribute("tabindex")||!AL(a,m)||E)a=h(e,a,r);else return a.focus(),!0}return!1}const uH=J.forwardRef(function(t,r){const{actions:l,autoFocus:h=!1,autoFocusItem:m=!1,children:x,className:a,disabledItemsFocusable:E=!1,disableListWrap:I=!1,onKeyDown:L,variant:O="selectedMenu"}=t,F=Dt(t,cH),K=J.useRef(null),W=J.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Ys(()=>{h&&K.current.focus()},[h]),J.useImperativeHandle(l,()=>({adjustStyleForScrollbar:(V,{direction:oe})=>{const pe=!K.current.style.width;if(V.clientHeight<K.current.clientHeight&&pe){const _e=`${Xz(No(V))}px`;K.current.style[oe==="rtl"?"paddingLeft":"paddingRight"]=_e,K.current.style.width=`calc(100% + ${_e})`}return K.current}}),[]);const G=V=>{const oe=K.current,pe=V.key,_e=No(oe).activeElement;if(pe==="ArrowDown")V.preventDefault(),zf(oe,_e,I,E,Ib);else if(pe==="ArrowUp")V.preventDefault(),zf(oe,_e,I,E,OA);else if(pe==="Home")V.preventDefault(),zf(oe,null,I,E,Ib);else if(pe==="End")V.preventDefault(),zf(oe,null,I,E,OA);else if(pe.length===1){const xe=W.current,De=pe.toLowerCase(),ye=performance.now();xe.keys.length>0&&(ye-xe.lastTime>500?(xe.keys=[],xe.repeating=!0,xe.previousKeyMatched=!0):xe.repeating&&De!==xe.keys[0]&&(xe.repeating=!1)),xe.lastTime=ye,xe.keys.push(De);const Ae=_e&&!xe.repeating&&AL(_e,xe);xe.previousKeyMatched&&(Ae||zf(oe,_e,!1,E,Ib,xe))?V.preventDefault():xe.previousKeyMatched=!1}L&&L(V)},ne=_i(K,r);let Z=-1;J.Children.forEach(x,(V,oe)=>{if(!J.isValidElement(V)){Z===oe&&(Z+=1,Z>=x.length&&(Z=-1));return}V.props.disabled||(O==="selectedMenu"&&V.props.selected||Z===-1)&&(Z=oe),Z===oe&&(V.props.disabled||V.props.muiSkipListHighlight||V.type.muiSkipListHighlight)&&(Z+=1,Z>=x.length&&(Z=-1))});const H=J.Children.map(x,(V,oe)=>{if(oe===Z){const pe={};return m&&(pe.autoFocus=!0),V.props.tabIndex===void 0&&O==="selectedMenu"&&(pe.tabIndex=0),J.cloneElement(V,pe)}return V});return D.jsx(Tu,ce({role:"menu",ref:ne,className:a,onKeyDown:G,tabIndex:h?0:-1},F,{children:H}))}),dH=uH;function hH(e){return yn("MuiPopover",e)}mn("MuiPopover",["root","paper"]);const pH=["onEntering"],fH=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],mH=["slotProps"];function BA(e,t){let r=0;return typeof t=="number"?r=t:t==="center"?r=e.height/2:t==="bottom"&&(r=e.height),r}function FA(e,t){let r=0;return typeof t=="number"?r=t:t==="center"?r=e.width/2:t==="right"&&(r=e.width),r}function jA(e){return[e.horizontal,e.vertical].map(t=>typeof t=="number"?`${t}px`:t).join(" ")}function Ab(e){return typeof e=="function"?e():e}const gH=e=>{const{classes:t}=e;return bn({root:["root"],paper:["paper"]},hH,t)},yH=Bt(fG,{name:"MuiPopover",slot:"Root",overridesResolver:(e,t)=>t.root})({}),ML=Bt(lc,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,t)=>t.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),_H=J.forwardRef(function(t,r){var l,h,m;const x=_n({props:t,name:"MuiPopover"}),{action:a,anchorEl:E,anchorOrigin:I={vertical:"top",horizontal:"left"},anchorPosition:L,anchorReference:O="anchorEl",children:F,className:K,container:W,elevation:G=8,marginThreshold:ne=16,open:Z,PaperProps:H={},slots:V,slotProps:oe,transformOrigin:pe={vertical:"top",horizontal:"left"},TransitionComponent:_e=cq,transitionDuration:xe="auto",TransitionProps:{onEntering:De}={},disableScrollLock:ye=!1}=x,Ae=Dt(x.TransitionProps,pH),ft=Dt(x,fH),Ge=(l=oe==null?void 0:oe.paper)!=null?l:H,et=J.useRef(),lt=_i(et,Ge.ref),gt=ce({},x,{anchorOrigin:I,anchorReference:O,elevation:G,marginThreshold:ne,externalPaperSlotProps:Ge,transformOrigin:pe,TransitionComponent:_e,transitionDuration:xe,TransitionProps:Ae}),St=gH(gt),It=J.useCallback(()=>{if(O==="anchorPosition")return L;const Xt=Ab(E),Kt=(Xt&&Xt.nodeType===1?Xt:No(et.current).body).getBoundingClientRect();return{top:Kt.top+BA(Kt,I.vertical),left:Kt.left+FA(Kt,I.horizontal)}},[E,I.horizontal,I.vertical,L,O]),Re=J.useCallback(Xt=>({vertical:BA(Xt,pe.vertical),horizontal:FA(Xt,pe.horizontal)}),[pe.horizontal,pe.vertical]),ct=J.useCallback(Xt=>{const Cn={width:Xt.offsetWidth,height:Xt.offsetHeight},Kt=Re(Cn);if(O==="none")return{top:null,left:null,transformOrigin:jA(Kt)};const Pr=It();let di=Pr.top-Kt.vertical,Sr=Pr.left-Kt.horizontal;const lr=di+Cn.height,Qr=Sr+Cn.width,On=Eu(Ab(E)),ki=On.innerHeight-ne,gr=On.innerWidth-ne;if(ne!==null&&di<ne){const zn=di-ne;di-=zn,Kt.vertical+=zn}else if(ne!==null&&lr>ki){const zn=lr-ki;di-=zn,Kt.vertical+=zn}if(ne!==null&&Sr<ne){const zn=Sr-ne;Sr-=zn,Kt.horizontal+=zn}else if(Qr>gr){const zn=Qr-gr;Sr-=zn,Kt.horizontal+=zn}return{top:`${Math.round(di)}px`,left:`${Math.round(Sr)}px`,transformOrigin:jA(Kt)}},[E,O,It,Re,ne]),[Ie,st]=J.useState(Z),Tt=J.useCallback(()=>{const Xt=et.current;if(!Xt)return;const Cn=ct(Xt);Cn.top!==null&&(Xt.style.top=Cn.top),Cn.left!==null&&(Xt.style.left=Cn.left),Xt.style.transformOrigin=Cn.transformOrigin,st(!0)},[ct]);J.useEffect(()=>(ye&&window.addEventListener("scroll",Tt),()=>window.removeEventListener("scroll",Tt)),[E,ye,Tt]);const zt=(Xt,Cn)=>{De&&De(Xt,Cn),Tt()},Nt=()=>{st(!1)};J.useEffect(()=>{Z&&Tt()}),J.useImperativeHandle(a,()=>Z?{updatePosition:()=>{Tt()}}:null,[Z,Tt]),J.useEffect(()=>{if(!Z)return;const Xt=qz(()=>{Tt()}),Cn=Eu(E);return Cn.addEventListener("resize",Xt),()=>{Xt.clear(),Cn.removeEventListener("resize",Xt)}},[E,Z,Tt]);let en=xe;xe==="auto"&&!_e.muiSupportAuto&&(en=void 0);const Zt=W||(E?No(Ab(E)).body:void 0),Mn=(h=V==null?void 0:V.root)!=null?h:yH,Wr=(m=V==null?void 0:V.paper)!=null?m:ML,qn=Sh({elementType:Wr,externalSlotProps:ce({},Ge,{style:Ie?Ge.style:ce({},Ge.style,{opacity:0})}),additionalProps:{elevation:G,ref:lt},ownerState:gt,className:Wt(St.paper,Ge==null?void 0:Ge.className)}),Mr=Sh({elementType:Mn,externalSlotProps:(oe==null?void 0:oe.root)||{},externalForwardedProps:ft,additionalProps:{ref:r,slotProps:{backdrop:{invisible:!0}},container:Zt,open:Z},ownerState:gt,className:Wt(St.root,K)}),{slotProps:Rt}=Mr,Dn=Dt(Mr,mH);return D.jsx(Mn,ce({},Dn,!wh(Mn)&&{slotProps:Rt,disableScrollLock:ye},{children:D.jsx(_e,ce({appear:!0,in:Z,onEntering:zt,onExited:Nt,timeout:en},Ae,{children:D.jsx(Wr,ce({},qn,{children:F}))}))}))}),xH=_H;function vH(e){return yn("MuiMenu",e)}mn("MuiMenu",["root","paper","list"]);const bH=["onEntering"],wH=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],SH={vertical:"top",horizontal:"right"},EH={vertical:"top",horizontal:"left"},TH=e=>{const{classes:t}=e;return bn({root:["root"],paper:["paper"],list:["list"]},vH,t)},CH=Bt(xH,{shouldForwardProp:e=>xs(e)||e==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(e,t)=>t.root})({}),kH=Bt(ML,{name:"MuiMenu",slot:"Paper",overridesResolver:(e,t)=>t.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),IH=Bt(dH,{name:"MuiMenu",slot:"List",overridesResolver:(e,t)=>t.list})({outline:0}),AH=J.forwardRef(function(t,r){var l,h;const m=_n({props:t,name:"MuiMenu"}),{autoFocus:x=!0,children:a,className:E,disableAutoFocusItem:I=!1,MenuListProps:L={},onClose:O,open:F,PaperProps:K={},PopoverClasses:W,transitionDuration:G="auto",TransitionProps:{onEntering:ne}={},variant:Z="selectedMenu",slots:H={},slotProps:V={}}=m,oe=Dt(m.TransitionProps,bH),pe=Dt(m,wH),_e=E8(),xe=ce({},m,{autoFocus:x,disableAutoFocusItem:I,MenuListProps:L,onEntering:ne,PaperProps:K,transitionDuration:G,TransitionProps:oe,variant:Z}),De=TH(xe),ye=x&&!I&&F,Ae=J.useRef(null),ft=(Re,ct)=>{Ae.current&&Ae.current.adjustStyleForScrollbar(Re,{direction:_e?"rtl":"ltr"}),ne&&ne(Re,ct)},Ge=Re=>{Re.key==="Tab"&&(Re.preventDefault(),O&&O(Re,"tabKeyDown"))};let et=-1;J.Children.map(a,(Re,ct)=>{J.isValidElement(Re)&&(Re.props.disabled||(Z==="selectedMenu"&&Re.props.selected||et===-1)&&(et=ct))});const lt=(l=H.paper)!=null?l:kH,gt=(h=V.paper)!=null?h:K,St=Sh({elementType:H.root,externalSlotProps:V.root,ownerState:xe,className:[De.root,E]}),It=Sh({elementType:lt,externalSlotProps:gt,ownerState:xe,className:De.paper});return D.jsx(CH,ce({onClose:O,anchorOrigin:{vertical:"bottom",horizontal:_e?"right":"left"},transformOrigin:_e?SH:EH,slots:{paper:lt,root:H.root},slotProps:{root:St,paper:It},open:F,ref:r,transitionDuration:G,TransitionProps:ce({onEntering:ft},oe),ownerState:xe},pe,{classes:W,children:D.jsx(IH,ce({onKeyDown:Ge,actions:Ae,autoFocus:x&&(et===-1||I),autoFocusItem:ye,variant:Z},L,{className:Wt(De.list,L.className),children:a}))}))}),PL=AH;function MH(e){return yn("MuiMenuItem",e)}const PH=mn("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),Lf=PH,RH=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],zH=(e,t)=>{const{ownerState:r}=e;return[t.root,r.dense&&t.dense,r.divider&&t.divider,!r.disableGutters&&t.gutters]},LH=e=>{const{disabled:t,dense:r,divider:l,disableGutters:h,selected:m,classes:x}=e,E=bn({root:["root",r&&"dense",t&&"disabled",!h&&"gutters",l&&"divider",m&&"selected"]},MH,x);return ce({},x,E)},DH=Bt(Eh,{shouldForwardProp:e=>xs(e)||e==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:zH})(({theme:e,ownerState:t})=>ce({},e.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!t.disableGutters&&{paddingLeft:16,paddingRight:16},t.divider&&{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Lf.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:sr(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${Lf.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:sr(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${Lf.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:sr(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:sr(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${Lf.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${Lf.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${PA.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${PA.inset}`]:{marginLeft:52},[`& .${b0.root}`]:{marginTop:0,marginBottom:0},[`& .${b0.inset}`]:{paddingLeft:36},[`& .${DA.root}`]:{minWidth:36}},!t.dense&&{[e.breakpoints.up("sm")]:{minHeight:"auto"}},t.dense&&ce({minHeight:32,paddingTop:4,paddingBottom:4},e.typography.body2,{[`& .${DA.root} svg`]:{fontSize:"1.25rem"}}))),OH=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiMenuItem"}),{autoFocus:h=!1,component:m="li",dense:x=!1,divider:a=!1,disableGutters:E=!1,focusVisibleClassName:I,role:L="menuitem",tabIndex:O,className:F}=l,K=Dt(l,RH),W=J.useContext(Ha),G=J.useMemo(()=>({dense:x||W.dense||!1,disableGutters:E}),[W.dense,x,E]),ne=J.useRef(null);Ys(()=>{h&&ne.current&&ne.current.focus()},[h]);const Z=ce({},l,{dense:G.dense,divider:a,disableGutters:E}),H=LH(l),V=_i(ne,r);let oe;return l.disabled||(oe=O!==void 0?O:-1),D.jsx(Ha.Provider,{value:G,children:D.jsx(DH,ce({ref:V,role:L,tabIndex:oe,component:m,focusVisibleClassName:Wt(H.focusVisible,I),className:Wt(H.root,F)},K,{ownerState:Z,classes:H}))})}),zo=OH;function BH(e){return yn("MuiNativeSelect",e)}const FH=mn("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),KS=FH,jH=["className","disabled","error","IconComponent","inputRef","variant"],NH=e=>{const{classes:t,variant:r,disabled:l,multiple:h,open:m,error:x}=e,a={select:["select",r,l&&"disabled",h&&"multiple",x&&"error"],icon:["icon",`icon${Ct(r)}`,m&&"iconOpen",l&&"disabled"]};return bn(a,BH,t)},RL=({ownerState:e,theme:t})=>ce({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":ce({},t.vars?{backgroundColor:`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:t.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${KS.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(t.vars||t).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},e.variant==="filled"&&{"&&&":{paddingRight:32}},e.variant==="outlined"&&{borderRadius:(t.vars||t).shape.borderRadius,"&:focus":{borderRadius:(t.vars||t).shape.borderRadius},"&&&":{paddingRight:32}}),$H=Bt("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:xs,overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.select,t[r.variant],r.error&&t.error,{[`&.${KS.multiple}`]:t.multiple}]}})(RL),zL=({ownerState:e,theme:t})=>ce({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(t.vars||t).palette.action.active,[`&.${KS.disabled}`]:{color:(t.vars||t).palette.action.disabled}},e.open&&{transform:"rotate(180deg)"},e.variant==="filled"&&{right:7},e.variant==="outlined"&&{right:7}),UH=Bt("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.icon,r.variant&&t[`icon${Ct(r.variant)}`],r.open&&t.iconOpen]}})(zL),VH=J.forwardRef(function(t,r){const{className:l,disabled:h,error:m,IconComponent:x,inputRef:a,variant:E="standard"}=t,I=Dt(t,jH),L=ce({},t,{disabled:h,variant:E,error:m}),O=NH(L);return D.jsxs(J.Fragment,{children:[D.jsx($H,ce({ownerState:L,className:Wt(O.select,l),disabled:h,ref:a||r},I)),t.multiple?null:D.jsx(UH,{as:x,ownerState:L,className:O.icon})]})}),WH=VH;var NA;const GH=["children","classes","className","label","notched"],qH=Bt("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:xs})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),HH=Bt("legend",{name:"MuiNotchedOutlined",shouldForwardProp:xs})(({ownerState:e,theme:t})=>ce({float:"unset",width:"auto",overflow:"hidden"},!e.withLabel&&{padding:0,lineHeight:"11px",transition:t.transitions.create("width",{duration:150,easing:t.transitions.easing.easeOut})},e.withLabel&&ce({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:t.transitions.create("max-width",{duration:50,easing:t.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},e.notched&&{maxWidth:"100%",transition:t.transitions.create("max-width",{duration:100,easing:t.transitions.easing.easeOut,delay:50})})));function ZH(e){const{className:t,label:r,notched:l}=e,h=Dt(e,GH),m=r!=null&&r!=="",x=ce({},e,{notched:l,withLabel:m});return D.jsx(qH,ce({"aria-hidden":!0,className:t,ownerState:x},h,{children:D.jsx(HH,{ownerState:x,children:m?D.jsx("span",{children:r}):NA||(NA=D.jsx("span",{className:"notranslate",children:""}))})}))}const XH=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],KH=e=>{const{classes:t}=e,l=bn({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},X7,t);return ce({},t,l)},YH=Bt(Hx,{shouldForwardProp:e=>xs(e)||e==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:Gx})(({theme:e,ownerState:t})=>{const r=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return ce({position:"relative",borderRadius:(e.vars||e).shape.borderRadius,[`&:hover .${Ll.notchedOutline}`]:{borderColor:(e.vars||e).palette.text.primary},"@media (hover: none)":{[`&:hover .${Ll.notchedOutline}`]:{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:r}},[`&.${Ll.focused} .${Ll.notchedOutline}`]:{borderColor:(e.vars||e).palette[t.color].main,borderWidth:2},[`&.${Ll.error} .${Ll.notchedOutline}`]:{borderColor:(e.vars||e).palette.error.main},[`&.${Ll.disabled} .${Ll.notchedOutline}`]:{borderColor:(e.vars||e).palette.action.disabled}},t.startAdornment&&{paddingLeft:14},t.endAdornment&&{paddingRight:14},t.multiline&&ce({padding:"16.5px 14px"},t.size==="small"&&{padding:"8.5px 14px"}))}),JH=Bt(ZH,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(e,t)=>t.notchedOutline})(({theme:e})=>{const t=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:t}}),QH=Bt(Zx,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:qx})(({theme:e,ownerState:t})=>ce({padding:"16.5px 14px"},!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},e.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},t.size==="small"&&{padding:"8.5px 14px"},t.multiline&&{padding:0},t.startAdornment&&{paddingLeft:0},t.endAdornment&&{paddingRight:0})),LL=J.forwardRef(function(t,r){var l,h,m,x,a;const E=_n({props:t,name:"MuiOutlinedInput"}),{components:I={},fullWidth:L=!1,inputComponent:O="input",label:F,multiline:K=!1,notched:W,slots:G={},type:ne="text"}=E,Z=Dt(E,XH),H=KH(E),V=Nh(),oe=jh({props:E,muiFormControl:V,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),pe=ce({},E,{color:oe.color||"primary",disabled:oe.disabled,error:oe.error,focused:oe.focused,formControl:V,fullWidth:L,hiddenLabel:oe.hiddenLabel,multiline:K,size:oe.size,type:ne}),_e=(l=(h=G.root)!=null?h:I.Root)!=null?l:YH,xe=(m=(x=G.input)!=null?x:I.Input)!=null?m:QH;return D.jsx(HS,ce({slots:{root:_e,input:xe},renderSuffix:De=>D.jsx(JH,{ownerState:pe,className:H.notchedOutline,label:F!=null&&F!==""&&oe.required?a||(a=D.jsxs(J.Fragment,{children:[F,"","*"]})):F,notched:typeof W<"u"?W:!!(De.startAdornment||De.filled||De.focused)}),fullWidth:L,inputComponent:O,multiline:K,ref:r,type:ne},Z,{classes:ce({},H,{notchedOutline:null})}))});LL.muiName="Input";const DL=LL;function eZ(e){return yn("MuiSelect",e)}const tZ=mn("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),Df=tZ;var $A;const nZ=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],rZ=Bt("div",{name:"MuiSelect",slot:"Select",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{[`&.${Df.select}`]:t.select},{[`&.${Df.select}`]:t[r.variant]},{[`&.${Df.error}`]:t.error},{[`&.${Df.multiple}`]:t.multiple}]}})(RL,{[`&.${Df.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),iZ=Bt("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.icon,r.variant&&t[`icon${Ct(r.variant)}`],r.open&&t.iconOpen]}})(zL),oZ=Bt("input",{shouldForwardProp:e=>pL(e)&&e!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(e,t)=>t.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function UA(e,t){return typeof t=="object"&&t!==null?e===t:String(e)===String(t)}function sZ(e){return e==null||typeof e=="string"&&!e.trim()}const aZ=e=>{const{classes:t,variant:r,disabled:l,multiple:h,open:m,error:x}=e,a={select:["select",r,l&&"disabled",h&&"multiple",x&&"error"],icon:["icon",`icon${Ct(r)}`,m&&"iconOpen",l&&"disabled"],nativeInput:["nativeInput"]};return bn(a,eZ,t)},lZ=J.forwardRef(function(t,r){var l;const{"aria-describedby":h,"aria-label":m,autoFocus:x,autoWidth:a,children:E,className:I,defaultOpen:L,defaultValue:O,disabled:F,displayEmpty:K,error:W=!1,IconComponent:G,inputRef:ne,labelId:Z,MenuProps:H={},multiple:V,name:oe,onBlur:pe,onChange:_e,onClose:xe,onFocus:De,onOpen:ye,open:Ae,readOnly:ft,renderValue:Ge,SelectDisplayProps:et={},tabIndex:lt,value:gt,variant:St="standard"}=t,It=Dt(t,nZ),[Re,ct]=YI({controlled:gt,default:O,name:"Select"}),[Ie,st]=YI({controlled:Ae,default:L,name:"Select"}),Tt=J.useRef(null),zt=J.useRef(null),[Nt,en]=J.useState(null),{current:Zt}=J.useRef(Ae!=null),[Mn,Wr]=J.useState(),qn=_i(r,ne),Mr=J.useCallback(Gt=>{zt.current=Gt,Gt&&en(Gt)},[]),Rt=Nt==null?void 0:Nt.parentNode;J.useImperativeHandle(qn,()=>({focus:()=>{zt.current.focus()},node:Tt.current,value:Re}),[Re]),J.useEffect(()=>{L&&Ie&&Nt&&!Zt&&(Wr(a?null:Rt.clientWidth),zt.current.focus())},[Nt,a]),J.useEffect(()=>{x&&zt.current.focus()},[x]),J.useEffect(()=>{if(!Z)return;const Gt=No(zt.current).getElementById(Z);if(Gt){const kn=()=>{getSelection().isCollapsed&&zt.current.focus()};return Gt.addEventListener("click",kn),()=>{Gt.removeEventListener("click",kn)}}},[Z]);const Dn=(Gt,kn)=>{Gt?ye&&ye(kn):xe&&xe(kn),Zt||(Wr(a?null:Rt.clientWidth),st(Gt))},Xt=Gt=>{Gt.button===0&&(Gt.preventDefault(),zt.current.focus(),Dn(!0,Gt))},Cn=Gt=>{Dn(!1,Gt)},Kt=J.Children.toArray(E),Pr=Gt=>{const kn=Kt.find(cr=>cr.props.value===Gt.target.value);kn!==void 0&&(ct(kn.props.value),_e&&_e(Gt,kn))},di=Gt=>kn=>{let cr;if(kn.currentTarget.hasAttribute("tabindex")){if(V){cr=Array.isArray(Re)?Re.slice():[];const Di=Re.indexOf(Gt.props.value);Di===-1?cr.push(Gt.props.value):cr.splice(Di,1)}else cr=Gt.props.value;if(Gt.props.onClick&&Gt.props.onClick(kn),Re!==cr&&(ct(cr),_e)){const Di=kn.nativeEvent||kn,vs=new Di.constructor(Di.type,Di);Object.defineProperty(vs,"target",{writable:!0,value:{value:cr,name:oe}}),_e(vs,Gt)}V||Dn(!1,kn)}},Sr=Gt=>{ft||[" ","ArrowUp","ArrowDown","Enter"].indexOf(Gt.key)!==-1&&(Gt.preventDefault(),Dn(!0,Gt))},lr=Nt!==null&&Ie,Qr=Gt=>{!lr&&pe&&(Object.defineProperty(Gt,"target",{writable:!0,value:{value:Re,name:oe}}),pe(Gt))};delete It["aria-invalid"];let On,ki;const gr=[];let zn=!1;(_0({value:Re})||K)&&(Ge?On=Ge(Re):zn=!0);const Ii=Kt.map(Gt=>{if(!J.isValidElement(Gt))return null;let kn;if(V){if(!Array.isArray(Re))throw new Error(Su(2));kn=Re.some(cr=>UA(cr,Gt.props.value)),kn&&zn&&gr.push(Gt.props.children)}else kn=UA(Re,Gt.props.value),kn&&zn&&(ki=Gt.props.children);return J.cloneElement(Gt,{"aria-selected":kn?"true":"false",onClick:di(Gt),onKeyUp:cr=>{cr.key===" "&&cr.preventDefault(),Gt.props.onKeyUp&&Gt.props.onKeyUp(cr)},role:"option",selected:kn,value:void 0,"data-value":Gt.props.value})});zn&&(V?gr.length===0?On=null:On=gr.reduce((Gt,kn,cr)=>(Gt.push(kn),cr<gr.length-1&&Gt.push(", "),Gt),[]):On=ki);let Ji=Mn;!a&&Zt&&Nt&&(Ji=Rt.clientWidth);let Er;typeof lt<"u"?Er=lt:Er=F?null:0;const wn=et.id||(oe?`mui-component-select-${oe}`:void 0),qt=ce({},t,{variant:St,value:Re,open:lr,error:W}),hi=aZ(qt),ao=ce({},H.PaperProps,(l=H.slotProps)==null?void 0:l.paper),To=FS();return D.jsxs(J.Fragment,{children:[D.jsx(rZ,ce({ref:Mr,tabIndex:Er,role:"combobox","aria-controls":To,"aria-disabled":F?"true":void 0,"aria-expanded":lr?"true":"false","aria-haspopup":"listbox","aria-label":m,"aria-labelledby":[Z,wn].filter(Boolean).join(" ")||void 0,"aria-describedby":h,onKeyDown:Sr,onMouseDown:F||ft?null:Xt,onBlur:Qr,onFocus:De},et,{ownerState:qt,className:Wt(et.className,hi.select,I),id:wn,children:sZ(On)?$A||($A=D.jsx("span",{className:"notranslate",children:""})):On})),D.jsx(oZ,ce({"aria-invalid":W,value:Array.isArray(Re)?Re.join(","):Re,name:oe,ref:Tt,"aria-hidden":!0,onChange:Pr,tabIndex:-1,disabled:F,className:hi.nativeInput,autoFocus:x,ownerState:qt},It)),D.jsx(iZ,{as:G,className:hi.icon,ownerState:qt}),D.jsx(PL,ce({id:`menu-${oe||""}`,anchorEl:Rt,open:lr,onClose:Cn,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},H,{MenuListProps:ce({"aria-labelledby":Z,role:"listbox","aria-multiselectable":V?"true":void 0,disableListWrap:!0,id:To},H.MenuListProps),slotProps:ce({},H.slotProps,{paper:ce({},ao,{style:ce({minWidth:Ji},ao!=null?ao.style:null)})}),children:Ii}))]})}),cZ=lZ,uZ=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],dZ=["root"],hZ=e=>{const{classes:t}=e;return t},YS={name:"MuiSelect",overridesResolver:(e,t)=>t.root,shouldForwardProp:e=>xs(e)&&e!=="variant",slot:"Root"},pZ=Bt(CL,YS)(""),fZ=Bt(DL,YS)(""),mZ=Bt(wL,YS)(""),OL=J.forwardRef(function(t,r){const l=_n({name:"MuiSelect",props:t}),{autoWidth:h=!1,children:m,classes:x={},className:a,defaultOpen:E=!1,displayEmpty:I=!1,IconComponent:L=Q7,id:O,input:F,inputProps:K,label:W,labelId:G,MenuProps:ne,multiple:Z=!1,native:H=!1,onClose:V,onOpen:oe,open:pe,renderValue:_e,SelectDisplayProps:xe,variant:De="outlined"}=l,ye=Dt(l,uZ),Ae=H?WH:cZ,ft=Nh(),Ge=jh({props:l,muiFormControl:ft,states:["variant","error"]}),et=Ge.variant||De,lt=ce({},l,{variant:et,classes:x}),gt=hZ(lt),St=Dt(gt,dZ),It=F||{standard:D.jsx(pZ,{ownerState:lt}),outlined:D.jsx(fZ,{label:W,ownerState:lt}),filled:D.jsx(mZ,{ownerState:lt})}[et],Re=_i(r,tg(It));return D.jsx(J.Fragment,{children:J.cloneElement(It,ce({inputComponent:Ae,inputProps:ce({children:m,error:Ge.error,IconComponent:L,variant:et,type:void 0,multiple:Z},H?{id:O}:{autoWidth:h,defaultOpen:E,displayEmpty:I,labelId:G,MenuProps:ne,onClose:V,onOpen:oe,open:pe,renderValue:_e,SelectDisplayProps:ce({id:O},xe)},K,{classes:K?jo(St,K.classes):St},F?F.props.inputProps:{})},(Z&&H||I)&&et==="outlined"?{notched:!0}:{},{ref:Re,className:Wt(It.props.className,a,gt.root)},!F&&{variant:et},ye))})});OL.muiName="Select";const w0=OL;function gZ(e){return yn("MuiToolbar",e)}mn("MuiToolbar",["root","gutters","regular","dense"]);const yZ=["className","component","disableGutters","variant"],_Z=e=>{const{classes:t,disableGutters:r,variant:l}=e;return bn({root:["root",!r&&"gutters",l]},gZ,t)},xZ=Bt("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.disableGutters&&t.gutters,t[r.variant]]}})(({theme:e,ownerState:t})=>ce({position:"relative",display:"flex",alignItems:"center"},!t.disableGutters&&{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}},t.variant==="dense"&&{minHeight:48}),({theme:e,ownerState:t})=>t.variant==="regular"&&e.mixins.toolbar),vZ=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiToolbar"}),{className:h,component:m="div",disableGutters:x=!1,variant:a="regular"}=l,E=Dt(l,yZ),I=ce({},l,{component:m,disableGutters:x,variant:a}),L=_Z(I);return D.jsx(xZ,ce({as:m,className:Wt(L.root,h),ref:r,ownerState:I},E))}),bZ=vZ;function wZ(e){return yn("MuiTextField",e)}mn("MuiTextField",["root"]);const SZ=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],EZ={standard:CL,filled:wL,outlined:DL},TZ=e=>{const{classes:t}=e;return bn({root:["root"]},wZ,t)},CZ=Bt(x0,{name:"MuiTextField",slot:"Root",overridesResolver:(e,t)=>t.root})({}),kZ=J.forwardRef(function(t,r){const l=_n({props:t,name:"MuiTextField"}),{autoComplete:h,autoFocus:m=!1,children:x,className:a,color:E="primary",defaultValue:I,disabled:L=!1,error:O=!1,FormHelperTextProps:F,fullWidth:K=!1,helperText:W,id:G,InputLabelProps:ne,inputProps:Z,InputProps:H,inputRef:V,label:oe,maxRows:pe,minRows:_e,multiline:xe=!1,name:De,onBlur:ye,onChange:Ae,onFocus:ft,placeholder:Ge,required:et=!1,rows:lt,select:gt=!1,SelectProps:St,type:It,value:Re,variant:ct="outlined"}=l,Ie=Dt(l,SZ),st=ce({},l,{autoFocus:m,color:E,disabled:L,error:O,fullWidth:K,multiline:xe,required:et,select:gt,variant:ct}),Tt=TZ(st),zt={};ct==="outlined"&&(ne&&typeof ne.shrink<"u"&&(zt.notched=ne.shrink),zt.label=oe),gt&&((!St||!St.native)&&(zt.id=void 0),zt["aria-describedby"]=void 0);const Nt=FS(G),en=W&&Nt?`${Nt}-helper-text`:void 0,Zt=oe&&Nt?`${Nt}-label`:void 0,Mn=EZ[ct],Wr=D.jsx(Mn,ce({"aria-describedby":en,autoComplete:h,autoFocus:m,defaultValue:I,fullWidth:K,multiline:xe,name:De,rows:lt,maxRows:pe,minRows:_e,type:It,value:Re,id:Nt,inputRef:V,onBlur:ye,onChange:Ae,onFocus:ft,placeholder:Ge,inputProps:Z},zt,H));return D.jsxs(CZ,ce({className:Wt(Tt.root,a),disabled:L,error:O,fullWidth:K,ref:r,required:et,color:E,variant:ct,ownerState:st},Ie,{children:[oe!=null&&oe!==""&&D.jsx(v0,ce({htmlFor:Nt,id:Zt},ne,{children:oe})),gt?D.jsx(w0,ce({"aria-describedby":en,id:Nt,labelId:Zt,value:Re,input:Wr},St,{children:x})):Wr,W&&D.jsx(OG,ce({id:en},F,{children:W}))]}))}),lh=kZ,Gf=wr(D.jsx("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2M6 9h12v2H6zm8 5H6v-2h8zm4-6H6V6h12z"}),"Chat"),IZ=wr(D.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear"),AZ=wr(D.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),JS=wr(D.jsx("path",{d:"M4 16c0 .88.39 1.67 1 2.22V20c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h8v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1.78c.61-.55 1-1.34 1-2.22V6c0-3.5-3.58-4-8-4s-8 .5-8 4zm3.5 1c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17m9 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m1.5-6H6V6h12z"}),"DirectionsBus"),nc=wr(D.jsx("path",{d:"M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16m11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5M5 11l1.5-4.5h11L19 11z"}),"DirectionsCar"),VA=wr(D.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"}),"Email"),MZ=wr(D.jsx("path",{d:"M10 18h4v-2h-4zM3 6v2h18V6zm3 7h12v-2H6z"}),"FilterList"),PZ=wr(D.jsx("path",{d:"M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"}),"GitHub"),RZ=wr(D.jsx("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home"),zZ=wr(D.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info"),LZ=wr(D.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"LocationOn"),Kd=wr(D.jsx("path",{d:"m20.5 3-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5M15 19l-6-2.11V5l6 2.11z"}),"Map"),DZ=wr(D.jsx("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu"),OZ=wr(D.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"}),"Phone"),BZ=wr(D.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"}),"Public"),Za=wr(D.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search"),FZ=wr(D.jsx("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send"),jZ=wr(D.jsx("path",{d:"m16 6 2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"}),"TrendingUp"),NZ=()=>{const e=Hm(),t=Vx(),r=n8(t.breakpoints.down("sm")),[l,h]=J.useState(null),m=E=>{h(E.currentTarget)},x=()=>{h(null)},a=[{path:"/",label:"Home",icon:D.jsx(RZ,{})},{path:"/chat",label:"Chat",icon:D.jsx(Gf,{})},{path:"/map",label:"Map",icon:D.jsx(Kd,{})},{path:"/search",label:"Search",icon:D.jsx(Za,{})}];return D.jsx(w7,{position:"static",elevation:2,children:D.jsx(ZS,{maxWidth:"xl",children:D.jsxs(bZ,{sx:{justifyContent:"space-between"},children:[D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[D.jsx(yt,{variant:"h5",component:$l,to:"/",sx:{textDecoration:"none",color:"inherit",fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:" CeBot"}),!r&&D.jsx(Zi,{label:"Cebu Transport Assistant",size:"small",variant:"outlined",sx:{color:"inherit",borderColor:"rgba(255,255,255,0.3)",backgroundColor:"rgba(255,255,255,0.1)"}})]}),r?D.jsxs(D.Fragment,{children:[D.jsx(Th,{color:"inherit","aria-label":"menu",onClick:m,children:D.jsx(DZ,{})}),D.jsx(PL,{id:"mobile-menu",anchorEl:l,keepMounted:!0,open:!!l,onClose:x,PaperProps:{style:{maxHeight:"65vh",width:"200px"}},children:a.map(E=>D.jsx(zo,{onClick:x,component:$l,to:E.path,selected:e.pathname===E.path,children:D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:2},children:[E.icon,D.jsx(yt,{variant:"body1",children:E.label})]})},E.path))})]}):D.jsx(Pt,{sx:{display:"flex",gap:1},children:a.map(E=>D.jsx(ro,{component:$l,to:E.path,startIcon:E.icon,sx:{color:"inherit",backgroundColor:e.pathname===E.path?"rgba(255,255,255,0.1)":"transparent","&:hover":{backgroundColor:"rgba(255,255,255,0.1)"}},children:E.label},E.path))})]})})})},$Z=()=>{const e=new Date().getFullYear();return D.jsx(Pt,{component:"footer",sx:{backgroundColor:"primary.main",color:"white",mt:"auto",py:4},children:D.jsxs(ZS,{maxWidth:"xl",children:[D.jsxs(er,{container:!0,spacing:2,children:[D.jsxs(er,{item:!0,xs:12,md:4,children:[D.jsxs(Pt,{sx:{mb:2},children:[D.jsx(yt,{variant:"h5",component:"div",sx:{fontWeight:"bold",display:"flex",alignItems:"center",gap:1,mb:1,fontSize:{xs:"1.25rem",md:"1.5rem"}},children:" CeBot"}),D.jsx(Zi,{label:"Cebu Transport Assistant",size:"small",variant:"outlined",sx:{color:"inherit",borderColor:"rgba(255,255,255,0.3)",backgroundColor:"rgba(255,255,255,0.1)"}})]}),D.jsx(yt,{variant:"body2",sx:{mb:2,opacity:.9},children:"Your intelligent Cebu City transport assistant. Find jeepney routes, bus schedules, and get real-time transport information to navigate the Queen City of the South."}),D.jsxs(Pt,{sx:{display:"flex",gap:1},children:[D.jsx(Th,{size:"small",sx:{color:"inherit"},component:"a",href:"https://github.com",target:"_blank",rel:"noopener noreferrer",children:D.jsx(PZ,{})}),D.jsx(Th,{size:"small",sx:{color:"inherit"},component:"a",href:"mailto:info@cebot.com",children:D.jsx(VA,{})})]})]}),D.jsxs(er,{item:!0,xs:12,sm:6,md:2,children:[D.jsx(yt,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Quick Links"}),D.jsxs(Pt,{sx:{display:"flex",flexDirection:"column",gap:1},children:[D.jsx(tu,{href:"/",color:"inherit",underline:"hover",sx:{fontSize:"0.875rem"},children:"Home"}),D.jsx(tu,{href:"/chat",color:"inherit",underline:"hover",sx:{fontSize:"0.875rem"},children:"Chat Assistant"}),D.jsx(tu,{href:"/map",color:"inherit",underline:"hover",sx:{fontSize:"0.875rem"},children:"Route Map"}),D.jsx(tu,{href:"/search",color:"inherit",underline:"hover",sx:{fontSize:"0.875rem"},children:"Route Search"})]})]}),D.jsxs(er,{item:!0,xs:12,sm:6,md:3,children:[D.jsx(yt,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Transport Types"}),D.jsxs(Pt,{sx:{display:"flex",flexDirection:"column",gap:1},children:[D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[D.jsx(Pt,{sx:{width:12,height:12,backgroundColor:"#1976d2",borderRadius:"50%"}}),D.jsx(yt,{variant:"body2",children:"Traditional Jeepney"})]}),D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[D.jsx(Pt,{sx:{width:12,height:12,backgroundColor:"#ff9800",borderRadius:"50%"}}),D.jsx(yt,{variant:"body2",children:"Modern Jeepney"})]}),D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[D.jsx(Pt,{sx:{width:12,height:12,backgroundColor:"#2196f3",borderRadius:"50%"}}),D.jsx(yt,{variant:"body2",children:"City Bus"})]})]})]}),D.jsxs(er,{item:!0,xs:12,md:3,children:[D.jsx(yt,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Contact Info"}),D.jsxs(Pt,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[D.jsx(LZ,{sx:{fontSize:18,opacity:.8}}),D.jsx(yt,{variant:"body2",children:"Cebu City, Philippines"})]}),D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[D.jsx(OZ,{sx:{fontSize:18,opacity:.8}}),D.jsx(yt,{variant:"body2",children:"+63 (32) 123-4567"})]}),D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[D.jsx(VA,{sx:{fontSize:18,opacity:.8}}),D.jsx(yt,{variant:"body2",children:"info@cebot.com"})]}),D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[D.jsx(BZ,{sx:{fontSize:18,opacity:.8}}),D.jsx(yt,{variant:"body2",children:"www.cebot.com"})]})]})]})]}),D.jsx(XS,{sx:{my:3,borderColor:"rgba(255,255,255,0.2)"}}),D.jsxs(Pt,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:"center",gap:2},children:[D.jsxs(yt,{variant:"body2",sx:{opacity:.8},children:[" ",e," CeBot. All rights reserved."]}),D.jsxs(Pt,{sx:{display:"flex",gap:3},children:[D.jsx(tu,{href:"/privacy",color:"inherit",underline:"hover",sx:{fontSize:"0.875rem"},children:"Privacy Policy"}),D.jsx(tu,{href:"/terms",color:"inherit",underline:"hover",sx:{fontSize:"0.875rem"},children:"Terms of Service"}),D.jsx(tu,{href:"/about",color:"inherit",underline:"hover",sx:{fontSize:"0.875rem"},children:"About Us"})]})]})]})})},ba=Object.create(null);ba.open="0";ba.close="1";ba.ping="2";ba.pong="3";ba.message="4";ba.upgrade="5";ba.noop="6";const k_=Object.create(null);Object.keys(ba).forEach(e=>{k_[ba[e]]=e});const n2={type:"error",data:"parser error"},BL=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",FL=typeof ArrayBuffer=="function",jL=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,QS=({type:e,data:t},r,l)=>BL&&t instanceof Blob?r?l(t):WA(t,l):FL&&(t instanceof ArrayBuffer||jL(t))?r?l(t):WA(new Blob([t]),l):l(ba[e]+(t||"")),WA=(e,t)=>{const r=new FileReader;return r.onload=function(){const l=r.result.split(",")[1];t("b"+(l||""))},r.readAsDataURL(e)};function GA(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let Mb;function UZ(e,t){if(BL&&e.data instanceof Blob)return e.data.arrayBuffer().then(GA).then(t);if(FL&&(e.data instanceof ArrayBuffer||jL(e.data)))return t(GA(e.data));QS(e,!1,r=>{Mb||(Mb=new TextEncoder),t(Mb.encode(r))})}const qA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qf=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<qA.length;e++)qf[qA.charCodeAt(e)]=e;const VZ=e=>{let t=e.length*.75,r=e.length,l,h=0,m,x,a,E;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const I=new ArrayBuffer(t),L=new Uint8Array(I);for(l=0;l<r;l+=4)m=qf[e.charCodeAt(l)],x=qf[e.charCodeAt(l+1)],a=qf[e.charCodeAt(l+2)],E=qf[e.charCodeAt(l+3)],L[h++]=m<<2|x>>4,L[h++]=(x&15)<<4|a>>2,L[h++]=(a&3)<<6|E&63;return I},WZ=typeof ArrayBuffer=="function",eE=(e,t)=>{if(typeof e!="string")return{type:"message",data:NL(e,t)};const r=e.charAt(0);return r==="b"?{type:"message",data:GZ(e.substring(1),t)}:k_[r]?e.length>1?{type:k_[r],data:e.substring(1)}:{type:k_[r]}:n2},GZ=(e,t)=>{if(WZ){const r=VZ(e);return NL(r,t)}else return{base64:!0,data:e}},NL=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},$L=String.fromCharCode(30),qZ=(e,t)=>{const r=e.length,l=new Array(r);let h=0;e.forEach((m,x)=>{QS(m,!1,a=>{l[x]=a,++h===r&&t(l.join($L))})})},HZ=(e,t)=>{const r=e.split($L),l=[];for(let h=0;h<r.length;h++){const m=eE(r[h],t);if(l.push(m),m.type==="error")break}return l};function ZZ(){return new TransformStream({transform(e,t){UZ(e,r=>{const l=r.length;let h;if(l<126)h=new Uint8Array(1),new DataView(h.buffer).setUint8(0,l);else if(l<65536){h=new Uint8Array(3);const m=new DataView(h.buffer);m.setUint8(0,126),m.setUint16(1,l)}else{h=new Uint8Array(9);const m=new DataView(h.buffer);m.setUint8(0,127),m.setBigUint64(1,BigInt(l))}e.data&&typeof e.data!="string"&&(h[0]|=128),t.enqueue(h),t.enqueue(r)})}})}let Pb;function Jy(e){return e.reduce((t,r)=>t+r.length,0)}function Qy(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let l=0;for(let h=0;h<t;h++)r[h]=e[0][l++],l===e[0].length&&(e.shift(),l=0);return e.length&&l<e[0].length&&(e[0]=e[0].slice(l)),r}function XZ(e,t){Pb||(Pb=new TextDecoder);const r=[];let l=0,h=-1,m=!1;return new TransformStream({transform(x,a){for(r.push(x);;){if(l===0){if(Jy(r)<1)break;const E=Qy(r,1);m=(E[0]&128)===128,h=E[0]&127,h<126?l=3:h===126?l=1:l=2}else if(l===1){if(Jy(r)<2)break;const E=Qy(r,2);h=new DataView(E.buffer,E.byteOffset,E.length).getUint16(0),l=3}else if(l===2){if(Jy(r)<8)break;const E=Qy(r,8),I=new DataView(E.buffer,E.byteOffset,E.length),L=I.getUint32(0);if(L>Math.pow(2,53-32)-1){a.enqueue(n2);break}h=L*Math.pow(2,32)+I.getUint32(4),l=3}else{if(Jy(r)<h)break;const E=Qy(r,h);a.enqueue(eE(m?E:Pb.decode(E),t)),l=0}if(h===0||h>e){a.enqueue(n2);break}}}})}const UL=4;function li(e){if(e)return KZ(e)}function KZ(e){for(var t in li.prototype)e[t]=li.prototype[t];return e}li.prototype.on=li.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};li.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this};li.prototype.off=li.prototype.removeListener=li.prototype.removeAllListeners=li.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var l,h=0;h<r.length;h++)if(l=r[h],l===t||l.fn===t){r.splice(h,1);break}return r.length===0&&delete this._callbacks["$"+e],this};li.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],l=1;l<arguments.length;l++)t[l-1]=arguments[l];if(r){r=r.slice(0);for(var l=0,h=r.length;l<h;++l)r[l].apply(this,t)}return this};li.prototype.emitReserved=li.prototype.emit;li.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};li.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Kx=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,r)=>r(t,0))(),ls=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())(),YZ="arraybuffer";function VL(e,...t){return t.reduce((r,l)=>(e.hasOwnProperty(l)&&(r[l]=e[l]),r),{})}const JZ=ls.setTimeout,QZ=ls.clearTimeout;function Yx(e,t){t.useNativeTimers?(e.setTimeoutFn=JZ.bind(ls),e.clearTimeoutFn=QZ.bind(ls)):(e.setTimeoutFn=ls.setTimeout.bind(ls),e.clearTimeoutFn=ls.clearTimeout.bind(ls))}const eX=1.33;function tX(e){return typeof e=="string"?nX(e):Math.ceil((e.byteLength||e.size)*eX)}function nX(e){let t=0,r=0;for(let l=0,h=e.length;l<h;l++)t=e.charCodeAt(l),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(l++,r+=4);return r}function WL(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function rX(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function iX(e){let t={},r=e.split("&");for(let l=0,h=r.length;l<h;l++){let m=r[l].split("=");t[decodeURIComponent(m[0])]=decodeURIComponent(m[1])}return t}class oX extends Error{constructor(t,r,l){super(t),this.description=r,this.context=l,this.type="TransportError"}}class tE extends li{constructor(t){super(),this.writable=!1,Yx(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,r,l){return super.emitReserved("error",new oX(t,r,l)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const r=eE(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,r={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const r=rX(t);return r.length?"?"+r:""}}class sX extends tE{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const r=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let l=0;this._polling&&(l++,this.once("pollComplete",function(){--l||r()})),this.writable||(l++,this.once("drain",function(){--l||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const r=l=>{if(this.readyState==="opening"&&l.type==="open"&&this.onOpen(),l.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(l)};HZ(t,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,qZ(t,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=WL()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(t,r)}}let GL=!1;try{GL=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const aX=GL;function lX(){}class cX extends sX{constructor(t){if(super(t),typeof location<"u"){const r=location.protocol==="https:";let l=location.port;l||(l=r?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||l!==t.port}}doWrite(t,r){const l=this.request({method:"POST",data:t});l.on("success",r),l.on("error",(h,m)=>{this.onError("xhr post error",h,m)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(r,l)=>{this.onError("xhr poll error",r,l)}),this.pollXhr=t}}let ch=class I_ extends li{constructor(t,r,l){super(),this.createRequest=t,Yx(this,l),this._opts=l,this._method=l.method||"GET",this._uri=r,this._data=l.data!==void 0?l.data:null,this._create()}_create(){var t;const r=VL(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const l=this._xhr=this.createRequest(r);try{l.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){l.setDisableHeaderCheck&&l.setDisableHeaderCheck(!0);for(let h in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(h)&&l.setRequestHeader(h,this._opts.extraHeaders[h])}}catch{}if(this._method==="POST")try{l.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{l.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(l),"withCredentials"in l&&(l.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(l.timeout=this._opts.requestTimeout),l.onreadystatechange=()=>{var h;l.readyState===3&&((h=this._opts.cookieJar)===null||h===void 0||h.parseCookies(l.getResponseHeader("set-cookie"))),l.readyState===4&&(l.status===200||l.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof l.status=="number"?l.status:0)},0))},l.send(this._data)}catch(h){this.setTimeoutFn(()=>{this._onError(h)},0);return}typeof document<"u"&&(this._index=I_.requestsCount++,I_.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=lX,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete I_.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};ch.requestsCount=0;ch.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",HA);else if(typeof addEventListener=="function"){const e="onpagehide"in ls?"pagehide":"unload";addEventListener(e,HA,!1)}}function HA(){for(let e in ch.requests)ch.requests.hasOwnProperty(e)&&ch.requests[e].abort()}const uX=function(){const e=qL({xdomain:!1});return e&&e.responseType!==null}();class dX extends cX{constructor(t){super(t);const r=t&&t.forceBase64;this.supportsBinary=uX&&!r}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new ch(qL,this.uri(),t)}}function qL(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||aX))return new XMLHttpRequest}catch{}if(!t)try{return new ls[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const HL=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class hX extends tE{get name(){return"websocket"}doOpen(){const t=this.uri(),r=this.opts.protocols,l=HL?{}:VL(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(l.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,r,l)}catch(h){return this.emitReserved("error",h)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const l=t[r],h=r===t.length-1;QS(l,this.supportsBinary,m=>{try{this.doWrite(l,m)}catch{}h&&Kx(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=WL()),this.supportsBinary||(r.b64=1),this.createUri(t,r)}}const Rb=ls.WebSocket||ls.MozWebSocket;class pX extends hX{createSocket(t,r,l){return HL?new Rb(t,r,l):r?new Rb(t,r):new Rb(t)}doWrite(t,r){this.ws.send(r)}}class fX extends tE{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const r=XZ(Number.MAX_SAFE_INTEGER,this.socket.binaryType),l=t.readable.pipeThrough(r).getReader(),h=ZZ();h.readable.pipeTo(t.writable),this._writer=h.writable.getWriter();const m=()=>{l.read().then(({done:a,value:E})=>{a||(this.onPacket(E),m())}).catch(a=>{})};m();const x={type:"open"};this.query.sid&&(x.data=`{"sid":"${this.query.sid}"}`),this._writer.write(x).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const l=t[r],h=r===t.length-1;this._writer.write(l).then(()=>{h&&Kx(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const mX={websocket:pX,webtransport:fX,polling:dX},gX=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,yX=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function r2(e){if(e.length>8e3)throw"URI too long";const t=e,r=e.indexOf("["),l=e.indexOf("]");r!=-1&&l!=-1&&(e=e.substring(0,r)+e.substring(r,l).replace(/:/g,";")+e.substring(l,e.length));let h=gX.exec(e||""),m={},x=14;for(;x--;)m[yX[x]]=h[x]||"";return r!=-1&&l!=-1&&(m.source=t,m.host=m.host.substring(1,m.host.length-1).replace(/;/g,":"),m.authority=m.authority.replace("[","").replace("]","").replace(/;/g,":"),m.ipv6uri=!0),m.pathNames=_X(m,m.path),m.queryKey=xX(m,m.query),m}function _X(e,t){const r=/\/{2,9}/g,l=t.replace(r,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&l.splice(0,1),t.slice(-1)=="/"&&l.splice(l.length-1,1),l}function xX(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(l,h,m){h&&(r[h]=m)}),r}const i2=typeof addEventListener=="function"&&typeof removeEventListener=="function",A_=[];i2&&addEventListener("offline",()=>{A_.forEach(e=>e())},!1);class rc extends li{constructor(t,r){if(super(),this.binaryType=YZ,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(r=t,t=null),t){const l=r2(t);r.hostname=l.host,r.secure=l.protocol==="https"||l.protocol==="wss",r.port=l.port,l.query&&(r.query=l.query)}else r.host&&(r.hostname=r2(r.host).host);Yx(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(l=>{const h=l.prototype.name;this.transports.push(h),this._transportsByName[h]=l}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=iX(this.opts.query)),i2&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},A_.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const r=Object.assign({},this.opts.query);r.EIO=UL,r.transport=t,this.id&&(r.sid=this.id);const l=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](l)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&rc.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(t);r.open(),this.setTransport(r)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",rc.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=t.data,this._onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let l=0;l<this.writeBuffer.length;l++){const h=this.writeBuffer[l].data;if(h&&(r+=tX(h)),l>0&&r>this._maxPayload)return this.writeBuffer.slice(0,l);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Kx(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,r,l){return this._sendPacket("message",t,r,l),this}send(t,r,l){return this._sendPacket("message",t,r,l),this}_sendPacket(t,r,l,h){if(typeof r=="function"&&(h=r,r=void 0),typeof l=="function"&&(h=l,l=null),this.readyState==="closing"||this.readyState==="closed")return;l=l||{},l.compress=l.compress!==!1;const m={type:t,data:r,options:l};this.emitReserved("packetCreate",m),this.writeBuffer.push(m),h&&this.once("flush",h),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},l=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?l():t()}):this.upgrading?l():t()),this}_onError(t){if(rc.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),i2&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const l=A_.indexOf(this._offlineEventListener);l!==-1&&A_.splice(l,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this._prevBufferLen=0}}}rc.protocol=UL;class vX extends rc{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let r=this.createTransport(t),l=!1;rc.priorWebsocketSuccess=!1;const h=()=>{l||(r.send([{type:"ping",data:"probe"}]),r.once("packet",O=>{if(!l)if(O.type==="pong"&&O.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;rc.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{l||this.readyState!=="closed"&&(L(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const F=new Error("probe error");F.transport=r.name,this.emitReserved("upgradeError",F)}}))};function m(){l||(l=!0,L(),r.close(),r=null)}const x=O=>{const F=new Error("probe error: "+O);F.transport=r.name,m(),this.emitReserved("upgradeError",F)};function a(){x("transport closed")}function E(){x("socket closed")}function I(O){r&&O.name!==r.name&&m()}const L=()=>{r.removeListener("open",h),r.removeListener("error",x),r.removeListener("close",a),this.off("close",E),this.off("upgrading",I)};r.once("open",h),r.once("error",x),r.once("close",a),this.once("close",E),this.once("upgrading",I),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{l||r.open()},200):r.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const r=[];for(let l=0;l<t.length;l++)~this.transports.indexOf(t[l])&&r.push(t[l]);return r}}let bX=class extends vX{constructor(t,r={}){const l=typeof t=="object"?t:r;(!l.transports||l.transports&&typeof l.transports[0]=="string")&&(l.transports=(l.transports||["polling","websocket","webtransport"]).map(h=>mX[h]).filter(h=>!!h)),super(t,l)}};function wX(e,t="",r){let l=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),l=r2(e)),l.port||(/^(http|ws)$/.test(l.protocol)?l.port="80":/^(http|ws)s$/.test(l.protocol)&&(l.port="443")),l.path=l.path||"/";const m=l.host.indexOf(":")!==-1?"["+l.host+"]":l.host;return l.id=l.protocol+"://"+m+":"+l.port+t,l.href=l.protocol+"://"+m+(r&&r.port===l.port?"":":"+l.port),l}const SX=typeof ArrayBuffer=="function",EX=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,ZL=Object.prototype.toString,TX=typeof Blob=="function"||typeof Blob<"u"&&ZL.call(Blob)==="[object BlobConstructor]",CX=typeof File=="function"||typeof File<"u"&&ZL.call(File)==="[object FileConstructor]";function nE(e){return SX&&(e instanceof ArrayBuffer||EX(e))||TX&&e instanceof Blob||CX&&e instanceof File}function M_(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,l=e.length;r<l;r++)if(M_(e[r]))return!0;return!1}if(nE(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return M_(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&M_(e[r]))return!0;return!1}function kX(e){const t=[],r=e.data,l=e;return l.data=o2(r,t),l.attachments=t.length,{packet:l,buffers:t}}function o2(e,t){if(!e)return e;if(nE(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){const r=new Array(e.length);for(let l=0;l<e.length;l++)r[l]=o2(e[l],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){const r={};for(const l in e)Object.prototype.hasOwnProperty.call(e,l)&&(r[l]=o2(e[l],t));return r}return e}function IX(e,t){return e.data=s2(e.data,t),delete e.attachments,e}function s2(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=s2(e[r],t);else if(typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=s2(e[r],t));return e}const AX=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],MX=5;var Rn;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(Rn||(Rn={}));class PX{constructor(t){this.replacer=t}encode(t){return(t.type===Rn.EVENT||t.type===Rn.ACK)&&M_(t)?this.encodeAsBinary({type:t.type===Rn.EVENT?Rn.BINARY_EVENT:Rn.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===Rn.BINARY_EVENT||t.type===Rn.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(r+=t.nsp+","),t.id!=null&&(r+=t.id),t.data!=null&&(r+=JSON.stringify(t.data,this.replacer)),r}encodeAsBinary(t){const r=kX(t),l=this.encodeAsString(r.packet),h=r.buffers;return h.unshift(l),h}}function ZA(e){return Object.prototype.toString.call(e)==="[object Object]"}class rE extends li{constructor(t){super(),this.reviver=t}add(t){let r;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(t);const l=r.type===Rn.BINARY_EVENT;l||r.type===Rn.BINARY_ACK?(r.type=l?Rn.EVENT:Rn.ACK,this.reconstructor=new RX(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(nE(t)||t.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let r=0;const l={type:Number(t.charAt(0))};if(Rn[l.type]===void 0)throw new Error("unknown packet type "+l.type);if(l.type===Rn.BINARY_EVENT||l.type===Rn.BINARY_ACK){const m=r+1;for(;t.charAt(++r)!=="-"&&r!=t.length;);const x=t.substring(m,r);if(x!=Number(x)||t.charAt(r)!=="-")throw new Error("Illegal attachments");l.attachments=Number(x)}if(t.charAt(r+1)==="/"){const m=r+1;for(;++r&&!(t.charAt(r)===","||r===t.length););l.nsp=t.substring(m,r)}else l.nsp="/";const h=t.charAt(r+1);if(h!==""&&Number(h)==h){const m=r+1;for(;++r;){const x=t.charAt(r);if(x==null||Number(x)!=x){--r;break}if(r===t.length)break}l.id=Number(t.substring(m,r+1))}if(t.charAt(++r)){const m=this.tryParse(t.substr(r));if(rE.isPayloadValid(l.type,m))l.data=m;else throw new Error("invalid payload")}return l}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,r){switch(t){case Rn.CONNECT:return ZA(r);case Rn.DISCONNECT:return r===void 0;case Rn.CONNECT_ERROR:return typeof r=="string"||ZA(r);case Rn.EVENT:case Rn.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&AX.indexOf(r[0])===-1);case Rn.ACK:case Rn.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class RX{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const r=IX(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const zX=Object.freeze(Object.defineProperty({__proto__:null,Decoder:rE,Encoder:PX,get PacketType(){return Rn},protocol:MX},Symbol.toStringTag,{value:"Module"}));function Ws(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const LX=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class XL extends li{constructor(t,r,l){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,l&&l.auth&&(this.auth=l.auth),this._opts=Object.assign({},l),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Ws(t,"open",this.onopen.bind(this)),Ws(t,"packet",this.onpacket.bind(this)),Ws(t,"error",this.onerror.bind(this)),Ws(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){var l,h,m;if(LX.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(r.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const x={type:Rn.EVENT,data:r};if(x.options={},x.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const L=this.ids++,O=r.pop();this._registerAckCallback(L,O),x.id=L}const a=(h=(l=this.io.engine)===null||l===void 0?void 0:l.transport)===null||h===void 0?void 0:h.writable,E=this.connected&&!(!((m=this.io.engine)===null||m===void 0)&&m._hasPingExpired());return this.flags.volatile&&!a||(E?(this.notifyOutgoingListeners(x),this.packet(x)):this.sendBuffer.push(x)),this.flags={},this}_registerAckCallback(t,r){var l;const h=(l=this.flags.timeout)!==null&&l!==void 0?l:this._opts.ackTimeout;if(h===void 0){this.acks[t]=r;return}const m=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===t&&this.sendBuffer.splice(a,1);r.call(this,new Error("operation has timed out"))},h),x=(...a)=>{this.io.clearTimeoutFn(m),r.apply(this,a)};x.withError=!0,this.acks[t]=x}emitWithAck(t,...r){return new Promise((l,h)=>{const m=(x,a)=>x?h(x):l(a);m.withError=!0,r.push(m),this.emit(t,...r)})}_addToQueue(t){let r;typeof t[t.length-1]=="function"&&(r=t.pop());const l={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((h,...m)=>l!==this._queue[0]?void 0:(h!==null?l.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(h)):(this._queue.shift(),r&&r(null,...m)),l.pending=!1,this._drainQueue())),this._queue.push(l),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!t||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:Rn.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(l=>String(l.id)===t)){const l=this.acks[t];delete this.acks[t],l.withError&&l.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case Rn.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Rn.EVENT:case Rn.BINARY_EVENT:this.onevent(t);break;case Rn.ACK:case Rn.BINARY_ACK:this.onack(t);break;case Rn.DISCONNECT:this.ondisconnect();break;case Rn.CONNECT_ERROR:this.destroy();const l=new Error(t.data.message);l.data=t.data.data,this.emitReserved("connect_error",l);break}}onevent(t){const r=t.data||[];t.id!=null&&r.push(this.ack(t.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const l of r)l.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const r=this;let l=!1;return function(...h){l||(l=!0,r.packet({type:Rn.ACK,id:t,data:h}))}}onack(t){const r=this.acks[t.id];typeof r=="function"&&(delete this.acks[t.id],r.withError&&t.data.unshift(null),r.apply(this,t.data))}onconnect(t,r){this.id=t,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Rn.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const r=this._anyListeners;for(let l=0;l<r.length;l++)if(t===r[l])return r.splice(l,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const r=this._anyOutgoingListeners;for(let l=0;l<r.length;l++)if(t===r[l])return r.splice(l,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const l of r)l.apply(this,t.data)}}}function $h(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}$h.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+r:e-r}return Math.min(e,this.max)|0};$h.prototype.reset=function(){this.attempts=0};$h.prototype.setMin=function(e){this.ms=e};$h.prototype.setMax=function(e){this.max=e};$h.prototype.setJitter=function(e){this.jitter=e};class a2 extends li{constructor(t,r){var l;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(r=t,t=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,Yx(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((l=r.randomizationFactor)!==null&&l!==void 0?l:.5),this.backoff=new $h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=t;const h=r.parser||zX;this.encoder=new h.Encoder,this.decoder=new h.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(r=this.backoff)===null||r===void 0||r.setMin(t),this)}randomizationFactor(t){var r;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(r=this.backoff)===null||r===void 0||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(r=this.backoff)===null||r===void 0||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new bX(this.uri,this.opts);const r=this.engine,l=this;this._readyState="opening",this.skipReconnect=!1;const h=Ws(r,"open",function(){l.onopen(),t&&t()}),m=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),t?t(a):this.maybeReconnectOnOpen()},x=Ws(r,"error",m);if(this._timeout!==!1){const a=this._timeout,E=this.setTimeoutFn(()=>{h(),m(new Error("timeout")),r.close()},a);this.opts.autoUnref&&E.unref(),this.subs.push(()=>{this.clearTimeoutFn(E)})}return this.subs.push(h),this.subs.push(x),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Ws(t,"ping",this.onping.bind(this)),Ws(t,"data",this.ondata.bind(this)),Ws(t,"error",this.onerror.bind(this)),Ws(t,"close",this.onclose.bind(this)),Ws(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(r){this.onclose("parse error",r)}}ondecoded(t){Kx(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,r){let l=this.nsps[t];return l?this._autoConnect&&!l.active&&l.connect():(l=new XL(this,t,r),this.nsps[t]=l),l}_destroy(t){const r=Object.keys(this.nsps);for(const l of r)if(this.nsps[l].active)return;this._close()}_packet(t){const r=this.encoder.encode(t);for(let l=0;l<r.length;l++)this.engine.write(r[l],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,r){var l;this.cleanup(),(l=this.engine)===null||l===void 0||l.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const l=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(h=>{h?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",h)):t.onreconnect()}))},r);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Of={};function zb(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const r=wX(e,t.path||"/socket.io"),l=r.source,h=r.id,m=r.path,x=Of[h]&&m in Of[h].nsps,a=t.forceNew||t["force new connection"]||t.multiplex===!1||x;let E;return a?E=new a2(l,t):(Of[h]||(Of[h]=new a2(l,t)),E=Of[h]),r.query&&!t.query&&(t.query=r.queryKey),E.socket(r.path,t)}Object.assign(zb,{Manager:a2,Socket:XL,io:zb,connect:zb});const DX=()=>{var pe,_e,xe,De;const e=lx(),{messages:t,isLoading:r,error:l,socket:h,isConnected:m,searchResults:x,suggestions:a}=$0(ye=>ye.chat),[E,I]=J.useState(""),[L,O]=J.useState(!1),[F,K]=J.useState(0),W=J.useRef(null),G=J.useRef(null);J.useEffect(()=>{const Ae=setTimeout(()=>{{console.log("Production environment detected - using HTTP API only"),e(hN(!1));return}},100);return()=>{clearTimeout(Ae),G.current&&(G.current.disconnect(),G.current=null)}},[e,F]),J.useEffect(()=>{W.current&&W.current.scrollIntoView({behavior:"smooth",block:"end"})},[t,L]);const ne=async()=>{if(!E.trim())return;const ye=E.trim();e(pN(ye)),I(""),O(!0);try{{console.log("Using HTTP API for message sending");const Ae=await e(g_({message:ye,sessionId:"user-session"})).unwrap();Ae.data&&Ae.data.text?e(mb(Ae.data.text)):e(mb(Ae.message||"I received your message!"))}}catch(Ae){console.error("Error sending message:",Ae);const ft=Z(ye);e(mb(ft))}finally{O(!1)}},Z=ye=>{const Ae=ye.toLowerCase();return Ae.includes("hello")||Ae.includes("hi")||Ae.includes("hey")?"Hello! I'm CeBot, your Cebu transport assistant. How can I help you today? You can ask me about routes, jeepney codes, or how to get from one place to another.":Ae.includes("route")||Ae.includes("jeepney")||Ae.includes("bus")?"I can help you find transport routes! Just tell me where you want to go from and to, like 'from Apas to Fuente' or 'how do I get from Ayala to SM'.":Ae.includes("help")?"I can help you with: finding routes, looking up jeepney codes, and getting transport information in Cebu City. What do you need?":Ae.includes("thank")?"You're welcome! Is there anything else I can help you with regarding Cebu transport?":Ae.includes("bye")||Ae.includes("goodbye")?"Goodbye! Have a safe journey in Cebu City!":"I'm here to help with Cebu transport! You can ask me about routes, jeepney codes, or how to get from one place to another. Try asking something like 'How do I get from Apas to Fuente?'"},H=ye=>{ye.key==="Enter"&&!ye.shiftKey&&(ye.preventDefault(),ne())},V=(ye,Ae)=>{const ft=`How do I get from ${ye} to ${Ae}?`;I(ft)},oe=ye=>{switch(ye){case"jeepney":return D.jsx(nc,{fontSize:"small",color:"primary"});case"modern_jeep":return D.jsx(nc,{fontSize:"small",color:"secondary"});case"bus":return D.jsx(JS,{fontSize:"small",color:"primary"});default:return D.jsx(nc,{fontSize:"small"})}};return D.jsxs(Pt,{sx:{maxWidth:1200,mx:"auto"},children:[D.jsx(yt,{variant:"h4",gutterBottom:!0,align:"center",color:"primary",sx:{fontSize:{xs:"1.5rem",sm:"1.8rem",md:"2.125rem"},mb:{xs:2,md:3}},children:" CeBot - Cebu Transport Assistant"}),D.jsxs(er,{container:!0,spacing:{xs:2,md:3},children:[D.jsx(er,{item:!0,xs:12,md:8,children:D.jsx(fr,{sx:{height:{xs:"70vh",sm:"75vh",md:"80vh"},display:"flex",flexDirection:"column",mb:{xs:2,md:0},overflow:"hidden"},children:D.jsxs(vr,{sx:{height:"100%",display:"flex",flexDirection:"column",p:{xs:1,sm:2},"&:last-child":{pb:{xs:1,sm:2}}},children:[D.jsx(Pt,{sx:{flex:"1 1 0",minHeight:0,overflow:"auto",mb:2,"&::-webkit-scrollbar":{width:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"#f1f1f1",borderRadius:"4px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#c1c1c1",borderRadius:"4px","&:hover":{backgroundColor:"#a8a8a8"}},scrollbarWidth:"thin",scrollbarColor:"#c1c1c1 #f1f1f1"},children:D.jsxs(Tu,{sx:{pb:0},children:[t.map((ye,Ae)=>D.jsx(Ga,{sx:{justifyContent:ye.sender==="user"?"flex-end":"flex-start",py:.5},children:D.jsxs(lc,{elevation:ye.sender==="user"?2:1,sx:{p:{xs:1.5,md:2},maxWidth:{xs:"85%",md:"75%"},backgroundColor:ye.sender==="user"?"primary.main":"grey.100",color:ye.sender==="user"?"white":"text.primary",borderRadius:ye.sender==="user"?"18px 18px 4px 18px":"18px 18px 18px 4px",wordBreak:"break-word",animation:"fadeIn 0.3s ease-in"},children:[D.jsx(yt,{variant:"body1",sx:{lineHeight:1.4},children:ye.message}),D.jsx(yt,{variant:"caption",sx:{opacity:.7,mt:1,display:"block",fontSize:"0.7rem"},children:new Date(ye.timestamp).toLocaleTimeString()})]})},ye.id||Ae)),L&&D.jsx(Ga,{sx:{justifyContent:"flex-start",py:.5},children:D.jsx(lc,{elevation:1,sx:{p:2,backgroundColor:"grey.100",borderRadius:"18px 18px 18px 4px",display:"flex",alignItems:"center",gap:1},children:D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:.5},children:[D.jsx(yt,{variant:"body2",color:"text.secondary",children:"CeBot is typing"}),D.jsx(Pt,{sx:{display:"flex",gap:.3},children:[0,1,2].map(ye=>D.jsx(Pt,{sx:{width:4,height:4,borderRadius:"50%",backgroundColor:"primary.main",animation:"typingDot 1.4s infinite ease-in-out",animationDelay:`${ye*.16}s`,"@keyframes typingDot":{"0%, 80%, 100%":{opacity:.3,transform:"scale(0.8)"},"40%":{opacity:1,transform:"scale(1)"}}}},ye))})]})})}),D.jsx("div",{ref:W})]})}),D.jsxs(Pt,{sx:{flexShrink:0,display:"flex",gap:1,alignItems:"flex-end",pt:1},children:[D.jsx(lh,{fullWidth:!0,multiline:!0,maxRows:3,value:E,onChange:ye=>I(ye.target.value),onKeyPress:H,placeholder:"Ask me about Cebu transport routes...",variant:"outlined",size:"small",disabled:r,InputProps:{sx:{fontSize:{xs:"0.9rem",md:"1rem"}}}}),D.jsx(ro,{variant:"contained",onClick:ne,disabled:!E.trim()||r,sx:{minWidth:{xs:"40px",md:"auto"},px:{xs:1,md:2},height:{xs:"40px",md:"auto"}},children:r?D.jsx(Om,{size:20}):D.jsx(FZ,{})})]})]})})}),D.jsx(er,{item:!0,xs:12,md:4,children:D.jsxs(Pt,{sx:{display:"flex",flexDirection:"column",gap:2},children:[x&&D.jsx(fr,{sx:{height:{md:"350px",display:"flex",flexDirection:"column"}},children:D.jsxs(vr,{sx:{display:"flex",flexDirection:"column",height:"100%",overflow:{md:"hidden"}},children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,children:" Route Results"}),D.jsxs(yt,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:["From ",x.origin," to ",x.destination]}),x.data&&x.data.length>0?D.jsx(Tu,{dense:!0,sx:{overflow:{md:"auto"},maxHeight:{md:"250px"},"&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,0.2)",borderRadius:"3px"},"&::-webkit-scrollbar-track":{backgroundColor:"rgba(0,0,0,0.05)"},flexGrow:1},children:x.data.map((ye,Ae)=>D.jsx(Ga,{sx:{px:0},children:D.jsx(pu,{primary:D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[oe(ye.type),D.jsx(yt,{variant:"body2",fontWeight:"bold",children:ye.route_code})]}),secondary:D.jsxs(Pt,{children:[D.jsxs(yt,{variant:"caption",display:"block",children:[ye.origin,"  ",ye.destination]}),ye.notes&&D.jsx(yt,{variant:"caption",color:"text.secondary",children:ye.notes})]})})},Ae))}):D.jsx(yt,{variant:"body2",color:"text.secondary",children:"No direct routes found"})]})}),a&&(((pe=a.similarOrigins)==null?void 0:pe.length)>0||((_e=a.similarDestinations)==null?void 0:_e.length)>0)&&D.jsx(fr,{children:D.jsxs(vr,{children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,children:" Suggestions"}),((xe=a.similarOrigins)==null?void 0:xe.length)>0&&D.jsxs(Pt,{sx:{mb:2},children:[D.jsx(yt,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Similar origins:"}),D.jsx(Pt,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:a.similarOrigins.map((ye,Ae)=>D.jsx(Zi,{label:`${ye.code} (${ye.location})`,size:"small",variant:"outlined",onClick:()=>V(ye.location,""),clickable:!0},Ae))})]}),((De=a.similarDestinations)==null?void 0:De.length)>0&&D.jsxs(Pt,{children:[D.jsx(yt,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Similar destinations:"}),D.jsx(Pt,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:a.similarDestinations.map((ye,Ae)=>D.jsx(Zi,{label:`${ye.code} (${ye.location})`,size:"small",variant:"outlined",onClick:()=>V("",ye.location),clickable:!0},Ae))})]})]})}),D.jsx(fr,{children:D.jsxs(vr,{children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,children:" Quick Actions"}),D.jsxs(Pt,{sx:{display:"flex",flexDirection:"column",gap:1},children:[D.jsx(ro,{variant:"outlined",size:"small",onClick:()=>V("Apas","Fuente"),startIcon:D.jsx(Za,{}),children:"Apas  Fuente"}),D.jsx(ro,{variant:"outlined",size:"small",onClick:()=>V("Ayala","SM"),startIcon:D.jsx(Za,{}),children:"Ayala  SM"}),D.jsx(ro,{variant:"outlined",size:"small",onClick:()=>V("Colon","Carbon"),startIcon:D.jsx(Za,{}),children:"Colon  Carbon"})]})]})})]})})]}),l&&D.jsx(im,{severity:"error",sx:{mt:2},children:l})]})};var KL={exports:{}};(function(e,t){(function(r,l){e.exports=l()})(kO,function(){var r,l,h;function m(a,E){if(!r)r=E;else if(!l)l=E;else{var I="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+l+")(sharedChunk); self.onerror = null;",L={};r(L),h=E(L),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(h.workerUrl=window.URL.createObjectURL(new Blob([I],{type:"text/javascript"})))}}m(["exports"],function(a){var E=typeof self<"u"?self:{},I="2.15.0";let L;const O={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(L==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{L={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):i}catch{L=i}}return L},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!O.API_URL)return null;try{const i=new URL(O.API_URL);return i.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":i.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},F={supported:!1,testSupport:function(i){!G&&W&&(ne?Z(i):K=i)}};let K,W,G=!1,ne=!1;function Z(i){const n=i.createTexture();i.bindTexture(i.TEXTURE_2D,n);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,W),i.isContextLost())return;F.supported=!0}catch{}i.deleteTexture(n),G=!0}E.document&&(W=E.document.createElement("img"),W.onload=function(){K&&Z(K),K=null,ne=!0},W.onerror=function(){G=!0,K=null},W.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const H="01";function V(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var oe=pe;function pe(i,n,o,c){this.cx=3*i,this.bx=3*(o-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(c-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=o,this.p2y=c}pe.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,n){if(n===void 0&&(n=1e-6),i<0)return 0;if(i>1)return 1;for(var o=i,c=0;c<8;c++){var d=this.sampleCurveX(o)-i;if(Math.abs(d)<n)return o;var f=this.sampleCurveDerivativeX(o);if(Math.abs(f)<1e-6)break;o-=d/f}var y=0,v=1;for(o=i,c=0;c<20&&(d=this.sampleCurveX(o),!(Math.abs(d-i)<n));c++)i>d?y=o:v=o,o=.5*(v-y)+y;return o},solve:function(i,n){return this.sampleCurveY(this.solveCurveX(i,n))}};var _e=V(oe),xe=De;function De(i,n){this.x=i,this.y=n}De.prototype={clone:function(){return new De(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,n){return this.clone()._rotateAround(i,n)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var n=i.x-this.x,o=i.y-this.y;return n*n+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,n){return Math.atan2(this.x*n-this.y*i,this.x*i+this.y*n)},_matMult:function(i){var n=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=n,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var n=Math.cos(i),o=Math.sin(i),c=o*this.x+n*this.y;return this.x=n*this.x-o*this.y,this.y=c,this},_rotateAround:function(i,n){var o=Math.cos(i),c=Math.sin(i),d=n.y+c*(this.x-n.x)+o*(this.y-n.y);return this.x=n.x+o*(this.x-n.x)-c*(this.y-n.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},De.convert=function(i){return i instanceof De?i:Array.isArray(i)?new De(i[0],i[1]):i};var ye=V(xe);const Ae=Math.PI/180,ft=180/Math.PI;function Ge(i){return i*Ae}function et(i){return i*ft}const lt=[[0,0],[1,0],[1,1],[0,1]];function gt(i){if(i<=0)return 0;if(i>=1)return 1;const n=i*i,o=n*i;return 4*(i<.5?o:3*(i-n)+o-.75)}function St(i,n,o,c){const d=new _e(i,n,o,c);return function(f){return d.solve(f)}}const It=St(.25,.1,.25,1);function Re(i,n,o){return Math.min(o,Math.max(n,i))}function ct(i,n,o){return(o=Re((o-i)/(n-i),0,1))*o*(3-2*o)}function Ie(i,n,o){const c=o-n,d=((i-n)%c+c)%c+n;return d===n?o:d}function st(i,n,o){if(!i.length)return o(null,[]);let c=i.length;const d=new Array(i.length);let f=null;i.forEach((y,v)=>{n(y,(w,S)=>{w&&(f=w),d[v]=S,--c==0&&o(f,d)})})}function Tt(i){const n=[];for(const o in i)n.push(i[o]);return n}function zt(i,...n){for(const o of n)for(const c in o)i[c]=o[c];return i}let Nt=1;function en(){return Nt++}function Zt(){return function i(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function Mn(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Wr(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function qn(i,n){i.forEach(o=>{n[o]&&(n[o]=n[o].bind(n))})}function Mr(i,n){return i.indexOf(n,i.length-n.length)!==-1}function Rt(i,n,o){const c={};for(const d in i)c[d]=n.call(o||this,i[d],d,i);return c}function Dn(i,n,o){const c={};for(const d in i)n.call(o||this,i[d],d,i)&&(c[d]=i[d]);return c}function Xt(i){return Array.isArray(i)?i.map(Xt):typeof i=="object"&&i?Rt(i,Xt):i}const Cn={};function Kt(i){Cn[i]||(typeof console<"u"&&console.warn(i),Cn[i]=!0)}function Pr(i,n,o){return(o.y-i.y)*(n.x-i.x)>(n.y-i.y)*(o.x-i.x)}function di(i){let n=0;for(let o,c,d=0,f=i.length,y=f-1;d<f;y=d++)o=i[d],c=i[y],n+=(c.x-o.x)*(o.y+c.y);return n}function Sr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function lr(i){const n={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,c,d,f)=>{const y=d||f;return n[c]=!y||y.toLowerCase(),""}),n["max-age"]){const o=parseInt(n["max-age"],10);isNaN(o)?delete n["max-age"]:n["max-age"]=o}return n}let Qr=null;function On(i){if(Qr==null){const n=i.navigator?i.navigator.userAgent:null;Qr=!!i.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Qr}function ki(i){try{const n=E[i];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}}function gr(i,n){return[i[4*n],i[4*n+1],i[4*n+2],i[4*n+3]]}const zn="mapbox-tiles";let Ii=500,Ji=50,Er,wn;function qt(){try{return E.caches}catch{}}function hi(){qt()&&!Er&&(Er=E.caches.open(zn))}function ao(i){const n=i.indexOf("?");if(n<0)return i;const o=function(d){const f=d.indexOf("?");return f>0?d.slice(f+1).split("&"):[]}(i),c=o.filter(d=>{const f=d.split("=");return f[0]==="language"||f[0]==="worldview"});return c.length?`${i.slice(0,n)}?${c.join("&")}`:i.slice(0,n)}let To=1/0;const Gt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Gt);class kn extends Error{constructor(n,o,c){o===401&&Le(c)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=o,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const cr=Sr()?()=>self.worker&&self.worker.referrer:()=>(E.location.protocol==="blob:"?E.parent:E).location.href,Di=function(i,n){if(!(/^file:/.test(o=i.url)||/^file:/.test(cr())&&!/^\w+:/.test(o))){if(E.fetch&&E.Request&&E.AbortController&&E.Request.prototype.hasOwnProperty("signal"))return function(c,d){const f=new E.AbortController,y=new E.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:cr(),referrerPolicy:c.referrerPolicy,signal:f.signal});let v=!1,w=!1;const S=(k=y.url).indexOf("sku=")>0&&Le(k);var k;c.type==="json"&&y.headers.set("Accept","application/json");const M=(B,j,U)=>{if(w)return;if(B&&B.message!=="SecurityError"&&Kt(B.toString()),j&&U)return P(j);const Q=Date.now();E.fetch(y).then(ae=>{if(ae.ok){const ge=S?ae.clone():null;return P(ae,ge,Q)}return d(new kn(ae.statusText,ae.status,c.url))}).catch(ae=>{ae.name!=="AbortError"&&d(new Error(`${ae.message} ${c.url}`))})},P=(B,j,U)=>{(c.type==="arrayBuffer"?B.arrayBuffer():c.type==="json"?B.json():B.text()).then(Q=>{w||(j&&U&&function(ae,ge,le){if(hi(),!Er)return;const fe={status:ge.status,statusText:ge.statusText,headers:new E.Headers};ge.headers.forEach((Ne,Be)=>fe.headers.set(Be,Ne));const be=lr(ge.headers.get("Cache-Control")||"");if(be["no-store"])return;be["max-age"]&&fe.headers.set("Expires",new Date(le+1e3*be["max-age"]).toUTCString());const ve=fe.headers.get("Expires");ve&&(new Date(ve).getTime()-le<42e4||function(Ne,Be){if(wn===void 0)try{new Response(new ReadableStream),wn=!0}catch{wn=!1}wn?Be(Ne.body):Ne.blob().then(Be)}(ge,Ne=>{const Be=new E.Response(Ne,fe);hi(),Er&&Er.then(He=>He.put(ao(ae.url),Be)).catch(He=>Kt(He.message))}))}(y,j,U),v=!0,d(null,Q,B.headers.get("Cache-Control"),B.headers.get("Expires")))}).catch(Q=>{w||d(new Error(Q.message))})};return S?function(B,j){if(hi(),!Er)return j(null);const U=ao(B.url);Er.then(Q=>{Q.match(U).then(ae=>{const ge=function(le){if(!le)return!1;const fe=new Date(le.headers.get("Expires")||0),be=lr(le.headers.get("Cache-Control")||"");return fe>Date.now()&&!be["no-cache"]}(ae);Q.delete(U),ge&&Q.put(U,ae.clone()),j(null,ae,ge)}).catch(j)}).catch(j)}(y,M):M(null,null),{cancel:()=>{w=!0,v||f.abort()}}}(i,n);if(Sr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,n,void 0,!0)}var o;return function(c,d){const f=new E.XMLHttpRequest;f.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(f.responseType="arraybuffer");for(const y in c.headers)f.setRequestHeader(y,c.headers[y]);return c.type==="json"&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials=c.credentials==="include",f.onerror=()=>{d(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||f.status===0)&&f.response!==null){let y=f.response;if(c.type==="json")try{y=JSON.parse(f.response)}catch(v){return d(v)}d(null,y,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else d(new kn(f.statusText,f.status,c.url))},f.send(c.body),{cancel:()=>f.abort()}}(i,n)},vs=function(i,n){return Di(zt(i,{type:"arrayBuffer"}),n)};function Pu(i){const n=E.document.createElement("a");return n.href=i,n.protocol===E.document.location.protocol&&n.host===E.document.location.host}const me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let q,X;q=[],X=0;const he=function(i,n){if(F.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),X>=O.MAX_PARALLEL_IMAGE_REQUESTS){const f={requestParameters:i,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return q.push(f),f}X++;let o=!1;const c=()=>{if(!o)for(o=!0,X--;q.length&&X<O.MAX_PARALLEL_IMAGE_REQUESTS;){const f=q.shift(),{requestParameters:y,callback:v,cancelled:w}=f;w||(f.cancel=he(y,v).cancel)}},d=vs(i,(f,y,v,w)=>{c(),f?n(f):y&&(E.createImageBitmap?function(S,k){const M=new E.Blob([new Uint8Array(S)],{type:"image/png"});E.createImageBitmap(M).then(P=>{k(null,P)}).catch(P=>{k(new Error(`Could not load image because of ${P.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(S,k)=>n(S,k,v,w)):function(S,k){const M=new E.Image,P=E.URL;M.onload=()=>{k(null,M),P.revokeObjectURL(M.src),M.onload=null,E.requestAnimationFrame(()=>{M.src=me})},M.onerror=()=>k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const B=new E.Blob([new Uint8Array(S)],{type:"image/png"});M.src=S.byteLength?P.createObjectURL(B):me}(y,(S,k)=>n(S,k,v,w)))});return{cancel:()=>{d.cancel(),c()}}},we="NO_ACCESS_TOKEN";function ke(i){return i.indexOf("mapbox:")===0}function Le(i){return O.API_URL_REGEX.test(i)}function ze(i){return O.API_CDN_URL_REGEX.test(i)}function Ce(i){return O.API_STYLE_REGEX.test(i)&&!Ve(i)}function Ve(i){return O.API_SPRITE_REGEX.test(i)}const pt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function mt(i){const n=i.match(pt);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function ut(i){const n=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${n}`}const tn="mapbox.eventData";function sn(i){if(!i)return null;const n=i.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(decodeURIComponent(E.atob(n[1]).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class nn{constructor(n){this.type=n,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(n){const o=sn(O.ACCESS_TOKEN);let c="";return c=o&&o.u?E.btoa(encodeURIComponent(o.u).replace(/%([0-9A-F]{2})/g,(d,f)=>String.fromCharCode(+("0x"+f)))):O.ACCESS_TOKEN||"",n?`${tn}.${n}:${c}`:`${tn}:${c}`}fetchEventData(){const n=ki("localStorage"),o=this.getStorageKey(),c=this.getStorageKey("uuid");if(n)try{const d=E.localStorage.getItem(o);d&&(this.eventData=JSON.parse(d));const f=E.localStorage.getItem(c);f&&(this.anonId=f)}catch{Kt("Unable to read from LocalStorage")}}saveEventData(){const n=ki("localStorage"),o=this.getStorageKey(),c=this.getStorageKey("uuid");if(n)try{E.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&E.localStorage.setItem(o,JSON.stringify(this.eventData))}catch{Kt("Unable to write to LocalStorage")}}processRequests(n){}postEvent(n,o,c,d){if(!O.EVENTS_URL)return;const f=mt(O.EVENTS_URL);f.params.push(`access_token=${d||O.ACCESS_TOKEN||""}`);const y={event:this.type,created:new Date(n).toISOString()},v=o?zt(y,o):y,w={url:ut(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([v])};this.pendingRequest=function(S,k){return Di(zt(S,{method:"POST"}),k)}(w,S=>{this.pendingRequest=null,c(S),this.saveEventData(),this.processRequests(d)})}queueRequest(n,o){this.queue.push(n),this.processRequests(o)}}const an=new class extends nn{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,n){O.EVENTS_URL&&O.ACCESS_TOKEN&&Array.isArray(i)&&i.some(o=>ke(o)||Le(o))&&this.queueRequest(Date.now(),n)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=sn(O.ACCESS_TOKEN),o=n?n.u:O.ACCESS_TOKEN;let c=o!==this.eventData.tokenU;Wr(this.anonId)||(this.anonId=Zt(),c=!0);const d=this.queue.shift();if(this.eventData.lastSuccess){const f=new Date(this.eventData.lastSuccess),y=new Date(d),v=(d-this.eventData.lastSuccess)/864e5;c=c||v>=1||v<-1||f.getDate()!==y.getDate()}else c=!0;c?this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:I,skuId:H,"enabled.telemetry":!1,userId:this.anonId},f=>{f||(this.eventData.lastSuccess=d,this.eventData.tokenU=o)},i):this.processRequests()}},pn=an.postTurnstileEvent.bind(an),ur=new class extends nn{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,n,o,c){this.skuToken=n,this.errorCb=c,O.EVENTS_URL&&(o||O.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},o):this.errorCb(new Error(we)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:o}=this.queue.shift();n&&this.success[n]||(this.anonId||this.fetchEventData(),Wr(this.anonId)||(this.anonId=Zt()),this.postEvent(o,{sdkIdentifier:"mapbox-gl-js",sdkVersion:I,skuId:H,skuToken:this.skuToken,userId:this.anonId},c=>{c?this.errorCb(c):n&&(this.success[n]=!0)},i))}},Rr=ur.postMapLoadEvent.bind(ur),xi=new class extends nn{constructor(){super("gljs.performance")}postPerformanceEvent(i,n){O.EVENTS_URL&&(i||O.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:n},i)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,performanceData:o}=this.queue.shift(),c=function(d){const f=E.performance.getEntriesByType("resource"),y=E.performance.getEntriesByType("mark"),v=function(P){const B={};if(P){for(const j in P)if(j!=="other")for(const U of P[j]){const Q=`${j}ResolveRangeMin`,ae=`${j}ResolveRangeMax`,ge=`${j}RequestCount`,le=`${j}RequestCachedCount`;B[Q]=Math.min(B[Q]||1/0,U.startTime),B[ae]=Math.max(B[ae]||-1/0,U.responseEnd);const fe=be=>{B[be]===void 0&&(B[be]=0),++B[be]};U.transferSize!==void 0&&U.transferSize===0&&fe(le),fe(ge)}}return B}(function(P,B){const j={};if(P)for(const U of P){const Q=B(U);j[Q]===void 0&&(j[Q]=[]),j[Q].push(U)}return j}(f,rg)),w=E.devicePixelRatio,S=E.navigator.connection||E.navigator.mozConnection||E.navigator.webkitConnection,k={counters:[],metadata:[],attributes:[]},M=(P,B,j)=>{j!=null&&P.push({name:B,value:j.toString()})};for(const P in v)M(k.counters,P,v[P]);if(d.interactionRange[0]!==1/0&&d.interactionRange[1]!==-1/0&&(M(k.counters,"interactionRangeMin",d.interactionRange[0]),M(k.counters,"interactionRangeMax",d.interactionRange[1])),y)for(const P of Object.keys(rl)){const B=rl[P],j=y.find(U=>U.name===B);j&&M(k.counters,B,j.startTime)}return M(k.counters,"visibilityHidden",d.visibilityHidden),M(k.attributes,"style",function(P){if(P)for(const B of P){const j=B.name.split("?")[0];if(Ce(j)){const U=j.split("/").slice(-2);if(U.length===2)return`mapbox://styles/${U[0]}/${U[1]}`}}}(f)),M(k.attributes,"terrainEnabled",d.terrainEnabled?"true":"false"),M(k.attributes,"fogEnabled",d.fogEnabled?"true":"false"),M(k.attributes,"projection",d.projection),M(k.attributes,"zoom",d.zoom),M(k.metadata,"devicePixelRatio",w),M(k.metadata,"connectionEffectiveType",S?S.effectiveType:void 0),M(k.metadata,"navigatorUserAgent",E.navigator.userAgent),M(k.metadata,"screenWidth",E.screen.width),M(k.metadata,"screenHeight",E.screen.height),M(k.metadata,"windowWidth",E.innerWidth),M(k.metadata,"windowHeight",E.innerHeight),M(k.metadata,"mapWidth",d.width/w),M(k.metadata,"mapHeight",d.height/w),M(k.metadata,"webglRenderer",d.renderer),M(k.metadata,"webglVendor",d.vendor),M(k.metadata,"sdkVersion",I),M(k.metadata,"sdkIdentifier","mapbox-gl-js"),k}(o);for(const d of c.metadata);for(const d of c.counters);for(const d of c.attributes);this.postEvent(n,c,()=>{},i)}},Gr=xi.postPerformanceEvent.bind(xi),qo=new class extends nn{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,n,o,c){if(!O.API_URL||!O.SESSION_PATH)return;const d=mt(O.API_URL+O.SESSION_PATH);d.params.push(`sku=${n||""}`),d.params.push(`access_token=${c||O.ACCESS_TOKEN||""}`);const f={url:ut(d),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(y,v){return Di(zt(y,{method:"GET"}),v)}(f,y=>{this.pendingRequest=null,o(y),this.saveEventData(),this.processRequests(c)})}getSessionAPI(i,n,o,c){this.skuToken=n,this.errorCb=c,O.SESSION_PATH&&O.API_URL&&(o||O.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},o):this.errorCb(new Error(we)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:o}=this.queue.shift();n&&this.success[n]||this.getSession(o,this.skuToken,c=>{c?this.errorCb(c):n&&(this.success[n]=!0)},i)}},ei=qo.getSessionAPI.bind(qo),Ai=new Set,rl={create:"create",load:"load",fullLoad:"fullLoad"},Jx={mark(i){E.performance.mark(i)},measure(i,n,o){E.performance.measure(i,n,o)}};function rg(i){const n=i.name.split("?")[0];return ze(n)&&n.includes("mapbox-gl.js")?"javascript":ze(n)&&n.includes("mapbox-gl.css")?"css":function(o){return O.API_FONTS_REGEX.test(o)}(n)?"fontRange":Ve(n)?"sprite":Ce(n)?"style":function(o){return O.API_TILEJSON_REGEX.test(o)}(n)?"tilejson":"other"}const In=E.performance;function Uh(i){const n=i?i.url.toString():void 0;return In.getEntriesByName(n)}let pc,Vh,Ru,Ho;const bs={now:()=>Ru!==void 0?Ru:E.performance.now(),setNow(i){Ru=i},restoreNow(){Ru=void 0},frame(i){const n=E.requestAnimationFrame(i);return{cancel:()=>E.cancelAnimationFrame(n)}},getImageData(i,n=0){const{width:o,height:c}=i;Ho||(Ho=E.document.createElement("canvas"));const d=Ho.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return(o>Ho.width||c>Ho.height)&&(Ho.width=o,Ho.height=c),d.clearRect(-n,-n,o+2*n,c+2*n),d.drawImage(i,0,0,o,c),d.getImageData(-n,-n,o+2*n,c+2*n)},resolveURL:i=>(pc||(pc=E.document.createElement("a")),pc.href=i,pc.href),get devicePixelRatio(){return E.devicePixelRatio},get prefersReducedMotion(){return!!E.matchMedia&&(Vh==null&&(Vh=E.matchMedia("(prefers-reduced-motion: reduce)")),Vh.matches)}};function Wh(i,n,o){o[i]&&o[i].indexOf(n)!==-1||(o[i]=o[i]||[],o[i].push(n))}function Gh(i,n,o){if(o&&o[i]){const c=o[i].indexOf(n);c!==-1&&o[i].splice(c,1)}}class wa{constructor(n,o={}){zt(this,o),this.type=n}}class ws extends wa{constructor(n,o={}){super("error",zt({error:n},o))}}class fc{on(n,o){return this._listeners=this._listeners||{},Wh(n,o,this._listeners),this}off(n,o){return Gh(n,o,this._listeners),Gh(n,o,this._oneTimeListeners),this}once(n,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Wh(n,o,this._oneTimeListeners),this):new Promise(c=>this.once(n,c))}fire(n,o){typeof n=="string"&&(n=new wa(n,o||{}));const c=n.type;if(this.listens(c)){n.target=this;const d=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const v of d)v.call(this,n);const f=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const v of f)Gh(c,v,this._oneTimeListeners),v.call(this,n);const y=this._eventedParent;y&&(zt(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(n))}else n instanceof ws&&console.error(n.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,o){return this._eventedParent=n,this._eventedParentData=o,this}}var qe=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ss(i,...n){for(const o of n)for(const c in o)i[c]=o[c];return i}function zr(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function ti(i){if(Array.isArray(i))return i.map(ti);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const n={};for(const o in i)n[o]=ti(i[o]);return n}return zr(i)}class ig extends Error{constructor(n,o){super(o),this.message=o,this.key=n}}var Zo=ig;class qh{constructor(n,o=[]){this.parent=n,this.bindings={};for(const[c,d]of o)this.bindings[c]=d}concat(n){return new qh(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}var og=qh;const il={kind:"null"},wt={kind:"number"},hn={kind:"string"},cn={kind:"boolean"},Qi={kind:"color"},Co={kind:"object"},un={kind:"value"},eo={kind:"collator"},mc={kind:"formatted"},Sa={kind:"resolvedImage"};function lo(i,n){return{kind:"array",itemType:i,N:n}}function ir(i){if(i.kind==="array"){const n=ir(i.itemType);return typeof i.N=="number"?`array<${n}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${n}>`}return i.kind}const sg=[il,wt,hn,cn,Qi,mc,Co,lo(un),Sa];function Es(i,n){if(n.kind==="error")return null;if(i.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!Es(i.itemType,n.itemType))&&(typeof i.N!="number"||i.N===n.N))return null}else{if(i.kind===n.kind)return null;if(i.kind==="value"){for(const o of sg)if(!Es(o,n))return null}}return`Expected ${ir(i)} but found ${ir(n)} instead.`}function gc(i,n){return n.some(o=>o.kind===i.kind)}function yc(i,n){return n.some(o=>o==="null"?i===null:o==="array"?Array.isArray(i):o==="object"?i&&!Array.isArray(i)&&typeof i=="object":o===typeof i)}var Hh,ag={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function _c(i){return(i=Math.round(i))<0?0:i>255?255:i}function xc(i){return _c(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function zu(i){return(n=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:n>1?1:n;var n}function ol(i,n,o){return o<0?o+=1:o>1&&(o-=1),6*o<1?i+(n-i)*o*6:2*o<1?n:3*o<2?i+(n-i)*(2/3-o)*6:i}try{Hh={}.parseCSSColor=function(i){var n,o=i.replace(/ /g,"").toLowerCase();if(o in ag)return ag[o].slice();if(o[0]==="#")return o.length===4?(n=parseInt(o.substr(1),16))>=0&&n<=4095?[(3840&n)>>4|(3840&n)>>8,240&n|(240&n)>>4,15&n|(15&n)<<4,1]:null:o.length===7&&(n=parseInt(o.substr(1),16))>=0&&n<=16777215?[(16711680&n)>>16,(65280&n)>>8,255&n,1]:null;var c=o.indexOf("("),d=o.indexOf(")");if(c!==-1&&d+1===o.length){var f=o.substr(0,c),y=o.substr(c+1,d-(c+1)).split(","),v=1;switch(f){case"rgba":if(y.length!==4)return null;v=zu(y.pop());case"rgb":return y.length!==3?null:[xc(y[0]),xc(y[1]),xc(y[2]),v];case"hsla":if(y.length!==4)return null;v=zu(y.pop());case"hsl":if(y.length!==3)return null;var w=(parseFloat(y[0])%360+360)%360/360,S=zu(y[1]),k=zu(y[2]),M=k<=.5?k*(S+1):k+S-k*S,P=2*k-M;return[_c(255*ol(P,M,w+1/3)),_c(255*ol(P,M,w)),_c(255*ol(P,M,w-1/3)),v];default:return null}}return null}}catch{}class Oi{constructor(n,o,c,d=1){this.r=n,this.g=o,this.b=c,this.a=d}static parse(n){if(!n)return;if(n instanceof Oi)return n;if(typeof n!="string")return;const o=Hh(n);return o?new Oi(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[n,o,c,d]=this.toArray();return`rgba(${Math.round(n)},${Math.round(o)},${Math.round(c)},${d})`}toArray(){const{r:n,g:o,b:c,a:d}=this;return d===0?[0,0,0,0]:[255*n/d,255*o/d,255*c/d,d]}toArray01(){const{r:n,g:o,b:c,a:d}=this;return d===0?[0,0,0,0]:[n/d,o/d,c/d,d]}toArray01PremultipliedAlpha(){const{r:n,g:o,b:c,a:d}=this;return[n,o,c,d]}}Oi.black=new Oi(0,0,0,1),Oi.white=new Oi(1,1,1,1),Oi.transparent=new Oi(0,0,0,0),Oi.red=new Oi(1,0,0,1),Oi.blue=new Oi(0,0,1,1);var Tr=Oi;class Zh{constructor(n,o,c){this.sensitivity=n?o?"variant":"case":o?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,o){return this.collator.compare(n,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Xh{constructor(n,o,c,d,f){this.text=n.normalize?n.normalize():n,this.image=o,this.scale=c,this.fontStack=d,this.textColor=f}}class Bi{constructor(n){this.sections=n}static fromString(n){return new Bi([new Xh(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof Bi?n:Bi.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const o of this.sections){if(o.image){n.push(["image",o.image.name]);continue}n.push(o.text);const c={};o.fontStack&&(c["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(c["font-scale"]=o.scale),o.textColor&&(c["text-color"]=["rgba"].concat(o.textColor.toArray())),n.push(c)}return n}}class co{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new co({name:n,available:!1}):null}serialize(){return["image",this.name]}}function lg(i,n,o,c){return typeof i=="number"&&i>=0&&i<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof o=="number"&&o>=0&&o<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[i,n,o,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[i,n,o,c]:[i,n,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function vc(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Tr||i instanceof Zh||i instanceof Bi||i instanceof co)return!0;if(Array.isArray(i)){for(const n of i)if(!vc(n))return!1;return!0}if(typeof i=="object"){for(const n in i)if(!vc(i[n]))return!1;return!0}return!1}function yr(i){if(i===null)return il;if(typeof i=="string")return hn;if(typeof i=="boolean")return cn;if(typeof i=="number")return wt;if(i instanceof Tr)return Qi;if(i instanceof Zh)return eo;if(i instanceof Bi)return mc;if(i instanceof co)return Sa;if(Array.isArray(i)){const n=i.length;let o;for(const c of i){const d=yr(c);if(o){if(o===d)continue;o=un;break}o=d}return lo(o||un,n)}return Co}function bc(i){const n=typeof i;return i===null?"":n==="string"||n==="number"||n==="boolean"?String(i):i instanceof Tr||i instanceof Bi||i instanceof co?i.toString():JSON.stringify(i)}class Kh{constructor(n,o){this.type=n,this.value=o}static parse(n,o){if(n.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!vc(n[1]))return o.error("invalid value");const c=n[1];let d=yr(c);const f=o.expectedType;return d.kind!=="array"||d.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(d=f),new Kh(d,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Tr?["rgba"].concat(this.value.toArray()):this.value instanceof Bi?this.value.serialize():this.value}}var Ea=Kh,pi=class{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}};const Yh={string:hn,number:wt,boolean:cn,object:Co};class Jh{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");let c,d=1;const f=n[0];if(f==="array"){let v,w;if(n.length>2){const S=n[1];if(typeof S!="string"||!(S in Yh)||S==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);v=Yh[S],d++}else v=un;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return o.error('The length argument to "array" must be a positive integer literal',2);w=n[2],d++}c=lo(v,w)}else c=Yh[f];const y=[];for(;d<n.length;d++){const v=o.parse(n[d],d,un);if(!v)return null;y.push(v)}return new Jh(c,y)}evaluate(n){for(let o=0;o<this.args.length;o++){const c=this.args[o].evaluate(n);if(!Es(this.type,yr(c)))return c;if(o===this.args.length-1)throw new pi(`Expected value to be of type ${ir(this.type)}, but found ${ir(yr(c))} instead.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,o=[n.kind];if(n.kind==="array"){const c=n.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){o.push(c.kind);const d=n.N;(typeof d=="number"||this.args.length>1)&&o.push(d)}}return o.concat(this.args.map(c=>c.serialize()))}}var Ts=Jh;class Qs{constructor(n){this.type=mc,this.sections=n}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const c=n[1];if(!Array.isArray(c)&&typeof c=="object")return o.error("First argument must be an image or text section.");const d=[];let f=!1;for(let y=1;y<=n.length-1;++y){const v=n[y];if(f&&typeof v=="object"&&!Array.isArray(v)){f=!1;let w=null;if(v["font-scale"]&&(w=o.parse(v["font-scale"],1,wt),!w))return null;let S=null;if(v["text-font"]&&(S=o.parse(v["text-font"],1,lo(hn)),!S))return null;let k=null;if(v["text-color"]&&(k=o.parse(v["text-color"],1,Qi),!k))return null;const M=d[d.length-1];M.scale=w,M.font=S,M.textColor=k}else{const w=o.parse(n[y],1,un);if(!w)return null;const S=w.type.kind;if(S!=="string"&&S!=="value"&&S!=="null"&&S!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,d.push({content:w,scale:null,font:null,textColor:null})}}return new Qs(d)}evaluate(n){return new Bi(this.sections.map(o=>{const c=o.content.evaluate(n);return yr(c)===Sa?new Xh("",c,null,null,null):new Xh(bc(c),null,o.scale?o.scale.evaluate(n):null,o.font?o.font.evaluate(n).join(","):null,o.textColor?o.textColor.evaluate(n):null)}))}eachChild(n){for(const o of this.sections)n(o.content),o.scale&&n(o.scale),o.font&&n(o.font),o.textColor&&n(o.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const o of this.sections){n.push(o.content.serialize());const c={};o.scale&&(c["font-scale"]=o.scale.serialize()),o.font&&(c["text-font"]=o.font.serialize()),o.textColor&&(c["text-color"]=o.textColor.serialize()),n.push(c)}return n}}class Lu{constructor(n){this.type=Sa,this.input=n}static parse(n,o){if(n.length!==2)return o.error("Expected two arguments.");const c=o.parse(n[1],1,hn);return c?new Lu(c):o.error("No image name provided.")}evaluate(n){const o=this.input.evaluate(n),c=co.fromString(o);return c&&n.availableImages&&(c.available=n.availableImages.indexOf(o)>-1),c}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Qx={"to-boolean":cn,"to-color":Qi,"to-number":wt,"to-string":hn};class Qh{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const c=n[0];if((c==="to-boolean"||c==="to-string")&&n.length!==2)return o.error("Expected one argument.");const d=Qx[c],f=[];for(let y=1;y<n.length;y++){const v=o.parse(n[y],y,un);if(!v)return null;f.push(v)}return new Qh(d,f)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let o,c;for(const d of this.args){if(o=d.evaluate(n),c=null,o instanceof Tr)return o;if(typeof o=="string"){const f=n.parseColor(o);if(f)return f}else if(Array.isArray(o)&&(c=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:lg(o[0],o[1],o[2],o[3]),!c))return new Tr(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new pi(c||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const c of this.args){if(o=c.evaluate(n),o===null)return 0;const d=Number(o);if(!isNaN(d))return d}throw new pi(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?Bi.fromString(bc(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?co.fromString(bc(this.args[0].evaluate(n))):bc(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Qs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Lu(this.args[0]).serialize();const n=[`to-${this.type.kind}`];return this.eachChild(o=>{n.push(o.serialize())}),n}}var sl=Qh;const Xo=["Unknown","Point","LineString","Polygon"];var ep=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Xo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,n=this.featureDistanceData.scale,{x:o,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(o*n-i[0])+this.featureDistanceData.bearing[1]*(c*n-i[1])}return 0}parseColor(i){let n=this._parseColorCache[i];return n||(n=this._parseColorCache[i]=Tr.parse(i)),n}};class Ta{constructor(n,o,c,d){this.name=n,this.type=o,this._evaluate=c,this.args=d}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,o){const c=n[0],d=Ta.definitions[c];if(!d)return o.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(d)?d[0]:d.type,y=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,v=y.filter(([S])=>!Array.isArray(S)||S.length===n.length-1);let w=null;for(const[S,k]of v){w=new sp(o.registry,o.path,null,o.scope);const M=[];let P=!1;for(let B=1;B<n.length;B++){const j=n[B],U=Array.isArray(S)?S[B-1]:S.type,Q=w.parse(j,1+M.length,U);if(!Q){P=!0;break}M.push(Q)}if(!P)if(Array.isArray(S)&&S.length!==M.length)w.error(`Expected ${S.length} arguments, but found ${M.length} instead.`);else{for(let B=0;B<M.length;B++){const j=Array.isArray(S)?S[B]:S.type,U=M[B];w.concat(B+1).checkSubtype(j,U.type)}if(w.errors.length===0)return new Ta(c,f,k,M)}}if(v.length===1)o.errors.push(...w.errors);else{const S=(v.length?v:y).map(([M])=>{return P=M,Array.isArray(P)?`(${P.map(ir).join(", ")})`:`(${ir(P.type)}...)`;var P}).join(" | "),k=[];for(let M=1;M<n.length;M++){const P=o.parse(n[M],1+k.length);if(!P)return null;k.push(ir(P.type))}o.error(`Expected arguments of type ${S}, but found (${k.join(", ")}) instead.`)}return null}static register(n,o){Ta.definitions=o;for(const c in o)n[c]=Ta}}var Cs=Ta;class wc{constructor(n,o,c){this.type=eo,this.locale=c,this.caseSensitive=n,this.diacriticSensitive=o}static parse(n,o){if(n.length!==2)return o.error("Expected one argument.");const c=n[1];if(typeof c!="object"||Array.isArray(c))return o.error("Collator options argument must be an object.");const d=o.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,cn);if(!d)return null;const f=o.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,cn);if(!f)return null;let y=null;return c.locale&&(y=o.parse(c.locale,1,hn),!y)?null:new wc(d,f,y)}evaluate(n){return new Zh(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}const ks=8192;function Du(i,n){i[0]=Math.min(i[0],n[0]),i[1]=Math.min(i[1],n[1]),i[2]=Math.max(i[2],n[0]),i[3]=Math.max(i[3],n[1])}function al(i,n){return!(i[0]<=n[0]||i[2]>=n[2]||i[1]<=n[1]||i[3]>=n[3])}function Sc(i,n){const o=(180+i[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,d=Math.pow(2,n.z);return[Math.round(o*d*ks),Math.round(c*d*ks)]}function cg(i,n,o){const c=i[0]-n[0],d=i[1]-n[1],f=i[0]-o[0],y=i[1]-o[1];return c*y-f*d==0&&c*f<=0&&d*y<=0}function Ou(i,n){let o=!1;for(let y=0,v=n.length;y<v;y++){const w=n[y];for(let S=0,k=w.length;S<k-1;S++){if(cg(i,w[S],w[S+1]))return!1;(d=w[S])[1]>(c=i)[1]!=(f=w[S+1])[1]>c[1]&&c[0]<(f[0]-d[0])*(c[1]-d[1])/(f[1]-d[1])+d[0]&&(o=!o)}}var c,d,f;return o}function tp(i,n){for(let o=0;o<n.length;o++)if(Ou(i,n[o]))return!0;return!1}function np(i,n,o,c){const d=c[0]-o[0],f=c[1]-o[1],y=(i[0]-o[0])*f-d*(i[1]-o[1]),v=(n[0]-o[0])*f-d*(n[1]-o[1]);return y>0&&v<0||y<0&&v>0}function ll(i,n,o){for(const S of o)for(let k=0;k<S.length-1;++k)if((v=[(y=S[k+1])[0]-(f=S[k])[0],y[1]-f[1]])[0]*(w=[(d=n)[0]-(c=i)[0],d[1]-c[1]])[1]-v[1]*w[0]!=0&&np(c,d,f,y)&&np(f,y,c,d))return!0;var c,d,f,y,v,w;return!1}function An(i,n){for(let o=0;o<i.length;++o)if(!Ou(i[o],n))return!1;for(let o=0;o<i.length-1;++o)if(ll(i[o],i[o+1],n))return!1;return!0}function ev(i,n){for(let o=0;o<n.length;o++)if(An(i,n[o]))return!0;return!1}function rp(i,n,o){const c=[];for(let d=0;d<i.length;d++){const f=[];for(let y=0;y<i[d].length;y++){const v=Sc(i[d][y],o);Du(n,v),f.push(v)}c.push(f)}return c}function ug(i,n,o){const c=[];for(let d=0;d<i.length;d++){const f=rp(i[d],n,o);c.push(f)}return c}function ip(i,n,o,c){if(i[0]<o[0]||i[0]>o[2]){const d=.5*c;let f=i[0]-o[0]>d?-c:o[0]-i[0]>d?c:0;f===0&&(f=i[0]-o[2]>d?-c:o[2]-i[0]>d?c:0),i[0]+=f}Du(n,i)}function dg(i,n,o,c){const d=Math.pow(2,c.z)*ks,f=[c.x*ks,c.y*ks],y=[];if(!i)return y;for(const v of i)for(const w of v){const S=[w.x+f[0],w.y+f[1]];ip(S,n,o,d),y.push(S)}return y}function op(i,n,o,c){const d=Math.pow(2,c.z)*ks,f=[c.x*ks,c.y*ks],y=[];if(!i)return y;for(const w of i){const S=[];for(const k of w){const M=[k.x+f[0],k.y+f[1]];Du(n,M),S.push(M)}y.push(S)}if(n[2]-n[0]<=d/2){(v=n)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const w of y)for(const S of w)ip(S,n,o,d)}var v;return y}class cl{constructor(n,o){this.type=cn,this.geojson=n,this.geometries=o}static parse(n,o){if(n.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(vc(n[1])){const c=n[1];if(c.type==="FeatureCollection")for(let d=0;d<c.features.length;++d){const f=c.features[d].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new cl(c,c.features[d].geometry)}else if(c.type==="Feature"){const d=c.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new cl(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new cl(c,c)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(o,c){const d=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],y=o.canonicalID();if(!y)return!1;if(c.type==="Polygon"){const v=rp(c.coordinates,f,y),w=dg(o.geometry(),d,f,y);if(!al(d,f))return!1;for(const S of w)if(!Ou(S,v))return!1}if(c.type==="MultiPolygon"){const v=ug(c.coordinates,f,y),w=dg(o.geometry(),d,f,y);if(!al(d,f))return!1;for(const S of w)if(!tp(S,v))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(o,c){const d=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],y=o.canonicalID();if(!y)return!1;if(c.type==="Polygon"){const v=rp(c.coordinates,f,y),w=op(o.geometry(),d,f,y);if(!al(d,f))return!1;for(const S of w)if(!An(S,v))return!1}if(c.type==="MultiPolygon"){const v=ug(c.coordinates,f,y),w=op(o.geometry(),d,f,y);if(!al(d,f))return!1;for(const S of w)if(!ev(S,v))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Bu=cl;function ul(i){if(i instanceof Cs&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Bu)return!1;let n=!0;return i.eachChild(o=>{n&&!ul(o)&&(n=!1)}),n}function Is(i){if(i instanceof Cs&&i.name==="feature-state")return!1;let n=!0;return i.eachChild(o=>{n&&!Is(o)&&(n=!1)}),n}function Ca(i,n){if(i instanceof Cs&&n.indexOf(i.name)>=0)return!1;let o=!0;return i.eachChild(c=>{o&&!Ca(c,n)&&(o=!1)}),o}class Fu{constructor(n,o){this.type=o.type,this.name=n,this.boundExpression=o}static parse(n,o){if(n.length!==2||typeof n[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const c=n[1];return o.scope.has(c)?new Fu(c,o.scope.get(c)):o.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var hg=Fu;class Ec{constructor(n,o=[],c,d=new og,f=[]){this.registry=n,this.path=o,this.key=o.map(y=>`[${y}]`).join(""),this.scope=d,this.errors=f,this.expectedType=c}parse(n,o,c,d,f={}){return o?this.concat(o,c,d)._parse(n,f):this._parse(n,f)}_parse(n,o){function c(d,f,y){return y==="assert"?new Ts(f,[d]):y==="coerce"?new sl(f,[d]):d}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=n[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[d];if(f){let y=f.parse(n,this);if(!y)return null;if(this.expectedType){const v=this.expectedType,w=y.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||w.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||w.kind!=="value"&&w.kind!=="string"){if(this.checkSubtype(v,w))return null}else y=c(y,v,o.typeAnnotation||"coerce");else y=c(y,v,o.typeAnnotation||"assert")}if(!(y instanceof Ea)&&y.type.kind!=="resolvedImage"&&ap(y)){const v=new ep;try{y=new Ea(y.type,y.evaluate(v))}catch(w){return this.error(w.message),null}}return y}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,o,c){const d=typeof n=="number"?this.path.concat(n):this.path,f=c?this.scope.concat(c):this.scope;return new Ec(this.registry,d,o||null,f,this.errors)}error(n,...o){const c=`${this.key}${o.map(d=>`[${d}]`).join("")}`;this.errors.push(new Zo(c,n))}checkSubtype(n,o){const c=Es(n,o);return c&&this.error(c),c}}var sp=Ec;function ap(i){if(i instanceof hg)return ap(i.boundExpression);if(i instanceof Cs&&i.name==="error"||i instanceof wc||i instanceof Bu)return!1;const n=i instanceof sl||i instanceof Ts;let o=!0;return i.eachChild(c=>{o=n?o&&ap(c):o&&c instanceof Ea}),!!o&&ul(i)&&Ca(i,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function ju(i,n){const o=i.length-1;let c,d,f=0,y=o,v=0;for(;f<=y;)if(v=Math.floor((f+y)/2),c=i[v],d=i[v+1],c<=n){if(v===o||n<d)return v;f=v+1}else{if(!(c>n))throw new pi("Input is not a number.");y=v-1}return 0}class Nu{constructor(n,o,c){this.type=n,this.input=o,this.labels=[],this.outputs=[];for(const[d,f]of c)this.labels.push(d),this.outputs.push(f)}static parse(n,o){if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");const c=o.parse(n[1],1,wt);if(!c)return null;const d=[];let f=null;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);for(let y=1;y<n.length;y+=2){const v=y===1?-1/0:n[y],w=n[y+1],S=y,k=y+1;if(typeof v!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',S);if(d.length&&d[d.length-1][0]>=v)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',S);const M=o.parse(w,k,f);if(!M)return null;f=f||M.type,d.push([v,M])}return new Nu(f,c,d)}evaluate(n){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(n);const d=this.input.evaluate(n);if(d<=o[0])return c[0].evaluate(n);const f=o.length;return d>=o[f-1]?c[f-1].evaluate(n):c[ju(o,d)].evaluate(n)}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&n.push(this.labels[o]),n.push(this.outputs[o].serialize());return n}}var lp=Nu;function gn(i,n,o){return i*(1-o)+n*o}var Tc=Object.freeze({__proto__:null,array:function(i,n,o){return i.map((c,d)=>gn(c,n[d],o))},color:function(i,n,o){return new Tr(gn(i.r,n.r,o),gn(i.g,n.g,o),gn(i.b,n.b,o),gn(i.a,n.a,o))},number:gn});const pg=.95047,cp=1.08883,fg=4/29,ka=6/29,up=3*ka*ka,tv=ka*ka*ka,nv=Math.PI/180,rv=180/Math.PI;function dp(i){return i>tv?Math.pow(i,1/3):i/up+fg}function hp(i){return i>ka?i*i*i:up*(i-fg)}function pp(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function $u(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function mg(i){const n=$u(i.r),o=$u(i.g),c=$u(i.b),d=dp((.4124564*n+.3575761*o+.1804375*c)/pg),f=dp((.2126729*n+.7151522*o+.072175*c)/1);return{l:116*f-16,a:500*(d-f),b:200*(f-dp((.0193339*n+.119192*o+.9503041*c)/cp)),alpha:i.a}}function gg(i){let n=(i.l+16)/116,o=isNaN(i.a)?n:n+i.a/500,c=isNaN(i.b)?n:n-i.b/200;return n=1*hp(n),o=pg*hp(o),c=cp*hp(c),new Tr(pp(3.2404542*o-1.5371385*n-.4985314*c),pp(-.969266*o+1.8760108*n+.041556*c),pp(.0556434*o-.2040259*n+1.0572252*c),i.alpha)}function iv(i,n,o){const c=n-i;return i+o*(c>180||c<-180?c-360*Math.round(c/360):c)}const Cc={forward:mg,reverse:gg,interpolate:function(i,n,o){return{l:gn(i.l,n.l,o),a:gn(i.a,n.a,o),b:gn(i.b,n.b,o),alpha:gn(i.alpha,n.alpha,o)}}},dl={forward:function(i){const{l:n,a:o,b:c}=mg(i),d=Math.atan2(c,o)*rv;return{h:d<0?d+360:d,c:Math.sqrt(o*o+c*c),l:n,alpha:i.a}},reverse:function(i){const n=i.h*nv,o=i.c;return gg({l:i.l,a:Math.cos(n)*o,b:Math.sin(n)*o,alpha:i.alpha})},interpolate:function(i,n,o){return{h:iv(i.h,n.h,o),c:gn(i.c,n.c,o),l:gn(i.l,n.l,o),alpha:gn(i.alpha,n.alpha,o)}}};var fp=Object.freeze({__proto__:null,hcl:dl,lab:Cc});class kc{constructor(n,o,c,d,f){this.type=n,this.operator=o,this.interpolation=c,this.input=d,this.labels=[],this.outputs=[];for(const[y,v]of f)this.labels.push(y),this.outputs.push(v)}static interpolationFactor(n,o,c,d){let f=0;if(n.name==="exponential")f=mp(o,n.base,c,d);else if(n.name==="linear")f=mp(o,1,c,d);else if(n.name==="cubic-bezier"){const y=n.controlPoints;f=new _e(y[0],y[1],y[2],y[3]).solve(mp(o,1,c,d))}return f}static parse(n,o){let[c,d,f,...y]=n;if(!Array.isArray(d)||d.length===0)return o.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const S=d[1];if(typeof S!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:S}}else{if(d[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const S=d.slice(1);if(S.length!==4||S.some(k=>typeof k!="number"||k<0||k>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:S}}}if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(f=o.parse(f,2,wt),!f)return null;const v=[];let w=null;c==="interpolate-hcl"||c==="interpolate-lab"?w=Qi:o.expectedType&&o.expectedType.kind!=="value"&&(w=o.expectedType);for(let S=0;S<y.length;S+=2){const k=y[S],M=y[S+1],P=S+3,B=S+4;if(typeof k!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(v.length&&v[v.length-1][0]>=k)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',P);const j=o.parse(M,B,w);if(!j)return null;w=w||j.type,v.push([k,j])}return w.kind==="number"||w.kind==="color"||w.kind==="array"&&w.itemType.kind==="number"&&typeof w.N=="number"?new kc(w,c,d,f,v):o.error(`Type ${ir(w)} is not interpolatable.`)}evaluate(n){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(n);const d=this.input.evaluate(n);if(d<=o[0])return c[0].evaluate(n);const f=o.length;if(d>=o[f-1])return c[f-1].evaluate(n);const y=ju(o,d),v=kc.interpolationFactor(this.interpolation,d,o[y],o[y+1]),w=c[y].evaluate(n),S=c[y+1].evaluate(n);return this.operator==="interpolate"?Tc[this.type.kind.toLowerCase()](w,S,v):this.operator==="interpolate-hcl"?dl.reverse(dl.interpolate(dl.forward(w),dl.forward(S),v)):Cc.reverse(Cc.interpolate(Cc.forward(w),Cc.forward(S),v))}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,n,this.input.serialize()];for(let c=0;c<this.labels.length;c++)o.push(this.labels[c],this.outputs[c].serialize());return o}}function mp(i,n,o,c){const d=c-o,f=i-o;return d===0?0:n===1?f/d:(Math.pow(n,f)-1)/(Math.pow(n,d)-1)}var Ko=kc;class Uu{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expectected at least one argument.");let c=null;const d=o.expectedType;d&&d.kind!=="value"&&(c=d);const f=[];for(const v of n.slice(1)){const w=o.parse(v,1+f.length,c,void 0,{typeAnnotation:"omit"});if(!w)return null;c=c||w.type,f.push(w)}const y=d&&f.some(v=>Es(d,v.type));return new Uu(y?un:c,f)}evaluate(n){let o,c=null,d=0;for(const f of this.args){if(d++,c=f.evaluate(n),c&&c instanceof co&&!c.available&&(o||(o=c),c=null,d===this.args.length))return o;if(c!==null)break}return c}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(o=>{n.push(o.serialize())}),n}}var gp=Uu;class Vu{constructor(n,o){this.type=o.type,this.bindings=[].concat(n),this.result=o}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const o of this.bindings)n(o[1]);n(this.result)}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const c=[];for(let f=1;f<n.length-1;f+=2){const y=n[f];if(typeof y!="string")return o.error(`Expected string, but found ${typeof y} instead.`,f);if(/[^a-zA-Z0-9_]/.test(y))return o.error("Variable names must contain only alphanumeric characters or '_'.",f);const v=o.parse(n[f+1],f+1);if(!v)return null;c.push([y,v])}const d=o.parse(n[n.length-1],n.length-1,o.expectedType,c);return d?new Vu(c,d):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[o,c]of this.bindings)n.push(o,c.serialize());return n.push(this.result.serialize()),n}}var yg=Vu;class yp{constructor(n,o,c){this.type=n,this.index=o,this.input=c}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=o.parse(n[1],1,wt),d=o.parse(n[2],2,lo(o.expectedType||un));return c&&d?new yp(d.type.itemType,c,d):null}evaluate(n){const o=this.index.evaluate(n),c=this.input.evaluate(n);if(o<0)throw new pi(`Array index out of bounds: ${o} < 0.`);if(o>=c.length)throw new pi(`Array index out of bounds: ${o} > ${c.length-1}.`);if(o!==Math.floor(o))throw new pi(`Array index must be an integer, but found ${o} instead.`);return c[o]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var ov=yp;class _p{constructor(n,o){this.type=cn,this.needle=n,this.haystack=o}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=o.parse(n[1],1,un),d=o.parse(n[2],2,un);return c&&d?gc(c.type,[cn,hn,wt,il,un])?new _p(c,d):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ir(c.type)} instead`):null}evaluate(n){const o=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(c==null)return!1;if(!yc(o,["boolean","string","number","null"]))throw new pi(`Expected first argument to be of type boolean, string, number or null, but found ${ir(yr(o))} instead.`);if(!yc(c,["string","array"]))throw new pi(`Expected second argument to be of type array or string, but found ${ir(yr(c))} instead.`);return c.indexOf(o)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Wu=_p;class Ic{constructor(n,o,c){this.type=wt,this.needle=n,this.haystack=o,this.fromIndex=c}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=o.parse(n[1],1,un),d=o.parse(n[2],2,un);if(!c||!d)return null;if(!gc(c.type,[cn,hn,wt,il,un]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ir(c.type)} instead`);if(n.length===4){const f=o.parse(n[3],3,wt);return f?new Ic(c,d,f):null}return new Ic(c,d)}evaluate(n){const o=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(!yc(o,["boolean","string","number","null"]))throw new pi(`Expected first argument to be of type boolean, string, number or null, but found ${ir(yr(o))} instead.`);if(!yc(c,["string","array"]))throw new pi(`Expected second argument to be of type array or string, but found ${ir(yr(c))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(n);return c.indexOf(o,d)}return c.indexOf(o)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var _g=Ic;class xp{constructor(n,o,c,d,f,y){this.inputType=n,this.type=o,this.input=c,this.cases=d,this.outputs=f,this.otherwise=y}static parse(n,o){if(n.length<5)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return o.error("Expected an even number of arguments.");let c,d;o.expectedType&&o.expectedType.kind!=="value"&&(d=o.expectedType);const f={},y=[];for(let S=2;S<n.length-1;S+=2){let k=n[S];const M=n[S+1];Array.isArray(k)||(k=[k]);const P=o.concat(S);if(k.length===0)return P.error("Expected at least one branch label.");for(const j of k){if(typeof j!="number"&&typeof j!="string")return P.error("Branch labels must be numbers or strings.");if(typeof j=="number"&&Math.abs(j)>Number.MAX_SAFE_INTEGER)return P.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof j=="number"&&Math.floor(j)!==j)return P.error("Numeric branch labels must be integer values.");if(c){if(P.checkSubtype(c,yr(j)))return null}else c=yr(j);if(f[String(j)]!==void 0)return P.error("Branch labels must be unique.");f[String(j)]=y.length}const B=o.parse(M,S,d);if(!B)return null;d=d||B.type,y.push(B)}const v=o.parse(n[1],1,un);if(!v)return null;const w=o.parse(n[n.length-1],n.length-1,d);return w?v.type.kind!=="value"&&o.concat(1).checkSubtype(c,v.type)?null:new xp(c,d,v,f,y,w):null}evaluate(n){const o=this.input.evaluate(n);return(yr(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),c=[],d={};for(const y of o){const v=d[this.cases[y]];v===void 0?(d[this.cases[y]]=c.length,c.push([this.cases[y],[y]])):c[v][1].push(y)}const f=y=>this.inputType.kind==="number"?Number(y):y;for(const[y,v]of c)n.push(v.length===1?f(v[0]):v.map(f)),n.push(this.outputs[y].serialize());return n.push(this.otherwise.serialize()),n}}var sv=xp;class vp{constructor(n,o,c){this.type=n,this.branches=o,this.otherwise=c}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return o.error("Expected an odd number of arguments.");let c;o.expectedType&&o.expectedType.kind!=="value"&&(c=o.expectedType);const d=[];for(let y=1;y<n.length-1;y+=2){const v=o.parse(n[y],y,cn);if(!v)return null;const w=o.parse(n[y+1],y+1,c);if(!w)return null;d.push([v,w]),c=c||w.type}const f=o.parse(n[n.length-1],n.length-1,c);return f?new vp(c,d,f):null}evaluate(n){for(const[o,c]of this.branches)if(o.evaluate(n))return c.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[o,c]of this.branches)n(o),n(c);n(this.otherwise)}outputDefined(){return this.branches.every(([n,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(o=>{n.push(o.serialize())}),n}}var xg=vp;class Ac{constructor(n,o,c,d){this.type=n,this.input=o,this.beginIndex=c,this.endIndex=d}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=o.parse(n[1],1,un),d=o.parse(n[2],2,wt);if(!c||!d)return null;if(!gc(c.type,[lo(un),hn,un]))return o.error(`Expected first argument to be of type array or string, but found ${ir(c.type)} instead`);if(n.length===4){const f=o.parse(n[3],3,wt);return f?new Ac(c.type,c,d,f):null}return new Ac(c.type,c,d)}evaluate(n){const o=this.input.evaluate(n),c=this.beginIndex.evaluate(n);if(!yc(o,["string","array"]))throw new pi(`Expected first argument to be of type array or string, but found ${ir(yr(o))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(n);return o.slice(c,d)}return o.slice(c)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var vg=Ac;function Gu(i,n){return i==="=="||i==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function bg(i,n,o,c){return c.compare(n,o)===0}function hl(i,n,o){const c=i!=="=="&&i!=="!=";return class YL{constructor(f,y,v){this.type=cn,this.lhs=f,this.rhs=y,this.collator=v,this.hasUntypedArgument=f.type.kind==="value"||y.type.kind==="value"}static parse(f,y){if(f.length!==3&&f.length!==4)return y.error("Expected two or three arguments.");const v=f[0];let w=y.parse(f[1],1,un);if(!w)return null;if(!Gu(v,w.type))return y.concat(1).error(`"${v}" comparisons are not supported for type '${ir(w.type)}'.`);let S=y.parse(f[2],2,un);if(!S)return null;if(!Gu(v,S.type))return y.concat(2).error(`"${v}" comparisons are not supported for type '${ir(S.type)}'.`);if(w.type.kind!==S.type.kind&&w.type.kind!=="value"&&S.type.kind!=="value")return y.error(`Cannot compare types '${ir(w.type)}' and '${ir(S.type)}'.`);c&&(w.type.kind==="value"&&S.type.kind!=="value"?w=new Ts(S.type,[w]):w.type.kind!=="value"&&S.type.kind==="value"&&(S=new Ts(w.type,[S])));let k=null;if(f.length===4){if(w.type.kind!=="string"&&S.type.kind!=="string"&&w.type.kind!=="value"&&S.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(k=y.parse(f[3],3,eo),!k)return null}return new YL(w,S,k)}evaluate(f){const y=this.lhs.evaluate(f),v=this.rhs.evaluate(f);if(c&&this.hasUntypedArgument){const w=yr(y),S=yr(v);if(w.kind!==S.kind||w.kind!=="string"&&w.kind!=="number")throw new pi(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${w.kind}, ${S.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const w=yr(y),S=yr(v);if(w.kind!=="string"||S.kind!=="string")return n(f,y,v)}return this.collator?o(f,y,v,this.collator.evaluate(f)):n(f,y,v)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}serialize(){const f=[i];return this.eachChild(y=>{f.push(y.serialize())}),f}}}const av=hl("==",function(i,n,o){return n===o},bg),lv=hl("!=",function(i,n,o){return n!==o},function(i,n,o,c){return!bg(0,n,o,c)}),cv=hl("<",function(i,n,o){return n<o},function(i,n,o,c){return c.compare(n,o)<0}),uv=hl(">",function(i,n,o){return n>o},function(i,n,o,c){return c.compare(n,o)>0}),dv=hl("<=",function(i,n,o){return n<=o},function(i,n,o,c){return c.compare(n,o)<=0}),wg=hl(">=",function(i,n,o){return n>=o},function(i,n,o,c){return c.compare(n,o)>=0});class qu{constructor(n,o,c,d,f,y){this.type=hn,this.number=n,this.locale=o,this.currency=c,this.unit=d,this.minFractionDigits=f,this.maxFractionDigits=y}static parse(n,o){if(n.length!==3)return o.error("Expected two arguments.");const c=o.parse(n[1],1,wt);if(!c)return null;const d=n[2];if(typeof d!="object"||Array.isArray(d))return o.error("NumberFormat options argument must be an object.");let f=null;if(d.locale&&(f=o.parse(d.locale,1,hn),!f))return null;let y=null;if(d.currency&&(y=o.parse(d.currency,1,hn),!y))return null;let v=null;if(d.unit&&(v=o.parse(d.unit,1,hn),!v))return null;let w=null;if(d["min-fraction-digits"]&&(w=o.parse(d["min-fraction-digits"],1,wt),!w))return null;let S=null;return d["max-fraction-digits"]&&(S=o.parse(d["max-fraction-digits"],1,wt),!S)?null:new qu(c,f,y,v,w,S)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class pl{constructor(n){this.type=wt,this.input=n}static parse(n,o){if(n.length!==2)return o.error(`Expected 1 argument, but found ${n.length-1} instead.`);const c=o.parse(n[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${ir(c.type)} instead.`):new pl(c):null}evaluate(n){const o=this.input.evaluate(n);if(typeof o=="string"||Array.isArray(o))return o.length;throw new pi(`Expected value to be of type string or array, but found ${ir(yr(o))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(o=>{n.push(o.serialize())}),n}}const Sg={"==":av,"!=":lv,">":uv,"<":cv,">=":wg,"<=":dv,array:Ts,at:ov,boolean:Ts,case:xg,coalesce:gp,collator:wc,format:Qs,image:Lu,in:Wu,"index-of":_g,interpolate:Ko,"interpolate-hcl":Ko,"interpolate-lab":Ko,length:pl,let:yg,literal:Ea,match:sv,number:Ts,"number-format":qu,object:Ts,slice:vg,step:lp,string:Ts,"to-boolean":sl,"to-color":sl,"to-number":sl,"to-string":sl,var:hg,within:Bu};function Eg(i,[n,o,c,d]){n=n.evaluate(i),o=o.evaluate(i),c=c.evaluate(i);const f=d?d.evaluate(i):1,y=lg(n,o,c,f);if(y)throw new pi(y);return new Tr(n/255*f,o/255*f,c/255*f,f)}function As(i,n){return i in n}function Hu(i,n){const o=n[i];return o===void 0?null:o}function uo(i){return{type:i}}Cs.register(Sg,{error:[{kind:"error"},[hn],(i,[n])=>{throw new pi(n.evaluate(i))}],typeof:[hn,[un],(i,[n])=>ir(yr(n.evaluate(i)))],"to-rgba":[lo(wt,4),[Qi],(i,[n])=>n.evaluate(i).toArray()],rgb:[Qi,[wt,wt,wt],Eg],rgba:[Qi,[wt,wt,wt,wt],Eg],has:{type:cn,overloads:[[[hn],(i,[n])=>As(n.evaluate(i),i.properties())],[[hn,Co],(i,[n,o])=>As(n.evaluate(i),o.evaluate(i))]]},get:{type:un,overloads:[[[hn],(i,[n])=>Hu(n.evaluate(i),i.properties())],[[hn,Co],(i,[n,o])=>Hu(n.evaluate(i),o.evaluate(i))]]},"feature-state":[un,[hn],(i,[n])=>Hu(n.evaluate(i),i.featureState||{})],properties:[Co,[],i=>i.properties()],"geometry-type":[hn,[],i=>i.geometryType()],id:[un,[],i=>i.id()],zoom:[wt,[],i=>i.globals.zoom],pitch:[wt,[],i=>i.globals.pitch||0],"distance-from-center":[wt,[],i=>i.distanceFromCenter()],"heatmap-density":[wt,[],i=>i.globals.heatmapDensity||0],"line-progress":[wt,[],i=>i.globals.lineProgress||0],"sky-radial-progress":[wt,[],i=>i.globals.skyRadialProgress||0],accumulated:[un,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[wt,uo(wt),(i,n)=>{let o=0;for(const c of n)o+=c.evaluate(i);return o}],"*":[wt,uo(wt),(i,n)=>{let o=1;for(const c of n)o*=c.evaluate(i);return o}],"-":{type:wt,overloads:[[[wt,wt],(i,[n,o])=>n.evaluate(i)-o.evaluate(i)],[[wt],(i,[n])=>-n.evaluate(i)]]},"/":[wt,[wt,wt],(i,[n,o])=>n.evaluate(i)/o.evaluate(i)],"%":[wt,[wt,wt],(i,[n,o])=>n.evaluate(i)%o.evaluate(i)],ln2:[wt,[],()=>Math.LN2],pi:[wt,[],()=>Math.PI],e:[wt,[],()=>Math.E],"^":[wt,[wt,wt],(i,[n,o])=>Math.pow(n.evaluate(i),o.evaluate(i))],sqrt:[wt,[wt],(i,[n])=>Math.sqrt(n.evaluate(i))],log10:[wt,[wt],(i,[n])=>Math.log(n.evaluate(i))/Math.LN10],ln:[wt,[wt],(i,[n])=>Math.log(n.evaluate(i))],log2:[wt,[wt],(i,[n])=>Math.log(n.evaluate(i))/Math.LN2],sin:[wt,[wt],(i,[n])=>Math.sin(n.evaluate(i))],cos:[wt,[wt],(i,[n])=>Math.cos(n.evaluate(i))],tan:[wt,[wt],(i,[n])=>Math.tan(n.evaluate(i))],asin:[wt,[wt],(i,[n])=>Math.asin(n.evaluate(i))],acos:[wt,[wt],(i,[n])=>Math.acos(n.evaluate(i))],atan:[wt,[wt],(i,[n])=>Math.atan(n.evaluate(i))],min:[wt,uo(wt),(i,n)=>Math.min(...n.map(o=>o.evaluate(i)))],max:[wt,uo(wt),(i,n)=>Math.max(...n.map(o=>o.evaluate(i)))],abs:[wt,[wt],(i,[n])=>Math.abs(n.evaluate(i))],round:[wt,[wt],(i,[n])=>{const o=n.evaluate(i);return o<0?-Math.round(-o):Math.round(o)}],floor:[wt,[wt],(i,[n])=>Math.floor(n.evaluate(i))],ceil:[wt,[wt],(i,[n])=>Math.ceil(n.evaluate(i))],"filter-==":[cn,[hn,un],(i,[n,o])=>i.properties()[n.value]===o.value],"filter-id-==":[cn,[un],(i,[n])=>i.id()===n.value],"filter-type-==":[cn,[hn],(i,[n])=>i.geometryType()===n.value],"filter-<":[cn,[hn,un],(i,[n,o])=>{const c=i.properties()[n.value],d=o.value;return typeof c==typeof d&&c<d}],"filter-id-<":[cn,[un],(i,[n])=>{const o=i.id(),c=n.value;return typeof o==typeof c&&o<c}],"filter->":[cn,[hn,un],(i,[n,o])=>{const c=i.properties()[n.value],d=o.value;return typeof c==typeof d&&c>d}],"filter-id->":[cn,[un],(i,[n])=>{const o=i.id(),c=n.value;return typeof o==typeof c&&o>c}],"filter-<=":[cn,[hn,un],(i,[n,o])=>{const c=i.properties()[n.value],d=o.value;return typeof c==typeof d&&c<=d}],"filter-id-<=":[cn,[un],(i,[n])=>{const o=i.id(),c=n.value;return typeof o==typeof c&&o<=c}],"filter->=":[cn,[hn,un],(i,[n,o])=>{const c=i.properties()[n.value],d=o.value;return typeof c==typeof d&&c>=d}],"filter-id->=":[cn,[un],(i,[n])=>{const o=i.id(),c=n.value;return typeof o==typeof c&&o>=c}],"filter-has":[cn,[un],(i,[n])=>n.value in i.properties()],"filter-has-id":[cn,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[cn,[lo(hn)],(i,[n])=>n.value.indexOf(i.geometryType())>=0],"filter-id-in":[cn,[lo(un)],(i,[n])=>n.value.indexOf(i.id())>=0],"filter-in-small":[cn,[hn,lo(un)],(i,[n,o])=>o.value.indexOf(i.properties()[n.value])>=0],"filter-in-large":[cn,[hn,lo(un)],(i,[n,o])=>function(c,d,f,y){for(;f<=y;){const v=f+y>>1;if(d[v]===c)return!0;d[v]>c?y=v-1:f=v+1}return!1}(i.properties()[n.value],o.value,0,o.value.length-1)],all:{type:cn,overloads:[[[cn,cn],(i,[n,o])=>n.evaluate(i)&&o.evaluate(i)],[uo(cn),(i,n)=>{for(const o of n)if(!o.evaluate(i))return!1;return!0}]]},any:{type:cn,overloads:[[[cn,cn],(i,[n,o])=>n.evaluate(i)||o.evaluate(i)],[uo(cn),(i,n)=>{for(const o of n)if(o.evaluate(i))return!0;return!1}]]},"!":[cn,[cn],(i,[n])=>!n.evaluate(i)],"is-supported-script":[cn,[hn],(i,[n])=>{const o=i.globals&&i.globals.isSupportedScript;return!o||o(n.evaluate(i))}],upcase:[hn,[hn],(i,[n])=>n.evaluate(i).toUpperCase()],downcase:[hn,[hn],(i,[n])=>n.evaluate(i).toLowerCase()],concat:[hn,uo(un),(i,n)=>n.map(o=>bc(o.evaluate(i))).join("")],"resolved-locale":[hn,[eo],(i,[n])=>n.evaluate(i).resolvedLocale()]});var Mc=Sg;function Tg(i){return{result:"success",value:i}}function Ia(i){return{result:"error",value:i}}function fl(i){return i["property-type"]==="data-driven"}function Zu(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Xu(i){return!!i.expression&&i.expression.interpolated}function xn(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Pc(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Cg(i){return i}function Ku(i,n){const o=n.type==="color",c=i.stops&&typeof i.stops[0][0]=="object",d=c||!(c||i.property!==void 0),f=i.type||(Xu(n)?"exponential":"interval");if(o&&((i=Ss({},i)).stops&&(i.stops=i.stops.map(S=>[S[0],Tr.parse(S[1])])),i.default=Tr.parse(i.default?i.default:n.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!fp[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let y,v,w;if(f==="exponential")y=Ms;else if(f==="interval")y=Yu;else if(f==="categorical"){y=kg,v=Object.create(null);for(const S of i.stops)v[S[0]]=S[1];w=typeof i.stops[0][0]}else{if(f!=="identity")throw new Error(`Unknown function type "${f}"`);y=Ig}if(c){const S={},k=[];for(let B=0;B<i.stops.length;B++){const j=i.stops[B],U=j[0].zoom;S[U]===void 0&&(S[U]={zoom:U,type:i.type,property:i.property,default:i.default,stops:[]},k.push(U)),S[U].stops.push([j[0].value,j[1]])}const M=[];for(const B of k)M.push([S[B].zoom,Ku(S[B],n)]);const P={name:"linear"};return{kind:"composite",interpolationType:P,interpolationFactor:Ko.interpolationFactor.bind(void 0,P),zoomStops:M.map(B=>B[0]),evaluate:({zoom:B},j)=>Ms({stops:M,base:i.base},n,B).evaluate(B,j)}}if(d){const S=f==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:S,interpolationFactor:Ko.interpolationFactor.bind(void 0,S),zoomStops:i.stops.map(k=>k[0]),evaluate:({zoom:k})=>y(i,n,k,v,w)}}return{kind:"source",evaluate(S,k){const M=k&&k.properties?k.properties[i.property]:void 0;return M===void 0?ml(i.default,n.default):y(i,n,M,v,w)}}}function ml(i,n,o){return i!==void 0?i:n!==void 0?n:o!==void 0?o:void 0}function kg(i,n,o,c,d){return ml(typeof o===d?c[o]:void 0,i.default,n.default)}function Yu(i,n,o){if(xn(o)!=="number")return ml(i.default,n.default);const c=i.stops.length;if(c===1||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[c-1][0])return i.stops[c-1][1];const d=ju(i.stops.map(f=>f[0]),o);return i.stops[d][1]}function Ms(i,n,o){const c=i.base!==void 0?i.base:1;if(xn(o)!=="number")return ml(i.default,n.default);const d=i.stops.length;if(d===1||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[d-1][0])return i.stops[d-1][1];const f=ju(i.stops.map(k=>k[0]),o),y=function(k,M,P,B){const j=B-P,U=k-P;return j===0?0:M===1?U/j:(Math.pow(M,U)-1)/(Math.pow(M,j)-1)}(o,c,i.stops[f][0],i.stops[f+1][0]),v=i.stops[f][1],w=i.stops[f+1][1];let S=Tc[n.type]||Cg;if(i.colorSpace&&i.colorSpace!=="rgb"){const k=fp[i.colorSpace];S=(M,P)=>k.reverse(k.interpolate(k.forward(M),k.forward(P),y))}return typeof v.evaluate=="function"?{evaluate(...k){const M=v.evaluate.apply(void 0,k),P=w.evaluate.apply(void 0,k);if(M!==void 0&&P!==void 0)return S(M,P,y)}}:S(v,w,y)}function Ig(i,n,o){return n.type==="color"?o=Tr.parse(o):n.type==="formatted"?o=Bi.fromString(o.toString()):n.type==="resolvedImage"?o=co.fromString(o.toString()):xn(o)===n.type||n.type==="enum"&&n.values[o]||(o=void 0),ml(o,i.default,n.default)}class Ju{constructor(n,o){this.expression=n,this._warningHistory={},this._evaluator=new ep,this._defaultValue=o?function(c){return c.type==="color"&&(Pc(c.default)||Array.isArray(c.default))?new Tr(0,0,0,0):c.type==="color"?Tr.parse(c.default)||null:c.default===void 0?null:c.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(n,o,c,d,f,y,v,w){return this._evaluator.globals=n,this._evaluator.feature=o,this._evaluator.featureState=c,this._evaluator.canonical=d||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=w||null,this.expression.evaluate(this._evaluator)}evaluate(n,o,c,d,f,y,v,w){this._evaluator.globals=n,this._evaluator.feature=o||null,this._evaluator.featureState=c||null,this._evaluator.canonical=d||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=w||null;try{const S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new pi(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function gl(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Mc}function yl(i,n){const o=new sp(Mc,[],n?function(d){const f={color:Qi,string:hn,number:wt,enum:hn,boolean:cn,formatted:mc,resolvedImage:Sa};return d.type==="array"?lo(f[d.value]||un,d.length):f[d.type]}(n):void 0),c=o.parse(i,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?Tg(new Ju(c,n)):Ia(o.errors)}class bp{constructor(n,o){this.kind=n,this._styleExpression=o,this.isStateDependent=n!=="constant"&&!Is(o.expression)}evaluateWithoutErrorHandling(n,o,c,d,f,y){return this._styleExpression.evaluateWithoutErrorHandling(n,o,c,d,f,y)}evaluate(n,o,c,d,f,y){return this._styleExpression.evaluate(n,o,c,d,f,y)}}class Rc{constructor(n,o,c,d){this.kind=n,this.zoomStops=c,this._styleExpression=o,this.isStateDependent=n!=="camera"&&!Is(o.expression),this.interpolationType=d}evaluateWithoutErrorHandling(n,o,c,d,f,y){return this._styleExpression.evaluateWithoutErrorHandling(n,o,c,d,f,y)}evaluate(n,o,c,d,f,y){return this._styleExpression.evaluate(n,o,c,d,f,y)}interpolationFactor(n,o,c){return this.interpolationType?Ko.interpolationFactor(this.interpolationType,n,o,c):0}}function zc(i,n){if((i=yl(i,n)).result==="error")return i;const o=i.value.expression,c=ul(o);if(!c&&!fl(n))return Ia([new Zo("","data expressions not supported")]);const d=Ca(o,["zoom","pitch","distance-from-center"]);if(!d&&!Zu(n))return Ia([new Zo("","zoom expressions not supported")]);const f=ed(o);return f||d?f instanceof Zo?Ia([f]):f instanceof Ko&&!Xu(n)?Ia([new Zo("",'"interpolate" expressions cannot be used with this property')]):Tg(f?new Rc(c?"camera":"composite",i.value,f.labels,f instanceof Ko?f.interpolation:void 0):new bp(c?"constant":"source",i.value)):Ia([new Zo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Qu{constructor(n,o){this._parameters=n,this._specification=o,Ss(this,Ku(this._parameters,this._specification))}static deserialize(n){return new Qu(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function ed(i){let n=null;if(i instanceof yg)n=ed(i.result);else if(i instanceof gp){for(const o of i.args)if(n=ed(o),n)break}else(i instanceof lp||i instanceof Ko)&&i.input instanceof Cs&&i.input.name==="zoom"&&(n=i);return n instanceof Zo||i.eachChild(o=>{const c=ed(o);c instanceof Zo?n=c:!n&&c?n=new Zo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&c&&n!==c&&(n=new Zo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}class Et{constructor(n,o,c,d){this.message=(n?`${n}: `:"")+c,d&&(this.identifier=d),o!=null&&o.__line__&&(this.line=o.__line__)}}function ko(i){const n=i.key,o=i.value,c=i.valueSpec||{},d=i.objectElementValidators||{},f=i.style,y=i.styleSpec;let v=[];const w=xn(o);if(w!=="object")return[new Et(n,o,`object expected, ${w} found`)];for(const S in o){const k=S.split(".")[0];let M;d[k]?M=d[k]:c[k]?M=vi:d["*"]?M=d["*"]:c["*"]&&(M=vi),M?v=v.concat(M({key:(n&&`${n}.`)+S,value:o[S],valueSpec:c[k]||c["*"],style:f,styleSpec:y,object:o,objectKey:S},o)):v.push(new Et(n,o[S],`unknown property "${S}"`))}for(const S in c)d[S]||c[S].required&&c[S].default===void 0&&o[S]===void 0&&v.push(new Et(n,o,`missing required property "${S}"`));return v}function Ag(i){const n=i.value,o=i.valueSpec,c=i.style,d=i.styleSpec,f=i.key,y=i.arrayElementValidator||vi;if(xn(n)!=="array")return[new Et(f,n,`array expected, ${xn(n)} found`)];if(o.length&&n.length!==o.length)return[new Et(f,n,`array length ${o.length} expected, length ${n.length} found`)];if(o["min-length"]&&n.length<o["min-length"])return[new Et(f,n,`array length at least ${o["min-length"]} expected, length ${n.length} found`)];let v={type:o.value,values:o.values,minimum:o.minimum,maximum:o.maximum,function:void 0};d.$version<7&&(v.function=o.function),xn(o.value)==="object"&&(v=o.value);let w=[];for(let S=0;S<n.length;S++)w=w.concat(y({array:n,arrayIndex:S,value:n[S],valueSpec:v,style:c,styleSpec:d,key:`${f}[${S}]`}));return w}function Lc(i){const n=i.key,o=i.value,c=i.valueSpec;let d=xn(o);if(d==="number"&&o!=o&&(d="NaN"),d!=="number")return[new Et(n,o,`number expected, ${d} found`)];if("minimum"in c){let f=c.minimum;if(xn(c.minimum)==="array"&&(f=c.minimum[i.arrayIndex]),o<f)return[new Et(n,o,`${o} is less than the minimum value ${f}`)]}if("maximum"in c){let f=c.maximum;if(xn(c.maximum)==="array"&&(f=c.maximum[i.arrayIndex]),o>f)return[new Et(n,o,`${o} is greater than the maximum value ${f}`)]}return[]}function Dc(i){const n=i.valueSpec,o=zr(i.value.type);let c,d,f,y={};const v=o!=="categorical"&&i.value.property===void 0,w=!v,S=xn(i.value.stops)==="array"&&xn(i.value.stops[0])==="array"&&xn(i.value.stops[0][0])==="object",k=ko({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(B){if(o==="identity")return[new Et(B.key,B.value,'identity function may not have a "stops" property')];let j=[];const U=B.value;return j=j.concat(Ag({key:B.key,value:U,valueSpec:B.valueSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:M})),xn(U)==="array"&&U.length===0&&j.push(new Et(B.key,U,"array must have at least one stop")),j},default:function(B){return vi({key:B.key,value:B.value,valueSpec:n,style:B.style,styleSpec:B.styleSpec})}}});return o==="identity"&&v&&k.push(new Et(i.key,i.value,'missing required property "property"')),o==="identity"||i.value.stops||k.push(new Et(i.key,i.value,'missing required property "stops"')),o==="exponential"&&i.valueSpec.expression&&!Xu(i.valueSpec)&&k.push(new Et(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(w&&!fl(i.valueSpec)?k.push(new Et(i.key,i.value,"property functions not supported")):v&&!Zu(i.valueSpec)&&k.push(new Et(i.key,i.value,"zoom functions not supported"))),o!=="categorical"&&!S||i.value.property!==void 0||k.push(new Et(i.key,i.value,'"property" property is required')),k;function M(B){let j=[];const U=B.value,Q=B.key;if(xn(U)!=="array")return[new Et(Q,U,`array expected, ${xn(U)} found`)];if(U.length!==2)return[new Et(Q,U,`array length 2 expected, length ${U.length} found`)];if(S){if(xn(U[0])!=="object")return[new Et(Q,U,`object expected, ${xn(U[0])} found`)];if(U[0].zoom===void 0)return[new Et(Q,U,"object stop key must have zoom")];if(U[0].value===void 0)return[new Et(Q,U,"object stop key must have value")];const ae=zr(U[0].zoom);if(typeof ae!="number")return[new Et(Q,U[0].zoom,"stop zoom values must be numbers")];if(f&&f>ae)return[new Et(Q,U[0].zoom,"stop zoom values must appear in ascending order")];ae!==f&&(f=ae,d=void 0,y={}),j=j.concat(ko({key:`${Q}[0]`,value:U[0],valueSpec:{zoom:{}},style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:Lc,value:P}}))}else j=j.concat(P({key:`${Q}[0]`,value:U[0],valueSpec:{},style:B.style,styleSpec:B.styleSpec},U));return gl(ti(U[1]))?j.concat([new Et(`${Q}[1]`,U[1],"expressions are not allowed in function stops.")]):j.concat(vi({key:`${Q}[1]`,value:U[1],valueSpec:n,style:B.style,styleSpec:B.styleSpec}))}function P(B,j){const U=xn(B.value),Q=zr(B.value),ae=B.value!==null?B.value:j;if(c){if(U!==c)return[new Et(B.key,ae,`${U} stop domain type must match previous stop domain type ${c}`)]}else c=U;if(U!=="number"&&U!=="string"&&U!=="boolean"&&typeof Q!="number"&&typeof Q!="string"&&typeof Q!="boolean")return[new Et(B.key,ae,"stop domain value must be a number, string, or boolean")];if(U!=="number"&&o!=="categorical"){let ge=`number expected, ${U} found`;return fl(n)&&o===void 0&&(ge+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Et(B.key,ae,ge)]}return o!=="categorical"||U!=="number"||typeof Q=="number"&&isFinite(Q)&&Math.floor(Q)===Q?o!=="categorical"&&U==="number"&&typeof Q=="number"&&typeof d=="number"&&d!==void 0&&Q<d?[new Et(B.key,ae,"stop domain values must appear in ascending order")]:(d=Q,o==="categorical"&&Q in y?[new Et(B.key,ae,"stop domain values must be unique")]:(y[Q]=!0,[])):[new Et(B.key,ae,`integer expected, found ${String(Q)}`)]}}function ni(i){const n=(i.expressionContext==="property"?zc:yl)(ti(i.value),i.valueSpec);if(n.result==="error")return n.value.map(c=>new Et(`${i.key}${c.key}`,i.value,c.message));const o=n.value.expression||n.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!o.outputDefined())return[new Et(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Is(o))return[new Et(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter")return Oc(o,i);if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Ca(o,["zoom","feature-state"]))return[new Et(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!ul(o))return[new Et(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Oc(i,n){const o=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const d of n.valueSpec.expression.parameters)o.delete(d);if(o.size===0)return[];const c=[];return i instanceof Cs&&o.has(i.name)?[new Et(n.key,n.value,`["${i.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(i.eachChild(d=>{c.push(...Oc(d,n))}),c)}function td(i){const n=i.key,o=i.value,c=i.valueSpec,d=[];return Array.isArray(c.values)?c.values.indexOf(zr(o))===-1&&d.push(new Et(n,o,`expected one of [${c.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(c.values).indexOf(zr(o))===-1&&d.push(new Et(n,o,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(o)} found`)),d}function wp(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const n of i.slice(1))if(!wp(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function nd(i,n="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};wp(i)||(i=xl(i));const o=i;let c=!0;try{c=function(S){if(!_l(S))return S;let k=ti(S);return rd(k),k=Mg(k),k}(o)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(o,null,2)}
        `)}const d=qe[`filter_${n}`],f=yl(c,d);let y=null;if(f.result==="error")throw new Error(f.value.map(S=>`${S.key}: ${S.message}`).join(", "));y=(S,k,M)=>f.value.evaluate(S,k,{},M);let v=null,w=null;if(c!==o){const S=yl(o,d);if(S.result==="error")throw new Error(S.value.map(k=>`${k.key}: ${k.message}`).join(", "));v=(k,M,P,B,j)=>S.value.evaluate(k,M,{},P,void 0,void 0,B,j),w=!ul(S.value.expression)}return{filter:y,dynamicFilter:v||void 0,needGeometry:Pg(c),needFeature:!!w}}function Mg(i){if(!Array.isArray(i))return i;const n=function(o){if(Sp.has(o[0])){for(let c=1;c<o.length;c++)if(_l(o[c]))return!0}return o}(i);return n===!0?n:n.map(o=>Mg(o))}function rd(i){let n=!1;const o=[];if(i[0]==="case"){for(let c=1;c<i.length-1;c+=2)n=n||_l(i[c]),o.push(i[c+1]);o.push(i[i.length-1])}else if(i[0]==="match"){n=n||_l(i[1]);for(let c=2;c<i.length-1;c+=2)o.push(i[c+1]);o.push(i[i.length-1])}else if(i[0]==="step"){n=n||_l(i[1]);for(let c=1;c<i.length-1;c+=2)o.push(i[c+1])}n&&(i.length=0,i.push("any",...o));for(let c=1;c<i.length;c++)rd(i[c])}function _l(i){if(!Array.isArray(i))return!1;if((n=i[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let o=1;o<i.length;o++)if(_l(i[o]))return!0;return!1}const Sp=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function hv(i,n){return i<n?-1:i>n?1:0}function Pg(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let n=1;n<i.length;n++)if(Pg(i[n]))return!0;return!1}function xl(i){if(!i)return!0;const n=i[0];return i.length<=1?n!=="any":n==="=="?Ep(i[1],i[2],"=="):n==="!="?id(Ep(i[1],i[2],"==")):n==="<"||n===">"||n==="<="||n===">="?Ep(i[1],i[2],n):n==="any"?(o=i.slice(1),["any"].concat(o.map(xl))):n==="all"?["all"].concat(i.slice(1).map(xl)):n==="none"?["all"].concat(i.slice(1).map(xl).map(id)):n==="in"?Tp(i[1],i.slice(2)):n==="!in"?id(Tp(i[1],i.slice(2))):n==="has"?Cp(i[1]):n==="!has"?id(Cp(i[1])):n!=="within"||i;var o}function Ep(i,n,o){switch(i){case"$type":return[`filter-type-${o}`,n];case"$id":return[`filter-id-${o}`,n];default:return[`filter-${o}`,i,n]}}function Tp(i,n){if(n.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(o=>typeof o!=typeof n[0])?["filter-in-large",i,["literal",n.sort(hv)]]:["filter-in-small",i,["literal",n]]}}function Cp(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function id(i){return["!",i]}function Bc(i){return wp(ti(i.value))?ni(Ss({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${i.layerType||"fill"}`]})):Fc(i)}function Fc(i){const n=i.value,o=i.key;if(xn(n)!=="array")return[new Et(o,n,`array expected, ${xn(n)} found`)];const c=i.styleSpec;let d,f=[];if(n.length<1)return[new Et(o,n,"filter array must have at least 1 element")];switch(f=f.concat(td({key:`${o}[0]`,value:n[0],valueSpec:c.filter_operator,style:i.style,styleSpec:i.styleSpec})),zr(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&zr(n[1])==="$type"&&f.push(new Et(o,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&f.push(new Et(o,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(d=xn(n[1]),d!=="string"&&f.push(new Et(`${o}[1]`,n[1],`string expected, ${d} found`)));for(let y=2;y<n.length;y++)d=xn(n[y]),zr(n[1])==="$type"?f=f.concat(td({key:`${o}[${y}]`,value:n[y],valueSpec:c.geometry_type,style:i.style,styleSpec:i.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&f.push(new Et(`${o}[${y}]`,n[y],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let y=1;y<n.length;y++)f=f.concat(Fc({key:`${o}[${y}]`,value:n[y],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":d=xn(n[1]),n.length!==2?f.push(new Et(o,n,`filter array for "${n[0]}" operator must have 2 elements`)):d!=="string"&&f.push(new Et(`${o}[1]`,n[1],`string expected, ${d} found`));break;case"within":d=xn(n[1]),n.length!==2?f.push(new Et(o,n,`filter array for "${n[0]}" operator must have 2 elements`)):d!=="object"&&f.push(new Et(`${o}[1]`,n[1],`object expected, ${d} found`))}return f}function kp(i,n){const o=i.key,c=i.style,d=i.styleSpec,f=i.value,y=i.objectKey,v=d[`${n}_${i.layerType}`];if(!v)return[];const w=y.match(/^(.*)-transition$/);if(n==="paint"&&w&&v[w[1]]&&v[w[1]].transition)return vi({key:o,value:f,valueSpec:d.transition,style:c,styleSpec:d});const S=i.valueSpec||v[y];if(!S)return[new Et(o,f,`unknown property "${y}"`)];let k;if(xn(f)==="string"&&fl(S)&&!S.tokens&&(k=/^{([^}]+)}$/.exec(f))){const P=`\`{ "type": "identity", "property": ${k?JSON.stringify(k[1]):'"_"'} }\``;return[new Et(o,f,`"${y}" does not support interpolation syntax
Use an identity property function instead: ${P}.`)]}const M=[];return i.layerType==="symbol"&&(y==="text-field"&&c&&!c.glyphs&&M.push(new Et(o,f,'use of "text-field" requires a style "glyphs" property')),y==="text-font"&&Pc(ti(f))&&zr(f.type)==="identity"&&M.push(new Et(o,f,'"text-font" does not support identity functions'))),M.concat(vi({key:i.key,value:f,valueSpec:S,style:c,styleSpec:d,expressionContext:"property",propertyType:n,propertyKey:y}))}function Rg(i){return kp(i,"paint")}function Ip(i){return kp(i,"layout")}function zg(i){let n=[];const o=i.value,c=i.key,d=i.style,f=i.styleSpec;o.type||o.ref||n.push(new Et(c,o,'either "type" or "ref" is required'));let y=zr(o.type);const v=zr(o.ref);if(o.id){const w=zr(o.id);for(let S=0;S<i.arrayIndex;S++){const k=d.layers[S];zr(k.id)===w&&n.push(new Et(c,o.id,`duplicate layer id "${o.id}", previously used at line ${k.id.__line__}`))}}if("ref"in o){let w;["type","source","source-layer","filter","layout"].forEach(S=>{S in o&&n.push(new Et(c,o[S],`"${S}" is prohibited for ref layers`))}),d.layers.forEach(S=>{zr(S.id)===v&&(w=S)}),w?w.ref?n.push(new Et(c,o.ref,"ref cannot reference another ref layer")):y=zr(w.type):typeof v=="string"&&n.push(new Et(c,o.ref,`ref layer "${v}" not found`))}else if(y!=="background"&&y!=="sky")if(o.source){const w=d.sources&&d.sources[o.source],S=w&&zr(w.type);w?S==="vector"&&y==="raster"?n.push(new Et(c,o.source,`layer "${o.id}" requires a raster source`)):S==="raster"&&y!=="raster"?n.push(new Et(c,o.source,`layer "${o.id}" requires a vector source`)):S!=="vector"||o["source-layer"]?S==="raster-dem"&&y!=="hillshade"?n.push(new Et(c,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!o.paint||!o.paint["line-gradient"]&&!o.paint["line-trim-offset"]||S==="geojson"&&w.lineMetrics||n.push(new Et(c,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Et(c,o,`layer "${o.id}" must specify a "source-layer"`)):n.push(new Et(c,o.source,`source "${o.source}" not found`))}else n.push(new Et(c,o,'missing required property "source"'));return n=n.concat(ko({key:c,value:o,valueSpec:f.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>vi({key:`${c}.type`,value:o.type,valueSpec:f.layer.type,style:i.style,styleSpec:i.styleSpec,object:o,objectKey:"type"}),filter:w=>Bc(Ss({layerType:y},w)),layout:w=>ko({layer:o,key:w.key,value:w.value,valueSpec:{},style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":S=>Ip(Ss({layerType:y},S))}}),paint:w=>ko({layer:o,key:w.key,value:w.value,valueSpec:{},style:w.style,styleSpec:w.styleSpec,objectElementValidators:{"*":S=>Rg(Ss({layerType:y},S))}})}})),n}function ea(i){const n=i.value,o=i.key,c=xn(n);return c!=="string"?[new Et(o,n,`string expected, ${c} found`)]:[]}const Lg={promoteId:function({key:i,value:n}){if(xn(n)==="string")return ea({key:i,value:n});{const o=[];for(const c in n)o.push(...ea({key:`${i}.${c}`,value:n[c]}));return o}}};function Dg(i){const n=i.value,o=i.key,c=i.styleSpec,d=i.style;if(!n.type)return[new Et(o,n,'"type" is required')];const f=zr(n.type);let y;switch(f){case"vector":case"raster":case"raster-dem":return y=ko({key:o,value:n,valueSpec:c[`source_${f.replace("-","_")}`],style:i.style,styleSpec:c,objectElementValidators:Lg}),y;case"geojson":if(y=ko({key:o,value:n,valueSpec:c.source_geojson,style:d,styleSpec:c,objectElementValidators:Lg}),n.cluster)for(const v in n.clusterProperties){const[w,S]=n.clusterProperties[v],k=typeof w=="string"?[w,["accumulated"],["get",v]]:w;y.push(...ni({key:`${o}.${v}.map`,value:S,expressionContext:"cluster-map"})),y.push(...ni({key:`${o}.${v}.reduce`,value:k,expressionContext:"cluster-reduce"}))}return y;case"video":return ko({key:o,value:n,valueSpec:c.source_video,style:d,styleSpec:c});case"image":return ko({key:o,value:n,valueSpec:c.source_image,style:d,styleSpec:c});case"canvas":return[new Et(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return td({key:`${o}.type`,value:n.type,valueSpec:{values:pv(c)},style:d,styleSpec:c})}}function pv(i){return i.source.reduce((n,o)=>{const c=i[o];return c.type.type==="enum"&&(n=n.concat(Object.keys(c.type.values))),n},[])}function Og(i){const n=i.value,o=i.styleSpec,c=o.light,d=i.style;let f=[];const y=xn(n);if(n===void 0)return f;if(y!=="object")return f=f.concat([new Et("light",n,`object expected, ${y} found`)]),f;for(const v in n){const w=v.match(/^(.*)-transition$/);f=f.concat(w&&c[w[1]]&&c[w[1]].transition?vi({key:v,value:n[v],valueSpec:o.transition,style:d,styleSpec:o}):c[v]?vi({key:v,value:n[v],valueSpec:c[v],style:d,styleSpec:o}):[new Et(v,n[v],`unknown property "${v}"`)])}return f}function Ap(i){const n=i.value,o=i.key,c=i.style,d=i.styleSpec,f=d.terrain;let y=[];const v=xn(n);if(n===void 0)return y;if(v!=="object")return y=y.concat([new Et("terrain",n,`object expected, ${v} found`)]),y;for(const w in n){const S=w.match(/^(.*)-transition$/);y=y.concat(S&&f[S[1]]&&f[S[1]].transition?vi({key:w,value:n[w],valueSpec:d.transition,style:c,styleSpec:d}):f[w]?vi({key:w,value:n[w],valueSpec:f[w],style:c,styleSpec:d}):[new Et(w,n[w],`unknown property "${w}"`)])}if(n.source){const w=c.sources&&c.sources[n.source],S=w&&zr(w.type);w?S!=="raster-dem"&&y.push(new Et(o,n.source,`terrain cannot be used with a source of type ${String(S)}, it only be used with a "raster-dem" source type`)):y.push(new Et(o,n.source,`source "${n.source}" not found`))}else y.push(new Et(o,n,'terrain is missing required property "source"'));return y}function Bg(i){const n=i.value,o=i.style,c=i.styleSpec,d=c.fog;let f=[];const y=xn(n);if(n===void 0)return f;if(y!=="object")return f=f.concat([new Et("fog",n,`object expected, ${y} found`)]),f;for(const v in n){const w=v.match(/^(.*)-transition$/);f=f.concat(w&&d[w[1]]&&d[w[1]].transition?vi({key:v,value:n[v],valueSpec:c.transition,style:o,styleSpec:c}):d[v]?vi({key:v,value:n[v],valueSpec:d[v],style:o,styleSpec:c}):[new Et(v,n[v],`unknown property "${v}"`)])}return f}const Fg={"*":()=>[],array:Ag,boolean:function(i){const n=i.value,o=i.key,c=xn(n);return c!=="boolean"?[new Et(o,n,`boolean expected, ${c} found`)]:[]},number:Lc,color:function(i){const n=i.key,o=i.value,c=xn(o);return c!=="string"?[new Et(n,o,`color expected, ${c} found`)]:Hh(o)===null?[new Et(n,o,`color expected, "${o}" found`)]:[]},enum:td,filter:Bc,function:Dc,layer:zg,object:ko,source:Dg,light:Og,terrain:Ap,fog:Bg,string:ea,formatted:function(i){return ea(i).length===0?[]:ni(i)},resolvedImage:function(i){return ea(i).length===0?[]:ni(i)},projection:function(i){const n=i.value,o=i.styleSpec,c=o.projection,d=i.style;let f=[];const y=xn(n);if(y==="object")for(const v in n)f=f.concat(vi({key:v,value:n[v],valueSpec:c[v],style:d,styleSpec:o}));else y!=="string"&&(f=f.concat([new Et("projection",n,`object or string expected, ${y} found`)]));return f}};function vi(i){const n=i.value,o=i.valueSpec,c=i.styleSpec;return o.expression&&Pc(zr(n))?Dc(i):o.expression&&gl(ti(n))?ni(i):o.type&&Fg[o.type]?Fg[o.type](i):ko(Ss({},i,{valueSpec:o.type?c[o.type]:o}))}function fv(i){const n=i.value,o=i.key,c=ea(i);return c.length||(n.indexOf("{fontstack}")===-1&&c.push(new Et(o,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&c.push(new Et(o,n,'"glyphs" url must include a "{range}" token'))),c}function jg(i,n=qe){return ho(vi({key:"",value:i,valueSpec:n.$root,styleSpec:n,style:i,objectElementValidators:{glyphs:fv,"*":()=>[]}}))}const mv=i=>ho(Rg(i)),gv=i=>ho(Ip(i));function ho(i){return i.slice().sort((n,o)=>n.line&&o.line?n.line-o.line:0)}function Ng(i,n){let o=!1;if(n&&n.length)for(const c of n)i.fire(new ws(new Error(c.message))),o=!0;return o}var yv=Yo,Io=3;function Yo(i,n,o){var c=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var d=new Int32Array(this.arrayBuffer);i=d[0],this.d=(n=d[1])+2*(o=d[2]);for(var f=0;f<this.d*this.d;f++){var y=d[Io+f],v=d[Io+f+1];c.push(y===v?null:d.subarray(y,v))}var w=d[Io+c.length+1];this.keys=d.subarray(d[Io+c.length],w),this.bboxes=d.subarray(w),this.insert=this._insertReadonly}else{this.d=n+2*o;for(var S=0;S<this.d*this.d;S++)c.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=i,this.padding=o,this.scale=n/i,this.uid=0;var k=o/n*i;this.min=-k,this.max=i+k}Yo.prototype.insert=function(i,n,o,c,d){this._forEachCell(n,o,c,d,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(n),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(d)},Yo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Yo.prototype._insertCell=function(i,n,o,c,d,f){this.cells[d].push(f)},Yo.prototype.query=function(i,n,o,c,d){var f=this.min,y=this.max;if(i<=f&&n<=f&&y<=o&&y<=c&&!d)return Array.prototype.slice.call(this.keys);var v=[];return this._forEachCell(i,n,o,c,this._queryCell,v,{},d),v},Yo.prototype._queryCell=function(i,n,o,c,d,f,y,v){var w=this.cells[d];if(w!==null)for(var S=this.keys,k=this.bboxes,M=0;M<w.length;M++){var P=w[M];if(y[P]===void 0){var B=4*P;(v?v(k[B+0],k[B+1],k[B+2],k[B+3]):i<=k[B+2]&&n<=k[B+3]&&o>=k[B+0]&&c>=k[B+1])?(y[P]=!0,f.push(S[P])):y[P]=!1}}},Yo.prototype._forEachCell=function(i,n,o,c,d,f,y,v){for(var w=this._convertToCellCoord(i),S=this._convertToCellCoord(n),k=this._convertToCellCoord(o),M=this._convertToCellCoord(c),P=w;P<=k;P++)for(var B=S;B<=M;B++){var j=this.d*B+P;if((!v||v(this._convertFromCellCoord(P),this._convertFromCellCoord(B),this._convertFromCellCoord(P+1),this._convertFromCellCoord(B+1)))&&d.call(this,i,n,o,c,j,f,y,v))return}},Yo.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},Yo.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},Yo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,n=Io+this.cells.length+1+1,o=0,c=0;c<this.cells.length;c++)o+=this.cells[c].length;var d=new Int32Array(n+o+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;for(var f=n,y=0;y<i.length;y++){var v=i[y];d[Io+y]=f,d.set(v,f),f+=v.length}return d[Io+i.length]=f,d.set(this.keys,f),d[Io+i.length+1]=f+=this.keys.length,d.set(this.bboxes,f),f+=this.bboxes.length,d.buffer};var Aa=V(yv);const od={};function kt(i,n,o={}){Object.defineProperty(i,"_classRegistryKey",{value:n,writeable:!1}),od[n]={klass:i,omit:o.omit||[]}}kt(Object,"Object"),Aa.serialize=function(i,n){const o=i.toArrayBuffer();return n&&n.push(o),{buffer:o}},Aa.deserialize=function(i){return new Aa(i.buffer)},Object.defineProperty(Aa,"name",{value:"Grid"}),kt(Aa,"Grid"),kt(Tr,"Color"),kt(Error,"Error"),kt(kn,"AJAXError"),kt(co,"ResolvedImage"),kt(Qu,"StylePropertyFunction"),kt(Ju,"StyleExpression",{omit:["_evaluator"]}),kt(Rc,"ZoomDependentExpression"),kt(bp,"ZoomConstantExpression"),kt(Cs,"CompoundExpression",{omit:["_evaluate"]});for(const i in Mc)od[Mc[i]._classRegistryKey]||kt(Mc[i],`Expression${i}`);function Mp(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Pp(i){return E.ImageBitmap&&i instanceof E.ImageBitmap}function vl(i,n){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(Mp(i)||Pp(i))return n&&n.push(i),i;if(ArrayBuffer.isView(i)){const o=i;return n&&n.push(o.buffer),o}if(i instanceof E.ImageData)return n&&n.push(i.data.buffer),i;if(Array.isArray(i)){const o=[];for(const c of i)o.push(vl(c,n));return o}if(typeof i=="object"){const o=i.constructor,c=o._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const d=o.serialize?o.serialize(i,n):{};if(!o.serialize){for(const f in i)i.hasOwnProperty(f)&&(od[c].omit.indexOf(f)>=0||(d[f]=vl(i[f],n)));i instanceof Error&&(d.message=i.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(d.$name=c),d}throw new Error("can't serialize object of type "+typeof i)}function Ma(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||Mp(i)||Pp(i)||ArrayBuffer.isView(i)||i instanceof E.ImageData)return i;if(Array.isArray(i))return i.map(Ma);if(typeof i=="object"){const n=i.$name||"Object",{klass:o}=od[n];if(!o)throw new Error(`can't deserialize unregistered class ${n}`);if(o.deserialize)return o.deserialize(i);const c=Object.create(o.prototype);for(const d of Object.keys(i))d!=="$name"&&(c[d]=Ma(i[d]));return c}throw new Error("can't deserialize object of type "+typeof i)}const bt={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function Rp(i){for(const n of i)if(zp(n.charCodeAt(0)))return!0;return!1}function _v(i){for(const n of i)if(!$g(n.charCodeAt(0)))return!1;return!0}function $g(i){return!(bt.Arabic(i)||bt["Arabic Supplement"](i)||bt["Arabic Extended-A"](i)||bt["Arabic Presentation Forms-A"](i)||bt["Arabic Presentation Forms-B"](i))}function zp(i){return!(i!==746&&i!==747&&(i<4352||!(bt["Bopomofo Extended"](i)||bt.Bopomofo(i)||bt["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||bt["CJK Compatibility Ideographs"](i)||bt["CJK Compatibility"](i)||bt["CJK Radicals Supplement"](i)||bt["CJK Strokes"](i)||!(!bt["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||bt["CJK Unified Ideographs Extension A"](i)||bt["CJK Unified Ideographs"](i)||bt["Enclosed CJK Letters and Months"](i)||bt["Hangul Compatibility Jamo"](i)||bt["Hangul Jamo Extended-A"](i)||bt["Hangul Jamo Extended-B"](i)||bt["Hangul Jamo"](i)||bt["Hangul Syllables"](i)||bt.Hiragana(i)||bt["Ideographic Description Characters"](i)||bt.Kanbun(i)||bt["Kangxi Radicals"](i)||bt["Katakana Phonetic Extensions"](i)||bt.Katakana(i)&&i!==12540||!(!bt["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!bt["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||bt["Unified Canadian Aboriginal Syllabics"](i)||bt["Unified Canadian Aboriginal Syllabics Extended"](i)||bt["Vertical Forms"](i)||bt["Yijing Hexagram Symbols"](i)||bt["Yi Syllables"](i)||bt["Yi Radicals"](i))))}function Ug(i){return!(zp(i)||function(n){return!!(bt["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||bt["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||bt["Letterlike Symbols"](n)||bt["Number Forms"](n)||bt["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||bt["Control Pictures"](n)&&n!==9251||bt["Optical Character Recognition"](n)||bt["Enclosed Alphanumerics"](n)||bt["Geometric Shapes"](n)||bt["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||bt["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||bt["CJK Symbols and Punctuation"](n)||bt.Katakana(n)||bt["Private Use Area"](n)||bt["CJK Compatibility Forms"](n)||bt["Small Form Variants"](n)||bt["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(i))}function Vg(i){return i>=1424&&i<=2303||bt["Arabic Presentation Forms-A"](i)||bt["Arabic Presentation Forms-B"](i)}function xv(i,n){return!(!n&&Vg(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||bt.Khmer(i))}function vv(i){for(const n of i)if(Vg(n.charCodeAt(0)))return!0;return!1}const Lp="deferred",Dp="loading",Op="loaded";let bl=null,p="unavailable",s=null;const u=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(p="error"),bl&&bl(i)};function g(){_.fire(new wa("pluginStateChange",{pluginStatus:p,pluginURL:s}))}const _=new fc,b=function(){return p},T=function(){if(p!==Lp||!s)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");p=Dp,g(),s&&vs({url:s},i=>{i?u(i):(p=Op,g())})},C={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>p===Op||C.applyArabicShaping!=null,isLoading:()=>p===Dp,setState(i){p=i.pluginStatus,s=i.pluginURL},isParsed:()=>C.applyArabicShaping!=null&&C.processBidirectionalText!=null&&C.processStyledBidirectionalText!=null,getPluginURL:()=>s};class A{constructor(n,o){this.zoom=n,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(n){return function(o,c){for(const d of o)if(!xv(d.charCodeAt(0),c))return!1;return!0}(n,C.isLoaded())}}class z{constructor(n,o){this.property=n,this.value=o,this.expression=function(c,d){if(Pc(c))return new Qu(c,d);if(gl(c)){const f=zc(c,d);if(f.result==="error")throw new Error(f.value.map(y=>`${y.key}: ${y.message}`).join(", "));return f.value}{let f=c;return typeof c=="string"&&d.type==="color"&&(f=Tr.parse(c)),{kind:"constant",evaluate:()=>f}}}(o===void 0?n.specification.default:o,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,o,c){return this.property.possiblyEvaluate(this,n,o,c)}}class R{constructor(n){this.property=n,this.value=new z(n,void 0)}transitioned(n,o){return new Y(this.property,this.value,o,zt({},n.transition,this.transition),n.now)}untransitioned(){return new Y(this.property,this.value,null,{},0)}}class N{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return Xt(this._values[n].value.value)}setValue(n,o){this._values.hasOwnProperty(n)||(this._values[n]=new R(this._values[n].property)),this._values[n].value=new z(this._values[n].property,o===null?void 0:Xt(o))}getTransition(n){return Xt(this._values[n].transition)}setTransition(n,o){this._values.hasOwnProperty(n)||(this._values[n]=new R(this._values[n].property)),this._values[n].transition=Xt(o)||void 0}serialize(){const n={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(n[o]=c);const d=this.getTransition(o);d!==void 0&&(n[`${o}-transition`]=d)}return n}transitioned(n,o){const c=new te(this._properties);for(const d of Object.keys(this._values))c._values[d]=this._values[d].transitioned(n,o._values[d]);return c}untransitioned(){const n=new te(this._properties);for(const o of Object.keys(this._values))n._values[o]=this._values[o].untransitioned();return n}}class Y{constructor(n,o,c,d,f){const y=d.delay||0,v=d.duration||0;f=f||0,this.property=n,this.value=o,this.begin=f+y,this.end=this.begin+v,n.specification.transition&&(d.delay||d.duration)&&(this.prior=c)}possiblyEvaluate(n,o,c){const d=n.now||0,f=this.value.possiblyEvaluate(n,o,c),y=this.prior;if(y){if(d>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(d<this.begin)return y.possiblyEvaluate(n,o,c);{const v=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(n,o,c),f,gt(v))}}return f}}class te{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,o,c){const d=new se(this._properties);for(const f of Object.keys(this._values))d._values[f]=this._values[f].possiblyEvaluate(n,o,c);return d}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class ie{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}getValue(n){return Xt(this._values[n].value)}setValue(n,o){this._values[n]=new z(this._values[n].property,o===null?void 0:Xt(o))}serialize(){const n={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(n[o]=c)}return n}possiblyEvaluate(n,o,c){const d=new se(this._properties);for(const f of Object.keys(this._values))d._values[f]=this._values[f].possiblyEvaluate(n,o,c);return d}}class re{constructor(n,o,c){this.property=n,this.value=o,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,o,c,d){return this.property.evaluate(this.value,this.parameters,n,o,c,d)}}class se{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class ${constructor(n){this.specification=n}possiblyEvaluate(n,o){return n.expression.evaluate(o)}interpolate(n,o,c){const d=Tc[this.specification.type];return d?d(n,o,c):n}}class ee{constructor(n,o){this.specification=n,this.overrides=o}possiblyEvaluate(n,o,c,d){return new re(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(o,null,{},c,d)}:n.expression,o)}interpolate(n,o,c){if(n.value.kind!=="constant"||o.value.kind!=="constant")return n;if(n.value.value===void 0||o.value.value===void 0)return new re(this,{kind:"constant",value:void 0},n.parameters);const d=Tc[this.specification.type];return d?new re(this,{kind:"constant",value:d(n.value.value,o.value.value,c)},n.parameters):n}evaluate(n,o,c,d,f,y){return n.kind==="constant"?n.value:n.evaluate(o,c,d,f,y)}}class ue{constructor(n){this.specification=n}possiblyEvaluate(n,o,c,d){return!!n.expression.evaluate(o,null,{},c,d)}interpolate(){return!1}}class de{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new A(0,{});for(const c in n){const d=n[c];d.specification.overridable&&this.overridableProperties.push(c);const f=this.defaultPropertyValues[c]=new z(d,void 0),y=this.defaultTransitionablePropertyValues[c]=new R(d);this.defaultTransitioningPropertyValues[c]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=f.possiblyEvaluate(o)}}}function Se(i,n){return 256*(i=Re(Math.floor(i),0,255))+Re(Math.floor(n),0,255)}kt(ee,"DataDrivenProperty"),kt($,"DataConstantProperty"),kt(ue,"ColorRampProperty");const Te={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ee{constructor(n,o){this._structArray=n,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Pe{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,o){return n._trim(),o&&(n.isTransferred=!0,o.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const o=Object.create(this.prototype);return o.arrayBuffer=n.arrayBuffer,o.length=n.length,o.capacity=n.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Me(i,n=1){let o=0,c=0;return{members:i.map(d=>{const f=Te[d.type].BYTES_PER_ELEMENT,y=o=je(o,Math.max(n,f)),v=d.components||1;return c=Math.max(c,f),o+=f*v,{name:d.name,type:d.type,components:v,offset:y}}),size:je(o,Math.max(c,n)),alignment:n}}function je(i,n){return Math.ceil(i/n)*n}class rt extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o){const c=this.length;return this.resize(c+1),this.emplace(c,n,o)}emplace(n,o,c){const d=2*n;return this.int16[d+0]=o,this.int16[d+1]=c,n}}rt.prototype.bytesPerElement=4,kt(rt,"StructArrayLayout2i4");class Oe extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,c){const d=this.length;return this.resize(d+1),this.emplace(d,n,o,c)}emplace(n,o,c,d){const f=3*n;return this.int16[f+0]=o,this.int16[f+1]=c,this.int16[f+2]=d,n}}Oe.prototype.bytesPerElement=6,kt(Oe,"StructArrayLayout3i6");class Ke extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,n,o,c,d)}emplace(n,o,c,d,f){const y=4*n;return this.int16[y+0]=o,this.int16[y+1]=c,this.int16[y+2]=d,this.int16[y+3]=f,n}}Ke.prototype.bytesPerElement=8,kt(Ke,"StructArrayLayout4i8");class $e extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,c,d,f,y,v){const w=this.length;return this.resize(w+1),this.emplace(w,n,o,c,d,f,y,v)}emplace(n,o,c,d,f,y,v,w){const S=6*n,k=12*n,M=3*n;return this.int16[S+0]=o,this.int16[S+1]=c,this.uint8[k+4]=d,this.uint8[k+5]=f,this.uint8[k+6]=y,this.uint8[k+7]=v,this.float32[M+2]=w,n}}$e.prototype.bytesPerElement=12,kt($e,"StructArrayLayout2i4ub1f12");class nt extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,n,o,c,d)}emplace(n,o,c,d,f){const y=4*n;return this.float32[y+0]=o,this.float32[y+1]=c,this.float32[y+2]=d,this.float32[y+3]=f,n}}nt.prototype.bytesPerElement=16,kt(nt,"StructArrayLayout4f16");class Fe extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,c,d,f){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,c,d,f)}emplace(n,o,c,d,f,y){const v=6*n,w=3*n;return this.uint16[v+0]=o,this.uint16[v+1]=c,this.uint16[v+2]=d,this.uint16[v+3]=f,this.float32[w+2]=y,n}}Fe.prototype.bytesPerElement=12,kt(Fe,"StructArrayLayout4ui1f12");class Ze extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,n,o,c,d)}emplace(n,o,c,d,f){const y=4*n;return this.uint16[y+0]=o,this.uint16[y+1]=c,this.uint16[y+2]=d,this.uint16[y+3]=f,n}}Ze.prototype.bytesPerElement=8,kt(Ze,"StructArrayLayout4ui8");class ot extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,c,d,f,y){const v=this.length;return this.resize(v+1),this.emplace(v,n,o,c,d,f,y)}emplace(n,o,c,d,f,y,v){const w=6*n;return this.int16[w+0]=o,this.int16[w+1]=c,this.int16[w+2]=d,this.int16[w+3]=f,this.int16[w+4]=y,this.int16[w+5]=v,n}}ot.prototype.bytesPerElement=12,kt(ot,"StructArrayLayout6i12");class Qe extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,c,d,f,y,v,w,S,k,M,P){const B=this.length;return this.resize(B+1),this.emplace(B,n,o,c,d,f,y,v,w,S,k,M,P)}emplace(n,o,c,d,f,y,v,w,S,k,M,P,B){const j=12*n;return this.int16[j+0]=o,this.int16[j+1]=c,this.int16[j+2]=d,this.int16[j+3]=f,this.uint16[j+4]=y,this.uint16[j+5]=v,this.uint16[j+6]=w,this.uint16[j+7]=S,this.int16[j+8]=k,this.int16[j+9]=M,this.int16[j+10]=P,this.int16[j+11]=B,n}}Qe.prototype.bytesPerElement=24,kt(Qe,"StructArrayLayout4i4ui4i24");class at extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,c,d,f,y){const v=this.length;return this.resize(v+1),this.emplace(v,n,o,c,d,f,y)}emplace(n,o,c,d,f,y,v){const w=10*n,S=5*n;return this.int16[w+0]=o,this.int16[w+1]=c,this.int16[w+2]=d,this.float32[S+2]=f,this.float32[S+3]=y,this.float32[S+4]=v,n}}at.prototype.bytesPerElement=20,kt(at,"StructArrayLayout3i3f20");class Ot extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint32[1*n+0]=o,n}}Ot.prototype.bytesPerElement=4,kt(Ot,"StructArrayLayout1ul4");class Ht extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,c,d,f,y,v,w,S,k,M,P,B){const j=this.length;return this.resize(j+1),this.emplace(j,n,o,c,d,f,y,v,w,S,k,M,P,B)}emplace(n,o,c,d,f,y,v,w,S,k,M,P,B,j){const U=20*n,Q=10*n;return this.int16[U+0]=o,this.int16[U+1]=c,this.int16[U+2]=d,this.int16[U+3]=f,this.int16[U+4]=y,this.float32[Q+3]=v,this.float32[Q+4]=w,this.float32[Q+5]=S,this.float32[Q+6]=k,this.int16[U+14]=M,this.uint32[Q+8]=P,this.uint16[U+18]=B,this.uint16[U+19]=j,n}}Ht.prototype.bytesPerElement=40,kt(Ht,"StructArrayLayout5i4f1i1ul2ui40");class At extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,c,d,f,y,v){const w=this.length;return this.resize(w+1),this.emplace(w,n,o,c,d,f,y,v)}emplace(n,o,c,d,f,y,v,w){const S=8*n;return this.int16[S+0]=o,this.int16[S+1]=c,this.int16[S+2]=d,this.int16[S+4]=f,this.int16[S+5]=y,this.int16[S+6]=v,this.int16[S+7]=w,n}}At.prototype.bytesPerElement=16,kt(At,"StructArrayLayout3i2i2i16");class Ut extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,c,d,f){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,c,d,f)}emplace(n,o,c,d,f,y){const v=4*n,w=8*n;return this.float32[v+0]=o,this.float32[v+1]=c,this.float32[v+2]=d,this.int16[w+6]=f,this.int16[w+7]=y,n}}Ut.prototype.bytesPerElement=16,kt(Ut,"StructArrayLayout2f1f2i16");class dn extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,n,o,c,d)}emplace(n,o,c,d,f){const y=12*n,v=3*n;return this.uint8[y+0]=o,this.uint8[y+1]=c,this.float32[v+1]=d,this.float32[v+2]=f,n}}dn.prototype.bytesPerElement=12,kt(dn,"StructArrayLayout2ub2f12");class ln extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,c){const d=this.length;return this.resize(d+1),this.emplace(d,n,o,c)}emplace(n,o,c,d){const f=3*n;return this.float32[f+0]=o,this.float32[f+1]=c,this.float32[f+2]=d,n}}ln.prototype.bytesPerElement=12,kt(ln,"StructArrayLayout3f12");class Lt extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,c){const d=this.length;return this.resize(d+1),this.emplace(d,n,o,c)}emplace(n,o,c,d){const f=3*n;return this.uint16[f+0]=o,this.uint16[f+1]=c,this.uint16[f+2]=d,n}}Lt.prototype.bytesPerElement=6,kt(Lt,"StructArrayLayout3ui6");class Pn extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,o,c,d,f,y,v,w,S,k,M,P,B,j,U,Q,ae,ge,le,fe,be){const ve=this.length;return this.resize(ve+1),this.emplace(ve,n,o,c,d,f,y,v,w,S,k,M,P,B,j,U,Q,ae,ge,le,fe,be)}emplace(n,o,c,d,f,y,v,w,S,k,M,P,B,j,U,Q,ae,ge,le,fe,be,ve){const Ne=30*n,Be=15*n,He=60*n;return this.int16[Ne+0]=o,this.int16[Ne+1]=c,this.int16[Ne+2]=d,this.float32[Be+2]=f,this.float32[Be+3]=y,this.uint16[Ne+8]=v,this.uint16[Ne+9]=w,this.uint32[Be+5]=S,this.uint32[Be+6]=k,this.uint32[Be+7]=M,this.uint16[Ne+16]=P,this.uint16[Ne+17]=B,this.uint16[Ne+18]=j,this.float32[Be+10]=U,this.float32[Be+11]=Q,this.uint8[He+48]=ae,this.uint8[He+49]=ge,this.uint8[He+50]=le,this.uint32[Be+13]=fe,this.int16[Ne+28]=be,this.uint8[He+58]=ve,n}}Pn.prototype.bytesPerElement=60,kt(Pn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Bn extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,o,c,d,f,y,v,w,S,k,M,P,B,j,U,Q,ae,ge,le,fe,be,ve,Ne,Be,He,it,Ue,Ye,Je,tt){const dt=this.length;return this.resize(dt+1),this.emplace(dt,n,o,c,d,f,y,v,w,S,k,M,P,B,j,U,Q,ae,ge,le,fe,be,ve,Ne,Be,He,it,Ue,Ye,Je,tt)}emplace(n,o,c,d,f,y,v,w,S,k,M,P,B,j,U,Q,ae,ge,le,fe,be,ve,Ne,Be,He,it,Ue,Ye,Je,tt,dt){const We=38*n,xt=19*n;return this.int16[We+0]=o,this.int16[We+1]=c,this.int16[We+2]=d,this.float32[xt+2]=f,this.float32[xt+3]=y,this.int16[We+8]=v,this.int16[We+9]=w,this.int16[We+10]=S,this.int16[We+11]=k,this.int16[We+12]=M,this.int16[We+13]=P,this.uint16[We+14]=B,this.uint16[We+15]=j,this.uint16[We+16]=U,this.uint16[We+17]=Q,this.uint16[We+18]=ae,this.uint16[We+19]=ge,this.uint16[We+20]=le,this.uint16[We+21]=fe,this.uint16[We+22]=be,this.uint16[We+23]=ve,this.uint16[We+24]=Ne,this.uint16[We+25]=Be,this.uint16[We+26]=He,this.uint16[We+27]=it,this.uint16[We+28]=Ue,this.uint32[xt+15]=Ye,this.float32[xt+16]=Je,this.float32[xt+17]=tt,this.float32[xt+18]=dt,n}}Bn.prototype.bytesPerElement=76,kt(Bn,"StructArrayLayout3i2f6i15ui1ul3f76");class Fn extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.float32[1*n+0]=o,n}}Fn.prototype.bytesPerElement=4,kt(Fn,"StructArrayLayout1f4");class jn extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,c,d,f){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,c,d,f)}emplace(n,o,c,d,f,y){const v=5*n;return this.float32[v+0]=o,this.float32[v+1]=c,this.float32[v+2]=d,this.float32[v+3]=f,this.float32[v+4]=y,n}}jn.prototype.bytesPerElement=20,kt(jn,"StructArrayLayout5f20");class bi extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,n,o,c,d)}emplace(n,o,c,d,f){const y=6*n;return this.uint32[3*n+0]=o,this.uint16[y+2]=c,this.uint16[y+3]=d,this.uint16[y+4]=f,n}}bi.prototype.bytesPerElement=12,kt(bi,"StructArrayLayout1ul3ui12");class ri extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o){const c=this.length;return this.resize(c+1),this.emplace(c,n,o)}emplace(n,o,c){const d=2*n;return this.uint16[d+0]=o,this.uint16[d+1]=c,n}}ri.prototype.bytesPerElement=4,kt(ri,"StructArrayLayout2ui4");class po extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint16[1*n+0]=o,n}}po.prototype.bytesPerElement=2,kt(po,"StructArrayLayout1ui2");class Jo extends Pe{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o){const c=this.length;return this.resize(c+1),this.emplace(c,n,o)}emplace(n,o,c){const d=2*n;return this.float32[d+0]=o,this.float32[d+1]=c,n}}Jo.prototype.bytesPerElement=8,kt(Jo,"StructArrayLayout2f8");class or extends Ee{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}or.prototype.size=40;class Nn extends Ht{get(n){return new or(this,n)}}kt(Nn,"CollisionBoxArray");class Sn extends Ee{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}Sn.prototype.size=60;class Lr extends Pn{get(n){return new Sn(this,n)}}kt(Lr,"PlacedSymbolArray");class Mi extends Ee{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(n){this._structArray.uint32[this._pos4+15]=n}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Mi.prototype.size=76;class tr extends Bn{get(n){return new Mi(this,n)}}kt(tr,"SymbolInstanceArray");class Fi extends Fn{getoffsetX(n){return this.float32[1*n+0]}}kt(Fi,"GlyphOffsetArray");class sd extends rt{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}kt(sd,"SymbolLineVertexArray");class Pa extends Ee{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Pa.prototype.size=12;class jc extends bi{get(n){return new Pa(this,n)}}kt(jc,"FeatureIndexArray");class Ps extends ri{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}kt(Ps,"FillExtrusionCentroidArray");const ta=Me([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ra=Me([{name:"a_dash",components:4,type:"Uint16"}]);var ad={exports:{}},Nc={exports:{}};Nc.exports=function(i,n){var o,c,d,f,y,v,w,S;for(c=i.length-(o=3&i.length),d=n,y=3432918353,v=461845907,S=0;S<c;)w=255&i.charCodeAt(S)|(255&i.charCodeAt(++S))<<8|(255&i.charCodeAt(++S))<<16|(255&i.charCodeAt(++S))<<24,++S,d=27492+(65535&(f=5*(65535&(d=(d^=w=(65535&(w=(w=(65535&w)*y+(((w>>>16)*y&65535)<<16)&4294967295)<<15|w>>>17))*v+(((w>>>16)*v&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(w=0,o){case 3:w^=(255&i.charCodeAt(S+2))<<16;case 2:w^=(255&i.charCodeAt(S+1))<<8;case 1:d^=w=(65535&(w=(w=(65535&(w^=255&i.charCodeAt(S)))*y+(((w>>>16)*y&65535)<<16)&4294967295)<<15|w>>>17))*v+(((w>>>16)*v&65535)<<16)&4294967295}return d^=i.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0};var Bp=Nc.exports,iE={exports:{}};iE.exports=function(i,n){for(var o,c=i.length,d=n^c,f=0;c>=4;)o=1540483477*(65535&(o=255&i.charCodeAt(f)|(255&i.charCodeAt(++f))<<8|(255&i.charCodeAt(++f))<<16|(255&i.charCodeAt(++f))<<24))+((1540483477*(o>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),c-=4,++f;switch(c){case 3:d^=(255&i.charCodeAt(f+2))<<16;case 2:d^=(255&i.charCodeAt(f+1))<<8;case 1:d=1540483477*(65535&(d^=255&i.charCodeAt(f)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};var oE=Bp,JL=iE.exports;ad.exports=oE,ad.exports.murmur3=oE,ad.exports.murmur2=JL;var bv=V(ad.exports);class Wg{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,o,c,d){this.ids.push(sE(n)),this.positions.push(o,c,d)}getPositions(n){const o=sE(n);let c=0,d=this.ids.length-1;for(;c<d;){const y=c+d>>1;this.ids[y]>=o?d=y:c=y+1}const f=[];for(;this.ids[c]===o;)f.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return f}static serialize(n,o){const c=new Float64Array(n.ids),d=new Uint32Array(n.positions);return wv(c,d,0,c.length-1),o&&o.push(c.buffer,d.buffer),{ids:c,positions:d}}static deserialize(n){const o=new Wg;return o.ids=n.ids,o.positions=n.positions,o.indexed=!0,o}}function sE(i){const n=+i;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:bv(String(i))}function wv(i,n,o,c){for(;o<c;){const d=i[o+c>>1];let f=o-1,y=c+1;for(;;){do f++;while(i[f]<d);do y--;while(i[y]>d);if(f>=y)break;Gg(i,f,y),Gg(n,3*f,3*y),Gg(n,3*f+1,3*y+1),Gg(n,3*f+2,3*y+2)}y-o<c-y?(wv(i,n,o,y),o=y+1):(wv(i,n,y+1,c),c=y)}}function Gg(i,n,o){const c=i[n];i[n]=i[o],i[o]=c}kt(Wg,"FeaturePositionMap");class za{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,o),this.initialized=!0),!!this.location}}class qg extends za{constructor(n){super(n),this.current=0}set(n,o,c){this.fetchUniformLocation(n,o)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class aE extends za{constructor(n){super(n),this.current=[0,0,0,0]}set(n,o,c){this.fetchUniformLocation(n,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class lE extends za{constructor(n){super(n),this.current=Tr.transparent}set(n,o,c){this.fetchUniformLocation(n,o)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const QL=new Float32Array(16),eD=new Float32Array(9),tD=new Float32Array(4);function Sv(i){return[Se(255*i.r,255*i.g),Se(255*i.b,255*i.a)]}class Fp{constructor(n,o,c){this.value=n,this.uniformNames=o.map(d=>`u_${d}`),this.type=c}setUniform(n,o,c,d,f){o.set(n,f,d.constantOr(this.value))}getBinding(n,o){return this.type==="color"?new lE(n):new qg(n)}}class ld{constructor(n,o){this.uniformNames=o.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,o,c,d,f){const y=f==="u_pattern"||f==="u_dash"?this.pattern:f==="u_pixel_ratio"?this.pixelRatio:null;y&&o.set(n,f,y)}getBinding(n,o){return o==="u_pattern"||o==="u_dash"?new aE(n):new qg(n)}}class La{constructor(n,o,c,d){this.expression=n,this.type=c,this.maxValue=0,this.paintVertexAttributes=o.map(f=>({name:`a_${f}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(n,o,c,d,f,y){const v=this.paintVertexArray.length,w=this.expression.evaluate(new A(0),o,{},f,d,y);this.paintVertexArray.resize(n),this._setPaintValue(v,n,w)}updatePaintArray(n,o,c,d,f){const y=this.expression.evaluate({zoom:0},c,d,void 0,f);this._setPaintValue(n,o,y)}_setPaintValue(n,o,c){if(this.type==="color"){const d=Sv(c);for(let f=n;f<o;f++)this.paintVertexArray.emplace(f,d[0],d[1])}else{for(let d=n;d<o;d++)this.paintVertexArray.emplace(d,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Rs{constructor(n,o,c,d,f,y){this.expression=n,this.uniformNames=o.map(v=>`u_${v}_t`),this.type=c,this.useIntegerZoom=d,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=o.map(v=>({name:`a_${v}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(n,o,c,d,f,y){const v=this.expression.evaluate(new A(this.zoom),o,{},f,d,y),w=this.expression.evaluate(new A(this.zoom+1),o,{},f,d,y),S=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(S,n,v,w)}updatePaintArray(n,o,c,d,f){const y=this.expression.evaluate({zoom:this.zoom},c,d,void 0,f),v=this.expression.evaluate({zoom:this.zoom+1},c,d,void 0,f);this._setPaintValue(n,o,y,v)}_setPaintValue(n,o,c,d){if(this.type==="color"){const f=Sv(c),y=Sv(d);for(let v=n;v<o;v++)this.paintVertexArray.emplace(v,f[0],f[1],y[0],y[1])}else{for(let f=n;f<o;f++)this.paintVertexArray.emplace(f,c,d);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(d))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,o,c,d,f){const y=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,v=Re(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);o.set(n,f,v)}getBinding(n,o){return new qg(n)}}class wl{constructor(n,o,c,d,f){this.expression=n,this.layerId=f,this.paintVertexAttributes=(c==="array"?Ra:ta).members;for(let y=0;y<o.length;++y);this.paintVertexArray=new d}populatePaintArray(n,o,c){const d=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(d,n,o.patterns&&o.patterns[this.layerId],c)}updatePaintArray(n,o,c,d,f,y){this._setPaintValues(n,o,c.patterns&&c.patterns[this.layerId],y)}_setPaintValues(n,o,c,d){if(!d||!c)return;const f=d[c];if(!f)return;const{tl:y,br:v,pixelRatio:w}=f;for(let S=n;S<o;S++)this.paintVertexArray.emplace(S,y[0],y[1],v[0],v[1],w)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Sl{constructor(n,o,c=()=>!0){this.binders={},this._buffers=[];const d=[];for(const f in n.paint._values){if(!c(f))continue;const y=n.paint.get(f);if(!(y instanceof re&&fl(y.property.specification)))continue;const v=rD(f,n.type),w=y.value,S=y.property.specification.type,k=!!y.property.useIntegerZoom,M=f==="line-dasharray"||f.endsWith("pattern"),P=f==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant";if(w.kind!=="constant"||P)if(w.kind==="source"||P||M){const B=cE(f,S,"source");this.binders[f]=M?new wl(w,v,S,B,n.id):new La(w,v,S,B),d.push(`/a_${f}`)}else{const B=cE(f,S,"composite");this.binders[f]=new Rs(w,v,S,k,o,B),d.push(`/z_${f}`)}else this.binders[f]=M?new ld(w.value,v):new Fp(w.value,v,S),d.push(`/u_${f}`)}this.cacheKey=d.sort().join("")}getMaxValue(n){const o=this.binders[n];return o instanceof La||o instanceof Rs?o.maxValue:0}populatePaintArrays(n,o,c,d,f,y){for(const v in this.binders){const w=this.binders[v];(w instanceof La||w instanceof Rs||w instanceof wl)&&w.populatePaintArray(n,o,c,d,f,y)}}setConstantPatternPositions(n){for(const o in this.binders){const c=this.binders[o];c instanceof ld&&c.setConstantPatternPositions(n)}}updatePaintArrays(n,o,c,d,f,y){let v=!1;for(const w in n){const S=o.getPositions(w);for(const k of S){const M=c.feature(k.index);for(const P in this.binders){const B=this.binders[P];if((B instanceof La||B instanceof Rs||B instanceof wl)&&B.expression.isStateDependent===!0){const j=d.paint.get(P);B.expression=j.value,B.updatePaintArray(k.start,k.end,M,n[w],f,y),v=!0}}}}return v}defines(){const n=[];for(const o in this.binders){const c=this.binders[o];(c instanceof Fp||c instanceof ld)&&n.push(...c.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return n}getBinderAttributes(){const n=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof La||c instanceof Rs||c instanceof wl)for(let d=0;d<c.paintVertexAttributes.length;d++)n.push(c.paintVertexAttributes[d].name)}return n}getBinderUniforms(){const n=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof Fp||c instanceof ld||c instanceof Rs)for(const d of c.uniformNames)n.push(d)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const o=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof Fp||d instanceof ld||d instanceof Rs)for(const f of d.uniformNames)o.push({name:f,property:c,binding:d.getBinding(n,f)})}return o}setUniforms(n,o,c,d,f){for(const{name:y,property:v,binding:w}of c)this.binders[v].setUniform(n,w,f,d.get(v),y)}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const o=this.binders[n];(o instanceof La||o instanceof Rs||o instanceof wl)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(n){for(const o in this.binders){const c=this.binders[o];(c instanceof La||c instanceof Rs||c instanceof wl)&&c.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const o=this.binders[n];(o instanceof La||o instanceof Rs||o instanceof wl)&&o.destroy()}}}class $c{constructor(n,o,c=()=>!0){this.programConfigurations={};for(const d of n)this.programConfigurations[d.id]=new Sl(d,o,c);this.needsUpload=!1,this._featureMap=new Wg,this._bufferOffset=0}populatePaintArrays(n,o,c,d,f,y,v){for(const w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(n,o,d,f,y,v);o.id!==void 0&&this._featureMap.add(o.id,c,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,o,c,d,f){for(const y of c)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(n,this._featureMap,o,y,d,f)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const nD={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function rD(i,n){return nD[i]||[i.replace(`${n}-`,"").replace(/-/g,"_")]}const iD={"line-pattern":{source:Fe,composite:Fe},"fill-pattern":{source:Fe,composite:Fe},"fill-extrusion-pattern":{source:Fe,composite:Fe},"line-dasharray":{source:Ze,composite:Ze}},oD={color:{source:Jo,composite:nt},number:{source:Fn,composite:Jo}};function cE(i,n,o){const c=iD[i];return c&&c[o]||oD[n][o]}kt(Fp,"ConstantBinder"),kt(ld,"PatternConstantBinder"),kt(La,"SourceExpressionBinder"),kt(wl,"PatternCompositeBinder"),kt(Rs,"CompositeExpressionBinder"),kt(Sl,"ProgramConfiguration",{omit:["_buffers"]}),kt($c,"ProgramConfigurationSet");const uE="-transition";class zs extends fc{constructor(n,o){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&n.type!=="sky"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),o.layout&&(this._unevaluatedLayout=new ie(o.layout)),o.paint)){this._transitionablePaint=new N(o.paint);for(const c in n.paint)this.setPaintProperty(c,n.paint[c],{validate:!1});for(const c in n.layout)this.setLayoutProperty(c,n.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new se(o.paint)}}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,o,c={}){o!=null&&this._validate(gv,`layers.${this.id}.layout.${n}`,n,o,c)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,o):this.visibility=o)}getPaintProperty(n){return Mr(n,uE)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,o,c={}){if(o!=null&&this._validate(mv,`layers.${this.id}.paint.${n}`,n,o,c))return!1;if(Mr(n,uE))return this._transitionablePaint.setTransition(n.slice(0,-11),o||void 0),!1;{const d=this._transitionablePaint._values[n],f=d.value.isDataDriven(),y=d.value;this._transitionablePaint.setValue(n,o),this._handleSpecialPaintPropertyUpdate(n);const v=this._transitionablePaint._values[n].value,w=v.isDataDriven(),S=Mr(n,"pattern")||n==="line-dasharray";return w||f||S||this._handleOverridablePaintPropertyUpdate(n,y,v)}}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getProgramConfiguration(n){return null}_handleOverridablePaintPropertyUpdate(n,o,c){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,o)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),Dn(n,(o,c)=>!(o===void 0||c==="layout"&&!Object.keys(o).length||c==="paint"&&!Object.keys(o).length))}_validate(n,o,c,d,f={}){return(!f||f.validate!==!1)&&Ng(this,n.call(jg,{key:o,layerType:this.type,objectKey:c,value:d,styleSpec:qe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const o=this.paint.get(n);if(o instanceof re&&fl(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=nd(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const sD=Me([{name:"a_pos",components:2,type:"Int16"}],4),aD=Me([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Dr{constructor(n=[]){this.segments=n}prepareSegment(n,o,c,d){let f=this.segments[this.segments.length-1];return n>Dr.MAX_VERTEX_ARRAY_LENGTH&&Kt(`Max vertices per segment is ${Dr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!f||f.vertexLength+n>Dr.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==d)&&(f={vertexOffset:o.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},d!==void 0&&(f.sortKey=d),this.segments.push(f)),f}get(){return this.segments}destroy(){for(const n of this.segments)for(const o in n.vaos)n.vaos[o].destroy()}static simpleSegment(n,o,c,d){return new Dr([{vertexOffset:n,primitiveOffset:o,vertexLength:c,primitiveLength:d,vaos:{},sortKey:0}])}}Dr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,kt(Dr,"SegmentVector");var $t=8192;class El{constructor(n,o){n&&(o?this.setSouthWest(n).setNorthEast(o):n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1]))}setNorthEast(n){return this._ne=n instanceof $n?new $n(n.lng,n.lat):$n.convert(n),this}setSouthWest(n){return this._sw=n instanceof $n?new $n(n.lng,n.lat):$n.convert(n),this}extend(n){const o=this._sw,c=this._ne;let d,f;if(n instanceof $n)d=n,f=n;else{if(!(n instanceof El))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(El.convert(n)):this.extend($n.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend($n.convert(n)):this;if(d=n._sw,f=n._ne,!d||!f)return this}return o||c?(o.lng=Math.min(d.lng,o.lng),o.lat=Math.min(d.lat,o.lat),c.lng=Math.max(f.lng,c.lng),c.lat=Math.max(f.lat,c.lat)):(this._sw=new $n(d.lng,d.lat),this._ne=new $n(f.lng,f.lat)),this}getCenter(){return new $n((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new $n(this.getWest(),this.getNorth())}getSouthEast(){return new $n(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:o,lat:c}=$n.convert(n);let d=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&d}static convert(n){return!n||n instanceof El?n:new El(n)}}var Hg=1e-6,fo=typeof Float32Array<"u"?Float32Array:Array;function dE(){var i=new fo(9);return fo!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function hE(i,n,o){var c=n[0],d=n[1],f=n[2],y=n[3],v=n[4],w=n[5],S=n[6],k=n[7],M=n[8],P=o[0],B=o[1],j=o[2],U=o[3],Q=o[4],ae=o[5],ge=o[6],le=o[7],fe=o[8];return i[0]=P*c+B*y+j*S,i[1]=P*d+B*v+j*k,i[2]=P*f+B*w+j*M,i[3]=U*c+Q*y+ae*S,i[4]=U*d+Q*v+ae*k,i[5]=U*f+Q*w+ae*M,i[6]=ge*c+le*y+fe*S,i[7]=ge*d+le*v+fe*k,i[8]=ge*f+le*w+fe*M,i}function Ls(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Ev(i,n){var o=n[0],c=n[1],d=n[2],f=n[3],y=n[4],v=n[5],w=n[6],S=n[7],k=n[8],M=n[9],P=n[10],B=n[11],j=n[12],U=n[13],Q=n[14],ae=n[15],ge=o*v-c*y,le=o*w-d*y,fe=o*S-f*y,be=c*w-d*v,ve=c*S-f*v,Ne=d*S-f*w,Be=k*U-M*j,He=k*Q-P*j,it=k*ae-B*j,Ue=M*Q-P*U,Ye=M*ae-B*U,Je=P*ae-B*Q,tt=ge*Je-le*Ye+fe*Ue+be*it-ve*He+Ne*Be;return tt?(i[0]=(v*Je-w*Ye+S*Ue)*(tt=1/tt),i[1]=(d*Ye-c*Je-f*Ue)*tt,i[2]=(U*Ne-Q*ve+ae*be)*tt,i[3]=(P*ve-M*Ne-B*be)*tt,i[4]=(w*it-y*Je-S*He)*tt,i[5]=(o*Je-d*it+f*He)*tt,i[6]=(Q*fe-j*Ne-ae*le)*tt,i[7]=(k*Ne-P*fe+B*le)*tt,i[8]=(y*Ye-v*it+S*Be)*tt,i[9]=(c*it-o*Ye-f*Be)*tt,i[10]=(j*ve-U*fe+ae*ge)*tt,i[11]=(M*fe-k*ve-B*ge)*tt,i[12]=(v*He-y*Ue-w*Be)*tt,i[13]=(o*Ue-c*He+d*Be)*tt,i[14]=(U*le-j*be-Q*ge)*tt,i[15]=(k*be-M*le+P*ge)*tt,i):null}function Uc(i,n,o){var c=n[0],d=n[1],f=n[2],y=n[3],v=n[4],w=n[5],S=n[6],k=n[7],M=n[8],P=n[9],B=n[10],j=n[11],U=n[12],Q=n[13],ae=n[14],ge=n[15],le=o[0],fe=o[1],be=o[2],ve=o[3];return i[0]=le*c+fe*v+be*M+ve*U,i[1]=le*d+fe*w+be*P+ve*Q,i[2]=le*f+fe*S+be*B+ve*ae,i[3]=le*y+fe*k+be*j+ve*ge,i[4]=(le=o[4])*c+(fe=o[5])*v+(be=o[6])*M+(ve=o[7])*U,i[5]=le*d+fe*w+be*P+ve*Q,i[6]=le*f+fe*S+be*B+ve*ae,i[7]=le*y+fe*k+be*j+ve*ge,i[8]=(le=o[8])*c+(fe=o[9])*v+(be=o[10])*M+(ve=o[11])*U,i[9]=le*d+fe*w+be*P+ve*Q,i[10]=le*f+fe*S+be*B+ve*ae,i[11]=le*y+fe*k+be*j+ve*ge,i[12]=(le=o[12])*c+(fe=o[13])*v+(be=o[14])*M+(ve=o[15])*U,i[13]=le*d+fe*w+be*P+ve*Q,i[14]=le*f+fe*S+be*B+ve*ae,i[15]=le*y+fe*k+be*j+ve*ge,i}function jp(i,n,o){var c,d,f,y,v,w,S,k,M,P,B,j,U=o[0],Q=o[1],ae=o[2];return n===i?(i[12]=n[0]*U+n[4]*Q+n[8]*ae+n[12],i[13]=n[1]*U+n[5]*Q+n[9]*ae+n[13],i[14]=n[2]*U+n[6]*Q+n[10]*ae+n[14],i[15]=n[3]*U+n[7]*Q+n[11]*ae+n[15]):(d=n[1],f=n[2],y=n[3],v=n[4],w=n[5],S=n[6],k=n[7],M=n[8],P=n[9],B=n[10],j=n[11],i[0]=c=n[0],i[1]=d,i[2]=f,i[3]=y,i[4]=v,i[5]=w,i[6]=S,i[7]=k,i[8]=M,i[9]=P,i[10]=B,i[11]=j,i[12]=c*U+v*Q+M*ae+n[12],i[13]=d*U+w*Q+P*ae+n[13],i[14]=f*U+S*Q+B*ae+n[14],i[15]=y*U+k*Q+j*ae+n[15]),i}function Vc(i,n,o){var c=o[0],d=o[1],f=o[2];return i[0]=n[0]*c,i[1]=n[1]*c,i[2]=n[2]*c,i[3]=n[3]*c,i[4]=n[4]*d,i[5]=n[5]*d,i[6]=n[6]*d,i[7]=n[7]*d,i[8]=n[8]*f,i[9]=n[9]*f,i[10]=n[10]*f,i[11]=n[11]*f,i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i}function Tv(i,n,o){var c=Math.sin(o),d=Math.cos(o),f=n[4],y=n[5],v=n[6],w=n[7],S=n[8],k=n[9],M=n[10],P=n[11];return n!==i&&(i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[4]=f*d+S*c,i[5]=y*d+k*c,i[6]=v*d+M*c,i[7]=w*d+P*c,i[8]=S*d-f*c,i[9]=k*d-y*c,i[10]=M*d-v*c,i[11]=P*d-w*c,i}function Zg(i,n,o){var c=Math.sin(o),d=Math.cos(o),f=n[0],y=n[1],v=n[2],w=n[3],S=n[8],k=n[9],M=n[10],P=n[11];return n!==i&&(i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[0]=f*d-S*c,i[1]=y*d-k*c,i[2]=v*d-M*c,i[3]=w*d-P*c,i[8]=f*c+S*d,i[9]=y*c+k*d,i[10]=v*c+M*d,i[11]=w*c+P*d,i}function pE(i,n){return i[0]=n[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=n[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=n[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function fE(i,n,o){var c,d,f,y=o[0],v=o[1],w=o[2],S=Math.hypot(y,v,w);return S<Hg?null:(y*=S=1/S,v*=S,w*=S,c=Math.sin(n),d=Math.cos(n),i[0]=y*y*(f=1-d)+d,i[1]=v*y*f+w*c,i[2]=w*y*f-v*c,i[3]=0,i[4]=y*v*f-w*c,i[5]=v*v*f+d,i[6]=w*v*f+y*c,i[7]=0,i[8]=y*w*f+v*c,i[9]=v*w*f-y*c,i[10]=w*w*f+d,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}Math.hypot||(Math.hypot=function(){for(var i=0,n=arguments.length;n--;)i+=arguments[n]*arguments[n];return Math.sqrt(i)});var lD=Uc;function Cv(){var i=new fo(3);return fo!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function mE(i){var n=new fo(3);return n[0]=i[0],n[1]=i[1],n[2]=i[2],n}function Np(i){return Math.hypot(i[0],i[1],i[2])}function cd(i,n,o){var c=new fo(3);return c[0]=i,c[1]=n,c[2]=o,c}function Da(i,n,o){return i[0]=n[0]+o[0],i[1]=n[1]+o[1],i[2]=n[2]+o[2],i}function kv(i,n,o){return i[0]=n[0]-o[0],i[1]=n[1]-o[1],i[2]=n[2]-o[2],i}function gE(i,n,o){return i[0]=n[0]*o[0],i[1]=n[1]*o[1],i[2]=n[2]*o[2],i}function $p(i,n,o){return i[0]=Math.min(n[0],o[0]),i[1]=Math.min(n[1],o[1]),i[2]=Math.min(n[2],o[2]),i}function Up(i,n,o){return i[0]=Math.max(n[0],o[0]),i[1]=Math.max(n[1],o[1]),i[2]=Math.max(n[2],o[2]),i}function Ao(i,n,o){return i[0]=n[0]*o,i[1]=n[1]*o,i[2]=n[2]*o,i}function Vp(i,n,o,c){return i[0]=n[0]+o[0]*c,i[1]=n[1]+o[1]*c,i[2]=n[2]+o[2]*c,i}function ji(i,n){var o=n[0],c=n[1],d=n[2],f=o*o+c*c+d*d;return f>0&&(f=1/Math.sqrt(f)),i[0]=n[0]*f,i[1]=n[1]*f,i[2]=n[2]*f,i}function Qo(i,n){return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]}function Iv(i,n,o){var c=n[0],d=n[1],f=n[2],y=o[0],v=o[1],w=o[2];return i[0]=d*w-f*v,i[1]=f*y-c*w,i[2]=c*v-d*y,i}function Cr(i,n,o){var c=n[0],d=n[1],f=n[2],y=o[3]*c+o[7]*d+o[11]*f+o[15];return i[0]=(o[0]*c+o[4]*d+o[8]*f+o[12])/(y=y||1),i[1]=(o[1]*c+o[5]*d+o[9]*f+o[13])/y,i[2]=(o[2]*c+o[6]*d+o[10]*f+o[14])/y,i}function yE(i,n,o){var c=o[0],d=o[1],f=o[2],y=n[0],v=n[1],w=n[2],S=d*w-f*v,k=f*y-c*w,M=c*v-d*y,P=d*M-f*k,B=f*S-c*M,j=c*k-d*S,U=2*o[3];return k*=U,M*=U,B*=2,j*=2,i[0]=y+(S*=U)+(P*=2),i[1]=v+k+B,i[2]=w+M+j,i}var Wp,Ds=kv,cD=gE,uD=Np;function _E(i,n,o){return i[0]=n[0]*o,i[1]=n[1]*o,i[2]=n[2]*o,i[3]=n[3]*o,i}function xE(i,n){var o=n[0],c=n[1],d=n[2],f=n[3],y=o*o+c*c+d*d+f*f;return y>0&&(y=1/Math.sqrt(y)),i[0]=o*y,i[1]=c*y,i[2]=d*y,i[3]=f*y,i}function Wc(i,n,o){var c=n[0],d=n[1],f=n[2],y=n[3];return i[0]=o[0]*c+o[4]*d+o[8]*f+o[12]*y,i[1]=o[1]*c+o[5]*d+o[9]*f+o[13]*y,i[2]=o[2]*c+o[6]*d+o[10]*f+o[14]*y,i[3]=o[3]*c+o[7]*d+o[11]*f+o[15]*y,i}function vE(){var i=new fo(4);return fo!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function bE(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function wE(i,n,o){o*=.5;var c=n[0],d=n[1],f=n[2],y=n[3],v=Math.sin(o),w=Math.cos(o);return i[0]=c*w+y*v,i[1]=d*w+f*v,i[2]=f*w-d*v,i[3]=y*w-c*v,i}function SE(i,n,o){o*=.5;var c=n[0],d=n[1],f=n[2],y=n[3],v=Math.sin(o),w=Math.cos(o);return i[0]=c*w-f*v,i[1]=d*w+y*v,i[2]=f*w+c*v,i[3]=y*w-d*v,i}Cv(),Wp=new fo(4),fo!=Float32Array&&(Wp[0]=0,Wp[1]=0,Wp[2]=0,Wp[3]=0);var dD=xE;Cv(),cd(1,0,0),cd(0,1,0),vE(),vE(),dE();const hD=Me([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:EE}=hD,TE=Me([{name:"a_pos_3",components:3,type:"Int16"}]);var Gp=Me([{name:"a_pos",type:"Int16",components:2}]);class Av{constructor(n,o){this.pos=n,this.dir=o}intersectsPlane(n,o,c){const d=Qo(o,this.dir);if(Math.abs(d)<1e-6)return!1;const f=((n[0]-this.pos[0])*o[0]+(n[1]-this.pos[1])*o[1]+(n[2]-this.pos[2])*o[2])/d;return c[0]=this.pos[0]+this.dir[0]*f,c[1]=this.pos[1]+this.dir[1]*f,c[2]=this.pos[2]+this.dir[2]*f,!0}closestPointOnSphere(n,o,c){if(function(B,j){var U=B[0],Q=B[1],ae=B[2],ge=j[0],le=j[1],fe=j[2];return Math.abs(U-ge)<=Hg*Math.max(1,Math.abs(U),Math.abs(ge))&&Math.abs(Q-le)<=Hg*Math.max(1,Math.abs(Q),Math.abs(le))&&Math.abs(ae-fe)<=Hg*Math.max(1,Math.abs(ae),Math.abs(fe))}(this.pos,n)||o===0)return c[0]=c[1]=c[2]=0,!1;const[d,f,y]=this.dir,v=this.pos[0]-n[0],w=this.pos[1]-n[1],S=this.pos[2]-n[2],k=d*d+f*f+y*y,M=2*(v*d+w*f+S*y),P=M*M-4*k*(v*v+w*w+S*S-o*o);if(P<0){const B=Math.max(-M/2,0),j=v+d*B,U=w+f*B,Q=S+y*B,ae=Math.hypot(j,U,Q);return c[0]=j*o/ae,c[1]=U*o/ae,c[2]=Q*o/ae,!1}{const B=(-M-Math.sqrt(P))/(2*k);if(B<0){const j=Math.hypot(v,w,S);return c[0]=v*o/j,c[1]=w*o/j,c[2]=S*o/j,!1}return c[0]=v+d*B,c[1]=w+f*B,c[2]=S+y*B,!0}}}class Mv{constructor(n,o,c,d,f){this.TL=n,this.TR=o,this.BR=c,this.BL=d,this.horizon=f}static fromInvProjectionMatrix(n,o,c){const d=[-1,1,1],f=[1,1,1],y=[1,-1,1],v=[-1,-1,1],w=Cr(d,d,n),S=Cr(f,f,n),k=Cr(y,y,n),M=Cr(v,v,n);return new Mv(w,S,k,M,o/c)}}class Pv{constructor(n,o){this.points=n,this.planes=o}static fromInvProjectionMatrix(n,o,c,d){const f=Math.pow(2,c),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(w=>{const S=Wc([],w,n),k=1/S[3]/o*f;return function(M,P,B){return M[0]=P[0]*B[0],M[1]=P[1]*B[1],M[2]=P[2]*B[2],M[3]=P[3]*B[3],M}(S,S,[k,k,d?1/S[3]:k,k])}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(w=>{const S=ji([],Iv([],Ds([],y[w[0]],y[w[1]]),Ds([],y[w[2]],y[w[1]]))),k=-Qo(S,y[w[1]]);return S.concat(k)});return new Pv(y,v)}}class Ni{static fromPoints(n){const o=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const d of n)$p(o,o,d),Up(c,c,d);return new Ni(o,c)}static applyTransform(n,o){const c=n.getCorners();for(let d=0;d<c.length;++d)Cr(c[d],c[d],o);return Ni.fromPoints(c)}constructor(n,o){this.min=n,this.max=o,this.center=Ao([],Da([],this.min,this.max),.5)}quadrant(n){const o=[n%2==0,n<2],c=mE(this.min),d=mE(this.max);for(let f=0;f<o.length;f++)c[f]=o[f]?this.min[f]:this.center[f],d[f]=o[f]?this.center[f]:this.max[f];return d[2]=this.max[2],new Ni(c,d)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,o=this.max;return[[n[0],n[1],n[2]],[o[0],n[1],n[2]],[o[0],o[1],n[2]],[n[0],o[1],n[2]],[n[0],n[1],o[2]],[o[0],n[1],o[2]],[o[0],o[1],o[2]],[n[0],o[1],o[2]]]}intersects(n){const o=this.getCorners();let c=!0;for(let d=0;d<n.planes.length;d++){const f=n.planes[d];let y=0;for(let v=0;v<o.length;v++)y+=Qo(f,o[v])+f[3]>=0;if(y===0)return 0;y!==o.length&&(c=!1)}if(c)return 2;for(let d=0;d<3;d++){let f=Number.MAX_VALUE,y=-Number.MAX_VALUE;for(let v=0;v<n.points.length;v++){const w=n.points[v][d]-this.min[d];f=Math.min(f,w),y=Math.max(y,w)}if(y<0||f>this.max[d]-this.min[d])return 0}return 1}}const Rv=5,CE=6,na=$t/Math.PI/2,pD=16383,Gc=64,qp=[Gc,32,16],es=-na,ts=na,fD=[new Ni([es,es,es],[ts,ts,ts]),new Ni([es,es,es],[0,0,ts]),new Ni([0,es,es],[ts,0,ts]),new Ni([es,0,es],[0,ts,ts]),new Ni([0,0,es],[ts,ts,ts])];function Xg(i){return i*na/Xp}function kE(i,n,o,c=!0){const d=Ao([],i._camera.position,i.worldSize),f=[n,o,1,1];Wc(f,f,i.pixelMatrixInverse),_E(f,f,1/f[3]);const y=ji([],Ds([],f,d)),v=i.globeMatrix,w=[v[12],v[13],v[14]],S=Ds([],w,d),k=Np(S),M=ji([],S),P=i.worldSize/(2*Math.PI),B=Qo(M,y),j=Math.asin(P/k);if(j<Math.acos(B)){if(!c)return null;const it=[],Ue=[];Ao(it,y,k/B),ji(Ue,Ds(Ue,it,S)),ji(y,Da(y,S,Ao(y,Ue,Math.tan(j)*k)))}const U=[];new Av(d,y).closestPointOnSphere(w,P,U);const Q=ji([],gr(v,0)),ae=ji([],gr(v,1)),ge=ji([],gr(v,2)),le=Qo(Q,U),fe=Qo(ae,U),be=Qo(ge,U),ve=et(Math.asin(-fe/P));let Ne=et(Math.atan2(le,be));Ne=i.center.lng+function(it,Ue){const Ye=(Ue-it+180)%360-180;return Ye<-180?Ye+360:Ye}(i.center.lng,Ne);const Be=ia(Ne),He=Re(oa(ve),0,1);return new pd(Be,He)}class mD{constructor(n,o,c){this.a=Ds([],n,c),this.b=Ds([],o,c),this.center=c;const d=ji([],this.a),f=ji([],this.b);this.angle=Math.acos(Qo(d,f))}}function zv(i,n){if(i.angle===0)return null;let o;return o=i.a[n]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[n]/i.a[n]/Math.sin(i.angle)-1/Math.tan(i.angle)),o<0||o>1?null:function(c,d,f,y){const v=Math.sin(f);return c*(Math.sin((1-y)*f)/v)+d*(Math.sin(y*f)/v)}(i.a[n],i.b[n],i.angle,Re(o,0,1))+i.center[n]}function ra(i){if(i.z<=1)return fD[i.z+2*i.y+i.x];const n=Lv(Kg(i));return Ni.fromPoints(n)}function qc(i,n,o){return Ao(i,i,1-o),Vp(i,i,n,o)}function IE(i,n){const o=hd(n.zoom);if(o===0)return ra(i);const c=Kg(i),d=Lv(c),f=ia(c.getWest())*n.worldSize,y=ia(c.getEast())*n.worldSize,v=oa(c.getNorth())*n.worldSize,w=oa(c.getSouth())*n.worldSize,S=[f,v,0],k=[y,v,0],M=[f,w,0],P=[y,w,0],B=Ev([],n.globeMatrix);return Cr(S,S,B),Cr(k,k,B),Cr(M,M,B),Cr(P,P,B),d[0]=qc(d[0],M,o),d[1]=qc(d[1],P,o),d[2]=qc(d[2],k,o),d[3]=qc(d[3],S,o),Ni.fromPoints(d)}function AE(i,n,o){for(const c of i)Cr(c,c,n),Ao(c,c,o)}function gD(i,n,o){const c=n/i.worldSize,d=i.globeMatrix;if(o.z<=1){const Be=ra(o).getCorners();return AE(Be,d,c),Ni.fromPoints(Be)}const f=Kg(o),y=Lv(f);AE(y,d,c);const v=Number.MAX_VALUE,w=[-v,-v,-v],S=[v,v,v];if(f.contains(i.center)){for(const it of y)$p(S,S,it),Up(w,w,it);w[2]=0;const Be=i.point,He=[Be.x*c,Be.y*c,0];return $p(S,S,He),Up(w,w,He),new Ni(S,w)}const k=[d[12]*c,d[13]*c,d[14]*c],M=f.getCenter(),P=Re(i.center.lat,-Si,Si),B=Re(M.lat,-Si,Si),j=ia(i.center.lng),U=oa(P);let Q=j-ia(M.lng);const ae=U-oa(B);Q>.5?Q-=1:Q<-.5&&(Q+=1);let ge=0;Math.abs(Q)>Math.abs(ae)?ge=Q>=0?1:3:(ge=ae>=0?0:2,Vp(k,k,[d[4]*c,d[5]*c,d[6]*c],-Math.sin(Ge(ae>=0?f.getSouth():f.getNorth()))*na));const le=y[ge],fe=y[(ge+1)%4],be=new mD(le,fe,k),ve=[zv(be,0)||le[0],zv(be,1)||le[1],zv(be,2)||le[2]],Ne=hd(i.zoom);if(Ne>0){const Be=function({x:it,y:Ue,z:Ye},Je,tt,dt,We){const xt=1/(1<<Ye);let Mt=it*xt,vt=Mt+xt,Yt=Ue*xt,ht=Yt+xt,Ft=0;const Jt=(Mt+vt)/2-dt;return Jt>.5?Ft=-1:Jt<-.5&&(Ft=1),Mt=((Mt+Ft)*Je-(dt*=Je))*tt+dt,vt=((vt+Ft)*Je-dt)*tt+dt,Yt=(Yt*Je-(We*=Je))*tt+We,ht=(ht*Je-We)*tt+We,[[Mt,ht,0],[vt,ht,0],[vt,Yt,0],[Mt,Yt,0]]}(o,n,i._pixelsPerMercatorPixel,j,U);for(let it=0;it<y.length;it++)qc(y[it],Be[it],Ne);const He=Da([],Be[ge],Be[(ge+1)%4]);Ao(He,He,.5),qc(ve,He,Ne)}for(const Be of y)$p(S,S,Be),Up(w,w,Be);return S[2]=Math.min(le[2],fe[2]),$p(S,S,ve),Up(w,w,ve),new Ni(S,w)}function Kg({x:i,y:n,z:o}){const c=1/(1<<o),d=new $n(Mo(i*c),wi((n+1)*c)),f=new $n(Mo((i+1)*c),wi(n*c));return new El(d,f)}function Lv(i){const n=Ge(i.getNorth()),o=Ge(i.getSouth()),c=Math.cos(n),d=Math.cos(o),f=Math.sin(n),y=Math.sin(o),v=i.getWest(),w=i.getEast();return[ud(d,y,v),ud(d,y,w),ud(c,f,w),ud(c,f,v)]}function ud(i,n,o,c=na){return o=Ge(o),[i*Math.sin(o)*c,-n*c,i*Math.cos(o)*c]}function dd(i,n,o){return ud(Math.cos(Ge(i)),Math.sin(Ge(i)),n,o)}function Hp(i,n,o,c){const d=1<<o.z,f=(i/$t+o.x)/d;return dd(wi((n/$t+o.y)/d),Mo(f),c)}function Yg({min:i,max:n}){return pD/Math.max(n[0]-i[0],n[1]-i[1],n[2]-i[2])}const ME=new Float64Array(16);function Zp(i){const n=Yg(i),o=pE(ME,[n,n,n]);return jp(o,o,((c=[])[0]=-(d=i.min)[0],c[1]=-d[1],c[2]=-d[2],c));var c,d}function Dv(i){const n=(c=i.min,(o=ME)[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=c[0],o[13]=c[1],o[14]=c[2],o[15]=1,o);var o,c;const d=1/Yg(i);return Vc(n,n,[d,d,d])}function PE(i,n,o,c,d){const f=function(w){const S=$t/(2*Math.PI);return w/(2*Math.PI)/S}(o),y=[i,n,-o/(2*Math.PI)],v=Ls(new Float64Array(16));return jp(v,v,y),Vc(v,v,[f,f,f]),Tv(v,v,Ge(-d)),Zg(v,v,Ge(-c)),v}function hd(i){return ct(Rv,CE,i)}function RE(i,n){const o=dd(n.lat,n.lng),c=function(j){const U=dd(j._center.lat,j._center.lng);let Q=Iv([],cd(0,1,0),U);const ae=fE([],-j.angle,U);Q=Cr(Q,Q,ae),fE(ae,-j._pitch,Q);const ge=ji([],U);return Ao(ge,ge,Xg(j.cameraToCenterDistance/j.pixelsPerMeter)),Cr(ge,ge,ae),Da([],U,ge)}(i);return y=(d=kv([],c,o))[0],v=d[1],w=d[2],S=(f=o)[0],k=f[1],M=f[2],B=(P=Math.sqrt(y*y+v*v+w*w)*Math.sqrt(S*S+k*k+M*M))&&Qo(d,f)/P,Math.acos(Math.min(Math.max(B,-1),1));var d,f,y,v,w,S,k,M,P,B}function Ov(i,n){return RE(i,n)>Math.PI/2*1.01}const zE=Ge(85),yD=Math.cos(zE),_D=Math.sin(zE),Xp=63710088e-1,LE=2*Math.PI*Xp;class Tl{constructor(n,o){if(isNaN(n)||isNaN(o))throw new Error(`Invalid LngLat object: (${n}, ${o})`);if(this.lng=+n,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Tl(Ie(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const o=Math.PI/180,c=this.lat*o,d=n.lat*o,f=Math.sin(c)*Math.sin(d)+Math.cos(c)*Math.cos(d)*Math.cos((n.lng-this.lng)*o);return Xp*Math.acos(Math.min(f,1))}toBounds(n=0){const o=360*n/40075017,c=o/Math.cos(Math.PI/180*this.lat);return new El(new Tl(this.lng-c,this.lat-o),new Tl(this.lng+c,this.lat+o))}toEcef(n){const o=Xg(n);return dd(this.lat,this.lng,na+o)}static convert(n){if(n instanceof Tl)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Tl(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Tl(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var $n=Tl;function Bv(i){return LE*Math.cos(i*Math.PI/180)}function ia(i){return(180+i)/360}function oa(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Os(i,n){return i/Bv(n)}function Mo(i){return 360*i-180}function wi(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function DE(i,n){return i*Bv(wi(n))}const Si=85.051129;function OE(i){return 1/Math.cos(i*Math.PI/180)}class pd{constructor(n,o,c=0){this.x=+n,this.y=+o,this.z=+c}static fromLngLat(n,o=0){const c=$n.convert(n);return new pd(ia(c.lng),oa(c.lat),Os(o,c.lat))}toLngLat(){return new $n(Mo(this.x),wi(this.y))}toAltitude(){return DE(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/LE*OE(wi(this.y))}}function Fv(i,n,o,c,d,f,y,v,w){const S=(n+c)/2,k=(o+d)/2,M=new ye(S,k);v(M),function(P,B,j,U,Q,ae){const ge=j-Q,le=U-ae;return Math.abs((U-B)*ge-(j-P)*le)/Math.hypot(ge,le)}(M.x,M.y,f.x,f.y,y.x,y.y)>=w?(Fv(i,n,o,S,k,f,M,v,w),Fv(i,S,k,c,d,M,y,v,w)):i.push(y)}function BE(i,n,o){let c=i[0],d=c.x,f=c.y;n(c);const y=[c];for(let v=1;v<i.length;v++){const w=i[v],{x:S,y:k}=w;n(w),Fv(y,d,f,S,k,c,w,n,o),d=S,f=k,c=w}return y}function jv(i,n,o,c){if(c(n,o)){const d=n.add(o)._mult(.5);jv(i,n,d,c),jv(i,d,o,c)}else i.push(o)}function xD(i,n){let o=i[0];const c=[o];for(let d=1;d<i.length;d++){const f=i[d];jv(c,o,f,n),o=f}return c}const Nv=Math.pow(2,14)-1,FE=-Nv-1;function vD(i,n){const o=Math.round(i.x*n),c=Math.round(i.y*n);return i.x=Re(o,FE,Nv),i.y=Re(c,FE,Nv),(o<i.x||o>i.x+1||c<i.y||c>i.y+1)&&Kt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function Oa(i,n,o){const c=i.loadGeometry(),d=i.extent,f=$t/d;if(n&&o&&o.projection.isReprojectedInTileSpace){const y=1<<n.z,{scale:v,x:w,y:S,projection:k}=o,M=P=>{const B=Mo((n.x+P.x/d)/y),j=wi((n.y+P.y/d)/y),U=k.project(B,j);P.x=(U.x*v-w)*d,P.y=(U.y*v-S)*d};for(let P=0;P<c.length;P++)if(i.type!==1)c[P]=BE(c[P],M,1);else{const B=[];for(const j of c[P])j.x<0||j.x>=d||j.y<0||j.y>=d||(M(j),B.push(j));c[P]=B}}for(const y of c)for(const v of y)vD(v,f);return c}function Hc(i,n){return{type:i.type,id:i.id,properties:i.properties,geometry:n?Oa(i):[]}}function Jg(i,n,o,c,d){i.emplaceBack(2*n+(c+1)/2,2*o+(d+1)/2)}function Qg(i,n,o){i.emplaceBack(n.x,n.y,n.z,o[0]*16384,o[1]*16384,o[2]*16384)}class $v{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new rt,this.indexArray=new Lt,this.segments=new Dr,this.programConfigurations=new $c(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,c,d){const f=this.layers[0],y=[];let v=null;f.type==="circle"&&(v=f.layout.get("circle-sort-key"));for(const{feature:S,id:k,index:M,sourceLayerIndex:P}of n){const B=this.layers[0]._featureFilter.needGeometry,j=Hc(S,B);if(!this.layers[0]._featureFilter.filter(new A(this.zoom),j,c))continue;const U=v?v.evaluate(j,{},c):void 0,Q={id:k,properties:S.properties,type:S.type,sourceLayerIndex:P,index:M,geometry:B?j.geometry:Oa(S,c,d),patterns:{},sortKey:U};y.push(Q)}v&&y.sort((S,k)=>S.sortKey-k.sortKey);let w=null;d.projection.name==="globe"&&(this.globeExtVertexArray=new ot,w=d.projection);for(const S of y){const{geometry:k,index:M,sourceLayerIndex:P}=S,B=n[M].feature;this.addFeature(S,k,M,o.availableImages,c,w),o.featureIndex.insert(B,k,M,P,this.index)}}update(n,o,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,c,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,sD.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,aD.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,o,c,d,f,y){for(const v of o)for(const w of v){const S=w.x,k=w.y;if(S<0||S>=$t||k<0||k>=$t)continue;if(y){const B=y.projectTilePoint(S,k,f),j=y.upVector(f,S,k),U=this.globeExtVertexArray;Qg(U,B,j),Qg(U,B,j),Qg(U,B,j),Qg(U,B,j)}const M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),P=M.vertexLength;Jg(this.layoutVertexArray,S,k,-1,-1),Jg(this.layoutVertexArray,S,k,1,-1),Jg(this.layoutVertexArray,S,k,1,1),Jg(this.layoutVertexArray,S,k,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+2,P+3),M.vertexLength+=4,M.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,{},d,f)}}function jE(i,n){for(let o=0;o<i.length;o++)if(Zc(n,i[o]))return!0;for(let o=0;o<n.length;o++)if(Zc(i,n[o]))return!0;return!!Uv(i,n)}function bD(i,n,o){return!!Zc(i,n)||!!Vv(n,i,o)}function NE(i,n){if(i.length===1)return UE(n,i[0]);for(let o=0;o<n.length;o++){const c=n[o];for(let d=0;d<c.length;d++)if(Zc(i,c[d]))return!0}for(let o=0;o<i.length;o++)if(UE(n,i[o]))return!0;for(let o=0;o<n.length;o++)if(Uv(i,n[o]))return!0;return!1}function wD(i,n,o){if(i.length>1){if(Uv(i,n))return!0;for(let c=0;c<n.length;c++)if(Vv(n[c],i,o))return!0}for(let c=0;c<i.length;c++)if(Vv(i[c],n,o))return!0;return!1}function Uv(i,n){if(i.length===0||n.length===0)return!1;for(let o=0;o<i.length-1;o++){const c=i[o],d=i[o+1];for(let f=0;f<n.length-1;f++)if(SD(c,d,n[f],n[f+1]))return!0}return!1}function SD(i,n,o,c){return Pr(i,o,c)!==Pr(n,o,c)&&Pr(i,n,o)!==Pr(i,n,c)}function Vv(i,n,o){const c=o*o;if(n.length===1)return i.distSqr(n[0])<c;for(let d=1;d<n.length;d++)if($E(i,n[d-1],n[d])<c)return!0;return!1}function $E(i,n,o){const c=n.distSqr(o);if(c===0)return i.distSqr(n);const d=((i.x-n.x)*(o.x-n.x)+(i.y-n.y)*(o.y-n.y))/c;return i.distSqr(d<0?n:d>1?o:o.sub(n)._mult(d)._add(n))}function UE(i,n){let o,c,d,f=!1;for(let y=0;y<i.length;y++){o=i[y];for(let v=0,w=o.length-1;v<o.length;w=v++)c=o[v],d=o[w],c.y>n.y!=d.y>n.y&&n.x<(d.x-c.x)*(n.y-c.y)/(d.y-c.y)+c.x&&(f=!f)}return f}function Zc(i,n){let o=!1;for(let c=0,d=i.length-1;c<i.length;d=c++){const f=i[c],y=i[d];f.y>n.y!=y.y>n.y&&n.x<(y.x-f.x)*(n.y-f.y)/(y.y-f.y)+f.x&&(o=!o)}return o}function VE(i,n,o,c,d){for(const y of i)if(n<=y.x&&o<=y.y&&c>=y.x&&d>=y.y)return!0;const f=[new ye(n,o),new ye(n,d),new ye(c,d),new ye(c,o)];if(i.length>2){for(const y of f)if(Zc(i,y))return!0}for(let y=0;y<i.length-1;y++)if(ED(i[y],i[y+1],f))return!0;return!1}function ED(i,n,o){const c=o[0],d=o[2];if(i.x<c.x&&n.x<c.x||i.x>d.x&&n.x>d.x||i.y<c.y&&n.y<c.y||i.y>d.y&&n.y>d.y)return!1;const f=Pr(i,n,o[0]);return f!==Pr(i,n,o[1])||f!==Pr(i,n,o[2])||f!==Pr(i,n,o[3])}function fd(i,n,o){const c=n.paint.get(i).value;return c.kind==="constant"?c.value:o.programConfigurations.get(n.id).getMaxValue(i)}function ey(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function WE(i,n,o,c,d){if(!n[0]&&!n[1])return i;const f=ye.convert(n)._mult(d);o==="viewport"&&f._rotate(-c);const y=[];for(let v=0;v<i.length;v++)y.push(i[v].sub(f));return y}function GE(i,n,o,c){const d=ye.convert(i)._mult(c);return n==="viewport"&&d._rotate(-o),d}kt($v,"CircleBucket",{omit:["layers"]});const TD=new de({"circle-sort-key":new ee(qe.layout_circle["circle-sort-key"])});var CD={paint:new de({"circle-radius":new ee(qe.paint_circle["circle-radius"]),"circle-color":new ee(qe.paint_circle["circle-color"]),"circle-blur":new ee(qe.paint_circle["circle-blur"]),"circle-opacity":new ee(qe.paint_circle["circle-opacity"]),"circle-translate":new $(qe.paint_circle["circle-translate"]),"circle-translate-anchor":new $(qe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new $(qe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new $(qe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ee(qe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ee(qe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ee(qe.paint_circle["circle-stroke-opacity"])}),layout:TD};function qE(i,n,o,c,d,f,y,v,w){if(f&&i.queryGeometry.isAboveHorizon)return!1;f&&(w*=i.pixelToTileUnitsFactor);const S=i.tileID.canonical,k=o.projection.upVectorScale(S,o.center.lat,o.worldSize).metersToTile;for(const M of n)for(const P of M){const B=P.add(v),j=d&&o.elevation?o.elevation.exaggeration()*d.getElevationAt(B.x,B.y,!0):0,U=o.projection.projectTilePoint(B.x,B.y,S);if(j>0){const le=o.projection.upVector(S,B.x,B.y);U.x+=le[0]*k*j,U.y+=le[1]*k*j,U.z+=le[2]*k*j}const Q=f?B:kD(U.x,U.y,U.z,c),ae=f?i.tilespaceRays.map(le=>AD(le,j)):i.queryGeometry.screenGeometry,ge=Wc([],[U.x,U.y,U.z,1],c);if(!y&&f?w*=ge[3]/o.cameraToCenterDistance:y&&!f&&(w*=o.cameraToCenterDistance/ge[3]),f){const le=wi((P.y/$t+S.y)/(1<<S.z));w/=o.projection.pixelsPerMeter(le,1)/Os(1,le)}if(bD(ae,Q,w))return!0}return!1}function kD(i,n,o,c){const d=Wc([],[i,n,o,1],c);return new ye(d[0]/d[3],d[1]/d[3])}const HE=cd(0,0,0),ID=cd(0,0,1);function AD(i,n){const o=Cv();return HE[2]=n,i.intersectsPlane(HE,ID,o),new ye(o[0],o[1])}class ZE extends $v{}function XE(i,{width:n,height:o},c,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==n*o*c)throw new RangeError("mismatched image size")}else d=new Uint8Array(n*o*c);return i.width=n,i.height=o,i.data=d,i}function KE(i,n,o){const{width:c,height:d}=n;c===i.width&&d===i.height||(Wv(i,n,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,c),height:Math.min(i.height,d)},o),i.width=c,i.height=d,i.data=n.data)}function Wv(i,n,o,c,d,f){if(d.width===0||d.height===0)return n;if(d.width>i.width||d.height>i.height||o.x>i.width-d.width||o.y>i.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>n.width||d.height>n.height||c.x>n.width-d.width||c.y>n.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const y=i.data,v=n.data;for(let w=0;w<d.height;w++){const S=((o.y+w)*i.width+o.x)*f,k=((c.y+w)*n.width+c.x)*f;for(let M=0;M<d.width*f;M++)v[k+M]=y[S+M]}return n}kt(ZE,"HeatmapBucket",{omit:["layers"]});class Ba{constructor(n,o){XE(this,n,1,o)}resize(n){KE(this,new Ba(n),1)}clone(){return new Ba({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,c,d,f){Wv(n,o,c,d,f,1)}}class mo{constructor(n,o){XE(this,n,4,o)}resize(n){KE(this,new mo(n),4)}replace(n,o){o?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new mo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,c,d,f){Wv(n,o,c,d,f,4)}}kt(Ba,"AlphaImage"),kt(mo,"RGBAImage");var MD={paint:new de({"heatmap-radius":new ee(qe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ee(qe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new $(qe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ue(qe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new $(qe.paint_heatmap["heatmap-opacity"])})};function Gv(i){const n={},o=i.resolution||256,c=i.clips?i.clips.length:1,d=i.image||new mo({width:o,height:c}),f=(y,v,w)=>{n[i.evaluationKey]=w;const S=i.expression.evaluate(n);d.data[y+v+0]=Math.floor(255*S.r/S.a),d.data[y+v+1]=Math.floor(255*S.g/S.a),d.data[y+v+2]=Math.floor(255*S.b/S.a),d.data[y+v+3]=Math.floor(255*S.a)};if(i.clips)for(let y=0,v=0;y<c;++y,v+=4*o)for(let w=0,S=0;w<o;w++,S+=4){const k=w/(o-1),{start:M,end:P}=i.clips[y];f(v,S,M*(1-k)+P*k)}else for(let y=0,v=0;y<o;y++,v+=4)f(0,v,y/(o-1));return d}var PD={paint:new de({"hillshade-illumination-direction":new $(qe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new $(qe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new $(qe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new $(qe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new $(qe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new $(qe.paint_hillshade["hillshade-accent-color"])})};const RD=Me([{name:"a_pos",components:2,type:"Int16"}],4),{members:zD}=RD;var qv={exports:{}};function ty(i,n,o){o=o||2;var c,d,f,y,v,w,S,k=n&&n.length,M=k?n[0]*o:i.length,P=YE(i,0,M,o,!0),B=[];if(!P||P.next===P.prev)return B;if(k&&(P=function(U,Q,ae,ge){var le,fe,be,ve=[];for(le=0,fe=Q.length;le<fe;le++)(be=YE(U,Q[le]*ge,le<fe-1?Q[le+1]*ge:U.length,ge,!1))===be.next&&(be.steiner=!0),ve.push($D(be));for(ve.sort(FD),le=0;le<ve.length;le++)ae=jD(ve[le],ae);return ae}(i,n,P,o)),i.length>80*o){c=f=i[0],d=y=i[1];for(var j=o;j<M;j+=o)(v=i[j])<c&&(c=v),(w=i[j+1])<d&&(d=w),v>f&&(f=v),w>y&&(y=w);S=(S=Math.max(f-c,y-d))!==0?32767/S:0}return Kp(P,B,o,c,d,S,0),B}function YE(i,n,o,c,d){var f,y;if(d===Xv(i,n,o,c)>0)for(f=n;f<o;f+=c)y=eT(f,i[f],i[f+1],y);else for(f=o-c;f>=n;f-=c)y=eT(f,i[f],i[f+1],y);return y&&ny(y,y.next)&&(Jp(y),y=y.next),y}function Xc(i,n){if(!i)return i;n||(n=i);var o,c=i;do if(o=!1,c.steiner||!ny(c,c.next)&&Or(c.prev,c,c.next)!==0)c=c.next;else{if(Jp(c),(c=n=c.prev)===c.next)break;o=!0}while(o||c!==n);return n}function Kp(i,n,o,c,d,f,y){if(i){!y&&f&&function(k,M,P,B){var j=k;do j.z===0&&(j.z=Hv(j.x,j.y,M,P,B)),j.prevZ=j.prev,j.nextZ=j.next,j=j.next;while(j!==k);j.prevZ.nextZ=null,j.prevZ=null,function(U){var Q,ae,ge,le,fe,be,ve,Ne,Be=1;do{for(ae=U,U=null,fe=null,be=0;ae;){for(be++,ge=ae,ve=0,Q=0;Q<Be&&(ve++,ge=ge.nextZ);Q++);for(Ne=Be;ve>0||Ne>0&&ge;)ve!==0&&(Ne===0||!ge||ae.z<=ge.z)?(le=ae,ae=ae.nextZ,ve--):(le=ge,ge=ge.nextZ,Ne--),fe?fe.nextZ=le:U=le,le.prevZ=fe,fe=le;ae=ge}fe.nextZ=null,Be*=2}while(be>1)}(j)}(i,c,d,f);for(var v,w,S=i;i.prev!==i.next;)if(v=i.prev,w=i.next,f?DD(i,c,d,f):LD(i))n.push(v.i/o|0),n.push(i.i/o|0),n.push(w.i/o|0),Jp(i),i=w.next,S=w.next;else if((i=w)===S){y?y===1?Kp(i=OD(Xc(i),n,o),n,o,c,d,f,2):y===2&&BD(i,n,o,c,d,f):Kp(Xc(i),n,o,c,d,f,1);break}}}function LD(i){var n=i.prev,o=i,c=i.next;if(Or(n,o,c)>=0)return!1;for(var d=n.x,f=o.x,y=c.x,v=n.y,w=o.y,S=c.y,k=d<f?d<y?d:y:f<y?f:y,M=v<w?v<S?v:S:w<S?w:S,P=d>f?d>y?d:y:f>y?f:y,B=v>w?v>S?v:S:w>S?w:S,j=c.next;j!==n;){if(j.x>=k&&j.x<=P&&j.y>=M&&j.y<=B&&md(d,v,f,w,y,S,j.x,j.y)&&Or(j.prev,j,j.next)>=0)return!1;j=j.next}return!0}function DD(i,n,o,c){var d=i.prev,f=i,y=i.next;if(Or(d,f,y)>=0)return!1;for(var v=d.x,w=f.x,S=y.x,k=d.y,M=f.y,P=y.y,B=v<w?v<S?v:S:w<S?w:S,j=k<M?k<P?k:P:M<P?M:P,U=v>w?v>S?v:S:w>S?w:S,Q=k>M?k>P?k:P:M>P?M:P,ae=Hv(B,j,n,o,c),ge=Hv(U,Q,n,o,c),le=i.prevZ,fe=i.nextZ;le&&le.z>=ae&&fe&&fe.z<=ge;){if(le.x>=B&&le.x<=U&&le.y>=j&&le.y<=Q&&le!==d&&le!==y&&md(v,k,w,M,S,P,le.x,le.y)&&Or(le.prev,le,le.next)>=0||(le=le.prevZ,fe.x>=B&&fe.x<=U&&fe.y>=j&&fe.y<=Q&&fe!==d&&fe!==y&&md(v,k,w,M,S,P,fe.x,fe.y)&&Or(fe.prev,fe,fe.next)>=0))return!1;fe=fe.nextZ}for(;le&&le.z>=ae;){if(le.x>=B&&le.x<=U&&le.y>=j&&le.y<=Q&&le!==d&&le!==y&&md(v,k,w,M,S,P,le.x,le.y)&&Or(le.prev,le,le.next)>=0)return!1;le=le.prevZ}for(;fe&&fe.z<=ge;){if(fe.x>=B&&fe.x<=U&&fe.y>=j&&fe.y<=Q&&fe!==d&&fe!==y&&md(v,k,w,M,S,P,fe.x,fe.y)&&Or(fe.prev,fe,fe.next)>=0)return!1;fe=fe.nextZ}return!0}function OD(i,n,o){var c=i;do{var d=c.prev,f=c.next.next;!ny(d,f)&&JE(d,c,c.next,f)&&Yp(d,f)&&Yp(f,d)&&(n.push(d.i/o|0),n.push(c.i/o|0),n.push(f.i/o|0),Jp(c),Jp(c.next),c=i=f),c=c.next}while(c!==i);return Xc(c)}function BD(i,n,o,c,d,f){var y=i;do{for(var v=y.next.next;v!==y.prev;){if(y.i!==v.i&&UD(y,v)){var w=QE(y,v);return y=Xc(y,y.next),w=Xc(w,w.next),Kp(y,n,o,c,d,f,0),void Kp(w,n,o,c,d,f,0)}v=v.next}y=y.next}while(y!==i)}function FD(i,n){return i.x-n.x}function jD(i,n){var o=function(d,f){var y,v=f,w=d.x,S=d.y,k=-1/0;do{if(S<=v.y&&S>=v.next.y&&v.next.y!==v.y){var M=v.x+(S-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(M<=w&&M>k&&(k=M,y=v.x<v.next.x?v:v.next,M===w))return y}v=v.next}while(v!==f);if(!y)return null;var P,B=y,j=y.x,U=y.y,Q=1/0;v=y;do w>=v.x&&v.x>=j&&w!==v.x&&md(S<U?w:k,S,j,U,S<U?k:w,S,v.x,v.y)&&(P=Math.abs(S-v.y)/(w-v.x),Yp(v,d)&&(P<Q||P===Q&&(v.x>y.x||v.x===y.x&&ND(y,v)))&&(y=v,Q=P)),v=v.next;while(v!==B);return y}(i,n);if(!o)return n;var c=QE(o,i);return Xc(c,c.next),Xc(o,o.next)}function ND(i,n){return Or(i.prev,i,n.prev)<0&&Or(n.next,i,i.next)<0}function Hv(i,n,o,c,d){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-o)*d|0)|i<<8))|i<<4))|i<<2))|i<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-c)*d|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function $D(i){var n=i,o=i;do(n.x<o.x||n.x===o.x&&n.y<o.y)&&(o=n),n=n.next;while(n!==i);return o}function md(i,n,o,c,d,f,y,v){return(d-y)*(n-v)>=(i-y)*(f-v)&&(i-y)*(c-v)>=(o-y)*(n-v)&&(o-y)*(f-v)>=(d-y)*(c-v)}function UD(i,n){return i.next.i!==n.i&&i.prev.i!==n.i&&!function(o,c){var d=o;do{if(d.i!==o.i&&d.next.i!==o.i&&d.i!==c.i&&d.next.i!==c.i&&JE(d,d.next,o,c))return!0;d=d.next}while(d!==o);return!1}(i,n)&&(Yp(i,n)&&Yp(n,i)&&function(o,c){var d=o,f=!1,y=(o.x+c.x)/2,v=(o.y+c.y)/2;do d.y>v!=d.next.y>v&&d.next.y!==d.y&&y<(d.next.x-d.x)*(v-d.y)/(d.next.y-d.y)+d.x&&(f=!f),d=d.next;while(d!==o);return f}(i,n)&&(Or(i.prev,i,n.prev)||Or(i,n.prev,n))||ny(i,n)&&Or(i.prev,i,i.next)>0&&Or(n.prev,n,n.next)>0)}function Or(i,n,o){return(n.y-i.y)*(o.x-n.x)-(n.x-i.x)*(o.y-n.y)}function ny(i,n){return i.x===n.x&&i.y===n.y}function JE(i,n,o,c){var d=iy(Or(i,n,o)),f=iy(Or(i,n,c)),y=iy(Or(o,c,i)),v=iy(Or(o,c,n));return d!==f&&y!==v||!(d!==0||!ry(i,o,n))||!(f!==0||!ry(i,c,n))||!(y!==0||!ry(o,i,c))||!(v!==0||!ry(o,n,c))}function ry(i,n,o){return n.x<=Math.max(i.x,o.x)&&n.x>=Math.min(i.x,o.x)&&n.y<=Math.max(i.y,o.y)&&n.y>=Math.min(i.y,o.y)}function iy(i){return i>0?1:i<0?-1:0}function Yp(i,n){return Or(i.prev,i,i.next)<0?Or(i,n,i.next)>=0&&Or(i,i.prev,n)>=0:Or(i,n,i.prev)<0||Or(i,i.next,n)<0}function QE(i,n){var o=new Zv(i.i,i.x,i.y),c=new Zv(n.i,n.x,n.y),d=i.next,f=n.prev;return i.next=n,n.prev=i,o.next=d,d.prev=o,c.next=o,o.prev=c,f.next=c,c.prev=f,c}function eT(i,n,o,c){var d=new Zv(i,n,o);return c?(d.next=c.next,d.prev=c,c.next.prev=d,c.next=d):(d.prev=d,d.next=d),d}function Jp(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Zv(i,n,o){this.i=i,this.x=n,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Xv(i,n,o,c){for(var d=0,f=n,y=o-c;f<o;f+=c)d+=(i[y]-i[f])*(i[f+1]+i[y+1]),y=f;return d}qv.exports=ty,qv.exports.default=ty,ty.deviation=function(i,n,o,c){var d=n&&n.length,f=Math.abs(Xv(i,0,d?n[0]*o:i.length,o));if(d)for(var y=0,v=n.length;y<v;y++)f-=Math.abs(Xv(i,n[y]*o,y<v-1?n[y+1]*o:i.length,o));var w=0;for(y=0;y<c.length;y+=3){var S=c[y]*o,k=c[y+1]*o,M=c[y+2]*o;w+=Math.abs((i[S]-i[M])*(i[k+1]-i[S+1])-(i[S]-i[k])*(i[M+1]-i[S+1]))}return f===0&&w===0?0:Math.abs((w-f)/f)},ty.flatten=function(i){for(var n=i[0][0].length,o={vertices:[],holes:[],dimensions:n},c=0,d=0;d<i.length;d++){for(var f=0;f<i[d].length;f++)for(var y=0;y<n;y++)o.vertices.push(i[d][f][y]);d>0&&o.holes.push(c+=i[d-1].length)}return o};var Kv=V(qv.exports);function VD(i,n,o,c,d){tT(i,n,o||0,c||i.length-1,d||WD)}function tT(i,n,o,c,d){for(;c>o;){if(c-o>600){var f=c-o+1,y=n-o+1,v=Math.log(f),w=.5*Math.exp(2*v/3),S=.5*Math.sqrt(v*w*(f-w)/f)*(y-f/2<0?-1:1);tT(i,n,Math.max(o,Math.floor(n-y*w/f+S)),Math.min(c,Math.floor(n+(f-y)*w/f+S)),d)}var k=i[n],M=o,P=c;for(Qp(i,o,n),d(i[c],k)>0&&Qp(i,o,c);M<P;){for(Qp(i,M,P),M++,P--;d(i[M],k)<0;)M++;for(;d(i[P],k)>0;)P--}d(i[o],k)===0?Qp(i,o,P):Qp(i,++P,c),P<=n&&(o=P+1),n<=P&&(c=P-1)}}function Qp(i,n,o){var c=i[n];i[n]=i[o],i[o]=c}function WD(i,n){return i<n?-1:i>n?1:0}function Yv(i,n){const o=i.length;if(o<=1)return[i];const c=[];let d,f;for(let y=0;y<o;y++){const v=di(i[y]);v!==0&&(i[y].area=Math.abs(v),f===void 0&&(f=v<0),f===v<0?(d&&c.push(d),d=[i[y]]):d.push(i[y]))}if(d&&c.push(d),n>1)for(let y=0;y<c.length;y++)c[y].length<=n||(VD(c[y],n,1,c[y].length-1,GD),c[y]=c[y].slice(0,n));return c}function GD(i,n){return n.area-i.area}function Jv(i,n,o){const c=o.patternDependencies;let d=!1;for(const f of n){const y=f.paint.get(`${i}-pattern`);y.isConstant()||(d=!0);const v=y.constantOr(null);v&&(d=!0,c[v]=!0)}return d}function Qv(i,n,o,c,d){const f=d.patternDependencies;for(const y of n){const v=y.paint.get(`${i}-pattern`).value;if(v.kind!=="constant"){let w=v.evaluate({zoom:c},o,{},d.availableImages);w=w&&w.name?w.name:w,f[w]=!0,o.patterns[y.id]=w}}return o}class oy{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new rt,this.indexArray=new Lt,this.indexArray2=new ri,this.programConfigurations=new $c(n.layers,n.zoom),this.segments=new Dr,this.segments2=new Dr,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=n.projection}populate(n,o,c,d){this.hasPattern=Jv("fill",this.layers,o);const f=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:v,id:w,index:S,sourceLayerIndex:k}of n){const M=this.layers[0]._featureFilter.needGeometry,P=Hc(v,M);if(!this.layers[0]._featureFilter.filter(new A(this.zoom),P,c))continue;const B=f?f.evaluate(P,{},c,o.availableImages):void 0,j={id:w,properties:v.properties,type:v.type,sourceLayerIndex:k,index:S,geometry:M?P.geometry:Oa(v,c,d),patterns:{},sortKey:B};y.push(j)}f&&y.sort((v,w)=>v.sortKey-w.sortKey);for(const v of y){const{geometry:w,index:S,sourceLayerIndex:k}=v;if(this.hasPattern){const M=Qv("fill",this.layers,v,this.zoom,o);this.patternFeatures.push(M)}else this.addFeature(v,w,S,c,{},o.availableImages);o.featureIndex.insert(n[S].feature,w,S,k,this.index)}}update(n,o,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,c,d)}addFeatures(n,o,c,d,f){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,o,c,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,zD),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,o,c,d,f,y=[]){for(const v of Yv(o,500)){let w=0;for(const j of v)w+=j.length;const S=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),k=S.vertexLength,M=[],P=[];for(const j of v){if(j.length===0)continue;j!==v[0]&&P.push(M.length/2);const U=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),Q=U.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack(Q+j.length-1,Q),M.push(j[0].x),M.push(j[0].y);for(let ae=1;ae<j.length;ae++)this.layoutVertexArray.emplaceBack(j[ae].x,j[ae].y),this.indexArray2.emplaceBack(Q+ae-1,Q+ae),M.push(j[ae].x),M.push(j[ae].y);U.vertexLength+=j.length,U.primitiveLength+=j.length}const B=Kv(M,P);for(let j=0;j<B.length;j+=3)this.indexArray.emplaceBack(k+B[j],k+B[j+1],k+B[j+2]);S.vertexLength+=w,S.primitiveLength+=B.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,f,y,d)}}kt(oy,"FillBucket",{omit:["layers","patternFeatures"]});const qD=new de({"fill-sort-key":new ee(qe.layout_fill["fill-sort-key"])});var HD={paint:new de({"fill-antialias":new $(qe.paint_fill["fill-antialias"]),"fill-opacity":new ee(qe.paint_fill["fill-opacity"]),"fill-color":new ee(qe.paint_fill["fill-color"]),"fill-outline-color":new ee(qe.paint_fill["fill-outline-color"]),"fill-translate":new $(qe.paint_fill["fill-translate"]),"fill-translate-anchor":new $(qe.paint_fill["fill-translate-anchor"]),"fill-pattern":new ee(qe.paint_fill["fill-pattern"])}),layout:qD};const ZD=Me([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),XD=Me([{name:"a_centroid_pos",components:2,type:"Uint16"}]),KD=Me([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:YD}=ZD;var sy={},JD=xe,nT=gd;function gd(i,n,o,c,d){this.properties={},this.extent=o,this.type=0,this._pbf=i,this._geometry=-1,this._keys=c,this._values=d,i.readFields(QD,this,n)}function QD(i,n,o){i==1?n.id=o.readVarint():i==2?function(c,d){for(var f=c.readVarint()+c.pos;c.pos<f;){var y=d._keys[c.readVarint()],v=d._values[c.readVarint()];d.properties[y]=v}}(o,n):i==3?n.type=o.readVarint():i==4&&(n._geometry=o.pos)}function e3(i){for(var n,o,c=0,d=0,f=i.length,y=f-1;d<f;y=d++)c+=((o=i[y]).x-(n=i[d]).x)*(n.y+o.y);return c}gd.types=["Unknown","Point","LineString","Polygon"],gd.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var n,o=i.readVarint()+i.pos,c=1,d=0,f=0,y=0,v=[];i.pos<o;){if(d<=0){var w=i.readVarint();c=7&w,d=w>>3}if(d--,c===1||c===2)f+=i.readSVarint(),y+=i.readSVarint(),c===1&&(n&&v.push(n),n=[]),n.push(new JD(f,y));else{if(c!==7)throw new Error("unknown command "+c);n&&n.push(n[0].clone())}}return n&&v.push(n),v},gd.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var n=i.readVarint()+i.pos,o=1,c=0,d=0,f=0,y=1/0,v=-1/0,w=1/0,S=-1/0;i.pos<n;){if(c<=0){var k=i.readVarint();o=7&k,c=k>>3}if(c--,o===1||o===2)(d+=i.readSVarint())<y&&(y=d),d>v&&(v=d),(f+=i.readSVarint())<w&&(w=f),f>S&&(S=f);else if(o!==7)throw new Error("unknown command "+o)}return[y,w,v,S]},gd.prototype.toGeoJSON=function(i,n,o){var c,d,f=this.extent*Math.pow(2,o),y=this.extent*i,v=this.extent*n,w=this.loadGeometry(),S=gd.types[this.type];function k(B){for(var j=0;j<B.length;j++){var U=B[j];B[j]=[360*(U.x+y)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(U.y+v)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(c=0;c<w.length;c++)M[c]=w[c][0];k(w=M);break;case 2:for(c=0;c<w.length;c++)k(w[c]);break;case 3:for(w=function(B){var j=B.length;if(j<=1)return[B];for(var U,Q,ae=[],ge=0;ge<j;ge++){var le=e3(B[ge]);le!==0&&(Q===void 0&&(Q=le<0),Q===le<0?(U&&ae.push(U),U=[B[ge]]):U.push(B[ge]))}return U&&ae.push(U),ae}(w),c=0;c<w.length;c++)for(d=0;d<w[c].length;d++)k(w[c][d])}w.length===1?w=w[0]:S="Multi"+S;var P={type:"Feature",geometry:{type:S,coordinates:w},properties:this.properties};return"id"in this&&(P.id=this.id),P};var t3=nT,rT=iT;function iT(i,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(n3,this,n),this.length=this._features.length}function n3(i,n,o){i===15?n.version=o.readVarint():i===1?n.name=o.readString():i===5?n.extent=o.readVarint():i===2?n._features.push(o.pos):i===3?n._keys.push(o.readString()):i===4&&n._values.push(function(c){for(var d=null,f=c.readVarint()+c.pos;c.pos<f;){var y=c.readVarint()>>3;d=y===1?c.readString():y===2?c.readFloat():y===3?c.readDouble():y===4?c.readVarint64():y===5?c.readVarint():y===6?c.readSVarint():y===7?c.readBoolean():null}return d}(o))}iT.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var n=this._pbf.readVarint()+this._pbf.pos;return new t3(this._pbf,n,this.extent,this._keys,this._values)};var r3=rT;function i3(i,n,o){if(i===3){var c=new r3(o,o.readVarint()+o.pos);c.length&&(n[c.name]=c)}}var e1=sy.VectorTile=function(i,n){this.layers=i.readFields(i3,{},n)},ay=sy.VectorTileFeature=nT;function ly(i,n,o,c){const d=[],f=c===0?(y,v,w,S,k,M)=>{y.push(new ye(M,w+(M-v)/(S-v)*(k-w)))}:(y,v,w,S,k,M)=>{y.push(new ye(v+(M-w)/(k-w)*(S-v),M))};for(const y of i){const v=[];for(const w of y){if(w.length<=2)continue;const S=[];for(let P=0;P<w.length-1;P++){const B=w[P].x,j=w[P].y,U=w[P+1].x,Q=w[P+1].y,ae=c===0?B:j,ge=c===0?U:Q;ae<n?ge>n&&f(S,B,j,U,Q,n):ae>o?ge<o&&f(S,B,j,U,Q,o):S.push(w[P]),ge<n&&ae>=n&&f(S,B,j,U,Q,n),ge>o&&ae<=o&&f(S,B,j,U,Q,o)}let k=w[w.length-1];const M=c===0?k.x:k.y;M>=n&&M<=o&&S.push(k),S.length&&(k=S[S.length-1],S[0].x===k.x&&S[0].y===k.y||S.push(S[0]),v.push(S))}v.length&&d.push(v)}return d}sy.VectorTileLayer=rT;const o3=ay.types,s3=Math.pow(2,13);function ef(i,n,o,c,d,f,y,v){i.emplaceBack((n<<1)+y,(o<<1)+f,(Math.floor(c*s3)<<1)+d,Math.round(v))}function tf(i,n,o){i.emplaceBack(n.x,n.y,n.z,o[0]*16384,o[1]*16384,o[2]*16384)}class oT{constructor(){this.acc=new ye(0,0),this.polyCount=[]}startRing(n){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new ye(n.x,n.y),this.max=new ye(n.x,n.y))}append(n,o){this.currentPolyCount.edges++,this.acc._add(n);const c=this.min,d=this.max;n.x<c.x?c.x=n.x:n.x>d.x&&(d.x=n.x),n.y<c.y?c.y=n.y:n.y>d.y&&(d.y=n.y),((n.x===0||n.x===$t)&&n.x===o.x)!=((n.y===0||n.y===$t)&&n.y===o.y)&&this.processBorderOverlap(n,o),o.x<0!=n.x<0&&this.addBorderIntersection(0,gn(o.y,n.y,(0-o.x)/(n.x-o.x))),o.x>$t!=n.x>$t&&this.addBorderIntersection(1,gn(o.y,n.y,($t-o.x)/(n.x-o.x))),o.y<0!=n.y<0&&this.addBorderIntersection(2,gn(o.x,n.x,(0-o.y)/(n.y-o.y))),o.y>$t!=n.y>$t&&this.addBorderIntersection(3,gn(o.x,n.x,($t-o.y)/(n.y-o.y)))}addBorderIntersection(n,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[n];o<c[0]&&(c[0]=o),o>c[1]&&(c[1]=o)}processBorderOverlap(n,o){if(n.x===o.x){if(n.y===o.y)return;const c=n.x===0?0:1;this.addBorderIntersection(c,o.y),this.addBorderIntersection(c,n.y)}else{const c=n.y===0?2:3;this.addBorderIntersection(c,o.x),this.addBorderIntersection(c,n.x)}}centroid(){const n=this.polyCount.reduce((o,c)=>o+c.edges,0);return n!==0?this.acc.div(n)._round():new ye(0,0)}span(){return new ye(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((n,o)=>n+ +(o[0]!==Number.MAX_VALUE),0)}}class nf{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.layoutVertexArray=new Ke,this.centroidVertexArray=new Ps,this.indexArray=new Lt,this.programConfigurations=new $c(n.layers,n.zoom),this.segments=new Dr,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.enableTerrain=n.enableTerrain}populate(n,o,c,d){this.features=[],this.hasPattern=Jv("fill-extrusion",this.layers,o),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(f){const y=Math.exp(Math.PI*(1-f.y/(1<<f.z)*2));return 80150034*y/(y*y+1)/$t/(1<<f.z)}(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:f,id:y,index:v,sourceLayerIndex:w}of n){const S=this.layers[0]._featureFilter.needGeometry,k=Hc(f,S);if(!this.layers[0]._featureFilter.filter(new A(this.zoom),k,c))continue;const M={id:y,sourceLayerIndex:w,index:v,geometry:S?k.geometry:Oa(f,c,d),properties:f.properties,type:f.type,patterns:{}},P=this.layoutVertexArray.length;this.hasPattern?this.features.push(Qv("fill-extrusion",this.layers,M,this.zoom,o)):this.addFeature(M,M.geometry,v,c,{},o.availableImages,d),o.featureIndex.insert(f,M.geometry,v,w,this.index,P)}this.sortBorders()}addFeatures(n,o,c,d,f){for(const y of this.features){const{geometry:v}=y;this.addFeature(y,v,y.index,o,c,d,f)}this.sortBorders()}update(n,o,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,c,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,YD),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,KD.members,!0))),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,XD.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,o,c,d,f,y,v){const w=[new ye(0,0),new ye($t,$t)],S=v.projection,k=S.name==="globe",M=this.enableTerrain&&!k?new oT:null,P=o3[n.type]==="Polygon";k&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new ot);const B=Yv(o,500);for(let ae=B.length-1;ae>=0;ae--){const ge=B[ae];(ge.length===0||(j=ge[0]).every(le=>le.x<=0)||j.every(le=>le.x>=$t)||j.every(le=>le.y<=0)||j.every(le=>le.y>=$t))&&B.splice(ae,1)}var j;let U;if(k)U=hT(B,w,d);else{U=[];for(const ae of B)U.push({polygon:ae,bounds:w})}const Q=P?this.edgeRadius:0;for(const{polygon:ae,bounds:ge}of U){let le=0,fe=0;for(const ve of ae)P&&!ve[0].equals(ve[ve.length-1])&&ve.push(ve[0]),fe+=P?ve.length-1:ve.length;const be=this.segments.prepareSegment((P?5:4)*fe,this.layoutVertexArray,this.indexArray);if(P){const ve=[],Ne=[];le=be.vertexLength;for(const He of ae){let it,Ue;He.length&&He!==ae[0]&&Ne.push(ve.length/2),it=He[1].sub(He[0])._perp()._unit();for(let Ye=1;Ye<He.length;Ye++){const Je=He[Ye],tt=He[Ye===He.length-1?1:Ye+1];let{x:dt,y:We}=Je;if(Q){Ue=tt.sub(Je)._perp()._unit();const xt=it.add(Ue)._unit(),Mt=Q*Math.min(4,1/(it.x*xt.x+it.y*xt.y));dt+=Mt*xt.x,We+=Mt*xt.y,it=Ue}ef(this.layoutVertexArray,dt,We,0,0,1,1,0),be.vertexLength++,ve.push(Je.x,Je.y),k&&tf(this.layoutVertexExtArray,S.projectTilePoint(dt,We,d),S.upVector(d,dt,We))}}const Be=Kv(ve,Ne);for(let He=0;He<Be.length;He+=3)this.indexArray.emplaceBack(le+Be[He],le+Be[He+2],le+Be[He+1]),be.primitiveLength++}for(const ve of ae){M&&ve.length&&M.startRing(ve[0]);let Ne,Be,He,it=ve.length>4&&cT(ve[ve.length-2],ve[0],ve[1]),Ue=Q?a3(ve[ve.length-2],ve[0],ve[1],Q):0;Be=ve[1].sub(ve[0])._perp()._unit();let Ye=!0;for(let Je=1,tt=0;Je<ve.length;Je++){let dt=ve[Je-1],We=ve[Je];const xt=ve[Je===ve.length-1?1:Je+1];if(M&&P&&M.currentPolyCount.top++,lT(We,dt,ge)){Q&&(Be=xt.sub(We)._perp()._unit(),Ye=!Ye);continue}M&&M.append(We,dt);const Mt=We.sub(dt)._perp(),vt=Mt.x/(Math.abs(Mt.x)+Math.abs(Mt.y)),Yt=Mt.y>0?1:0,ht=dt.dist(We);if(tt+ht>32768&&(tt=0),Q){He=xt.sub(We)._perp()._unit();let Qt=aT(dt,We,xt,sT(Be,He),Q);isNaN(Qt)&&(Qt=0);const Vt=We.sub(dt)._unit();dt=dt.add(Vt.mult(Ue))._round(),We=We.add(Vt.mult(-Qt))._round(),Ue=Qt,Be=He}const Ft=be.vertexLength,Jt=ve.length>4&&cT(dt,We,xt);let vn=uT(tt,it,Ye);if(ef(this.layoutVertexArray,dt.x,dt.y,vt,Yt,0,0,vn),ef(this.layoutVertexArray,dt.x,dt.y,vt,Yt,0,1,vn),tt+=ht,vn=uT(tt,Jt,!Ye),it=Jt,ef(this.layoutVertexArray,We.x,We.y,vt,Yt,0,0,vn),ef(this.layoutVertexArray,We.x,We.y,vt,Yt,0,1,vn),be.vertexLength+=4,this.indexArray.emplaceBack(Ft+0,Ft+1,Ft+2),this.indexArray.emplaceBack(Ft+1,Ft+3,Ft+2),be.primitiveLength+=2,Q){const Qt=le+(Je===1?ve.length-2:Je-2),Vt=Je===1?le:Qt+1;if(this.indexArray.emplaceBack(Ft+1,Qt,Ft+3),this.indexArray.emplaceBack(Qt,Vt,Ft+3),be.primitiveLength+=2,Ne===void 0&&(Ne=Ft),!lT(xt,ve[Je],ge)){const Qn=Je===ve.length-1?Ne:be.vertexLength;this.indexArray.emplaceBack(Ft+2,Ft+3,Qn),this.indexArray.emplaceBack(Ft+3,Qn+1,Qn),this.indexArray.emplaceBack(Ft+3,Vt,Qn+1),be.primitiveLength+=3}Ye=!Ye}if(k){const Qt=this.layoutVertexExtArray,Vt=S.projectTilePoint(dt.x,dt.y,d),Qn=S.projectTilePoint(We.x,We.y,d),rn=S.upVector(d,dt.x,dt.y),on=S.upVector(d,We.x,We.y);tf(Qt,Vt,rn),tf(Qt,Vt,rn),tf(Qt,Qn,on),tf(Qt,Qn,on)}}P&&(le+=ve.length-1)}}if(M&&M.polyCount.length>0){if(M.borders){M.vertexArrayOffset=this.centroidVertexArray.length;const ae=M.borders,ge=this.featuresOnBorder.push(M)-1;for(let le=0;le<4;le++)ae[le][0]!==Number.MAX_VALUE&&this.borders[le].push(ge)}this.encodeCentroid(M.borders?void 0:M.centroid(),M)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,f,y,d)}sortBorders(){for(let n=0;n<4;n++)this.borders[n].sort((o,c)=>this.featuresOnBorder[o].borders[n][0]-this.featuresOnBorder[c].borders[n][0])}encodeCentroid(n,o,c=!0){let d,f;if(n)if(n.y!==0){const v=o.span()._mult(this.tileToMeter);d=(Math.max(n.x,1)<<3)+Math.min(7,Math.round(v.x/10)),f=(Math.max(n.y,1)<<3)+Math.min(7,Math.round(v.y/10))}else d=Math.ceil(7*(n.x+450)),f=0;else d=0,f=+c;let y=c?this.centroidVertexArray.length:o.vertexArrayOffset;for(const v of o.polyCount){c&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*v.edges+v.top);for(let w=0;w<v.top;w++)this.centroidVertexArray.emplace(y++,d,f);for(let w=0;w<2*v.edges;w++)this.centroidVertexArray.emplace(y++,0,f),this.centroidVertexArray.emplace(y++,d,f)}}}function sT(i,n){const o=i.add(n)._unit();return i.x*o.x+i.y*o.y}function a3(i,n,o,c){const d=n.sub(i)._perp()._unit(),f=o.sub(n)._perp()._unit();return aT(i,n,o,sT(d,f),c)}function aT(i,n,o,c,d){const f=Math.sqrt(1-c*c);return Math.min(i.dist(n)/3,n.dist(o)/3,d*f/c)}function lT(i,n,o){return i.x<o[0].x&&n.x<o[0].x||i.x>o[1].x&&n.x>o[1].x||i.y<o[0].y&&n.y<o[0].y||i.y>o[1].y&&n.y>o[1].y}function cT(i,n,o){if(i.x<0||i.x>=$t||n.x<0||n.x>=$t||o.x<0||o.x>=$t)return!1;const c=o.sub(n),d=c.perp(),f=i.sub(n);return(c.x*f.x+c.y*f.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(f.x*f.x+f.y*f.y))>-.866&&d.x*f.x+d.y*f.y<0}function uT(i,n,o){const c=n?2|i:-3&i;return o?1|c:-2&c}function dT(){const i=Math.PI/32,n=Math.tan(i),o=Xp;return o*Math.sqrt(1+2*n*n)-o}function hT(i,n,o){const c=1<<o.z,d=Mo(o.x/c),f=Mo((o.x+1)/c),y=wi(o.y/c),v=wi((o.y+1)/c);return function(w,S,k,M,P=0,B){const j=[];if(!w.length||!k||!M)return j;const U=(ve,Ne)=>{for(const Be of ve)j.push({polygon:Be,bounds:Ne})},Q=Math.ceil(Math.log2(k)),ae=Math.ceil(Math.log2(M)),ge=Q-ae,le=[];for(let ve=0;ve<Math.abs(ge);ve++)le.push(ge>0?0:1);for(let ve=0;ve<Math.min(Q,ae);ve++)le.push(0),le.push(1);let fe=w;if(fe=ly(fe,S[0].y-P,S[1].y+P,1),fe=ly(fe,S[0].x-P,S[1].x+P,0),!fe.length)return j;const be=[];for(le.length?be.push({polygons:fe,bounds:S,depth:0}):U(fe,S);be.length;){const ve=be.pop(),Ne=ve.depth,Be=le[Ne],He=ve.bounds[0],it=ve.bounds[1],Ue=Be===0?He.x:He.y,Ye=Be===0?it.x:it.y,Je=B?B(Be,Ue,Ye):.5*(Ue+Ye),tt=ly(ve.polygons,Ue-P,Je+P,Be),dt=ly(ve.polygons,Je-P,Ye+P,Be);if(tt.length){const We=[He,new ye(Be===0?Je:it.x,Be===1?Je:it.y)];le.length>Ne+1?be.push({polygons:tt,bounds:We,depth:Ne+1}):U(tt,We)}if(dt.length){const We=[new ye(Be===0?Je:He.x,Be===1?Je:He.y),it];le.length>Ne+1?be.push({polygons:dt,bounds:We,depth:Ne+1}):U(dt,We)}}return j}(i,n,Math.ceil((f-d)/11.25),Math.ceil((y-v)/11.25),1,(w,S,k)=>{if(w===0)return .5*(S+k);{const M=wi((o.y+S/$t)/c);return(oa(.5*(wi((o.y+k/$t)/c)+M))*c-o.y)*$t}})}kt(nf,"FillExtrusionBucket",{omit:["layers","features"]}),kt(oT,"PartMetadata");const l3=new de({"fill-extrusion-edge-radius":new $(qe["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var c3={paint:new de({"fill-extrusion-opacity":new $(qe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ee(qe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new $(qe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new $(qe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ee(qe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ee(qe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ee(qe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new $(qe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new $(qe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new $(qe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new $(qe["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:l3};function pT(i,n,o){var c=2*Math.PI*6378137/256/Math.pow(2,o);return[i*c-2*Math.PI*6378137/2,n*c-2*Math.PI*6378137/2]}class cy{constructor(n,o,c){this.z=n,this.x=o,this.y=c,this.key=rf(0,n,n,o,c)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,o){const c=function(f,y,v){var w=pT(256*f,256*(y=Math.pow(2,v)-y-1),v),S=pT(256*(f+1),256*(y+1),v);return w[0]+","+w[1]+","+S[0]+","+S[1]}(this.x,this.y,this.z),d=function(f,y,v){let w,S="";for(let k=f;k>0;k--)w=1<<k-1,S+=(y&w?1:0)+(v&w?2:0);return S}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",d).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class fT{constructor(n,o){this.wrap=n,this.canonical=o,this.key=rf(n,o.z,o.z,o.x,o.y)}}class $i{constructor(n,o,c,d,f){this.overscaledZ=n,this.wrap=o,this.canonical=new cy(c,+d,+f),this.key=o===0&&n===c?this.canonical.key:rf(o,n,c,d,f)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const o=this.canonical.z-n;return n>this.canonical.z?new $i(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $i(n,this.wrap,n,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(n,o=!0){if(this.overscaledZ===n&&o)return this.key;if(n>this.canonical.z)return rf(this.wrap*+o,n,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-n;return rf(this.wrap*+o,n,n,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const o=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>o&&n.canonical.y===this.canonical.y>>o}children(n){if(this.overscaledZ>=n)return[new $i(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,c=2*this.canonical.x,d=2*this.canonical.y;return[new $i(o,this.wrap,o,c,d),new $i(o,this.wrap,o,c+1,d),new $i(o,this.wrap,o,c,d+1),new $i(o,this.wrap,o,c+1,d+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new $i(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new $i(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new fT(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function rf(i,n,o,c,d){const f=1<<Math.min(o,22);let y=f*(d%f)+c%f;return i&&o<22&&(y+=f*f*((i<0?-2*i-1:2*i)%(1<<2*(22-o)))),16*(32*y+o)+(n-o)}kt(cy,"CanonicalTileID"),kt($i,"OverscaledTileID",{omit:["projMatrix"]});class yd extends ye{constructor(n,o,c){super(n,o),this.z=c}}function of(i,n){return i.x*n.x+i.y*n.y}function mT(i,n){if(i.length===1){let o=0;const c=n[o++];let d;for(;!d||c.equals(d);)if(d=n[o++],!d)return 1/0;for(;o<n.length;o++){const f=n[o],y=i[0],v=d.sub(c),w=f.sub(c),S=y.sub(c),k=of(v,v),M=of(v,w),P=of(w,w),B=of(S,v),j=of(S,w),U=k*P-M*M,Q=(P*B-M*j)/U,ae=(k*j-M*B)/U,ge=c.z*(1-Q-ae)+d.z*Q+f.z*ae;if(isFinite(ge))return ge}return 1/0}{let o=1/0;for(const c of n)o=Math.min(o,c.z);return o}}function gT(i,n,o,c,d,f,y,v){const w=y*d.getElevationAt(i,n,!0,!0),S=f[0]!==0,k=S?f[1]===0?y*(f[0]/7-450):y*function(M,P,B){const j=Math.floor(P[0]/8),U=Math.floor(P[1]/8),Q=10*(P[0]-8*j),ae=10*(P[1]-8*U),ge=M.getElevationAt(j,U,!0,!0),le=M.getMeterToDEM(B),fe=Math.floor(.5*(Q*le-1)),be=Math.floor(.5*(ae*le-1)),ve=M.tileCoordToPixel(j,U),Ne=2*fe+1,Be=2*be+1,He=function(dt,We,xt,Mt,vt){return[dt.getElevationAtPixel(We,xt,!0),dt.getElevationAtPixel(We+vt,xt,!0),dt.getElevationAtPixel(We,xt+vt,!0),dt.getElevationAtPixel(We+Mt,xt+vt,!0)]}(M,ve.x-fe,ve.y-be,Ne,Be),it=Math.abs(He[0]-He[1]),Ue=Math.abs(He[2]-He[3]),Ye=Math.abs(He[0]-He[2])+Math.abs(He[1]-He[3]),Je=Math.min(.25,.5*le*(it+Ue)/Ne),tt=Math.min(.25,.5*le*Ye/Be);return ge+Math.max(Je*Q,tt*ae)}(d,f,v):w;return{base:w+(o===0)?-1:o,top:S?Math.max(k+c,w+o+2):w+c}}const u3=Me([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:d3}=u3,h3=Me([{name:"a_packed",components:4,type:"Float32"}]),{members:p3}=h3,f3=ay.types,m3=Math.cos(Math.PI/180*37.5);class uy{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new $e,this.layoutVertexArray2=new nt,this.indexArray=new Lt,this.programConfigurations=new $c(n.layers,n.zoom),this.segments=new Dr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,c,d){this.hasPattern=Jv("line",this.layers,o);const f=this.layers[0].layout.get("line-sort-key"),y=[];for(const{feature:k,id:M,index:P,sourceLayerIndex:B}of n){const j=this.layers[0]._featureFilter.needGeometry,U=Hc(k,j);if(!this.layers[0]._featureFilter.filter(new A(this.zoom),U,c))continue;const Q=f?f.evaluate(U,{},c):void 0,ae={id:M,properties:k.properties,type:k.type,sourceLayerIndex:B,index:P,geometry:j?U.geometry:Oa(k,c,d),patterns:{},sortKey:Q};y.push(ae)}f&&y.sort((k,M)=>k.sortKey-M.sortKey);const{lineAtlas:v,featureIndex:w}=o,S=this.addConstantDashes(v);for(const k of y){const{geometry:M,index:P,sourceLayerIndex:B}=k;if(S&&this.addFeatureDashes(k,v),this.hasPattern){const j=Qv("line",this.layers,k,this.zoom,o);this.patternFeatures.push(j)}else this.addFeature(k,M,P,c,v.positions,o.availableImages);w.insert(n[P].feature,M,P,B,this.index)}}addConstantDashes(n){let o=!1;for(const c of this.layers){const d=c.paint.get("line-dasharray").value,f=c.layout.get("line-cap").value;if(d.kind!=="constant"||f.kind!=="constant")o=!0;else{const y=f.value,v=d.value;if(!v)continue;n.addDash(v,y)}}return o}addFeatureDashes(n,o){const c=this.zoom;for(const d of this.layers){const f=d.paint.get("line-dasharray").value,y=d.layout.get("line-cap").value;if(f.kind==="constant"&&y.kind==="constant")continue;let v,w;if(f.kind==="constant"){if(v=f.value,!v)continue}else v=f.evaluate({zoom:c},n);w=y.kind==="constant"?y.value:y.evaluate({zoom:c},n),o.addDash(v,w),n.patterns[d.id]=o.getKey(v,w)}}update(n,o,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,c,d)}addFeatures(n,o,c,d,f){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,o,c,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,p3)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,d3),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,o,c,d,f,y){const v=this.layers[0].layout,w=v.get("line-join").evaluate(n,{}),S=v.get("line-cap").evaluate(n,{}),k=v.get("line-miter-limit"),M=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const P of o)this.addLine(P,n,w,S,k,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,f,y,d)}addLine(n,o,c,d,f,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ae=0;ae<n.length-1;ae++)this.totalDistance+=n[ae].dist(n[ae+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v=f3[o.type]==="Polygon";let w=n.length;for(;w>=2&&n[w-1].equals(n[w-2]);)w--;let S=0;for(;S<w-1&&n[S].equals(n[S+1]);)S++;if(w<(v?3:2))return;c==="bevel"&&(f=1.05);const k=this.overscaling<=16?15*$t/(512*this.overscaling):0,M=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray);let P,B,j,U,Q;this.e1=this.e2=-1,v&&(P=n[w-2],Q=n[S].sub(P)._unit()._perp());for(let ae=S;ae<w;ae++){if(j=ae===w-1?v?n[S+1]:void 0:n[ae+1],j&&n[ae].equals(j))continue;Q&&(U=Q),P&&(B=P),P=n[ae],Q=j?j.sub(P)._unit()._perp():U,U=U||Q;let ge=U.add(Q);ge.x===0&&ge.y===0||ge._unit();const le=U.x*Q.x+U.y*Q.y,fe=ge.x*Q.x+ge.y*Q.y,be=fe!==0?1/fe:1/0,ve=2*Math.sqrt(2-2*fe),Ne=fe<m3&&B&&j,Be=U.x*Q.y-U.y*Q.x>0;if(Ne&&ae>S){const Ue=P.dist(B);if(Ue>2*k){const Ye=P.sub(P.sub(B)._mult(k/Ue)._round());this.updateDistance(B,Ye),this.addCurrentVertex(Ye,U,0,0,M),B=Ye}}const He=B&&j;let it=He?c:v?"butt":d;if(He&&it==="round"&&(be<y?it="miter":be<=2&&(it="fakeround")),it==="miter"&&be>f&&(it="bevel"),it==="bevel"&&(be>2&&(it="flipbevel"),be<f&&(it="miter")),B&&this.updateDistance(B,P),it==="miter")ge._mult(be),this.addCurrentVertex(P,ge,0,0,M);else if(it==="flipbevel"){if(be>100)ge=Q.mult(-1);else{const Ue=be*U.add(Q).mag()/U.sub(Q).mag();ge._perp()._mult(Ue*(Be?-1:1))}this.addCurrentVertex(P,ge,0,0,M),this.addCurrentVertex(P,ge.mult(-1),0,0,M)}else if(it==="bevel"||it==="fakeround"){const Ue=-Math.sqrt(be*be-1),Ye=Be?Ue:0,Je=Be?0:Ue;if(B&&this.addCurrentVertex(P,U,Ye,Je,M),it==="fakeround"){const tt=Math.round(180*ve/Math.PI/20);for(let dt=1;dt<tt;dt++){let We=dt/tt;if(We!==.5){const Mt=We-.5;We+=We*Mt*(We-1)*((1.0904+le*(le*(3.55645-1.43519*le)-3.2452))*Mt*Mt+(.848013+le*(.215638*le-1.06021)))}const xt=Q.sub(U)._mult(We)._add(U)._unit()._mult(Be?-1:1);this.addHalfVertex(P,xt.x,xt.y,!1,Be,0,M)}}j&&this.addCurrentVertex(P,Q,-Ye,-Je,M)}else if(it==="butt")this.addCurrentVertex(P,ge,0,0,M);else if(it==="square"){const Ue=B?1:-1;B||this.addCurrentVertex(P,ge,Ue,Ue,M),this.addCurrentVertex(P,ge,0,0,M),B&&this.addCurrentVertex(P,ge,Ue,Ue,M)}else it==="round"&&(B&&(this.addCurrentVertex(P,U,0,0,M),this.addCurrentVertex(P,U,1,1,M,!0)),j&&(this.addCurrentVertex(P,Q,-1,-1,M,!0),this.addCurrentVertex(P,Q,0,0,M)));if(Ne&&ae<w-1){const Ue=P.dist(j);if(Ue>2*k){const Ye=P.add(j.sub(P)._mult(k/Ue)._round());this.updateDistance(P,Ye),this.addCurrentVertex(Ye,Q,0,0,M),P=Ye}}}}addCurrentVertex(n,o,c,d,f,y=!1){const v=o.y*d-o.x,w=-o.y-o.x*d;this.addHalfVertex(n,o.x+o.y*c,o.y-o.x*c,y,!1,c,f),this.addHalfVertex(n,v,w,y,!0,-d,f)}addHalfVertex({x:n,y:o},c,d,f,y,v,w){this.layoutVertexArray.emplaceBack((n<<1)+(f?1:0),(o<<1)+(y?1:0),Math.round(63*c)+128,Math.round(63*d)+128,1+(v===0?0:v<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const S=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,S),w.primitiveLength++),y?this.e2=S:this.e1=S}updateScaledDistance(){if(this.lineClips){const n=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=n*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(n,o){this.distance+=n.dist(o),this.updateScaledDistance()}}kt(uy,"LineBucket",{omit:["layers","patternFeatures"]});const g3=new de({"line-cap":new ee(qe.layout_line["line-cap"]),"line-join":new ee(qe.layout_line["line-join"]),"line-miter-limit":new $(qe.layout_line["line-miter-limit"]),"line-round-limit":new $(qe.layout_line["line-round-limit"]),"line-sort-key":new ee(qe.layout_line["line-sort-key"])});var yT={paint:new de({"line-opacity":new ee(qe.paint_line["line-opacity"]),"line-color":new ee(qe.paint_line["line-color"]),"line-translate":new $(qe.paint_line["line-translate"]),"line-translate-anchor":new $(qe.paint_line["line-translate-anchor"]),"line-width":new ee(qe.paint_line["line-width"]),"line-gap-width":new ee(qe.paint_line["line-gap-width"]),"line-offset":new ee(qe.paint_line["line-offset"]),"line-blur":new ee(qe.paint_line["line-blur"]),"line-dasharray":new ee(qe.paint_line["line-dasharray"]),"line-pattern":new ee(qe.paint_line["line-pattern"]),"line-gradient":new ue(qe.paint_line["line-gradient"]),"line-trim-offset":new $(qe.paint_line["line-trim-offset"])}),layout:g3};const _T=new class extends ee{possiblyEvaluate(i,n){return n=new A(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,transition:n.transition}),super.possiblyEvaluate(i,n)}evaluate(i,n,o,c){return n=zt({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(i,n,o,c)}}(yT.paint.properties["line-width"].specification);function xT(i,n){return n>0?n+2*i:i}_T.useIntegerZoom=!0;const y3=Me([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),_3=Me([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),x3=Me([{name:"a_projected_pos",components:4,type:"Float32"}],4);Me([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const v3=Me([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),b3=Me([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Me([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const vT=Me([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),w3=Me([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Me([{name:"triangle",components:3,type:"Uint16"}]),Me([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Me([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Me([{type:"Float32",name:"offsetX"}]),Me([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var fi=24;const Bs=128;function t1(i,n){const{expression:o}=n;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new A(i+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:d}=o;let f=0;for(;f<c.length&&c[f]<=i;)f++;f=Math.max(0,f-1);let y=f;for(;y<c.length&&c[y]<i+1;)y++;y=Math.min(c.length-1,y);const v=c[f],w=c[y];return o.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:w,interpolationType:d}:{kind:"camera",minZoom:v,maxZoom:w,minSize:o.evaluate(new A(v)),maxSize:o.evaluate(new A(w)),interpolationType:d}}}function dy(i,{uSize:n,uSizeT:o},{lowerSize:c,upperSize:d}){return i.kind==="source"?c/Bs:i.kind==="composite"?gn(c/Bs,d/Bs,o):n}function _d(i,n){let o=0,c=0;if(i.kind==="constant")c=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:d,minZoom:f,maxZoom:y}=i,v=d?Re(Ko.interpolationFactor(d,n,f,y),0,1):0;i.kind==="camera"?c=gn(i.minSize,i.maxSize,v):o=v}return{uSizeT:o,uSize:c}}var S3=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Bs,evaluateSizeForFeature:dy,evaluateSizeForZoom:_d,getSizeData:t1});function E3(i,n,o){return i.sections.forEach(c=>{c.text=function(d,f,y){const v=f.layout.get("text-transform").evaluate(y,{});return v==="uppercase"?d=d.toLocaleUpperCase():v==="lowercase"&&(d=d.toLocaleLowerCase()),C.applyArabicShaping&&(d=C.applyArabicShaping(d)),d}(c.text,n,o)}),i}const sf={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function T3(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}function C3(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}var bT=Hn,wT=function(i,n,o,c,d){var f,y,v=8*d-c-1,w=(1<<v)-1,S=w>>1,k=-7,M=o?d-1:0,P=o?-1:1,B=i[n+M];for(M+=P,f=B&(1<<-k)-1,B>>=-k,k+=v;k>0;f=256*f+i[n+M],M+=P,k-=8);for(y=f&(1<<-k)-1,f>>=-k,k+=c;k>0;y=256*y+i[n+M],M+=P,k-=8);if(f===0)f=1-S;else{if(f===w)return y?NaN:1/0*(B?-1:1);y+=Math.pow(2,c),f-=S}return(B?-1:1)*y*Math.pow(2,f-c)},ST=function(i,n,o,c,d,f){var y,v,w,S=8*f-d-1,k=(1<<S)-1,M=k>>1,P=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=c?0:f-1,j=c?1:-1,U=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(v=isNaN(n)?1:0,y=k):(y=Math.floor(Math.log(n)/Math.LN2),n*(w=Math.pow(2,-y))<1&&(y--,w*=2),(n+=y+M>=1?P/w:P*Math.pow(2,1-M))*w>=2&&(y++,w/=2),y+M>=k?(v=0,y=k):y+M>=1?(v=(n*w-1)*Math.pow(2,d),y+=M):(v=n*Math.pow(2,M-1)*Math.pow(2,d),y=0));d>=8;i[o+B]=255&v,B+=j,v/=256,d-=8);for(y=y<<d|v,S+=d;S>0;i[o+B]=255&y,B+=j,y/=256,S-=8);i[o+B-j]|=128*U};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Hn(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Hn.Varint=0,Hn.Fixed64=1,Hn.Bytes=2,Hn.Fixed32=5;var n1=4294967296,ET=1/n1,TT=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Fa(i){return i.type===Hn.Bytes?i.readVarint()+i.pos:i.pos+1}function xd(i,n,o){return o?4294967296*n+(i>>>0):4294967296*(n>>>0)+(i>>>0)}function CT(i,n,o){var c=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));o.realloc(c);for(var d=o.pos-1;d>=i;d--)o.buf[d+c]=o.buf[d]}function k3(i,n){for(var o=0;o<i.length;o++)n.writeVarint(i[o])}function I3(i,n){for(var o=0;o<i.length;o++)n.writeSVarint(i[o])}function A3(i,n){for(var o=0;o<i.length;o++)n.writeFloat(i[o])}function M3(i,n){for(var o=0;o<i.length;o++)n.writeDouble(i[o])}function P3(i,n){for(var o=0;o<i.length;o++)n.writeBoolean(i[o])}function R3(i,n){for(var o=0;o<i.length;o++)n.writeFixed32(i[o])}function z3(i,n){for(var o=0;o<i.length;o++)n.writeSFixed32(i[o])}function L3(i,n){for(var o=0;o<i.length;o++)n.writeFixed64(i[o])}function D3(i,n){for(var o=0;o<i.length;o++)n.writeSFixed64(i[o])}function hy(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+16777216*i[n+3]}function vd(i,n,o){i[o]=n,i[o+1]=n>>>8,i[o+2]=n>>>16,i[o+3]=n>>>24}function kT(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+(i[n+3]<<24)}Hn.prototype={destroy:function(){this.buf=null},readFields:function(i,n,o){for(o=o||this.length;this.pos<o;){var c=this.readVarint(),d=c>>3,f=this.pos;this.type=7&c,i(d,n,this),this.pos===f&&this.skip(c)}return n},readMessage:function(i,n){return this.readFields(i,n,this.readVarint()+this.pos)},readFixed32:function(){var i=hy(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=kT(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=hy(this.buf,this.pos)+hy(this.buf,this.pos+4)*n1;return this.pos+=8,i},readSFixed64:function(){var i=hy(this.buf,this.pos)+kT(this.buf,this.pos+4)*n1;return this.pos+=8,i},readFloat:function(){var i=wT(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=wT(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var n,o,c=this.buf;return n=127&(o=c[this.pos++]),o<128?n:(n|=(127&(o=c[this.pos++]))<<7,o<128?n:(n|=(127&(o=c[this.pos++]))<<14,o<128?n:(n|=(127&(o=c[this.pos++]))<<21,o<128?n:function(d,f,y){var v,w,S=y.buf;if(v=(112&(w=S[y.pos++]))>>4,w<128||(v|=(127&(w=S[y.pos++]))<<3,w<128)||(v|=(127&(w=S[y.pos++]))<<10,w<128)||(v|=(127&(w=S[y.pos++]))<<17,w<128)||(v|=(127&(w=S[y.pos++]))<<24,w<128)||(v|=(1&(w=S[y.pos++]))<<31,w<128))return xd(d,v,f);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(o=c[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,n=this.pos;return this.pos=i,i-n>=12&&TT?function(o,c,d){return TT.decode(o.subarray(c,d))}(this.buf,n,i):function(o,c,d){for(var f="",y=c;y<d;){var v,w,S,k=o[y],M=null,P=k>239?4:k>223?3:k>191?2:1;if(y+P>d)break;P===1?k<128&&(M=k):P===2?(192&(v=o[y+1]))==128&&(M=(31&k)<<6|63&v)<=127&&(M=null):P===3?(w=o[y+2],(192&(v=o[y+1]))==128&&(192&w)==128&&((M=(15&k)<<12|(63&v)<<6|63&w)<=2047||M>=55296&&M<=57343)&&(M=null)):P===4&&(w=o[y+2],S=o[y+3],(192&(v=o[y+1]))==128&&(192&w)==128&&(192&S)==128&&((M=(15&k)<<18|(63&v)<<12|(63&w)<<6|63&S)<=65535||M>=1114112)&&(M=null)),M===null?(M=65533,P=1):M>65535&&(M-=65536,f+=String.fromCharCode(M>>>10&1023|55296),M=56320|1023&M),f+=String.fromCharCode(M),y+=P}return f}(this.buf,n,i)},readBytes:function(){var i=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,i);return this.pos=i,n},readPackedVarint:function(i,n){if(this.type!==Hn.Bytes)return i.push(this.readVarint(n));var o=Fa(this);for(i=i||[];this.pos<o;)i.push(this.readVarint(n));return i},readPackedSVarint:function(i){if(this.type!==Hn.Bytes)return i.push(this.readSVarint());var n=Fa(this);for(i=i||[];this.pos<n;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Hn.Bytes)return i.push(this.readBoolean());var n=Fa(this);for(i=i||[];this.pos<n;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Hn.Bytes)return i.push(this.readFloat());var n=Fa(this);for(i=i||[];this.pos<n;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Hn.Bytes)return i.push(this.readDouble());var n=Fa(this);for(i=i||[];this.pos<n;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Hn.Bytes)return i.push(this.readFixed32());var n=Fa(this);for(i=i||[];this.pos<n;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Hn.Bytes)return i.push(this.readSFixed32());var n=Fa(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Hn.Bytes)return i.push(this.readFixed64());var n=Fa(this);for(i=i||[];this.pos<n;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Hn.Bytes)return i.push(this.readSFixed64());var n=Fa(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed64());return i},skip:function(i){var n=7&i;if(n===Hn.Varint)for(;this.buf[this.pos++]>127;);else if(n===Hn.Bytes)this.pos=this.readVarint()+this.pos;else if(n===Hn.Fixed32)this.pos+=4;else{if(n!==Hn.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(i,n){this.writeVarint(i<<3|n)},realloc:function(i){for(var n=this.length||16;n<this.pos+i;)n*=2;if(n!==this.length){var o=new Uint8Array(n);o.set(this.buf),this.buf=o,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),vd(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),vd(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),vd(this.buf,-1&i,this.pos),vd(this.buf,Math.floor(i*ET),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),vd(this.buf,-1&i,this.pos),vd(this.buf,Math.floor(i*ET),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(n,o){var c,d;if(n>=0?(c=n%4294967296|0,d=n/4294967296|0):(d=~(-n/4294967296),4294967295^(c=~(-n%4294967296))?c=c+1|0:(c=0,d=d+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(f,y,v){v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,v.buf[v.pos]=127&(f>>>=7)}(c,0,o),function(f,y){var v=(7&f)<<4;y.buf[y.pos++]|=v|((f>>>=3)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f|((f>>>=7)?128:0),f&&(y.buf[y.pos++]=127&f)))))}(d,o)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var n=this.pos;this.pos=function(c,d,f){for(var y,v,w=0;w<d.length;w++){if((y=d.charCodeAt(w))>55295&&y<57344){if(!v){y>56319||w+1===d.length?(c[f++]=239,c[f++]=191,c[f++]=189):v=y;continue}if(y<56320){c[f++]=239,c[f++]=191,c[f++]=189,v=y;continue}y=v-55296<<10|y-56320|65536,v=null}else v&&(c[f++]=239,c[f++]=191,c[f++]=189,v=null);y<128?c[f++]=y:(y<2048?c[f++]=y>>6|192:(y<65536?c[f++]=y>>12|224:(c[f++]=y>>18|240,c[f++]=y>>12&63|128),c[f++]=y>>6&63|128),c[f++]=63&y|128)}return f}(this.buf,i,this.pos);var o=this.pos-n;o>=128&&CT(n,o,this),this.pos=n-1,this.writeVarint(o),this.pos+=o},writeFloat:function(i){this.realloc(4),ST(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),ST(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var n=i.length;this.writeVarint(n),this.realloc(n);for(var o=0;o<n;o++)this.buf[this.pos++]=i[o]},writeRawMessage:function(i,n){this.pos++;var o=this.pos;i(n,this);var c=this.pos-o;c>=128&&CT(o,c,this),this.pos=o-1,this.writeVarint(c),this.pos+=c},writeMessage:function(i,n,o){this.writeTag(i,Hn.Bytes),this.writeRawMessage(n,o)},writePackedVarint:function(i,n){n.length&&this.writeMessage(i,k3,n)},writePackedSVarint:function(i,n){n.length&&this.writeMessage(i,I3,n)},writePackedBoolean:function(i,n){n.length&&this.writeMessage(i,P3,n)},writePackedFloat:function(i,n){n.length&&this.writeMessage(i,A3,n)},writePackedDouble:function(i,n){n.length&&this.writeMessage(i,M3,n)},writePackedFixed32:function(i,n){n.length&&this.writeMessage(i,R3,n)},writePackedSFixed32:function(i,n){n.length&&this.writeMessage(i,z3,n)},writePackedFixed64:function(i,n){n.length&&this.writeMessage(i,L3,n)},writePackedSFixed64:function(i,n){n.length&&this.writeMessage(i,D3,n)},writeBytesField:function(i,n){this.writeTag(i,Hn.Bytes),this.writeBytes(n)},writeFixed32Field:function(i,n){this.writeTag(i,Hn.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(i,n){this.writeTag(i,Hn.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(i,n){this.writeTag(i,Hn.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(i,n){this.writeTag(i,Hn.Fixed64),this.writeSFixed64(n)},writeVarintField:function(i,n){this.writeTag(i,Hn.Varint),this.writeVarint(n)},writeSVarintField:function(i,n){this.writeTag(i,Hn.Varint),this.writeSVarint(n)},writeStringField:function(i,n){this.writeTag(i,Hn.Bytes),this.writeString(n)},writeFloatField:function(i,n){this.writeTag(i,Hn.Fixed32),this.writeFloat(n)},writeDoubleField:function(i,n){this.writeTag(i,Hn.Fixed64),this.writeDouble(n)},writeBooleanField:function(i,n){this.writeVarintField(i,!!n)}};var py=V(bT);const r1=3;function O3(i,n,o){n.glyphs=[],i===1&&o.readMessage(B3,n)}function B3(i,n,o){if(i===3){const{id:c,bitmap:d,width:f,height:y,left:v,top:w,advance:S}=o.readMessage(F3,{});n.glyphs.push({id:c,bitmap:new Ba({width:f+2*r1,height:y+2*r1},d),metrics:{width:f,height:y,left:v,top:w,advance:S}})}else i===4?n.ascender=o.readSVarint():i===5&&(n.descender=o.readSVarint())}function F3(i,n,o){i===1?n.id=o.readVarint():i===2?n.bitmap=o.readBytes():i===3?n.width=o.readVarint():i===4?n.height=o.readVarint():i===5?n.left=o.readSVarint():i===6?n.top=o.readSVarint():i===7&&(n.advance=o.readVarint())}const IT=r1;function i1(i){let n=0,o=0;for(const y of i)n+=y.w*y.h,o=Math.max(o,y.w);i.sort((y,v)=>v.h-y.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),o),h:1/0}];let d=0,f=0;for(const y of i)for(let v=c.length-1;v>=0;v--){const w=c[v];if(!(y.w>w.w||y.h>w.h)){if(y.x=w.x,y.y=w.y,f=Math.max(f,y.y+y.h),d=Math.max(d,y.x+y.w),y.w===w.w&&y.h===w.h){const S=c.pop();v<c.length&&(c[v]=S)}else y.h===w.h?(w.x+=y.w,w.w-=y.w):y.w===w.w?(w.y+=y.h,w.h-=y.h):(c.push({x:w.x+y.w,y:w.y,w:w.w-y.w,h:y.h}),w.y+=y.h,w.h-=y.h);break}}return{w:d,h:f,fill:n/(d*f)||0}}const to=1;class o1{constructor(n,{pixelRatio:o,version:c,stretchX:d,stretchY:f,content:y}){this.paddedRect=n,this.pixelRatio=o,this.stretchX=d,this.stretchY=f,this.content=y,this.version=c}get tl(){return[this.paddedRect.x+to,this.paddedRect.y+to]}get br(){return[this.paddedRect.x+this.paddedRect.w-to,this.paddedRect.y+this.paddedRect.h-to]}get displaySize(){return[(this.paddedRect.w-2*to)/this.pixelRatio,(this.paddedRect.h-2*to)/this.pixelRatio]}}class AT{constructor(n,o){const c={},d={};this.haveRenderCallbacks=[];const f=[];this.addImages(n,c,f),this.addImages(o,d,f);const{w:y,h:v}=i1(f),w=new mo({width:y||1,height:v||1});for(const S in n){const k=n[S],M=c[S].paddedRect;mo.copy(k.data,w,{x:0,y:0},{x:M.x+to,y:M.y+to},k.data)}for(const S in o){const k=o[S],M=d[S].paddedRect,P=M.x+to,B=M.y+to,j=k.data.width,U=k.data.height;mo.copy(k.data,w,{x:0,y:0},{x:P,y:B},k.data),mo.copy(k.data,w,{x:0,y:U-1},{x:P,y:B-1},{width:j,height:1}),mo.copy(k.data,w,{x:0,y:0},{x:P,y:B+U},{width:j,height:1}),mo.copy(k.data,w,{x:j-1,y:0},{x:P-1,y:B},{width:1,height:U}),mo.copy(k.data,w,{x:0,y:0},{x:P+j,y:B},{width:1,height:U})}this.image=w,this.iconPositions=c,this.patternPositions=d}addImages(n,o,c){for(const d in n){const f=n[d],y={x:0,y:0,w:f.data.width+2*to,h:f.data.height+2*to};c.push(y),o[d]=new o1(y,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(n,o){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(c=>n.hasImage(c)),n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in n.updatedImages)this.patchUpdatedImage(this.iconPositions[c],n.getImage(c),o),this.patchUpdatedImage(this.patternPositions[c],n.getImage(c),o)}patchUpdatedImage(n,o,c){if(!n||!o||n.version===o.version)return;n.version=o.version;const[d,f]=n.tl;c.update(o.data,void 0,{x:d,y:f})}}kt(o1,"ImagePosition"),kt(AT,"ImageAtlas");const Po={horizontal:1,vertical:2,horizontalOnly:3},MT=-17;class af{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,o){const c=new af;return c.scale=n||1,c.fontStack=o,c}static forImage(n){const o=new af;return o.imageName=n,o}}class bd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,o){const c=new bd;for(let d=0;d<n.sections.length;d++){const f=n.sections[d];f.image?c.addImageSection(f):c.addTextSection(f,o)}return c}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(n){this.text=function(o,c){let d="";for(let f=0;f<o.length;f++){const y=o.charCodeAt(f+1)||null,v=o.charCodeAt(f-1)||null;d+=!c&&(y&&Ug(y)&&!sf[o[f+1]]||v&&Ug(v)&&!sf[o[f-1]])||!sf[o[f]]?o[f]:sf[o[f]]}return d}(this.text,n)}trim(){let n=0;for(let c=0;c<this.text.length&&fy[this.text.charCodeAt(c)];c++)n++;let o=this.text.length;for(let c=this.text.length-1;c>=0&&c>=n&&fy[this.text.charCodeAt(c)];c--)o--;this.text=this.text.substring(n,o),this.sectionIndex=this.sectionIndex.slice(n,o)}substring(n,o){const c=new bd;return c.text=this.text.substring(n,o),c.sectionIndex=this.sectionIndex.slice(n,o),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,o)=>Math.max(n,this.sections[o].scale),0)}addTextSection(n,o){this.text+=n.text,this.sections.push(af.forText(n.scale,n.fontStack||o));const c=this.sections.length-1;for(let d=0;d<n.text.length;++d)this.sectionIndex.push(c)}addImageSection(n){const o=n.image?n.image.name:"";if(o.length===0)return void Kt("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(af.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Kt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function s1(i,n,o,c,d,f,y,v,w,S,k,M,P,B,j){const U=bd.fromFeature(i,d);M===Po.vertical&&U.verticalizePunctuation(P);let Q=[];const ae=function(ve,Ne,Be,He,it,Ue){if(!ve)return[];const Ye=[],Je=function(xt,Mt,vt,Yt,ht,Ft){let Jt=0;for(let vn=0;vn<xt.length();vn++){const Qt=xt.getSection(vn);Jt+=PT(xt.getCharCode(vn),Qt,Yt,ht,Mt,Ft)}return Jt/Math.max(1,Math.ceil(Jt/vt))}(ve,Ne,Be,He,it,Ue),tt=ve.text.indexOf("")>=0;let dt=0;for(let xt=0;xt<ve.length();xt++){const Mt=ve.getSection(xt),vt=ve.getCharCode(xt);if(fy[vt]||(dt+=PT(vt,Mt,He,it,Ne,Ue)),xt<ve.length()-1){const Yt=!((We=vt)<11904||!(bt["Bopomofo Extended"](We)||bt.Bopomofo(We)||bt["CJK Compatibility Forms"](We)||bt["CJK Compatibility Ideographs"](We)||bt["CJK Compatibility"](We)||bt["CJK Radicals Supplement"](We)||bt["CJK Strokes"](We)||bt["CJK Symbols and Punctuation"](We)||bt["CJK Unified Ideographs Extension A"](We)||bt["CJK Unified Ideographs"](We)||bt["Enclosed CJK Letters and Months"](We)||bt["Halfwidth and Fullwidth Forms"](We)||bt.Hiragana(We)||bt["Ideographic Description Characters"](We)||bt["Kangxi Radicals"](We)||bt["Katakana Phonetic Extensions"](We)||bt.Katakana(We)||bt["Vertical Forms"](We)||bt["Yi Radicals"](We)||bt["Yi Syllables"](We)));(j3[vt]||Yt||Mt.imageName)&&Ye.push(zT(xt+1,dt,Je,Ye,N3(vt,ve.getCharCode(xt+1),Yt&&tt),!1))}}var We;return LT(zT(ve.length(),dt,Je,Ye,0,!0))}(U,S,f,n,c,B),{processBidirectionalText:ge,processStyledBidirectionalText:le}=C;if(ge&&U.sections.length===1){const ve=ge(U.toString(),ae);for(const Ne of ve){const Be=new bd;Be.text=Ne,Be.sections=U.sections;for(let He=0;He<Ne.length;He++)Be.sectionIndex.push(0);Q.push(Be)}}else if(le){const ve=le(U.text,U.sectionIndex,ae);for(const Ne of ve){const Be=new bd;Be.text=Ne[0],Be.sectionIndex=Ne[1],Be.sections=U.sections,Q.push(Be)}}else Q=function(ve,Ne){const Be=[],He=ve.text;let it=0;for(const Ue of Ne)Be.push(ve.substring(it,Ue)),it=Ue;return it<He.length&&Be.push(ve.substring(it,He.length)),Be}(U,ae);const fe=[],be={positionedLines:fe,text:U.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:M,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ve,Ne,Be,He,it,Ue,Ye,Je,tt,dt,We,xt){let Mt=0,vt=0,Yt=0;const ht=Je==="right"?1:Je==="left"?0:.5;let Ft=!1;for(const rn of it){const on=rn.getSections();for(const Un of on){if(Un.imageName)continue;const Zn=Ne[Un.fontStack];if(Zn&&(Ft=Zn.ascender!==void 0&&Zn.descender!==void 0,!Ft))break}if(!Ft)break}let Jt=0;for(const rn of it){rn.trim();const on=rn.getMaxScale(),Un=(on-1)*fi,Zn={positionedGlyphs:[],lineOffset:0};ve.positionedLines[Jt]=Zn;const Xn=Zn.positionedGlyphs;let Vn=0;if(!rn.length()){vt+=Ue,++Jt;continue}let dr=0,_r=0;for(let Wn=0;Wn<rn.length();Wn++){const qr=rn.getSection(Wn),Fr=rn.getSectionIndex(Wn),pr=rn.getCharCode(Wn);let En=qr.scale,jr=null,Kn=null,Ui=null,Nr=fi,mi=0;const ii=!(tt===Po.horizontal||!We&&!zp(pr)||We&&(fy[pr]||(vn=pr,bt.Arabic(vn)||bt["Arabic Supplement"](vn)||bt["Arabic Extended-A"](vn)||bt["Arabic Presentation Forms-A"](vn)||bt["Arabic Presentation Forms-B"](vn))));if(qr.imageName){const Vi=He[qr.imageName];if(!Vi)continue;Ui=qr.imageName,ve.iconsInText=ve.iconsInText||!0,Kn=Vi.paddedRect;const oi=Vi.displaySize;En=En*fi/xt,jr={width:oi[0],height:oi[1],left:to,top:-IT,advance:ii?oi[1]:oi[0],localGlyph:!1},mi=Ft?-jr.height*En:MT+on*fi-oi[1]*En,Nr=jr.advance;const Ns=(ii?oi[0]:oi[1])*En-fi*on;Ns>0&&Ns>Vn&&(Vn=Ns)}else{const Vi=Be[qr.fontStack];if(!Vi)continue;Vi[pr]&&(Kn=Vi[pr]);const oi=Ne[qr.fontStack];if(!oi)continue;const Ns=oi.glyphs[pr];if(!Ns)continue;if(jr=Ns.metrics,Nr=pr!==8203?fi:0,Ft){const Id=oi.ascender!==void 0?Math.abs(oi.ascender):0,yf=oi.descender!==void 0?Math.abs(oi.descender):0,_f=(Id+yf)*En;dr<_f&&(dr=_f,_r=(Id-yf)/2*En),mi=-Id*En}else mi=MT+(on-En)*fi}ii?(ve.verticalizable=!0,Xn.push({glyph:pr,imageName:Ui,x:Mt,y:vt+mi,vertical:ii,scale:En,localGlyph:jr.localGlyph,fontStack:qr.fontStack,sectionIndex:Fr,metrics:jr,rect:Kn}),Mt+=Nr*En+dt):(Xn.push({glyph:pr,imageName:Ui,x:Mt,y:vt+mi,vertical:ii,scale:En,localGlyph:jr.localGlyph,fontStack:qr.fontStack,sectionIndex:Fr,metrics:jr,rect:Kn}),Mt+=jr.advance*En+dt)}Xn.length!==0&&(Yt=Math.max(Mt-dt,Yt),Ft?DT(Xn,ht,Vn,_r,Ue*on/2):DT(Xn,ht,Vn,0,Ue/2)),Mt=0;const Br=Ue*on+Vn;Zn.lineOffset=Math.max(Vn,Un),vt+=Br,++Jt}var vn;const Qt=vt,{horizontalAlign:Vt,verticalAlign:Qn}=a1(Ye);(function(rn,on,Un,Zn,Xn,Vn){const dr=(on-Un)*Xn,_r=-Vn*Zn;for(const Br of rn)for(const Wn of Br.positionedGlyphs)Wn.x+=dr,Wn.y+=_r})(ve.positionedLines,ht,Vt,Qn,Yt,Qt),ve.top+=-Qn*Qt,ve.bottom=ve.top+Qt,ve.left+=-Vt*Yt,ve.right=ve.left+Yt,ve.hasBaseline=Ft}(be,n,o,c,Q,y,v,w,M,S,P,j),!function(ve){for(const Ne of ve)if(Ne.positionedGlyphs.length!==0)return!1;return!0}(fe)&&be}const fy={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},j3={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function PT(i,n,o,c,d,f){if(n.imageName){const y=c[n.imageName];return y?y.displaySize[0]*n.scale*fi/f+d:0}{const y=o[n.fontStack],v=y&&y.glyphs[i];return v?v.metrics.advance*n.scale+d:0}}function RT(i,n,o,c){const d=Math.pow(i-n,2);return c?i<n?d/2:2*d:d+Math.abs(o)*o}function N3(i,n,o){let c=0;return i===10&&(c-=1e4),o&&(c+=150),i!==40&&i!==65288||(c+=50),n!==41&&n!==65289||(c+=50),c}function zT(i,n,o,c,d,f){let y=null,v=RT(n,o,d,f);for(const w of c){const S=RT(n-w.x,o,d,f)+w.badness;S<=v&&(y=w,v=S)}return{index:i,x:n,priorBreak:y,badness:v}}function LT(i){return i?LT(i.priorBreak).concat(i.index):[]}function a1(i){let n=.5,o=.5;switch(i){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:n,verticalAlign:o}}function DT(i,n,o,c,d){if(!(n||o||c||d))return;const f=i.length-1,y=i[f],v=(y.x+y.metrics.advance*y.scale)*n;for(let w=0;w<=f;w++)i[w].x-=v,i[w].y+=o+c+d}function $3(i,n,o){const{horizontalAlign:c,verticalAlign:d}=a1(o),f=n[0]-i.displaySize[0]*c,y=n[1]-i.displaySize[1]*d;return{image:i,top:y,bottom:y+i.displaySize[1],left:f,right:f+i.displaySize[0]}}function OT(i,n,o,c,d,f){const y=i.image;let v;if(y.content){const Q=y.content,ae=y.pixelRatio||1;v=[Q[0]/ae,Q[1]/ae,y.displaySize[0]-Q[2]/ae,y.displaySize[1]-Q[3]/ae]}const w=n.left*f,S=n.right*f;let k,M,P,B;o==="width"||o==="both"?(B=d[0]+w-c[3],M=d[0]+S+c[1]):(B=d[0]+(w+S-y.displaySize[0])/2,M=B+y.displaySize[0]);const j=n.top*f,U=n.bottom*f;return o==="height"||o==="both"?(k=d[1]+j-c[0],P=d[1]+U+c[2]):(k=d[1]+(j+U-y.displaySize[1])/2,P=k+y.displaySize[1]),{image:y,top:k,right:M,bottom:P,left:B,collisionPadding:v}}class ja extends ye{constructor(n,o,c,d,f){super(n,o),this.angle=d,this.z=c,f!==void 0&&(this.segment=f)}clone(){return new ja(this.x,this.y,this.z,this.angle,this.segment)}}function BT(i,n,o,c,d){if(n.segment===void 0)return!0;let f=n,y=n.segment+1,v=0;for(;v>-o/2;){if(y--,y<0)return!1;v-=i[y].dist(f),f=i[y]}v+=i[y].dist(i[y+1]),y++;const w=[];let S=0;for(;v<o/2;){const k=i[y],M=i[y+1];if(!M)return!1;let P=i[y-1].angleTo(k)-k.angleTo(M);for(P=Math.abs((P+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:v,angleDelta:P}),S+=P;v-w[0].distance>c;)S-=w.shift().angleDelta;if(S>d)return!1;y++,v+=k.dist(M)}return!0}function FT(i){let n=0;for(let o=0;o<i.length-1;o++)n+=i[o].dist(i[o+1]);return n}function jT(i,n,o){return i?.6*n*o:0}function NT(i,n){return Math.max(i?i.right-i.left:0,n?n.right-n.left:0)}function U3(i,n,o,c,d,f){const y=jT(o,d,f),v=NT(o,c)*f;let w=0;const S=FT(i)/2;for(let k=0;k<i.length-1;k++){const M=i[k],P=i[k+1],B=M.dist(P);if(w+B>S){const j=(S-w)/B,U=gn(M.x,P.x,j),Q=gn(M.y,P.y,j),ae=new ja(U,Q,0,P.angleTo(M),k);return!y||BT(i,ae,v,y,n)?ae:void 0}w+=B}}function V3(i,n,o,c,d,f,y,v,w){const S=jT(c,f,y),k=NT(c,d),M=k*y,P=i[0].x===0||i[0].x===w||i[0].y===0||i[0].y===w;return n-M<n/4&&(n=M+n/4),$T(i,P?n/2*v%n:(k/2+2*f)*y*v%n,n,S,o,M,P,!1,w)}function $T(i,n,o,c,d,f,y,v,w){const S=f/2,k=FT(i);let M=0,P=n-o,B=[];for(let j=0;j<i.length-1;j++){const U=i[j],Q=i[j+1],ae=U.dist(Q),ge=Q.angleTo(U);for(;P+o<M+ae;){P+=o;const le=(P-M)/ae,fe=gn(U.x,Q.x,le),be=gn(U.y,Q.y,le);if(fe>=0&&fe<w&&be>=0&&be<w&&P-S>=0&&P+S<=k){const ve=new ja(fe,be,0,ge,j);ve._round(),c&&!BT(i,ve,f,c,d)||B.push(ve)}}M+=ae}return v||B.length||y||(B=$T(i,M/2,o,c,d,f,y,!0,w)),B}function UT(i,n,o,c,d){const f=[];for(let y=0;y<i.length;y++){const v=i[y];let w;for(let S=0;S<v.length-1;S++){let k=v[S],M=v[S+1];k.x<n&&M.x<n||(k.x<n?k=new ye(n,k.y+(n-k.x)/(M.x-k.x)*(M.y-k.y))._round():M.x<n&&(M=new ye(n,k.y+(n-k.x)/(M.x-k.x)*(M.y-k.y))._round()),k.y<o&&M.y<o||(k.y<o?k=new ye(k.x+(o-k.y)/(M.y-k.y)*(M.x-k.x),o)._round():M.y<o&&(M=new ye(k.x+(o-k.y)/(M.y-k.y)*(M.x-k.x),o)._round()),k.x>=c&&M.x>=c||(k.x>=c?k=new ye(c,k.y+(c-k.x)/(M.x-k.x)*(M.y-k.y))._round():M.x>=c&&(M=new ye(c,k.y+(c-k.x)/(M.x-k.x)*(M.y-k.y))._round()),k.y>=d&&M.y>=d||(k.y>=d?k=new ye(k.x+(d-k.y)/(M.y-k.y)*(M.x-k.x),d)._round():M.y>=d&&(M=new ye(k.x+(d-k.y)/(M.y-k.y)*(M.x-k.x),d)._round()),w&&k.equals(w[w.length-1])||(w=[k],f.push(w)),w.push(M)))))}}return f}kt(ja,"Anchor");const lf=1e20;function VT(i,n,o,c,d,f,y,v,w){for(let S=n;S<n+c;S++)WT(i,o*f+S,f,d,y,v,w);for(let S=o;S<o+d;S++)WT(i,S*f+n,1,c,y,v,w)}function WT(i,n,o,c,d,f,y){f[0]=0,y[0]=-lf,y[1]=lf,d[0]=i[n];for(let v=1,w=0,S=0;v<c;v++){d[v]=i[n+v*o];const k=v*v;do{const M=f[w];S=(d[v]-d[M]+k-M*M)/(v-M)/2}while(S<=y[w]&&--w>-1);w++,f[w]=v,y[w]=S,y[w+1]=lf}for(let v=0,w=0;v<c;v++){for(;y[w+1]<v;)w++;const S=f[w],k=v-S;i[n+v*o]=d[S]+k*k}}const Fs=2,l1={none:0,ideographs:1,all:2};class wd{constructor(n,o,c){this.requestManager=n,this.localGlyphMode=o,this.localFontFamily=c,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n){this.url=n}getGlyphs(n,o){const c=[];for(const d in n)for(const f of n[d])c.push({stack:d,id:f});st(c,({stack:d,id:f},y)=>{let v=this.entries[d];v||(v=this.entries[d]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=v.glyphs[f];if(w!==void 0)return void y(null,{stack:d,id:f,glyph:w});if(w=this._tinySDF(v,d,f),w)return v.glyphs[f]=w,void y(null,{stack:d,id:f,glyph:w});const S=Math.floor(f/256);if(256*S>65535)return void y(new Error("glyphs > 65535 not supported"));if(v.ranges[S])return void y(null,{stack:d,id:f,glyph:w});let k=v.requests[S];k||(k=v.requests[S]=[],wd.loadGlyphRange(d,S,this.url,this.requestManager,(M,P)=>{if(P){v.ascender=P.ascender,v.descender=P.descender;for(const B in P.glyphs)this._doesCharSupportLocalGlyph(+B)||(v.glyphs[+B]=P.glyphs[+B]);v.ranges[S]=!0}for(const B of k)B(M,P);delete v.requests[S]})),k.push((M,P)=>{M?y(M):P&&y(null,{stack:d,id:f,glyph:P.glyphs[f]||null})})},(d,f)=>{if(d)o(d);else if(f){const y={};for(const{stack:v,id:w,glyph:S}of f)y[v]===void 0&&(y[v]={}),y[v].glyphs===void 0&&(y[v].glyphs={}),y[v].glyphs[w]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics},y[v].ascender=this.entries[v].ascender,y[v].descender=this.entries[v].descender;o(null,y)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==l1.none&&(this.localGlyphMode===l1.all?!!this.localFontFamily:!!this.localFontFamily&&(bt["CJK Unified Ideographs"](n)||bt["Hangul Syllables"](n)||bt.Hiragana(n)||bt.Katakana(n)||bt["CJK Symbols and Punctuation"](n)))}_tinySDF(n,o,c){const d=this.localFontFamily;if(!d||!this._doesCharSupportLocalGlyph(c))return;let f=n.tinySDF;if(!f){let U="400";/bold/i.test(o)?U="900":/medium/i.test(o)?U="500":/light/i.test(o)&&(U="200"),f=n.tinySDF=new wd.TinySDF({fontFamily:d,fontWeight:U,fontSize:24*Fs,buffer:3*Fs,radius:8*Fs}),f.fontWeight=U}if(this.localGlyphs[f.fontWeight][c])return this.localGlyphs[f.fontWeight][c];const y=String.fromCharCode(c),{data:v,width:w,height:S,glyphWidth:k,glyphHeight:M,glyphLeft:P,glyphTop:B,glyphAdvance:j}=f.draw(y);return this.localGlyphs[f.fontWeight][c]={id:c,bitmap:new Ba({width:w,height:S},v),metrics:{width:k/Fs,height:M/Fs,left:P/Fs,top:B/Fs-27,advance:j/Fs,localGlyph:!0}}}}wd.loadGlyphRange=function(i,n,o,c,d){const f=256*n,y=f+255,v=c.transformRequest(c.normalizeGlyphsURL(o).replace("{fontstack}",i).replace("{range}",`${f}-${y}`),Gt.Glyphs);vs(v,(w,S)=>{if(w)d(w);else if(S){const k={},M=function(P){return new py(P).readFields(O3,{})}(S);for(const P of M.glyphs)k[P.id]=P;d(null,{glyphs:k,ascender:M.ascender,descender:M.descender})}})},wd.TinySDF=class{constructor({fontSize:i=24,buffer:n=3,radius:o=8,cutoff:c=.25,fontFamily:d="sans-serif",fontWeight:f="normal",fontStyle:y="normal"}={}){this.buffer=n,this.cutoff=c,this.radius=o;const v=this.size=i+4*n,w=this._createCanvas(v),S=this.ctx=w.getContext("2d",{willReadFrequently:!0});S.font=`${y} ${f} ${i}px ${d}`,S.textBaseline="alphabetic",S.textAlign="left",S.fillStyle="black",this.gridOuter=new Float64Array(v*v),this.gridInner=new Float64Array(v*v),this.f=new Float64Array(v),this.z=new Float64Array(v+1),this.v=new Uint16Array(v)}_createCanvas(i){const n=document.createElement("canvas");return n.width=n.height=i,n}draw(i){const{width:n,actualBoundingBoxAscent:o,actualBoundingBoxDescent:c,actualBoundingBoxLeft:d,actualBoundingBoxRight:f}=this.ctx.measureText(i),y=Math.ceil(o),v=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-d))),w=Math.min(this.size-this.buffer,y+Math.ceil(c)),S=v+2*this.buffer,k=w+2*this.buffer,M=Math.max(S*k,0),P=new Uint8ClampedArray(M),B={data:P,width:S,height:k,glyphWidth:v,glyphHeight:w,glyphTop:y,glyphLeft:0,glyphAdvance:n};if(v===0||w===0)return B;const{ctx:j,buffer:U,gridInner:Q,gridOuter:ae}=this;j.clearRect(U,U,v,w),j.fillText(i,U,U+y);const ge=j.getImageData(U,U,v,w);ae.fill(lf,0,M),Q.fill(0,0,M);for(let le=0;le<w;le++)for(let fe=0;fe<v;fe++){const be=ge.data[4*(le*v+fe)+3]/255;if(be===0)continue;const ve=(le+U)*S+fe+U;if(be===1)ae[ve]=0,Q[ve]=lf;else{const Ne=.5-be;ae[ve]=Ne>0?Ne*Ne:0,Q[ve]=Ne<0?Ne*Ne:0}}VT(ae,0,0,S,k,S,this.f,this.v,this.z),VT(Q,U,U,v,w,S,this.f,this.v,this.z);for(let le=0;le<M;le++){const fe=Math.sqrt(ae[le])-Math.sqrt(Q[le]);P[le]=Math.round(255-255*(fe/this.radius+this.cutoff))}return B}};const Sd=to;function GT(i,n,o,c){const d=[],f=i.image,y=f.pixelRatio,v=f.paddedRect.w-2*Sd,w=f.paddedRect.h-2*Sd,S=i.right-i.left,k=i.bottom-i.top,M=f.stretchX||[[0,v]],P=f.stretchY||[[0,w]],B=(Ue,Ye)=>Ue+Ye[1]-Ye[0],j=M.reduce(B,0),U=P.reduce(B,0),Q=v-j,ae=w-U;let ge=0,le=j,fe=0,be=U,ve=0,Ne=Q,Be=0,He=ae;if(f.content&&c){const Ue=f.content;ge=my(M,0,Ue[0]),fe=my(P,0,Ue[1]),le=my(M,Ue[0],Ue[2]),be=my(P,Ue[1],Ue[3]),ve=Ue[0]-ge,Be=Ue[1]-fe,Ne=Ue[2]-Ue[0]-le,He=Ue[3]-Ue[1]-be}const it=(Ue,Ye,Je,tt)=>{const dt=gy(Ue.stretch-ge,le,S,i.left),We=yy(Ue.fixed-ve,Ne,Ue.stretch,j),xt=gy(Ye.stretch-fe,be,k,i.top),Mt=yy(Ye.fixed-Be,He,Ye.stretch,U),vt=gy(Je.stretch-ge,le,S,i.left),Yt=yy(Je.fixed-ve,Ne,Je.stretch,j),ht=gy(tt.stretch-fe,be,k,i.top),Ft=yy(tt.fixed-Be,He,tt.stretch,U),Jt=new ye(dt,xt),vn=new ye(vt,xt),Qt=new ye(vt,ht),Vt=new ye(dt,ht),Qn=new ye(We/y,Mt/y),rn=new ye(Yt/y,Ft/y),on=n*Math.PI/180;if(on){const Xn=Math.sin(on),Vn=Math.cos(on),dr=[Vn,-Xn,Xn,Vn];Jt._matMult(dr),vn._matMult(dr),Vt._matMult(dr),Qt._matMult(dr)}const Un=Ue.stretch+Ue.fixed,Zn=Ye.stretch+Ye.fixed;return{tl:Jt,tr:vn,bl:Vt,br:Qt,tex:{x:f.paddedRect.x+Sd+Un,y:f.paddedRect.y+Sd+Zn,w:Je.stretch+Je.fixed-Un,h:tt.stretch+tt.fixed-Zn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Qn,pixelOffsetBR:rn,minFontScaleX:Ne/y/S,minFontScaleY:He/y/k,isSDF:o}};if(c&&(f.stretchX||f.stretchY)){const Ue=qT(M,Q,j),Ye=qT(P,ae,U);for(let Je=0;Je<Ue.length-1;Je++){const tt=Ue[Je],dt=Ue[Je+1];for(let We=0;We<Ye.length-1;We++)d.push(it(tt,Ye[We],dt,Ye[We+1]))}}else d.push(it({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:w+1}));return d}function my(i,n,o){let c=0;for(const d of i)c+=Math.max(n,Math.min(o,d[1]))-Math.max(n,Math.min(o,d[0]));return c}function qT(i,n,o){const c=[{fixed:-Sd,stretch:0}];for(const[d,f]of i){const y=c[c.length-1];c.push({fixed:d-y.stretch,stretch:y.stretch}),c.push({fixed:d-y.stretch,stretch:y.stretch+(f-d)})}return c.push({fixed:n+Sd,stretch:o}),c}function gy(i,n,o,c){return i/n*o+c}function yy(i,n,o,c){return i-n*o/c}function W3(i,n,o,c){const d=n+i.positionedLines[c].lineOffset;return c===0?o+d/2:o+(d+(n+i.positionedLines[c-1].lineOffset))/2}class G3{constructor(n=[],o=q3){if(this.data=n,this.length=this.data.length,this.compare=o,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(n){this.data.push(n),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const n=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:o,compare:c}=this,d=o[n];for(;n>0;){const f=n-1>>1,y=o[f];if(c(d,y)>=0)break;o[n]=y,n=f}o[n]=d}_down(n){const{data:o,compare:c}=this,d=this.length>>1,f=o[n];for(;n<d;){let y=1+(n<<1),v=o[y];const w=y+1;if(w<this.length&&c(o[w],v)<0&&(y=w,v=o[w]),c(v,f)>=0)break;o[n]=v,n=y}o[n]=f}}function q3(i,n){return i<n?-1:i>n?1:0}function H3(i,n=1,o=!1){let c=1/0,d=1/0,f=-1/0,y=-1/0;const v=i[0];for(let B=0;B<v.length;B++){const j=v[B];(!B||j.x<c)&&(c=j.x),(!B||j.y<d)&&(d=j.y),(!B||j.x>f)&&(f=j.x),(!B||j.y>y)&&(y=j.y)}const w=Math.min(f-c,y-d);let S=w/2;const k=new G3([],Z3);if(w===0)return new ye(c,d);for(let B=c;B<f;B+=w)for(let j=d;j<y;j+=w)k.push(new Ed(B+S,j+S,S,i));let M=function(B){let j=0,U=0,Q=0;const ae=B[0];for(let ge=0,le=ae.length,fe=le-1;ge<le;fe=ge++){const be=ae[ge],ve=ae[fe],Ne=be.x*ve.y-ve.x*be.y;U+=(be.x+ve.x)*Ne,Q+=(be.y+ve.y)*Ne,j+=3*Ne}return new Ed(U/j,Q/j,0,B)}(i),P=k.length;for(;k.length;){const B=k.pop();(B.d>M.d||!M.d)&&(M=B,o&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,P)),B.max-M.d<=n||(S=B.h/2,k.push(new Ed(B.p.x-S,B.p.y-S,S,i)),k.push(new Ed(B.p.x+S,B.p.y-S,S,i)),k.push(new Ed(B.p.x-S,B.p.y+S,S,i)),k.push(new Ed(B.p.x+S,B.p.y+S,S,i)),P+=4)}return o&&(console.log(`num probes: ${P}`),console.log(`best distance: ${M.d}`)),M.p}function Z3(i,n){return n.max-i.max}class Ed{constructor(n,o,c,d){this.p=new ye(n,o),this.h=c,this.d=function(f,y){let v=!1,w=1/0;for(let S=0;S<y.length;S++){const k=y[S];for(let M=0,P=k.length,B=P-1;M<P;B=M++){const j=k[M],U=k[B];j.y>f.y!=U.y>f.y&&f.x<(U.x-j.x)*(f.y-j.y)/(U.y-j.y)+j.x&&(v=!v),w=Math.min(w,$E(f,j,U))}}return(v?1:-1)*Math.sqrt(w)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}}const Td=7,c1=Number.POSITIVE_INFINITY,X3=Math.sqrt(2);function HT(i,[n,o]){let c=0,d=0;if(o===c1){n<0&&(n=0);const f=n/X3;switch(i){case"top-right":case"top-left":d=f-Td;break;case"bottom-right":case"bottom-left":d=-f+Td;break;case"bottom":d=-n+Td;break;case"top":d=n-Td}switch(i){case"top-right":case"bottom-right":c=-f;break;case"top-left":case"bottom-left":c=f;break;case"left":c=n;break;case"right":c=-n}}else{switch(n=Math.abs(n),o=Math.abs(o),i){case"top-right":case"top-left":case"top":d=o-Td;break;case"bottom-right":case"bottom-left":case"bottom":d=-o+Td}switch(i){case"top-right":case"bottom-right":case"right":c=-n;break;case"top-left":case"bottom-left":case"left":c=n}}return[c,d]}function K3(i,n,o,c,d,f,y,v,w,S){i.createArrays(),i.tilePixelRatio=$t/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const k=i.layers[0].layout,M=i.layers[0]._unevaluatedLayout._values,P={};if(i.textSizeData.kind==="composite"){const{minZoom:U,maxZoom:Q}=i.textSizeData;P.compositeTextSizes=[M["text-size"].possiblyEvaluate(new A(U),v),M["text-size"].possiblyEvaluate(new A(Q),v)]}if(i.iconSizeData.kind==="composite"){const{minZoom:U,maxZoom:Q}=i.iconSizeData;P.compositeIconSizes=[M["icon-size"].possiblyEvaluate(new A(U),v),M["icon-size"].possiblyEvaluate(new A(Q),v)]}P.layoutTextSize=M["text-size"].possiblyEvaluate(new A(w+1),v),P.layoutIconSize=M["icon-size"].possiblyEvaluate(new A(w+1),v),P.textMaxSize=M["text-size"].possiblyEvaluate(new A(18),v);const B=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",j=k.get("text-size");for(const U of i.features){const Q=k.get("text-font").evaluate(U,{},v).join(","),ae=j.evaluate(U,{},v),ge=P.layoutTextSize.evaluate(U,{},v),le=(P.layoutIconSize.evaluate(U,{},v),{horizontal:{},vertical:void 0}),fe=U.text;let be,ve=[0,0];if(fe){const He=fe.toString(),it=k.get("text-letter-spacing").evaluate(U,{},v)*fi,Ue=k.get("text-line-height").evaluate(U,{},v)*fi,Ye=_v(He)?it:0,Je=k.get("text-anchor").evaluate(U,{},v),tt=k.get("text-variable-anchor");if(!tt){const vt=k.get("text-radial-offset").evaluate(U,{},v);ve=vt?HT(Je,[vt*fi,c1]):k.get("text-offset").evaluate(U,{},v).map(Yt=>Yt*fi)}let dt=B?"center":k.get("text-justify").evaluate(U,{},v);const We=k.get("symbol-placement")==="point",xt=We?k.get("text-max-width").evaluate(U,{},v)*fi:1/0,Mt=vt=>{i.allowVerticalPlacement&&Rp(He)&&(le.vertical=s1(fe,n,o,d,Q,xt,Ue,Je,vt,Ye,ve,Po.vertical,!0,ge,ae))};if(!B&&tt){const vt=dt==="auto"?tt.map(ht=>u1(ht)):[dt];let Yt=!1;for(let ht=0;ht<vt.length;ht++){const Ft=vt[ht];if(!le.horizontal[Ft])if(Yt)le.horizontal[Ft]=le.horizontal[0];else{const Jt=s1(fe,n,o,d,Q,xt,Ue,"center",Ft,Ye,ve,Po.horizontal,!1,ge,ae);Jt&&(le.horizontal[Ft]=Jt,Yt=Jt.positionedLines.length===1)}}Mt("left")}else{if(dt==="auto"&&(dt=u1(Je)),We||k.get("text-writing-mode").indexOf("horizontal")>=0||!Rp(He)){const vt=s1(fe,n,o,d,Q,xt,Ue,Je,dt,Ye,ve,Po.horizontal,!1,ge,ae);vt&&(le.horizontal[dt]=vt)}Mt(We?"left":dt)}}let Ne=!1;if(U.icon&&U.icon.name){const He=c[U.icon.name];He&&(be=$3(d[U.icon.name],k.get("icon-offset").evaluate(U,{},v),k.get("icon-anchor").evaluate(U,{},v)),Ne=He.sdf,i.sdfIcons===void 0?i.sdfIcons=He.sdf:i.sdfIcons!==He.sdf&&Kt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(He.pixelRatio!==i.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const Be=XT(le.horizontal)||le.vertical;i.iconsInText||(i.iconsInText=!!Be&&Be.iconsInText),(Be||be)&&Y3(i,U,le,be,c,P,ge,0,ve,Ne,y,v,S)}f&&i.generateCollisionDebugBuffers(w,i.collisionBoxArray)}function u1(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Y3(i,n,o,c,d,f,y,v,w,S,k,M,P){let B=f.textMaxSize.evaluate(n,{},M);B===void 0&&(B=y);const j=i.layers[0].layout,U=j.get("icon-offset").evaluate(n,{},M),Q=XT(o.horizontal)||o.vertical,ae=P.name==="globe",ge=fi,le=y/ge,fe=i.tilePixelRatio*B/ge,be=(Je=i.overscaling,i.zoom>18&&Je>2&&(Je>>=1),Math.max($t/(512*Je),1)*j.get("symbol-spacing")),ve=j.get("text-padding")*i.tilePixelRatio,Ne=j.get("icon-padding")*i.tilePixelRatio,Be=Ge(j.get("text-max-angle")),He=j.get("text-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",it=j.get("icon-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",Ue=j.get("symbol-placement"),Ye=be/2;var Je;const tt=j.get("icon-text-fit");let dt;c&&tt!=="none"&&(i.allowVerticalPlacement&&o.vertical&&(dt=OT(c,o.vertical,tt,j.get("icon-text-fit-padding"),U,le)),Q&&(c=OT(c,Q,tt,j.get("icon-text-fit-padding"),U,le)));const We=(xt,Mt,vt)=>{if(Mt.x<0||Mt.x>=$t||Mt.y<0||Mt.y>=$t)return;let Yt=null;if(ae){const{x:ht,y:Ft,z:Jt}=P.projectTilePoint(Mt.x,Mt.y,vt);Yt={anchor:new ja(ht,Ft,Jt,0,void 0),up:P.upVector(vt,Mt.x,Mt.y)}}(function(ht,Ft,Jt,vn,Qt,Vt,Qn,rn,on,Un,Zn,Xn,Vn,dr,_r,Br,Wn,qr,Fr,pr,En,jr,Kn,Ui,Nr){const mi=ht.addToLineVertexArray(Ft,vn);let ii,Vi,oi,Ns,Id,yf,_f,IC=0,AC=0,MC=0,PC=0,T1=-1,C1=-1;const ca={};let RC=bv("");const Jc=Jt?Jt.anchor:Ft;let k1=0,I1=0;if(on._unevaluatedLayout.getValue("text-radial-offset")===void 0?[k1,I1]=on.layout.get("text-offset").evaluate(En,{},Nr).map(go=>go*fi):(k1=on.layout.get("text-radial-offset").evaluate(En,{},Nr)*fi,I1=c1),ht.allowVerticalPlacement&&Qt.vertical){const go=Qt.vertical;if(_r)yf=d1(go),rn&&(_f=d1(rn));else{const yo=on.layout.get("text-rotate").evaluate(En,{},Nr)+90;oi=_y(Un,Jc,Ft,Zn,Xn,Vn,go,dr,yo,Br),rn&&(Ns=_y(Un,Jc,Ft,Zn,Xn,Vn,rn,qr,yo))}}if(Vt){const go=on.layout.get("icon-rotate").evaluate(En,{},Nr),yo=on.layout.get("icon-text-fit")!=="none",xf=GT(Vt,go,Kn,yo),M1=rn?GT(rn,go,Kn,yo):void 0;Vi=_y(Un,Jc,Ft,Zn,Xn,Vn,Vt,qr,go),IC=4*xf.length;const zC=ht.iconSizeData;let Qc=null;zC.kind==="source"?(Qc=[Bs*on.layout.get("icon-size").evaluate(En,{},Nr)],Qc[0]>Cl&&Kt(`${ht.layerIds[0]}: Value for "icon-size" is >= ${cf}. Reduce your "icon-size".`)):zC.kind==="composite"&&(Qc=[Bs*jr.compositeIconSizes[0].evaluate(En,{},Nr),Bs*jr.compositeIconSizes[1].evaluate(En,{},Nr)],(Qc[0]>Cl||Qc[1]>Cl)&&Kt(`${ht.layerIds[0]}: Value for "icon-size" is >= ${cf}. Reduce your "icon-size".`)),ht.addSymbols(ht.icon,xf,Qc,pr,Fr,En,!1,Jt,Ft,mi.lineStartIndex,mi.lineLength,-1,Ui,Nr),T1=ht.icon.placedSymbolArray.length-1,M1&&(AC=4*M1.length,ht.addSymbols(ht.icon,M1,Qc,pr,Fr,En,Po.vertical,Jt,Ft,mi.lineStartIndex,mi.lineLength,-1,Ui,Nr),C1=ht.icon.placedSymbolArray.length-1)}for(const go in Qt.horizontal){const yo=Qt.horizontal[go];ii||(RC=bv(yo.text),_r?Id=d1(yo):ii=_y(Un,Jc,Ft,Zn,Xn,Vn,yo,dr,on.layout.get("text-rotate").evaluate(En,{},Nr),Br));const xf=yo.positionedLines.length===1;if(MC+=ZT(ht,Jt,Ft,yo,Qn,on,_r,En,Br,mi,Qt.vertical?Po.horizontal:Po.horizontalOnly,xf?Object.keys(Qt.horizontal):[go],ca,T1,jr,Ui,Nr),xf)break}Qt.vertical&&(PC+=ZT(ht,Jt,Ft,Qt.vertical,Qn,on,_r,En,Br,mi,Po.vertical,["vertical"],ca,C1,jr,Ui,Nr));let Rl=-1;const A1=(go,yo)=>go?Math.max(go,yo):yo;Rl=A1(Id,Rl),Rl=A1(yf,Rl),Rl=A1(_f,Rl);const TO=Rl>-1?1:0;ht.glyphOffsetArray.length>=Il.MAX_GLYPHS&&Kt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),En.sortKey!==void 0&&ht.addToSortKeyRanges(ht.symbolInstances.length,En.sortKey),ht.symbolInstances.emplaceBack(Jc.x,Jc.y,Jc.z,Ft.x,Ft.y,ca.right>=0?ca.right:-1,ca.center>=0?ca.center:-1,ca.left>=0?ca.left:-1,ca.vertical>=0?ca.vertical:-1,T1,C1,RC,ii!==void 0?ii:ht.collisionBoxArray.length,ii!==void 0?ii+1:ht.collisionBoxArray.length,oi!==void 0?oi:ht.collisionBoxArray.length,oi!==void 0?oi+1:ht.collisionBoxArray.length,Vi!==void 0?Vi:ht.collisionBoxArray.length,Vi!==void 0?Vi+1:ht.collisionBoxArray.length,Ns||ht.collisionBoxArray.length,Ns?Ns+1:ht.collisionBoxArray.length,Zn,MC,PC,IC,AC,TO,0,k1,I1,Rl)})(i,Mt,Yt,xt,o,c,d,dt,i.layers[0],i.collisionBoxArray,n.index,n.sourceLayerIndex,i.index,ve,He,w,0,Ne,it,U,n,f,S,k,M)};if(Ue==="line")for(const xt of UT(n.geometry,0,0,$t,$t)){const Mt=V3(xt,be,Be,o.vertical||Q,c,ge,fe,i.overscaling,$t);for(const vt of Mt)Q&&J3(i,Q.text,Ye,vt)||We(xt,vt,M)}else if(Ue==="line-center"){for(const xt of n.geometry)if(xt.length>1){const Mt=U3(xt,Be,o.vertical||Q,c,ge,fe);Mt&&We(xt,Mt,M)}}else if(n.type==="Polygon")for(const xt of Yv(n.geometry,0)){const Mt=H3(xt,16);We(xt[0],new ja(Mt.x,Mt.y,0,0,void 0),M)}else if(n.type==="LineString")for(const xt of n.geometry)We(xt,new ja(xt[0].x,xt[0].y,0,0,void 0),M);else if(n.type==="Point")for(const xt of n.geometry)for(const Mt of xt)We([Mt],new ja(Mt.x,Mt.y,0,0,void 0),M)}const cf=255,Cl=cf*Bs;function ZT(i,n,o,c,d,f,y,v,w,S,k,M,P,B,j,U,Q){const ae=function(fe,be,ve,Ne,Be,He,it,Ue){const Ye=[];if(be.positionedLines.length===0)return Ye;const Je=Ne.layout.get("text-rotate").evaluate(He,{})*Math.PI/180,tt=function(vt){const Yt=vt[0],ht=vt[1],Ft=Yt*ht;return Ft>0?[Yt,-ht]:Ft<0?[-Yt,ht]:Yt===0?[ht,Yt]:[ht,-Yt]}(ve);let dt=Math.abs(be.top-be.bottom);for(const vt of be.positionedLines)dt-=vt.lineOffset;const We=be.positionedLines.length,xt=dt/We;let Mt=be.top-ve[1];for(let vt=0;vt<We;++vt){const Yt=be.positionedLines[vt];Mt=W3(be,xt,Mt,vt);for(const ht of Yt.positionedGlyphs){if(!ht.rect)continue;const Ft=ht.rect||{};let Jt=IT+1,vn=!0,Qt=1,Vt=0;if(ht.imageName){const Kn=it[ht.imageName];if(!Kn)continue;if(Kn.sdf){Kt("SDF images are not supported in formatted text and will be ignored.");continue}vn=!1,Qt=Kn.pixelRatio,Jt=to/Qt}const Qn=(Be||Ue)&&ht.vertical,rn=ht.metrics.advance*ht.scale/2,on=ht.metrics,Un=ht.rect;if(Un===null)continue;Ue&&be.verticalizable&&(Vt=ht.imageName?rn-ht.metrics.width*ht.scale/2:0);const Zn=Be?[ht.x+rn,ht.y]:[0,0];let Xn=[0,0],Vn=[0,0],dr=!1;Be||(Qn?(Vn=[ht.x+rn+tt[0],ht.y+tt[1]-Vt],dr=!0):Xn=[ht.x+rn+ve[0],ht.y+ve[1]-Vt]);const _r=Un.w*ht.scale/(Qt*(ht.localGlyph?Fs:1)),Br=Un.h*ht.scale/(Qt*(ht.localGlyph?Fs:1));let Wn,qr,Fr,pr;if(Qn){const Kn=ht.y-Mt,Ui=new ye(-rn,rn-Kn),Nr=-Math.PI/2,mi=new ye(...Vn);Wn=new ye(-rn+Xn[0],Xn[1]),Wn._rotateAround(Nr,Ui)._add(mi),Wn.x+=-Kn+rn,Wn.y-=(on.left-Jt)*ht.scale;const ii=ht.imageName?on.advance*ht.scale:fi*ht.scale,Vi=String.fromCharCode(ht.glyph);T3(Vi)?Wn.x+=(1-Jt)*ht.scale:C3(Vi)?Wn.x+=ii-on.height*ht.scale+(-Jt-1)*ht.scale:Wn.x+=ht.imageName||on.width+2*Jt===Un.w&&on.height+2*Jt===Un.h?(ii-Br)/2:(ii-(on.height+2*Jt)*ht.scale)/2,qr=new ye(Wn.x,Wn.y-_r),Fr=new ye(Wn.x+Br,Wn.y),pr=new ye(Wn.x+Br,Wn.y-_r)}else{const Kn=(on.left-Jt)*ht.scale-rn+Xn[0],Ui=(-on.top-Jt)*ht.scale+Xn[1],Nr=Kn+_r,mi=Ui+Br;Wn=new ye(Kn,Ui),qr=new ye(Nr,Ui),Fr=new ye(Kn,mi),pr=new ye(Nr,mi)}if(Je){let Kn;Kn=Be?new ye(0,0):dr?new ye(tt[0],tt[1]):new ye(ve[0],ve[1]),Wn._rotateAround(Je,Kn),qr._rotateAround(Je,Kn),Fr._rotateAround(Je,Kn),pr._rotateAround(Je,Kn)}const En=new ye(0,0),jr=new ye(0,0);Ye.push({tl:Wn,tr:qr,bl:Fr,br:pr,tex:Ft,writingMode:be.writingMode,glyphOffset:Zn,sectionIndex:ht.sectionIndex,isSDF:vn,pixelOffsetTL:En,pixelOffsetBR:jr,minFontScaleX:0,minFontScaleY:0})}}return Ye}(0,c,w,f,y,v,d,i.allowVerticalPlacement),ge=i.textSizeData;let le=null;ge.kind==="source"?(le=[Bs*f.layout.get("text-size").evaluate(v,{},Q)],le[0]>Cl&&Kt(`${i.layerIds[0]}: Value for "text-size" is >= ${cf}. Reduce your "text-size".`)):ge.kind==="composite"&&(le=[Bs*j.compositeTextSizes[0].evaluate(v,{},Q),Bs*j.compositeTextSizes[1].evaluate(v,{},Q)],(le[0]>Cl||le[1]>Cl)&&Kt(`${i.layerIds[0]}: Value for "text-size" is >= ${cf}. Reduce your "text-size".`)),i.addSymbols(i.text,ae,le,w,y,v,k,n,o,S.lineStartIndex,S.lineLength,B,U,Q);for(const fe of M)P[fe]=i.text.placedSymbolArray.length-1;return 4*ae.length}function XT(i){for(const n in i)return i[n];return null}function _y(i,n,o,c,d,f,y,v,w,S){let k=y.top,M=y.bottom,P=y.left,B=y.right;const j=y.collisionPadding;if(j&&(P-=j[0],k-=j[1],B+=j[2],M+=j[3]),w){const U=new ye(P,k),Q=new ye(B,k),ae=new ye(P,M),ge=new ye(B,M),le=Ge(w);let fe=new ye(0,0);S&&(fe=new ye(S[0],S[1])),U._rotateAround(le,fe),Q._rotateAround(le,fe),ae._rotateAround(le,fe),ge._rotateAround(le,fe),P=Math.min(U.x,Q.x,ae.x,ge.x),B=Math.max(U.x,Q.x,ae.x,ge.x),k=Math.min(U.y,Q.y,ae.y,ge.y),M=Math.max(U.y,Q.y,ae.y,ge.y)}return i.emplaceBack(n.x,n.y,n.z,o.x,o.y,P,k,B,M,v,c,d,f),i.length-1}function d1(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const n=i.bottom-i.top;return n>0?Math.max(10,n):null}function J3(i,n,o,c){const d=i.compareText;if(n in d){const f=d[n];for(let y=f.length-1;y>=0;y--)if(c.dist(f[y])<o)return!0}else d[n]=[];return d[n].push(c),!1}function KT(i,n){const o=i.fovAboveCenter,c=i.elevation?i.elevation.getMinElevationBelowMSL()*n:0,d=(i._camera.position[2]*i.worldSize-c)/Math.cos(i._pitch),f=Math.sin(o)*d/Math.sin(Math.max(Math.PI/2-i._pitch-o,.01)),y=Math.sin(i._pitch)*f+d;return Math.min(1.01*y,d*(1/i._horizonShift))}function Kc(i,n){if(!n.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:n};const o=Math.pow(2,-i.z),c=i.x*o,d=(i.x+1)*o,f=i.y*o,y=(i.y+1)*o,v=Mo(c),w=Mo(d),S=wi(f),k=wi(y),M=n.project(v,S),P=n.project(w,S),B=n.project(w,k),j=n.project(v,k);let U=Math.min(M.x,P.x,B.x,j.x),Q=Math.min(M.y,P.y,B.y,j.y),ae=Math.max(M.x,P.x,B.x,j.x),ge=Math.max(M.y,P.y,B.y,j.y);const le=o/16;function fe(ve,Ne,Be,He,it,Ue){const Ye=(Be+it)/2,Je=(He+Ue)/2,tt=n.project(Mo(Ye),wi(Je)),dt=Math.max(0,U-tt.x,Q-tt.y,tt.x-ae,tt.y-ge);U=Math.min(U,tt.x),ae=Math.max(ae,tt.x),Q=Math.min(Q,tt.y),ge=Math.max(ge,tt.y),dt>le&&(fe(ve,tt,Be,He,Ye,Je),fe(tt,Ne,Ye,Je,it,Ue))}fe(M,P,c,f,d,f),fe(P,B,d,f,d,y),fe(B,j,d,y,c,y),fe(j,M,c,y,c,f),U-=le,Q-=le,ae+=le,ge+=le;const be=1/Math.max(ae-U,ge-Q);return{scale:be,x:U*be,y:Q*be,x2:ae*be,y2:ge*be,projection:n}}const Q3=Ls(new Float32Array(16));class kl{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,o){return{x:0,y:0,z:0}}unproject(n,o){return new $n(0,0)}projectTilePoint(n,o,c){return{x:n,y:o,z:0}}locationPoint(n,o,c=!0){return n._coordinatePoint(n.locationCoordinate(o),c)}pixelsPerMeter(n,o){return Os(1,n)*o}pixelSpaceConversion(n,o,c){return 1}farthestPixelDistance(n){return KT(n,n.pixelsPerMeter)}pointCoordinate(n,o,c,d){const f=n.horizonLineFromTop(!1),y=new ye(o,Math.max(f,c));return n.rayIntersectionCoordinate(n.pointRayIntersection(y,d))}pointCoordinate3D(n,o,c){const d=new ye(o,c);if(n.elevation)return n.elevation.pointCoordinate(d);{const f=this.pointCoordinate(n,d.x,d.y,0);return[f.x,f.y,f.z]}}isPointAboveHorizon(n,o){if(n.elevation)return!this.pointCoordinate3D(n,o.x,o.y);const c=n.horizonLineFromTop();return o.y<c}createInversionMatrix(n,o){return Q3}createTileMatrix(n,o,c){let d,f,y;const v=c.canonical,w=Ls(new Float64Array(16));if(this.isReprojectedInTileSpace){const S=Kc(v,this);d=1,f=S.x+c.wrap*S.scale,y=S.y,Vc(w,w,[d/S.scale,d/S.scale,n.pixelsPerMeter/o])}else d=o/n.zoomScale(v.z),f=(v.x+Math.pow(2,v.z)*c.wrap)*d,y=v.y*d;return jp(w,w,[f,y,0]),Vc(w,w,[d/$t,d/$t,1]),w}upVector(n,o,c){return[0,0,1]}upVectorScale(n,o,c){return{metersToTile:1}}}class eO extends kl{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[o,c]=this.parallels=n.parallels||[29.5,45.5],d=Math.sin(Ge(o));this.n=(d+Math.sin(Ge(c)))/2,this.c=1+d*(2*this.n-d),this.r0=Math.sqrt(this.c)/this.n}project(n,o){const{n:c,c:d,r0:f}=this,y=Ge(n-this.center[0]),v=Ge(o),w=Math.sqrt(d-2*c*Math.sin(v))/c;return{x:w*Math.sin(y*c),y:w*Math.cos(y*c)-f,z:0}}unproject(n,o){const{n:c,c:d,r0:f}=this,y=f+o;let v=Math.atan2(n,Math.abs(y))*Math.sign(y);y*c<0&&(v-=Math.PI*Math.sign(n)*Math.sign(y));const w=Ge(this.center[0])*c;v=Ie(v,-Math.PI-w,Math.PI-w);const S=Re(et(v/c)+this.center[0],-180,180),k=Math.asin(Re((d-(n*n+y*y)*c*c)/(2*c),-1,1)),M=Re(et(k),-Si,Si);return new $n(S,M)}}const uf=1.340264,df=-.081106,hf=893e-6,pf=.003796,xy=Math.sqrt(3)/2;class tO extends kl{project(n,o){o=o/180*Math.PI,n=n/180*Math.PI;const c=Math.asin(xy*Math.sin(o)),d=c*c,f=d*d*d;return{x:.5*(n*Math.cos(c)/(xy*(uf+3*df*d+f*(7*hf+9*pf*d)))/Math.PI+.5),y:1-.5*(c*(uf+df*d+f*(hf+pf*d))/Math.PI+1),z:0}}unproject(n,o){n=(2*n-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,d=c*c,f=d*d*d;for(let k,M,P,B=0;B<12&&(M=c*(uf+df*d+f*(hf+pf*d))-o,P=uf+3*df*d+f*(7*hf+9*pf*d),k=M/P,c=Re(c-k,-Math.PI/3,Math.PI/3),d=c*c,f=d*d*d,!(Math.abs(k)<1e-12));++B);const y=xy*n*(uf+3*df*d+f*(7*hf+9*pf*d))/Math.cos(c),v=Math.asin(Math.sin(c)/xy),w=Re(180*y/Math.PI,-180,180),S=Re(180*v/Math.PI,-Si,Si);return new $n(w,S)}}class nO extends kl{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,o){return{x:.5+n/360,y:.5-o/360,z:0}}unproject(n,o){const c=360*(n-.5),d=Re(360*(.5-o),-Si,Si);return new $n(c,d)}}const Cd=Math.PI/2;function vy(i){return Math.tan((Cd+i)/2)}class rO extends kl{constructor(n){super(n),this.center=n.center||[0,30];const[o,c]=this.parallels=n.parallels||[30,30];let d=Ge(o),f=Ge(c);this.southernCenter=d+f<0,this.southernCenter&&(d=-d,f=-f);const y=Math.cos(d),v=vy(d);this.n=d===f?Math.sin(d):Math.log(y/Math.cos(f))/Math.log(vy(f)/v),this.f=y*Math.pow(vy(d),this.n)/this.n}project(n,o){o=Ge(o),this.southernCenter&&(o=-o),n=Ge(n-this.center[0]);const c=1e-6,{n:d,f}=this;f>0?o<-Cd+c&&(o=-Cd+c):o>Cd-c&&(o=Cd-c);const y=f/Math.pow(vy(o),d);let v=y*Math.sin(d*n),w=f-y*Math.cos(d*n);return v=.5*(v/Math.PI+.5),w=.5*(w/Math.PI+.5),{x:v,y:this.southernCenter?w:1-w,z:0}}unproject(n,o){n=(2*n-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:c,f:d}=this,f=d-o,y=Math.sign(f),v=Math.sign(c)*Math.sqrt(n*n+f*f);let w=Math.atan2(n,Math.abs(f))*y;f*c<0&&(w-=Math.PI*Math.sign(n)*y);const S=Re(et(w/c)+this.center[0],-180,180),k=Re(et(2*Math.atan(Math.pow(d/v,1/c))-Cd),-Si,Si);return new $n(S,this.southernCenter?-k:k)}}class YT extends kl{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,o){return{x:ia(n),y:oa(o),z:0}}unproject(n,o){const c=Mo(n),d=wi(o);return new $n(c,d)}}const JT=Ge(Si);class iO extends kl{project(n,o){const c=(o=Ge(o))*o,d=c*c;return{x:.5*((n=Ge(n))*(.8707-.131979*c+d*(d*(.003971*c-.001529*d)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+c*(.015085+d*(.028874*c-.044475-.005916*d)))/Math.PI+1),z:0}}unproject(n,o){n=(2*n-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,d=25,f=0,y=c*c;do{y=c*c;const S=y*y;f=(c*(1.007226+y*(.015085+S*(.028874*y-.044475-.005916*S)))-o)/(1.007226+y*(.045255+S*(.259866*y-.311325-.005916*11*S))),c=Re(c-f,-JT,JT)}while(Math.abs(f)>1e-6&&--d>0);y=c*c;const v=Re(et(n/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),w=et(c);return new $n(v,w)}}const QT=Ge(Si);class oO extends kl{project(n,o){o=Ge(o),n=Ge(n);const c=Math.cos(o),d=2/Math.PI,f=Math.acos(c*Math.cos(n/2)),y=Math.sin(f)/f,v=.5*(n*d+2*c*Math.sin(n/2)/y)||0,w=.5*(o+Math.sin(o)/y)||0;return{x:.5*(v/Math.PI+.5),y:1-.5*(w/Math.PI+1),z:0}}unproject(n,o){let c=n=(2*n-.5)*Math.PI,d=o=(2*(1-o)-1)*Math.PI,f=25;const y=1e-6;let v=0,w=0;do{const S=Math.cos(d),k=Math.sin(d),M=2*k*S,P=k*k,B=S*S,j=Math.cos(c/2),U=Math.sin(c/2),Q=2*j*U,ae=U*U,ge=1-B*j*j,le=ge?1/ge:0,fe=ge?Math.acos(S*j)*Math.sqrt(1/ge):0,be=.5*(2*fe*S*U+2*c/Math.PI)-n,ve=.5*(fe*k+d)-o,Ne=.5*le*(B*ae+fe*S*j*P)+1/Math.PI,Be=le*(Q*M/4-fe*k*U),He=.125*le*(M*U-fe*k*B*Q),it=.5*le*(P*j+fe*ae*S)+.5,Ue=Be*He-it*Ne;v=(ve*Be-be*it)/Ue,w=(be*He-ve*Ne)/Ue,c=Re(c-v,-Math.PI,Math.PI),d=Re(d-w,-QT,QT)}while((Math.abs(v)>y||Math.abs(w)>y)&&--f>0);return new $n(et(c),et(d))}}class eC extends kl{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ge(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,o){const{scale:c,cosPhi:d}=this;return{x:Ge(n)*d*c+.5,y:-Math.sin(Ge(o))/d*c+.5,z:0}}unproject(n,o){const{scale:c,cosPhi:d}=this,f=-(o-.5)/c,y=Re(et((n-.5)/c)/d,-180,180),v=Math.asin(Re(f*d,-1,1)),w=Re(et(v),-Si,Si);return new $n(y,w)}}class sO extends YT{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,o,c){const d=Hp(n,o,c);return Cr(d,d,Zp(ra(c))),{x:d[0],y:d[1],z:d[2]}}locationPoint(n,o){const c=dd(o.lat,o.lng),d=ji([],c),f=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(o),n._centerAltitude):n._centerAltitude;Vp(c,c,d,Os(1,0)*$t*f);const y=Ls(new Float64Array(16));return Uc(y,n.pixelMatrix,n.globeMatrix),Cr(c,c,y),new ye(c[0],c[1])}pixelsPerMeter(n,o){return Os(1,0)*o}pixelSpaceConversion(n,o,c){const d=Os(1,n)*o,f=gn(Os(1,45)*o,d,c);return this.pixelsPerMeter(n,o)/f}createTileMatrix(n,o,c){const d=Dv(ra(c.canonical));return Uc(new Float64Array(16),n.globeMatrix,d)}createInversionMatrix(n,o){const{center:c}=n,d=Zp(ra(o));return Zg(d,d,Ge(c.lng)),Tv(d,d,Ge(c.lat)),Vc(d,d,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(d)}pointCoordinate(n,o,c,d){return kE(n,o,c,!0)||new pd(0,0)}pointCoordinate3D(n,o,c){const d=this.pointCoordinate(n,o,c,0);return[d.x,d.y,d.z]}isPointAboveHorizon(n,o){return!kE(n,o.x,o.y,!1)}farthestPixelDistance(n){const o=function(d,f){const y=d.cameraToCenterDistance,v=d._centerAltitude*f,w=d._camera,S=d._camera.forward(),k=Da([],Ao([],S,-y),[0,0,v]),M=d.worldSize/(2*Math.PI),P=[0,0,-M],B=d.width/d.height,j=Math.tan(d.fovAboveCenter),U=Ao([],w.up(),j),Q=Ao([],w.right(),j*B),ae=ji([],Da([],Da([],S,U),Q)),ge=[];let le;if(new Av(k,ae).closestPointOnSphere(P,M,ge)){const fe=Da([],ge,P),be=Ds([],fe,k);le=Math.cos(d.fovAboveCenter)*Np(be)}else{const fe=Ds([],k,P),be=Ds([],P,k);ji(be,be);const ve=Np(fe)-M;le=Math.sqrt(ve*(ve+2*M));const Ne=Math.acos(le/(M+ve))-Math.acos(Qo(S,be));le*=Math.cos(Ne)}return 1.01*le}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),c=hd(n.zoom);if(c>0){const d=KT(n,Os(1,n.center.lat)*n.worldSize),f=n.worldSize/(2*Math.PI),y=Math.max(n.width,n.height)/n.worldSize*Math.PI;return gn(o,d+f*(1-Math.cos(y)),Math.pow(c,10))}return o}upVector(n,o,c){return Hp(o,c,n,1)}upVectorScale(n){return{metersToTile:Xg(Yg(ra(n)))}}}function tC(i){const n=i.parallels,o=!!n&&Math.abs(n[0]+n[1])<.01;switch(i.name){case"mercator":return new YT(i);case"equirectangular":return new nO(i);case"naturalEarth":return new iO(i);case"equalEarth":return new tO(i);case"winkelTripel":return new oO(i);case"albers":return o?new eC(i):new eO(i);case"lambertConformalConic":return o?new eC(i):new rO(i);case"globe":return new sO(i)}throw new Error(`Invalid projection name: ${i.name}`)}const aO=ay.types,lO=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function by(i,n,o,c,d,f,y,v,w,S,k,M,P){const B=v?Math.min(Cl,Math.round(v[0])):0,j=v?Math.min(Cl,Math.round(v[1])):0;i.emplaceBack(n,o,Math.round(32*c),Math.round(32*d),f,y,(B<<1)+(w?1:0),j,16*S,16*k,256*M,256*P)}function wy(i,n,o,c,d,f,y){i.emplaceBack(n,o,c,d,f,y)}function Sy(i,n,o,c,d){i.emplaceBack(n,o,c,d),i.emplaceBack(n,o,c,d),i.emplaceBack(n,o,c,d),i.emplaceBack(n,o,c,d)}function cO(i){for(const n of i.sections)if(vv(n.text))return!0;return!1}class h1{constructor(n){this.layoutVertexArray=new Qe,this.indexArray=new Lt,this.programConfigurations=n,this.segments=new Dr,this.dynamicLayoutVertexArray=new nt,this.opacityVertexArray=new Ot,this.placedSymbolArray=new Lr,this.globeExtVertexArray=new at}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,o,c,d){this.isEmpty()||(c&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,y3.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,x3.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,lO,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,_3.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||d)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}kt(h1,"SymbolBuffers");class p1{constructor(n,o,c){this.layoutVertexArray=new n,this.layoutAttributes=o,this.indexArray=new c,this.segments=new Dr,this.collisionVertexArray=new dn,this.collisionVertexArrayExt=new ln}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,v3.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,b3.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}kt(p1,"CollisionBuffers");class Il{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(y=>y.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ls([]),this.placementViewportMatrix=Ls([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=t1(this.zoom,o["text-size"]),this.iconSizeData=t1(this.zoom,o["icon-size"]);const c=this.layers[0].layout,d=c.get("symbol-sort-key"),f=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&d.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(y=>Po[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=n.sourceID,this.projection=n.projection}createArrays(){this.text=new h1(new $c(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new h1(new $c(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new Fi,this.lineVertexArray=new sd,this.symbolInstances=new tr}calculateGlyphDependencies(n,o,c,d,f){for(let y=0;y<n.length;y++)if(o[n.charCodeAt(y)]=!0,d&&f){const v=sf[n.charAt(y)];v&&(o[v.charCodeAt(0)]=!0)}}populate(n,o,c,d){const f=this.layers[0],y=f.layout,v=this.projection.name==="globe",w=y.get("text-font"),S=y.get("text-field"),k=y.get("icon-image"),M=(S.value.kind!=="constant"||S.value.value instanceof Bi&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),P=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,B=y.get("symbol-sort-key");if(this.features=[],!M&&!P)return;const j=o.iconDependencies,U=o.glyphDependencies,Q=o.availableImages,ae=new A(this.zoom);for(const{feature:ge,id:le,index:fe,sourceLayerIndex:be}of n){const ve=f._featureFilter.needGeometry,Ne=Hc(ge,ve);if(!f._featureFilter.filter(ae,Ne,c))continue;if(ve||(Ne.geometry=Oa(ge,c,d)),v&&ge.type!==1&&c.z<=5){const Ue=Ne.geometry,Ye=.98078528056,Je=(tt,dt)=>Qo(Hp(tt.x,tt.y,c,1),Hp(dt.x,dt.y,c,1))<Ye;for(let tt=0;tt<Ue.length;tt++)Ue[tt]=xD(Ue[tt],Je)}let Be,He;if(M){const Ue=f.getValueAndResolveTokens("text-field",Ne,c,Q),Ye=Bi.factory(Ue);cO(Ye)&&(this.hasRTLText=!0),(!this.hasRTLText||b()==="unavailable"||this.hasRTLText&&C.isParsed())&&(Be=E3(Ye,f,Ne))}if(P){const Ue=f.getValueAndResolveTokens("icon-image",Ne,c,Q);He=Ue instanceof co?Ue:co.fromString(Ue)}if(!Be&&!He)continue;const it=this.sortFeaturesByKey?B.evaluate(Ne,{},c):void 0;if(this.features.push({id:le,text:Be,icon:He,index:fe,sourceLayerIndex:be,geometry:Ne.geometry,properties:ge.properties,type:aO[ge.type],sortKey:it}),He&&(j[He.name]=!0),Be){const Ue=w.evaluate(Ne,{},c).join(","),Ye=y.get("text-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Po.vertical)>=0;for(const Je of Be.sections)if(Je.image)j[Je.image.name]=!0;else{const tt=Rp(Be.toString()),dt=Je.fontStack||Ue,We=U[dt]=U[dt]||{};this.calculateGlyphDependencies(Je.text,We,Ye,this.allowVerticalPlacement,tt)}}}y.get("symbol-placement")==="line"&&(this.features=function(ge){const le={},fe={},be=[];let ve=0;function Ne(Ue){be.push(ge[Ue]),ve++}function Be(Ue,Ye,Je){const tt=fe[Ue];return delete fe[Ue],fe[Ye]=tt,be[tt].geometry[0].pop(),be[tt].geometry[0]=be[tt].geometry[0].concat(Je[0]),tt}function He(Ue,Ye,Je){const tt=le[Ye];return delete le[Ye],le[Ue]=tt,be[tt].geometry[0].shift(),be[tt].geometry[0]=Je[0].concat(be[tt].geometry[0]),tt}function it(Ue,Ye,Je){const tt=Je?Ye[0][Ye[0].length-1]:Ye[0][0];return`${Ue}:${tt.x}:${tt.y}`}for(let Ue=0;Ue<ge.length;Ue++){const Ye=ge[Ue],Je=Ye.geometry,tt=Ye.text?Ye.text.toString():null;if(!tt){Ne(Ue);continue}const dt=it(tt,Je),We=it(tt,Je,!0);if(dt in fe&&We in le&&fe[dt]!==le[We]){const xt=He(dt,We,Je),Mt=Be(dt,We,be[xt].geometry);delete le[dt],delete fe[We],fe[it(tt,be[Mt].geometry,!0)]=Mt,be[xt].geometry=null}else dt in fe?Be(dt,We,Je):We in le?He(dt,We,Je):(Ne(Ue),le[dt]=ve-1,fe[We]=ve-1)}return be.filter(Ue=>Ue.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ge,le)=>ge.sortKey-le.sortKey)}update(n,o,c,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,o,this.layers,c,d),this.icon.programConfigurations.updatePaintArrays(n,o,this.layers,c,d))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=tC(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,o){const c=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:d,y:f}of o)this.lineVertexArray.emplaceBack(d,f);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(n,o,c,d,f,y,v,w,S,k,M,P,B,j){const U=n.indexArray,Q=n.layoutVertexArray,ae=n.globeExtVertexArray,ge=n.segments.prepareSegment(4*o.length,Q,U,this.canOverlap?y.sortKey:void 0),le=this.glyphOffsetArray.length,fe=ge.vertexLength,be=this.allowVerticalPlacement&&v===Po.vertical?Math.PI/2:0,ve=y.text&&y.text.sections;for(let Be=0;Be<o.length;Be++){const{tl:He,tr:it,bl:Ue,br:Ye,tex:Je,pixelOffsetTL:tt,pixelOffsetBR:dt,minFontScaleX:We,minFontScaleY:xt,glyphOffset:Mt,isSDF:vt,sectionIndex:Yt}=o[Be],ht=ge.vertexLength,Ft=Mt[1];if(by(Q,S.x,S.y,He.x,Ft+He.y,Je.x,Je.y,c,vt,tt.x,tt.y,We,xt),by(Q,S.x,S.y,it.x,Ft+it.y,Je.x+Je.w,Je.y,c,vt,dt.x,tt.y,We,xt),by(Q,S.x,S.y,Ue.x,Ft+Ue.y,Je.x,Je.y+Je.h,c,vt,tt.x,dt.y,We,xt),by(Q,S.x,S.y,Ye.x,Ft+Ye.y,Je.x+Je.w,Je.y+Je.h,c,vt,dt.x,dt.y,We,xt),w){const{x:Jt,y:vn,z:Qt}=w.anchor,[Vt,Qn,rn]=w.up;wy(ae,Jt,vn,Qt,Vt,Qn,rn),wy(ae,Jt,vn,Qt,Vt,Qn,rn),wy(ae,Jt,vn,Qt,Vt,Qn,rn),wy(ae,Jt,vn,Qt,Vt,Qn,rn),Sy(n.dynamicLayoutVertexArray,Jt,vn,Qt,be)}else Sy(n.dynamicLayoutVertexArray,S.x,S.y,S.z,be);U.emplaceBack(ht,ht+1,ht+2),U.emplaceBack(ht+1,ht+2,ht+3),ge.vertexLength+=4,ge.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Mt[0]),Be!==o.length-1&&Yt===o[Be+1].sectionIndex||n.programConfigurations.populatePaintArrays(Q.length,y,y.index,{},B,j,ve&&ve[Yt])}const Ne=w?w.anchor:S;n.placedSymbolArray.emplaceBack(Ne.x,Ne.y,Ne.z,S.x,S.y,le,this.glyphOffsetArray.length-le,fe,k,M,S.segment,c?c[0]:0,c?c[1]:0,d[0],d[1],v,0,!1,0,P,0)}_commitLayoutVertex(n,o,c,d,f,y,v){n.emplaceBack(o,c,d,f,y,Math.round(v.x),Math.round(v.y))}_addCollisionDebugVertices(n,o,c,d,f,y,v){const w=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),S=w.vertexLength,k=v.tileAnchorX,M=v.tileAnchorY;for(let B=0;B<4;B++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(o,-n.padding,-n.padding),c.collisionVertexArrayExt.emplaceBack(o,n.padding,-n.padding),c.collisionVertexArrayExt.emplaceBack(o,n.padding,n.padding),c.collisionVertexArrayExt.emplaceBack(o,-n.padding,n.padding),this._commitLayoutVertex(c.layoutVertexArray,d,f,y,k,M,new ye(n.x1,n.y1)),this._commitLayoutVertex(c.layoutVertexArray,d,f,y,k,M,new ye(n.x2,n.y1)),this._commitLayoutVertex(c.layoutVertexArray,d,f,y,k,M,new ye(n.x2,n.y2)),this._commitLayoutVertex(c.layoutVertexArray,d,f,y,k,M,new ye(n.x1,n.y2)),w.vertexLength+=4;const P=c.indexArray;P.emplaceBack(S,S+1),P.emplaceBack(S+1,S+2),P.emplaceBack(S+2,S+3),P.emplaceBack(S+3,S),w.primitiveLength+=4}_addTextDebugCollisionBoxes(n,o,c,d,f,y){for(let v=d;v<f;v++){const w=c.get(v),S=this.getSymbolInstanceTextSize(n,y,o,v);this._addCollisionDebugVertices(w,S,this.textCollisionBox,w.projectedAnchorX,w.projectedAnchorY,w.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(n,o,c,d,f,y){for(let v=d;v<f;v++){const w=c.get(v),S=this.getSymbolInstanceIconSize(n,o,y.placedIconSymbolIndex);this._addCollisionDebugVertices(w,S,this.iconCollisionBox,w.projectedAnchorX,w.projectedAnchorY,w.projectedAnchorZ,y)}}generateCollisionDebugBuffers(n,o){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new p1(At,vT.members,ri),this.iconCollisionBox=new p1(At,vT.members,ri);const c=_d(this.iconSizeData,n),d=_d(this.textSizeData,n);for(let f=0;f<this.symbolInstances.length;f++){const y=this.symbolInstances.get(f);this._addTextDebugCollisionBoxes(d,n,o,y.textBoxStartIndex,y.textBoxEndIndex,y),this._addTextDebugCollisionBoxes(d,n,o,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._addIconDebugCollisionBoxes(c,n,o,y.iconBoxStartIndex,y.iconBoxEndIndex,y),this._addIconDebugCollisionBoxes(c,n,o,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y)}}getSymbolInstanceTextSize(n,o,c,d){const f=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:d),y=dy(this.textSizeData,n,f)/fi;return this.tilePixelRatio*y}getSymbolInstanceIconSize(n,o,c){const d=this.icon.placedSymbolArray.get(c),f=dy(this.iconSizeData,n,d);return this.tilePixelRatio*f}_commitDebugCollisionVertexUpdate(n,o,c){n.emplaceBack(o,-c,-c),n.emplaceBack(o,c,-c),n.emplaceBack(o,c,c),n.emplaceBack(o,-c,c)}_updateTextDebugCollisionBoxes(n,o,c,d,f,y){for(let v=d;v<f;v++){const w=c.get(v),S=this.getSymbolInstanceTextSize(n,y,o,v);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,S,w.padding)}}_updateIconDebugCollisionBoxes(n,o,c,d,f,y){for(let v=d;v<f;v++){const w=c.get(v),S=this.getSymbolInstanceIconSize(n,o,y);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,S,w.padding)}}updateCollisionDebugBuffers(n,o){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=_d(this.iconSizeData,n),d=_d(this.textSizeData,n);for(let f=0;f<this.symbolInstances.length;f++){const y=this.symbolInstances.get(f);this._updateTextDebugCollisionBoxes(d,n,o,y.textBoxStartIndex,y.textBoxEndIndex,y),this._updateTextDebugCollisionBoxes(d,n,o,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._updateIconDebugCollisionBoxes(c,n,o,y.iconBoxStartIndex,y.iconBoxEndIndex,y.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(c,n,o,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,o,c,d,f,y,v,w,S){const k={};if(o<c){const{x1:M,y1:P,x2:B,y2:j,padding:U,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:le,tileAnchorY:fe,featureIndex:be}=n.get(o);k.textBox={x1:M,y1:P,x2:B,y2:j,padding:U,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:le,tileAnchorY:fe},k.textFeatureIndex=be}if(d<f){const{x1:M,y1:P,x2:B,y2:j,padding:U,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:le,tileAnchorY:fe,featureIndex:be}=n.get(d);k.verticalTextBox={x1:M,y1:P,x2:B,y2:j,padding:U,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:le,tileAnchorY:fe},k.verticalTextFeatureIndex=be}if(y<v){const{x1:M,y1:P,x2:B,y2:j,padding:U,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:le,tileAnchorY:fe,featureIndex:be}=n.get(y);k.iconBox={x1:M,y1:P,x2:B,y2:j,padding:U,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:le,tileAnchorY:fe},k.iconFeatureIndex=be}if(w<S){const{x1:M,y1:P,x2:B,y2:j,padding:U,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:le,tileAnchorY:fe,featureIndex:be}=n.get(w);k.verticalIconBox={x1:M,y1:P,x2:B,y2:j,padding:U,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:le,tileAnchorY:fe},k.verticalIconFeatureIndex=be}return k}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const c=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,o){const c=n.placedSymbolArray.get(o),d=c.vertexStartIndex+4*c.numGlyphs;for(let f=c.vertexStartIndex;f<d;f+=4)n.indexArray.emplaceBack(f,f+1,f+2),n.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(n),c=Math.cos(n),d=[],f=[],y=[];for(let v=0;v<this.symbolInstances.length;++v){y.push(v);const w=this.symbolInstances.get(v);d.push(0|Math.round(o*w.tileAnchorX+c*w.tileAnchorY)),f.push(w.featureIndex)}return y.sort((v,w)=>d[v]-d[w]||f[w]-f[v]),y}addToSortKeyRanges(n,o){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===o?c.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const c=this.symbolInstances.get(o);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:d,centerJustifiedTextSymbolIndex:f,leftJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:v,placedIconSymbolIndex:w,verticalPlacedIconSymbolIndex:S}=c;d>=0&&this.addIndicesForPlacedSymbol(this.text,d),f>=0&&f!==d&&this.addIndicesForPlacedSymbol(this.text,f),y>=0&&y!==f&&y!==d&&this.addIndicesForPlacedSymbol(this.text,y),v>=0&&this.addIndicesForPlacedSymbol(this.text,v),w>=0&&this.addIndicesForPlacedSymbol(this.icon,w),S>=0&&this.addIndicesForPlacedSymbol(this.icon,S)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}kt(Il,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Il.MAX_GLYPHS=65535,Il.addDynamicAttributes=Sy;const uO=new de({"symbol-placement":new $(qe.layout_symbol["symbol-placement"]),"symbol-spacing":new $(qe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new $(qe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ee(qe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new $(qe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new $(qe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new $(qe.layout_symbol["icon-ignore-placement"]),"icon-optional":new $(qe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new $(qe.layout_symbol["icon-rotation-alignment"]),"icon-size":new ee(qe.layout_symbol["icon-size"]),"icon-text-fit":new $(qe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new $(qe.layout_symbol["icon-text-fit-padding"]),"icon-image":new ee(qe.layout_symbol["icon-image"]),"icon-rotate":new ee(qe.layout_symbol["icon-rotate"]),"icon-padding":new $(qe.layout_symbol["icon-padding"]),"icon-keep-upright":new $(qe.layout_symbol["icon-keep-upright"]),"icon-offset":new ee(qe.layout_symbol["icon-offset"]),"icon-anchor":new ee(qe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new $(qe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new $(qe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new $(qe.layout_symbol["text-rotation-alignment"]),"text-field":new ee(qe.layout_symbol["text-field"]),"text-font":new ee(qe.layout_symbol["text-font"]),"text-size":new ee(qe.layout_symbol["text-size"]),"text-max-width":new ee(qe.layout_symbol["text-max-width"]),"text-line-height":new ee(qe.layout_symbol["text-line-height"]),"text-letter-spacing":new ee(qe.layout_symbol["text-letter-spacing"]),"text-justify":new ee(qe.layout_symbol["text-justify"]),"text-radial-offset":new ee(qe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new $(qe.layout_symbol["text-variable-anchor"]),"text-anchor":new ee(qe.layout_symbol["text-anchor"]),"text-max-angle":new $(qe.layout_symbol["text-max-angle"]),"text-writing-mode":new $(qe.layout_symbol["text-writing-mode"]),"text-rotate":new ee(qe.layout_symbol["text-rotate"]),"text-padding":new $(qe.layout_symbol["text-padding"]),"text-keep-upright":new $(qe.layout_symbol["text-keep-upright"]),"text-transform":new ee(qe.layout_symbol["text-transform"]),"text-offset":new ee(qe.layout_symbol["text-offset"]),"text-allow-overlap":new $(qe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new $(qe.layout_symbol["text-ignore-placement"]),"text-optional":new $(qe.layout_symbol["text-optional"])});var f1={paint:new de({"icon-opacity":new ee(qe.paint_symbol["icon-opacity"]),"icon-color":new ee(qe.paint_symbol["icon-color"]),"icon-halo-color":new ee(qe.paint_symbol["icon-halo-color"]),"icon-halo-width":new ee(qe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ee(qe.paint_symbol["icon-halo-blur"]),"icon-translate":new $(qe.paint_symbol["icon-translate"]),"icon-translate-anchor":new $(qe.paint_symbol["icon-translate-anchor"]),"text-opacity":new ee(qe.paint_symbol["text-opacity"]),"text-color":new ee(qe.paint_symbol["text-color"],{runtimeType:Qi,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new ee(qe.paint_symbol["text-halo-color"]),"text-halo-width":new ee(qe.paint_symbol["text-halo-width"]),"text-halo-blur":new ee(qe.paint_symbol["text-halo-blur"]),"text-translate":new $(qe.paint_symbol["text-translate"]),"text-translate-anchor":new $(qe.paint_symbol["text-translate-anchor"])}),layout:uO};class nC{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:il,this.defaultValue=n}evaluate(n){if(n.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(n.formattedSection))return o.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}kt(nC,"FormatSectionOverride",{omit:["defaultValue"]});class Ey extends zs{constructor(n){super(n,f1)}recalculate(n,o){super.recalculate(n,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const d=[];for(const f of c)d.indexOf(f)<0&&d.push(f);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(n,o,c,d){const f=this.layout.get(n).evaluate(o,{},c,d),y=this._unevaluatedLayout._values[n];return y.isDataDriven()||gl(y.value)||!f?f:function(v,w){return w.replace(/{([^{}]+)}/g,(S,k)=>k in v?String(v[k]):"")}(o.properties,f)}createBucket(n){return new Il(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of f1.paint.overridableProperties){if(!Ey.hasPaintOverride(this.layout,n))continue;const o=this.paint.get(n),c=new nC(o),d=new Ju(c,o.property.specification);let f=null;f=o.value.kind==="constant"||o.value.kind==="source"?new bp("source",d):new Rc("composite",d,o.value.zoomStops,o.value._interpolationType),this.paint._values[n]=new re(o.property,f,o.parameters)}}_handleOverridablePaintPropertyUpdate(n,o,c){return!(!this.layout||o.isDataDriven()||c.isDataDriven())&&Ey.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,o){const c=n.get("text-field"),d=f1.paint.properties[o];let f=!1;const y=v=>{for(const w of v)if(d.overrides&&d.overrides.hasOverride(w))return void(f=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Bi)y(c.value.value.sections);else if(c.value.kind==="source"){const v=S=>{f||(S instanceof Ea&&yr(S.value)===mc?y(S.value.sections):S instanceof Qs?y(S.sections):S.eachChild(v))},w=c.value;w._styleExpression&&v(w._styleExpression.expression)}return f}getProgramConfiguration(n){return new Sl(this,n)}}var dO={paint:new de({"background-color":new $(qe.paint_background["background-color"]),"background-pattern":new $(qe.paint_background["background-pattern"]),"background-opacity":new $(qe.paint_background["background-opacity"])})},hO={paint:new de({"raster-opacity":new $(qe.paint_raster["raster-opacity"]),"raster-hue-rotate":new $(qe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new $(qe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new $(qe.paint_raster["raster-brightness-max"]),"raster-saturation":new $(qe.paint_raster["raster-saturation"]),"raster-contrast":new $(qe.paint_raster["raster-contrast"]),"raster-resampling":new $(qe.paint_raster["raster-resampling"]),"raster-fade-duration":new $(qe.paint_raster["raster-fade-duration"])})};class pO extends zs{constructor(n){super(n,{}),this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}var fO={paint:new de({"sky-type":new $(qe.paint_sky["sky-type"]),"sky-atmosphere-sun":new $(qe.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new $(qe.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new $(qe.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new $(qe.paint_sky["sky-gradient-radius"]),"sky-gradient":new ue(qe.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new $(qe.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new $(qe.paint_sky["sky-atmosphere-color"]),"sky-opacity":new $(qe.paint_sky["sky-opacity"])})};function m1(i,n,o){const c=[0,0,1],d=bE([]);return SE(d,d,o?-Ge(i)+Math.PI:Ge(i)),wE(d,d,-Ge(n)),yE(c,c,d),ji(c,c)}const mO={circle:class extends zs{constructor(i){super(i,CD)}createBucket(i){return new $v(i)}queryRadius(i){const n=i;return fd("circle-radius",this,n)+fd("circle-stroke-width",this,n)+ey(this.paint.get("circle-translate"))}queryIntersectsFeature(i,n,o,c,d,f,y,v){const w=GE(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,i.pixelToTileUnitsFactor),S=this.paint.get("circle-radius").evaluate(n,o)+this.paint.get("circle-stroke-width").evaluate(n,o);return qE(i,c,f,y,v,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",w,S)}getProgramIds(){return["circle"]}getProgramConfiguration(i){return new Sl(this,i)}},heatmap:class extends zs{createBucket(i){return new ZE(i)}constructor(i){super(i,MD),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Gv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return fd("heatmap-radius",this,i)}queryIntersectsFeature(i,n,o,c,d,f,y,v){const w=this.paint.get("heatmap-radius").evaluate(n,o);return qE(i,c,f,y,v,!0,!0,new ye(0,0),w)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(i){return new Sl(this,i)}},hillshade:class extends zs{constructor(i){super(i,PD)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends zs{constructor(i){super(i,HD)}getProgramIds(){const i=this.paint.get("fill-pattern"),n=i&&i.constantOr(1),o=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getProgramConfiguration(i){return new Sl(this,i)}recalculate(i,n){super.recalculate(i,n);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new oy(i)}queryRadius(){return ey(this.paint.get("fill-translate"))}queryIntersectsFeature(i,n,o,c,d,f){return!i.queryGeometry.isAboveHorizon&&NE(WE(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,i.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends zs{constructor(i){super(i,c3)}createBucket(i){return new nf(i)}queryRadius(){return ey(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(i){return new Sl(this,i)}queryIntersectsFeature(i,n,o,c,d,f,y,v,w){const S=GE(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,i.pixelToTileUnitsFactor),k=this.paint.get("fill-extrusion-height").evaluate(n,o),M=this.paint.get("fill-extrusion-base").evaluate(n,o),P=[0,0],B=v&&f.elevation,j=f.elevation?f.elevation.exaggeration():1,U=i.tile.getBucket(this);if(B&&U instanceof nf){const fe=U.centroidVertexArray,be=w+1;be<fe.length&&(P[0]=fe.geta_centroid_pos0(be),P[1]=fe.geta_centroid_pos1(be))}if(P[0]===0&&P[1]===1)return!1;f.projection.name==="globe"&&(c=hT([c],[new ye(0,0),new ye($t,$t)],i.tileID.canonical).map(fe=>fe.polygon).flat());const Q=B?v:null,[ae,ge]=function(fe,be,ve,Ne,Be,He,it,Ue,Ye,Je,tt){return fe.projection.name==="globe"?function(dt,We,xt,Mt,vt,Yt,ht,Ft,Jt,vn,Qt){const Vt=[],Qn=[],rn=dt.projection.upVectorScale(Qt,dt.center.lat,dt.worldSize).metersToTile,on=[0,0,0,1],Un=[0,0,0,1],Zn=(Vn,dr,_r,Br)=>{Vn[0]=dr,Vn[1]=_r,Vn[2]=Br,Vn[3]=1},Xn=dT();xt>0&&(xt+=Xn),Mt+=Xn;for(const Vn of We){const dr=[],_r=[];for(const Br of Vn){const Wn=Br.x+vt.x,qr=Br.y+vt.y,Fr=dt.projection.projectTilePoint(Wn,qr,Qt),pr=dt.projection.upVector(Qt,Br.x,Br.y);let En=xt,jr=Mt;if(ht){const Kn=gT(Wn,qr,xt,Mt,ht,Ft,Jt,vn);En+=Kn.base,jr+=Kn.top}xt!==0?Zn(on,Fr.x+pr[0]*rn*En,Fr.y+pr[1]*rn*En,Fr.z+pr[2]*rn*En):Zn(on,Fr.x,Fr.y,Fr.z),Zn(Un,Fr.x+pr[0]*rn*jr,Fr.y+pr[1]*rn*jr,Fr.z+pr[2]*rn*jr),Cr(on,on,Yt),Cr(Un,Un,Yt),dr.push(new yd(on[0],on[1],on[2])),_r.push(new yd(Un[0],Un[1],Un[2]))}Vt.push(dr),Qn.push(_r)}return[Vt,Qn]}(fe,be,ve,Ne,Be,He,it,Ue,Ye,Je,tt):it?function(dt,We,xt,Mt,vt,Yt,ht,Ft,Jt){const vn=[],Qt=[],Vt=[0,0,0,1];for(const Qn of dt){const rn=[],on=[];for(const Un of Qn){const Zn=Un.x+Mt.x,Xn=Un.y+Mt.y,Vn=gT(Zn,Xn,We,xt,Yt,ht,Ft,Jt);Vt[0]=Zn,Vt[1]=Xn,Vt[2]=Vn.base,Vt[3]=1,Wc(Vt,Vt,vt),Vt[3]=Math.max(Vt[3],1e-5);const dr=new yd(Vt[0]/Vt[3],Vt[1]/Vt[3],Vt[2]/Vt[3]);Vt[0]=Zn,Vt[1]=Xn,Vt[2]=Vn.top,Vt[3]=1,Wc(Vt,Vt,vt),Vt[3]=Math.max(Vt[3],1e-5);const _r=new yd(Vt[0]/Vt[3],Vt[1]/Vt[3],Vt[2]/Vt[3]);rn.push(dr),on.push(_r)}vn.push(rn),Qt.push(on)}return[vn,Qt]}(be,ve,Ne,Be,He,it,Ue,Ye,Je):function(dt,We,xt,Mt,vt){const Yt=[],ht=[],Ft=vt[8]*We,Jt=vt[9]*We,vn=vt[10]*We,Qt=vt[11]*We,Vt=vt[8]*xt,Qn=vt[9]*xt,rn=vt[10]*xt,on=vt[11]*xt;for(const Un of dt){const Zn=[],Xn=[];for(const Vn of Un){const dr=Vn.x+Mt.x,_r=Vn.y+Mt.y,Br=vt[0]*dr+vt[4]*_r+vt[12],Wn=vt[1]*dr+vt[5]*_r+vt[13],qr=vt[2]*dr+vt[6]*_r+vt[14],Fr=vt[3]*dr+vt[7]*_r+vt[15],pr=Br+Ft,En=Wn+Jt,jr=qr+vn,Kn=Math.max(Fr+Qt,1e-5),Ui=Br+Vt,Nr=Wn+Qn,mi=qr+rn,ii=Math.max(Fr+on,1e-5);Zn.push(new yd(pr/Kn,En/Kn,jr/Kn)),Xn.push(new yd(Ui/ii,Nr/ii,mi/ii))}Yt.push(Zn),ht.push(Xn)}return[Yt,ht]}(be,ve,Ne,Be,He)}(f,c,M,k,S,y,Q,P,j,f.center.lat,i.tileID.canonical),le=i.queryGeometry;return function(fe,be,ve){let Ne=1/0;NE(ve,be)&&(Ne=mT(ve,be[0]));for(let Be=0;Be<be.length;Be++){const He=be[Be],it=fe[Be];for(let Ue=0;Ue<He.length-1;Ue++){const Ye=He[Ue],Je=[Ye,He[Ue+1],it[Ue+1],it[Ue],Ye];jE(ve,Je)&&(Ne=Math.min(Ne,mT(ve,Je)))}}return Ne!==1/0&&Ne}(ae,ge,le.isPointQuery()?le.screenBounds:le.screenGeometry)}},line:class extends zs{constructor(i){super(i,yT),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof lp,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(i,n){super.recalculate(i,n),this.paint._values["line-floorwidth"]=_T.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new uy(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(i){return new Sl(this,i)}queryRadius(i){const n=i,o=xT(fd("line-width",this,n),fd("line-gap-width",this,n)),c=fd("line-offset",this,n);return o/2+Math.abs(c)+ey(this.paint.get("line-translate"))}queryIntersectsFeature(i,n,o,c,d,f){if(i.queryGeometry.isAboveHorizon)return!1;const y=WE(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,i.pixelToTileUnitsFactor),v=i.pixelToTileUnitsFactor/2*xT(this.paint.get("line-width").evaluate(n,o),this.paint.get("line-gap-width").evaluate(n,o)),w=this.paint.get("line-offset").evaluate(n,o);return w&&(c=function(S,k){const M=[],P=new ye(0,0);for(let B=0;B<S.length;B++){const j=S[B],U=[];for(let Q=0;Q<j.length;Q++){const ae=j[Q],ge=j[Q+1],le=Q===0?P:ae.sub(j[Q-1])._unit()._perp(),fe=Q===j.length-1?P:ge.sub(ae)._unit()._perp(),be=le._add(fe)._unit();be._mult(1/(be.x*fe.x+be.y*fe.y)),U.push(be._mult(k)._add(ae))}M.push(U)}return M}(c,w*i.pixelToTileUnitsFactor)),function(S,k,M){for(let P=0;P<k.length;P++){const B=k[P];if(S.length>=3){for(let j=0;j<B.length;j++)if(Zc(S,B[j]))return!0}if(wD(S,B,M))return!0}return!1}(y,c,v)}isTileClipped(){return!0}},symbol:Ey,background:class extends zs{constructor(i){super(i,dO)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends zs{constructor(i){super(i,hO)}getProgramIds(){return["raster"]}},sky:class extends zs{constructor(i){super(i,fO),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Gv({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(i,n){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),d=!c,f=i.style.light,y=f.properties.get("position");return d&&f.properties.get("anchor")==="viewport"&&Kt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),d?m1(y.azimuthal,90-y.polar,n):m1(c[0],90-c[1],n)}const o=this.paint.get("sky-gradient-center");return m1(o[0],90-o[1],n)}is3D(){return!1}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}}};class ff{constructor(n,o,c,d){this.context=n,this.format=c,this.texture=n.gl.createTexture(),this.update(o,d)}update(n,o,c){const{width:d,height:f}=n,{context:y}=this,{gl:v}=y,{HTMLImageElement:w,HTMLCanvasElement:S,HTMLVideoElement:k,ImageData:M,ImageBitmap:P}=E;if(v.bindTexture(v.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!o||o.premultiply!==!1)),c||this.size&&this.size[0]===d&&this.size[1]===f){const{x:B,y:j}=c||{x:0,y:0};n instanceof w||n instanceof S||n instanceof k||n instanceof M||P&&n instanceof P?v.texSubImage2D(v.TEXTURE_2D,0,B,j,v.RGBA,v.UNSIGNED_BYTE,n):v.texSubImage2D(v.TEXTURE_2D,0,B,j,d,f,v.RGBA,v.UNSIGNED_BYTE,n.data)}else this.size=[d,f],n instanceof w||n instanceof S||n instanceof k||n instanceof M||P&&n instanceof P?v.texImage2D(v.TEXTURE_2D,0,this.format,this.format,v.UNSIGNED_BYTE,n):v.texImage2D(v.TEXTURE_2D,0,this.format,d,f,0,this.format,v.UNSIGNED_BYTE,n.data);this.useMipmap=!!(o&&o.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(n,o){const{context:c}=this,{gl:d}=c;d.bindTexture(d.TEXTURE_2D,this.texture),n!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,n),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap?n===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_NEAREST:n),this.filter=n),o!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,o),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class gO{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class yO{constructor(){this.tasks={},this.taskQueue=[],qn(["process"],this),this.invoker=new gO(this.process),this.nextId=0}add(n,o){const c=this.nextId++,d=function({type:f,isSymbolTile:y,zoom:v}){return v=v||0,f==="message"?0:f!=="maybePrepare"||y?f!=="parseTile"||y?f==="parseTile"&&y?300-v:f==="maybePrepare"&&y?400-v:500:200-v:100-v}(o);if(d===0){Sr();try{n()}finally{}return{cancel:()=>{}}}return this.tasks[c]={fn:n,metadata:o,priority:d,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){Sr();try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const o=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let n=null,o=1/0;for(let d=0;d<this.taskQueue.length;d++){const f=this.tasks[this.taskQueue[d]];f.priority<o&&(o=f.priority,n=d)}if(n===null)return null;const c=this.taskQueue[n];return this.taskQueue.splice(n,1),c}remove(){this.invoker.remove()}}class rC{constructor(n){this._stringToNumber={},this._numberToString=[];for(let o=0;o<n.length;o++){const c=n[o];this._stringToNumber[c]=o,this._numberToString[o]=c}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}const _O=["tile","layer","source","sourceLayer","state"];class iC{constructor(n,o,c,d,f){this.type="Feature",this._vectorTileFeature=n,this._z=o,this._x=c,this._y=d,this.properties=n.properties,this.id=f}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(n.id=this.id);for(const o of _O)this[o]!==void 0&&(n[o]=this[o]);return n}}const ns=32,sa=33,Al=new Uint16Array(8184);for(let i=0;i<2046;i++){let n=i+2,o=0,c=0,d=0,f=0,y=0,v=0;for(1&n?d=f=y=ns:o=c=v=ns;(n>>=1)>1;){const S=o+d>>1,k=c+f>>1;1&n?(d=o,f=c,o=y,c=v):(o=d,c=f,d=y,f=v),y=S,v=k}const w=4*i;Al[w+0]=o,Al[w+1]=c,Al[w+2]=d,Al[w+3]=f}const aa=new Uint16Array(2178),Ml=new Uint8Array(1089),Ty=new Uint16Array(1089);function oC(i){return i===0?-.03125:i===32?.03125:0}var sC=Me([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const aC={type:2,extent:$t,loadGeometry:()=>[[new ye(0,0),new ye($t+1,0),new ye($t+1,$t+1),new ye(0,$t+1),new ye(0,0)]]};class g1{constructor(n,o,c,d,f){this.tileID=n,this.uid=en(),this.uses=0,this.tileSize=o,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=f,this.expiredRequestCount=0,this.state="loading",d&&d.transform&&(this.projection=d.transform.projection)}registerFadeDuration(n){const o=n+this.timeAdded;o<bs.now()||this.fadeEndTime&&o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Kc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(n,o,c){if(this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(d,f){const y={};if(!f)return y;for(const v of d){const w=v.layerIds.map(S=>f.getLayer(S)).filter(Boolean);if(w.length!==0){v.layers=w,v.stateDependentLayerIds&&(v.stateDependentLayers=v.stateDependentLayerIds.map(S=>w.filter(k=>k.id===S)[0]));for(const S of w)y[S.id]=v}}return y}(n.buckets,o.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const f=this.buckets[d];if(f instanceof Il){if(this.hasSymbolBuckets=!0,!c)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const f=this.buckets[d];if(f instanceof Il&&f.hasRTLText){this.hasRTLText=!0,C.isLoading()||C.isLoaded()||b()!=="deferred"||T();break}}this.queryPadding=0;for(const d in this.buckets){const f=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(d).queryRadius(f))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),n.lineAtlas&&(this.lineAtlas=n.lineAtlas)}else this.collisionBoxArray=new Nn}unloadVectorData(){if(this.hasData()){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(n){return this.buckets[n.id]}upload(n){for(const c in this.buckets){const d=this.buckets[c];d.uploadPending()&&d.upload(n)}const o=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ff(n,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ff(n,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new ff(n,this.lineAtlas.image,o.ALPHA),this.lineAtlas.uploaded=!0)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,o,c,d,f,y,v,w){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:d,pixelPosMatrix:v,transform:y,params:f,tileTransform:this.tileTransform},n,o,c):{}}querySourceFeatures(n,o){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const d=c.loadVTLayers(),f=o?o.sourceLayer:"",y=d._geojsonTileLayer||d[f];if(!y)return;const v=nd(o&&o.filter),{z:w,x:S,y:k}=this.tileID.canonical,M={z:w,x:S,y:k};for(let P=0;P<y.length;P++){const B=y.feature(P);if(v.needGeometry){const Q=Hc(B,!0);if(!v.filter(new A(this.tileID.overscaledZ),Q,this.tileID.canonical))continue}else if(!v.filter(new A(this.tileID.overscaledZ),B))continue;const j=c.getId(B,f),U=new iC(B,w,S,k,j);U.tile=M,n.push(U)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const o=this.expirationTime;if(n.cacheControl){const c=lr(n.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const c=Date.now();let d=!1;if(this.expirationTime>c)d=!1;else if(o)if(this.expirationTime<o)d=!0;else{const f=this.expirationTime-o;f?this.expirationTime=c+Math.max(f,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0||!o)return;const c=this.latestFeatureIndex.loadVTLayers(),d=o.style.listImages();for(const f in this.buckets){if(!o.style.hasLayer(f))continue;const y=this.buckets[f],v=y.layers[0].sourceLayer||"_geojsonTileLayer",w=c[v],S=n[v];if(!w||!S||Object.keys(S).length===0)continue;if(y.update(S,w,d,this.imageAtlas&&this.imageAtlas.patternPositions||{}),y instanceof uy||y instanceof oy){const M=o.style._getSourceCache(y.layers[0].source);o._terrain&&o._terrain.enabled&&M&&y.programConfigurations.needsUpload&&o._terrain._clearRenderCacheForTile(M.id,this.tileID)}const k=o&&o.style&&o.style.getLayer(f);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<bs.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=bs.now()+n}setTexture(n,o){const c=o.context,d=c.gl;this.texture=this.texture||o.getTileTexture(n.width),this.texture?this.texture.update(n,{useMipmap:!0}):(this.texture=new ff(c,n,d.RGBA,{useMipmap:!0}),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE))}setDependencies(n,o){const c={};for(const d of o)c[d]=!0;this.dependencies[n]=c}hasDependency(n,o){for(const c of n){const d=this.dependencies[c];if(d){for(const f of o)if(d[f])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(n,o){if(!o||o.name==="mercator"||this._tileDebugBuffer)return;const c=Oa(aC,this.tileID.canonical,this.tileTransform)[0],d=new rt,f=new po;for(let y=0;y<c.length;y++){const{x:v,y:w}=c[y];d.emplaceBack(v,w),f.emplaceBack(y)}f.emplaceBack(0),this._tileDebugIndexBuffer=n.createIndexBuffer(f),this._tileDebugBuffer=n.createVertexBuffer(d,Gp.members),this._tileDebugSegments=Dr.simpleSegment(0,0,d.length,f.length)}_makeTileBoundsBuffers(n,o){if(this._tileBoundsBuffer||!o||o.name==="mercator")return;const c=Oa(aC,this.tileID.canonical,this.tileTransform)[0];let d,f;if(this.isRaster){const y=function(v,w){const S=Kc(v,w),k=Math.pow(2,v.z);for(let Q=0;Q<sa;Q++)for(let ae=0;ae<sa;ae++){const ge=Mo((v.x+(ae+oC(ae))/ns)/k),le=wi((v.y+(Q+oC(Q))/ns)/k),fe=w.project(ge,le),be=Q*sa+ae;aa[2*be+0]=Math.round((fe.x*S.scale-S.x)*$t),aa[2*be+1]=Math.round((fe.y*S.scale-S.y)*$t)}Ml.fill(0),Ty.fill(0);for(let Q=2045;Q>=0;Q--){const ae=4*Q,ge=Al[ae+0],le=Al[ae+1],fe=Al[ae+2],be=Al[ae+3],ve=ge+fe>>1,Ne=le+be>>1,Be=ve+Ne-le,He=Ne+ge-ve,it=le*sa+ge,Ue=be*sa+fe,Ye=Ne*sa+ve,Je=Math.hypot((aa[2*it+0]+aa[2*Ue+0])/2-aa[2*Ye+0],(aa[2*it+1]+aa[2*Ue+1])/2-aa[2*Ye+1])>=16;Ml[Ye]=Ml[Ye]||(Je?1:0),Q<1022&&(Ml[Ye]=Ml[Ye]||Ml[(le+He>>1)*sa+(ge+Be>>1)]||Ml[(be+He>>1)*sa+(fe+Be>>1)])}const M=new Ke,P=new Lt;let B=0;function j(Q,ae){const ge=ae*sa+Q;return Ty[ge]===0&&(M.emplaceBack(aa[2*ge+0],aa[2*ge+1],Q*$t/ns,ae*$t/ns),Ty[ge]=++B),Ty[ge]-1}function U(Q,ae,ge,le,fe,be){const ve=Q+ge>>1,Ne=ae+le>>1;if(Math.abs(Q-fe)+Math.abs(ae-be)>1&&Ml[Ne*sa+ve])U(fe,be,Q,ae,ve,Ne),U(ge,le,fe,be,ve,Ne);else{const Be=j(Q,ae),He=j(ge,le),it=j(fe,be);P.emplaceBack(Be,He,it)}}return U(0,0,ns,ns,ns,0),U(ns,ns,0,0,0,ns),{vertices:M,indices:P}}(this.tileID.canonical,o);d=y.vertices,f=y.indices}else{d=new Ke,f=new Lt;for(const{x:v,y:w}of c)d.emplaceBack(v,w,0,0);const y=Kv(d.int16,void 0,4);for(let v=0;v<y.length;v+=3)f.emplaceBack(y[v],y[v+1],y[v+2])}this._tileBoundsBuffer=n.createVertexBuffer(d,sC.members),this._tileBoundsIndexBuffer=n.createIndexBuffer(f),this._tileBoundsSegments=Dr.simpleSegment(0,0,d.length,f.length)}_makeGlobeTileDebugBuffers(n,o){const c=o.projection;if(!c||c.name!=="globe"||o.freezeTileCoverage)return;const d=this.tileID.canonical,f=Zp(IE(d,o)),y=hd(o.zoom);let v;y>0&&(v=Ev(new Float64Array(16),o.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(n,d,o,f,v,y),this._makeGlobeTileDebugTextBuffer(n,d,o,f,v,y)}_globePoint(n,o,c,d,f,y,v){let w=Hp(n,o,c);if(y){const S=1<<c.z,k=ia(d.center.lng),M=oa(d.center.lat),P=(c.x+.5)/S-k;let B=0;P>.5?B=-1:P<-.5&&(B=1);let j=(n/$t+c.x)/S+B,U=(o/$t+c.y)/S;j=(j-k)*d._pixelsPerMercatorPixel+k,U=(U-M)*d._pixelsPerMercatorPixel+M;const Q=[j*d.worldSize,U*d.worldSize,0];Cr(Q,Q,y),w=qc(w,Q,v)}return Cr(w,w,f)}_makeGlobeTileDebugBorderBuffer(n,o,c,d,f,y){const v=new rt,w=new po,S=new Oe,k=(P,B,j,U,Q)=>{const ae=(j-P)/(Q-1),ge=(U-B)/(Q-1),le=v.length;for(let fe=0;fe<Q;fe++){const be=P+fe*ae,ve=B+fe*ge;v.emplaceBack(be,ve);const Ne=this._globePoint(be,ve,o,c,d,f,y);S.emplaceBack(Ne[0],Ne[1],Ne[2]),w.emplaceBack(le+fe)}},M=$t;k(0,0,M,0,16),k(M,0,M,M,16),k(M,M,0,M,16),k(0,M,0,0,16),this._tileDebugIndexBuffer=n.createIndexBuffer(w),this._tileDebugBuffer=n.createVertexBuffer(v,Gp.members),this._globeTileDebugBorderBuffer=n.createVertexBuffer(S,TE.members),this._tileDebugSegments=Dr.simpleSegment(0,0,v.length,w.length)}_makeGlobeTileDebugTextBuffer(n,o,c,d,f,y){const v=$t/4,w=new rt,S=new Lt,k=new Oe,M=25;S.reserve(32),w.reserve(M),k.reserve(M);const P=(B,j)=>M*B+j;for(let B=0;B<M;B++){const j=B*v;for(let U=0;U<M;U++){const Q=U*v;w.emplaceBack(Q,j);const ae=this._globePoint(Q,j,o,c,d,f,y);k.emplaceBack(ae[0],ae[1],ae[2])}}for(let B=0;B<4;B++)for(let j=0;j<4;j++){const U=P(B,j),Q=P(B,j+1),ae=P(B+1,j),ge=P(B+1,j+1);S.emplaceBack(U,Q,ae),S.emplaceBack(ae,Q,ge)}this._tileDebugTextIndexBuffer=n.createIndexBuffer(S),this._tileDebugTextBuffer=n.createVertexBuffer(w,Gp.members),this._globeTileDebugTextBuffer=n.createVertexBuffer(k,TE.members),this._tileDebugTextSegments=Dr.simpleSegment(0,0,M,32)}}class xO{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,o,c){const d=String(o);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][d]=this.stateChanges[n][d]||{},zt(this.stateChanges[n][d],c),this.deletedStates[n]===null){this.deletedStates[n]={};for(const f in this.state[n])f!==d&&(this.deletedStates[n][f]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][d]===null){this.deletedStates[n][d]={};for(const f in this.state[n][d])c[f]||(this.deletedStates[n][d][f]=null)}else for(const f in c)this.deletedStates[n]&&this.deletedStates[n][d]&&this.deletedStates[n][d][f]===null&&delete this.deletedStates[n][d][f]}removeFeatureState(n,o,c){if(this.deletedStates[n]===null)return;const d=String(o);if(this.deletedStates[n]=this.deletedStates[n]||{},c&&o!==void 0)this.deletedStates[n][d]!==null&&(this.deletedStates[n][d]=this.deletedStates[n][d]||{},this.deletedStates[n][d][c]=null);else if(o!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][d])for(c in this.deletedStates[n][d]={},this.stateChanges[n][d])this.deletedStates[n][d][c]=null;else this.deletedStates[n][d]=null;else this.deletedStates[n]=null}getState(n,o){const c=String(o),d=zt({},(this.state[n]||{})[c],(this.stateChanges[n]||{})[c]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const f=this.deletedStates[n][o];if(f===null)return{};for(const y in f)delete d[y]}return d}initializeTileState(n,o){n.setFeatureState(this.state,o)}coalesceChanges(n,o){const c={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const f={};for(const y in this.stateChanges[d])this.state[d][y]||(this.state[d][y]={}),zt(this.state[d][y],this.stateChanges[d][y]),f[y]=this.state[d][y];c[d]=f}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const f={};if(this.deletedStates[d]===null)for(const y in this.state[d])f[y]={},this.state[d][y]={};else for(const y in this.deletedStates[d]){if(this.deletedStates[d][y]===null)this.state[d][y]={};else if(this.state[d][y])for(const v of Object.keys(this.deletedStates[d][y]))delete this.state[d][y][v];f[y]=this.state[d][y]}c[d]=c[d]||{},zt(c[d],f)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const d in n)n[d].setFeatureState(c,o)}}class lC{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,o){const c=this.toIdx(n,o);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(n,o){return this.leaves[this.toIdx(n,o)]}toIdx(n,o){return o*this.size+n}}function cC(i,n,o,c){let d=0,f=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(c[y])<1e-15){if(o[y]<i[y]||o[y]>n[y])return null}else{const v=1/c[y];let w=(i[y]-o[y])*v,S=(n[y]-o[y])*v;if(w>S){const k=w;w=S,S=k}if(w>d&&(d=w),S<f&&(f=S),d>f)return null}return d}function uC(i,n,o,c,d,f,y,v,w,S,k){const M=c-i,P=d-n,B=f-o,j=y-i,U=v-n,Q=w-o,ae=k[1]*Q-k[2]*U,ge=k[2]*j-k[0]*Q,le=k[0]*U-k[1]*j,fe=M*ae+P*ge+B*le;if(Math.abs(fe)<1e-15)return null;const be=1/fe,ve=S[0]-i,Ne=S[1]-n,Be=S[2]-o,He=(ve*ae+Ne*ge+Be*le)*be;if(He<0||He>1)return null;const it=Ne*B-Be*P,Ue=Be*M-ve*B,Ye=ve*P-Ne*M,Je=(k[0]*it+k[1]*Ue+k[2]*Ye)*be;return Je<0||He+Je>1?null:(j*it+U*Ue+Q*Ye)*be}function dC(i,n,o){return(i-n)/(o-n)}function hC(i,n,o,c,d,f,y,v,w){const S=1<<o,k=f-c,M=y-d,P=(i+1)/S*k+c,B=(n+0)/S*M+d,j=(n+1)/S*M+d;v[0]=(i+0)/S*k+c,v[1]=B,w[0]=P,w[1]=j}class pC{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(f){const y=Math.ceil(Math.log2(f.dim/8)),v=[];let w=Math.ceil(Math.pow(2,y));const S=1/w,k=(B,j,U,Q,ae)=>{const ge=Q?1:0,le=(B+1)*U-ge,fe=j*U,be=(j+1)*U-ge;ae[0]=B*U,ae[1]=fe,ae[2]=le,ae[3]=be};let M=new lC(w);const P=[];for(let B=0;B<w*w;B++){k(B%w,Math.floor(B/w),S,!1,P);const j=Pl(P[0],P[1],f),U=Pl(P[2],P[1],f),Q=Pl(P[2],P[3],f),ae=Pl(P[0],P[3],f);M.minimums.push(Math.min(j,U,Q,ae)),M.maximums.push(Math.max(j,U,Q,ae)),M.leaves.push(1)}for(v.push(M),w/=2;w>=1;w/=2){const B=v[v.length-1];M=new lC(w);for(let j=0;j<w*w;j++){k(j%w,Math.floor(j/w),2,!0,P);const U=B.getElevation(P[0],P[1]),Q=B.getElevation(P[2],P[1]),ae=B.getElevation(P[2],P[3]),ge=B.getElevation(P[0],P[3]),le=B.isLeaf(P[0],P[1]),fe=B.isLeaf(P[2],P[1]),be=B.isLeaf(P[2],P[3]),ve=B.isLeaf(P[0],P[3]),Ne=Math.min(U.min,Q.min,ae.min,ge.min),Be=Math.max(U.max,Q.max,ae.max,ge.max),He=le&&fe&&be&&ve;M.maximums.push(Be),M.minimums.push(Ne),M.leaves.push(Be-Ne<=5&&He?1:0)}v.push(M)}return v}(this.dem),c=o.length-1,d=o[c];this._addNode(d.minimums[0],d.maximums[0],d.leaves[0]),this._construct(o,0,0,c,0)}raycastRoot(n,o,c,d,f,y,v=1){return cC([n,o,-100],[c,d,this.maximums[0]*v],f,y)}raycast(n,o,c,d,f,y,v=1){if(!this.nodeCount)return null;const w=this.raycastRoot(n,o,c,d,f,y,v);if(w==null)return null;const S=[],k=[],M=[],P=[],B=[{idx:0,t:w,nodex:0,nodey:0,depth:0}];for(;B.length>0;){const{idx:j,t:U,nodex:Q,nodey:ae,depth:ge}=B.pop();if(this.leaves[j]){hC(Q,ae,ge,n,o,c,d,M,P);const fe=1<<ge,be=(Q+0)/fe,ve=(Q+1)/fe,Ne=(ae+0)/fe,Be=(ae+1)/fe,He=Pl(be,Ne,this.dem)*v,it=Pl(ve,Ne,this.dem)*v,Ue=Pl(ve,Be,this.dem)*v,Ye=Pl(be,Be,this.dem)*v,Je=uC(M[0],M[1],He,P[0],M[1],it,P[0],P[1],Ue,f,y),tt=uC(P[0],P[1],Ue,M[0],P[1],Ye,M[0],M[1],He,f,y),dt=Math.min(Je!==null?Je:Number.MAX_VALUE,tt!==null?tt:Number.MAX_VALUE);if(dt!==Number.MAX_VALUE)return dt;{const We=Vp([],f,y,U);if(fC(He,it,Ye,Ue,dC(We[0],M[0],P[0]),dC(We[1],M[1],P[1]))>=We[2])return U}continue}let le=0;for(let fe=0;fe<this._siblingOffset.length;fe++){hC((Q<<1)+this._siblingOffset[fe][0],(ae<<1)+this._siblingOffset[fe][1],ge+1,n,o,c,d,M,P),M[2]=-100,P[2]=this.maximums[this.childOffsets[j]+fe]*v;const be=cC(M,P,f,y);if(be!=null){const ve=be;S[fe]=ve;let Ne=!1;for(let Be=0;Be<le&&!Ne;Be++)ve>=S[k[Be]]&&(k.splice(Be,0,fe),Ne=!0);Ne||(k[le]=fe),le++}}for(let fe=0;fe<le;fe++){const be=k[fe];B.push({idx:this.childOffsets[j]+be,t:S[be],nodex:(Q<<1)+this._siblingOffset[be][0],nodey:(ae<<1)+this._siblingOffset[be][1],depth:ge+1})}}return null}_addNode(n,o,c){return this.minimums.push(n),this.maximums.push(o),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(n,o,c,d,f){if(n[d].isLeaf(o,c)===1)return;this.childOffsets[f]||(this.childOffsets[f]=this.nodeCount);const y=d-1,v=n[y];let w=0,S=0;for(let k=0;k<this._siblingOffset.length;k++){const M=2*o+this._siblingOffset[k][0],P=2*c+this._siblingOffset[k][1],B=v.getElevation(M,P),j=v.isLeaf(M,P),U=this._addNode(B.min,B.max,j);j&&(w|=1<<k),S||(S=U)}for(let k=0;k<this._siblingOffset.length;k++)w&1<<k||this._construct(n,2*o+this._siblingOffset[k][0],2*c+this._siblingOffset[k][1],y,S+k)}}function fC(i,n,o,c,d,f){return gn(gn(i,o,f),gn(n,c,f),d)}function Pl(i,n,o){const c=o.dim,d=Re(i*c-.5,0,c-1),f=Re(n*c-.5,0,c-1),y=Math.floor(d),v=Math.floor(f),w=Math.min(y+1,c-1),S=Math.min(v+1,c-1);return fC(o.get(y,v),o.get(w,v),o.get(y,S),o.get(w,S),d-y,f-v)}const mC={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function vO(i,n,o){return(256*i*256+256*n+o)/10-1e4}function bO(i,n,o){return 256*i+n+o/256-32768}class Cy{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,o,c,d=!1,f=!1){if(this.uid=n,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return Kt(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const y=this.dim=o.height-2,v=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.encoding=c||"mapbox",this.borderReady=d,!d){for(let w=0;w<y;w++)v[this._idx(-1,w)]=v[this._idx(0,w)],v[this._idx(y,w)]=v[this._idx(y-1,w)],v[this._idx(w,-1)]=v[this._idx(w,0)],v[this._idx(w,y)]=v[this._idx(w,y-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(y,-1)]=v[this._idx(y-1,0)],v[this._idx(-1,y)]=v[this._idx(0,y-1)],v[this._idx(y,y)]=v[this._idx(y-1,y-1)],f&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new pC(this)}get(n,o,c=!1){c&&(n=Re(n,-1,this.dim),o=Re(o,-1,this.dim));const d=4*this._idx(n,o);return(this.encoding==="terrarium"?bO:vO)(this.pixels[d],this.pixels[d+1],this.pixels[d+2])}static getUnpackVector(n){return mC[n]}get unpackVector(){return mC[this.encoding]}_idx(n,o){if(n<-1||n>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(n+1)}static pack(n,o){const c=[0,0,0,0],d=Cy.getUnpackVector(o);let f=Math.floor((n+d[3])/d[2]);return c[2]=f%256,f=Math.floor(f/256),c[1]=f%256,f=Math.floor(f/256),c[0]=f,c}getPixels(){return new mo({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,o,c){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let d=o*this.dim,f=o*this.dim+this.dim,y=c*this.dim,v=c*this.dim+this.dim;switch(o){case-1:d=f-1;break;case 1:f=d+1}switch(c){case-1:y=v-1;break;case 1:v=y+1}const w=-o*this.dim,S=-c*this.dim;for(let k=y;k<v;k++)for(let M=d;M<f;M++){const P=4*this._idx(M,k),B=4*this._idx(M+w,k+S);this.pixels[P+0]=n.pixels[B+0],this.pixels[P+1]=n.pixels[B+1],this.pixels[P+2]=n.pixels[B+2],this.pixels[P+3]=n.pixels[B+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}kt(Cy,"DEMData"),kt(pC,"DemMinMaxQuadTree",{omit:["dem"]});class wO{constructor(n,o){this.max=n,this.onRemove=o,this.reset()}reset(){for(const n in this.data)for(const o of this.data[n])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(n,o,c){const d=n.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const f={value:o,timeout:void 0};if(c!==void 0&&(f.timeout=setTimeout(()=>{this.remove(n,f)},c)),this.data[d].push(f),this.order.push(d),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const o=this.data[n].shift();return o.timeout&&clearTimeout(o.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),o.value}getByKey(n){const o=this.data[n];return o?o[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,o){if(!this.has(n))return this;const c=n.wrapped().key,d=o===void 0?0:this.data[c].indexOf(o),f=this.data[c][d];return this.data[c].splice(d,1),f.timeout&&clearTimeout(f.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(f.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(n){const o=[];for(const c in this.data)for(const d of this.data[c])n(d.value)||o.push(d);for(const c of o)this.remove(c.value.tileID,c)}}class kd{constructor(n,o,c){this.func=n,this.mask=o,this.range=c}}kd.ReadOnly=!1,kd.ReadWrite=!0,kd.disabled=new kd(519,kd.ReadOnly,[0,1]);const y1=7680;class _1{constructor(n,o,c,d,f,y){this.test=n,this.ref=o,this.mask=c,this.fail=d,this.depthFail=f,this.pass=y}}_1.disabled=new _1({func:519,mask:0},0,0,y1,y1,y1);class la{constructor(n,o,c){this.blendFunction=n,this.blendColor=o,this.mask=c}}la.Replace=[1,0],la.disabled=new la(la.Replace,Tr.transparent,[!1,!1,!1,!1]),la.unblended=new la(la.Replace,Tr.transparent,[!0,!0,!0,!0]),la.alphaBlended=new la([1,771],Tr.transparent,[!0,!0,!0,!0]);const x1=1029,v1=2305;class js{constructor(n,o,c){this.enable=n,this.mode=o,this.frontFace=c}}js.disabled=new js(!1,x1,v1),js.backCCW=new js(!0,x1,v1),js.backCW=new js(!0,x1,2304),js.frontCW=new js(!0,1028,2304),js.frontCCW=new js(!0,1028,v1);class Yc extends fc{constructor(n,o,c){super(),this.id=n,this._onlySymbols=c,o.on("data",d=>{d.dataType==="source"&&d.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&d.dataType==="source"&&d.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),o.on("error",()=>{this._sourceErrored=!0}),this._source=o,this._tiles={},this._cache=new wO(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=o.minTileCacheSize,this._maxTileCacheSize=o.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new xO,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(n){this.map=n,this._minTileCacheSize=this._minTileCacheSize===void 0&&n?n._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&n?n._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles){const o=this._tiles[n];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,o){return n.isSymbolTile=this._onlySymbols,this._source.loadTile(n,o)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n,()=>{})}_abortTile(n){if(this._source.abortTile)return this._source.abortTile(n,()=>{})}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const c=this._tiles[o];c.upload(n),c.prepare(this.map.style.imageManager)}}getIds(){return Tt(this._tiles).map(n=>n.tileID).sort(gC).map(n=>n.key)}getRenderableIds(n){const o=[];for(const c in this._tiles)this._isIdRenderable(+c,n)&&o.push(this._tiles[c]);return n?o.sort((c,d)=>{const f=c.tileID,y=d.tileID,v=new ye(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),w=new ye(y.canonical.x,y.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-y.overscaledZ||w.y-v.y||w.x-v.x}).map(c=>c.tileID.key):o.map(c=>c.tileID).sort(gC).map(c=>c.key)}hasRenderableParent(n){const o=this.findLoadedParent(n,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(n,o){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(o||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(+n,"reloading")}}_reloadTile(n,o){const c=this._tiles[n];c&&(c.state!=="loading"&&(c.state=o),this._loadTile(c,this._tileLoaded.bind(this,c,n,o)))}_tileLoaded(n,o,c,d){if(d)if(n.state="errored",d.status!==404)this._source.fire(new ws(d,{tile:n}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const f=this.map.painter.terrain;this.update(this.transform,f.getScaledDemTileSize(),!0),f.resetTileLookupCache(this.id)}else this.update(this.transform);else n.timeAdded=bs.now(),c==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(o,n),this._source.type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new wa("data",{dataType:"source",tile:n,coord:n.tileID,sourceCacheId:this.id}))}_backfillDEM(n){const o=this.getRenderableIds();for(let d=0;d<o.length;d++){const f=o[d];if(n.neighboringTiles&&n.neighboringTiles[f]){const y=this.getTileByID(f);c(n,y),c(y,n)}}function c(d,f){if(!d.dem||d.dem.borderReady)return;d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0;let y=f.tileID.canonical.x-d.tileID.canonical.x;const v=f.tileID.canonical.y-d.tileID.canonical.y,w=Math.pow(2,d.tileID.canonical.z),S=f.tileID.key;y===0&&v===0||Math.abs(v)>1||(Math.abs(y)>1&&(Math.abs(y+w)===1?y+=w:Math.abs(y-w)===1&&(y-=w)),f.dem&&d.dem&&(d.dem.backfillBorder(f.dem,y,v),d.neighboringTiles&&d.neighboringTiles[S]&&(d.neighboringTiles[S].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,o,c,d){for(const f in this._tiles){let y=this._tiles[f];if(d[f]||!y.hasData()||y.tileID.overscaledZ<=o||y.tileID.overscaledZ>c)continue;let v=y.tileID;for(;y&&y.tileID.overscaledZ>o+1;){const S=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[S.key],y&&y.hasData()&&(v=S)}let w=v;for(;w.overscaledZ>o;)if(w=w.scaledTo(w.overscaledZ-1),n[w.key]){d[v.key]=v;break}}}findLoadedParent(n,o){if(n.key in this._loadedParentTiles){const c=this._loadedParentTiles[n.key];return c&&c.tileID.overscaledZ>=o?c:null}for(let c=n.overscaledZ-1;c>=o;c--){const d=n.scaledTo(c),f=this._getLoadedTile(d);if(f)return f}}_getLoadedTile(n){const o=this._tiles[n.key];return o&&o.hasData()?o:this._cache.getByKey(this._source.reparseOverscaled?n.wrapped().key:n.canonical.key)}updateCacheSize(n,o){o=o||this._source.tileSize;const c=Math.ceil(n.width/o)+1,d=Math.ceil(n.height/o)+1,f=Math.floor(c*d*5),y=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,f):f,v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(v)}handleWrapJump(n){const o=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,o){const c={};for(const d in this._tiles){const f=this._tiles[d];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+o),c[f.tileID.key]=f}this._tiles=c;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(+d,this._tiles[d])}}update(n,o,c){if(this.transform=n,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let d;this.updateCacheSize(n,o),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new $i(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y)):(d=n.coveringTiles({tileSize:o||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(d=d.filter(v=>this._source.hasTile(v)))):d=[];const f=this._updateRetainedTiles(d);if(yC(this._source.type)&&d.length!==0){const v={},w={},S=Object.keys(f);for(const M of S){const P=f[M],B=this._tiles[M];if(!B||B.fadeEndTime&&B.fadeEndTime<=bs.now())continue;const j=this.findLoadedParent(P,Math.max(P.overscaledZ-Yc.maxOverzooming,this._source.minzoom));j&&(this._addTile(j.tileID),v[j.tileID.key]=j.tileID),w[M]=P}const k=d[d.length-1].overscaledZ;for(const M in this._tiles){const P=this._tiles[M];if(f[M]||!P.hasData())continue;let B=P.tileID;for(;B.overscaledZ>k;){B=B.scaledTo(B.overscaledZ-1);const j=this._tiles[B.key];if(j&&j.hasData()&&w[B.key]){f[M]=P.tileID;break}}}for(const M in v)f[M]||(this._coveredTiles[M]=!0,f[M]=v[M])}for(const v in f)this._tiles[v].clearFadeHold();const y=function(v,w){const S=[];for(const k in v)k in w||S.push(k);return S}(this._tiles,f);for(const v of y){const w=this._tiles[v];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(+n)}_updateRetainedTiles(n){const o={};if(n.length===0)return o;const c={},d=n.reduce((S,k)=>Math.min(S,k.overscaledZ),1/0),f=n[0].overscaledZ,y=Math.max(f-Yc.maxOverzooming,this._source.minzoom),v=Math.max(f+Yc.maxUnderzooming,this._source.minzoom),w={};for(const S of n){const k=this._addTile(S);o[S.key]=S,k.hasData()||d<this._source.maxzoom&&(w[S.key]=S)}this._retainLoadedChildren(w,d,v,o);for(const S of n){let k=this._tiles[S.key];if(k.hasData())continue;if(S.canonical.z>=this._source.maxzoom){const P=S.children(this._source.maxzoom)[0],B=this.getTile(P);if(B&&B.hasData()){o[P.key]=P;continue}}else{const P=S.children(this._source.maxzoom);if(o[P[0].key]&&o[P[1].key]&&o[P[2].key]&&o[P[3].key])continue}let M=k.wasRequested();for(let P=S.overscaledZ-1;P>=y;--P){const B=S.scaledTo(P);if(c[B.key]||(c[B.key]=!0,k=this.getTile(B),!k&&M&&(k=this._addTile(B)),k&&(o[B.key]=B,M=k.wasRequested(),k.hasData())))break}}return o}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const o=[];let c,d=this._tiles[n].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){c=this._loadedParentTiles[d.key];break}o.push(d.key);const f=d.scaledTo(d.overscaledZ-1);if(c=this._getLoadedTile(f),c)break;d=f}for(const f of o)this._loadedParentTiles[f]=c}}_addTile(n){let o=this._tiles[n.key];if(o)return o;o=this._cache.getAndRemove(n),o&&(this._setTileReloadTimer(n.key,o),o.tileID=n,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,o)));const c=!!o;if(!c){const d=this.map?this.map.painter:null;o=new g1(n,this._source.tileSize*n.overscaleFactor(),this.transform.tileZoom,d,this._isRaster),this._loadTile(o,this._tileLoaded.bind(this,o,n.key,o.state))}return o?(o.uses++,this._tiles[n.key]=o,c||this._source.fire(new wa("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o):null}_setTileReloadTimer(n,o){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const c=o.getExpiryTimeout();c&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},c))}_removeTile(n){const o=this._tiles[n];o&&(o.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(+n);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(n,o,c){const d=[],f=this.transform;if(!f)return d;const y=f.projection.name==="globe",v=ia(f.center.lng);for(const w in this._tiles){const S=this._tiles[w];if(c&&S.clearQueryDebugViz(),S.holdingForFade())continue;let k;if(y){const M=S.tileID.canonical;if(M.z===0){const P=[Math.abs(Re(v,...mf(M,-1))-v),Math.abs(Re(v,...mf(M,1))-v)];k=[0,2*P.indexOf(Math.min(...P))-1]}else{const P=[Math.abs(Re(v,...mf(M,-1))-v),Math.abs(Re(v,...mf(M,0))-v),Math.abs(Re(v,...mf(M,1))-v)];k=[P.indexOf(Math.min(...P))-1]}}else k=[0];for(const M of k){const P=n.containsTile(S,f,o,M);P&&d.push(P)}}return d}getVisibleCoordinates(n){const o=this.getRenderableIds(n).map(c=>this._tiles[c].tileID);for(const c of o)c.projMatrix=this.transform.calculateProjMatrix(c.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(yC(this._source.type))for(const n in this._tiles){const o=this._tiles[n];if(o.fadeEndTime!==void 0&&o.fadeEndTime>=bs.now())return!0}return!1}setFeatureState(n,o,c){this._state.updateState(n=n||"_geojsonTileLayer",o,c)}removeFeatureState(n,o,c){this._state.removeFeatureState(n=n||"_geojsonTileLayer",o,c)}getFeatureState(n,o){return this._state.getState(n=n||"_geojsonTileLayer",o)}setDependencies(n,o,c){const d=this._tiles[n];d&&d.setDependencies(o,c)}reloadTilesForDependencies(n,o){for(const c in this._tiles)this._tiles[c].hasDependency(n,o)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(n,o))}_preloadTiles(n,o){if(!this._sourceLoaded){const v=()=>{this._sourceLoaded&&(this._source.off("data",v),this._preloadTiles(n,o))};return void this._source.on("data",v)}const c=new Map,d=Array.isArray(n)?n:[n],f=this.map.painter.terrain,y=this.usedForTerrain&&f?f.getScaledDemTileSize():this._source.tileSize;for(const v of d){const w=v.coveringTiles({tileSize:y,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const S of w)c.set(S.key,S);this.usedForTerrain&&v.updateElevation(!1)}st(Array.from(c.values()),(v,w)=>{const S=new g1(v,this._source.tileSize*v.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(S,k=>{this._source.type==="raster-dem"&&S.dem&&this._backfillDEM(S),w(k,S)})},o)}}function gC(i,n){const o=Math.abs(2*i.wrap)-+(i.wrap<0),c=Math.abs(2*n.wrap)-+(n.wrap<0);return i.overscaledZ-n.overscaledZ||c-o||n.canonical.y-i.canonical.y||n.canonical.x-i.canonical.x}function yC(i){return i==="raster"||i==="image"||i==="video"||i==="custom"}function mf(i,n){const o=1<<i.z;return[i.x/o+n,(i.x+1)/o+n]}Yc.maxOverzooming=10,Yc.maxUnderzooming=3;class ky{constructor(n,o,c){this._demTile=n,this._dem=this._demTile.dem,this._scale=o,this._offset=c}static create(n,o,c){const d=c||n.findDEMTileFor(o);if(!d||!d.dem)return;const f=d.dem,y=d.tileID,v=1<<o.canonical.z-y.canonical.z;return new ky(d,d.tileSize/$t/v,[(o.canonical.x/v-y.canonical.x)*f.dim,(o.canonical.y/v-y.canonical.y)*f.dim])}tileCoordToPixel(n,o){const c=o*this._scale+this._offset[1],d=Math.floor(n*this._scale+this._offset[0]),f=Math.floor(c);return new ye(d,f)}getElevationAt(n,o,c,d){const f=n*this._scale+this._offset[0],y=o*this._scale+this._offset[1],v=Math.floor(f),w=Math.floor(y),S=this._dem;return d=!!d,c?gn(gn(S.get(v,w,d),S.get(v,w+1,d),y-w),gn(S.get(v+1,w,d),S.get(v+1,w+1,d),y-w),f-v):S.get(v,w,d)}getElevationAtPixel(n,o,c){return this._dem.get(n,o,!!c)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*Os(1,n)*this._dem.stride}}class _C{constructor(n,o){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Aa($t,16,0),this.featureIndexArray=new jc,this.promoteId=o}insert(n,o,c,d,f,y=0){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,d,f,y);const w=this.grid;for(let S=0;S<o.length;S++){const k=o[S],M=[1/0,1/0,-1/0,-1/0];for(let P=0;P<k.length;P++){const B=k[P];M[0]=Math.min(M[0],B.x),M[1]=Math.min(M[1],B.y),M[2]=Math.max(M[2],B.x),M[3]=Math.max(M[3],B.y)}M[0]<$t&&M[1]<$t&&M[2]>=0&&M[3]>=0&&w.insert(v,M[0],M[1],M[2],M[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new e1(new py(this.rawTileData)).layers,this.sourceLayerCoder=new rC(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,o,c,d){this.loadVTLayers();const f=n.params||{},y=nd(f.filter),v=n.tileResult,w=n.transform,S=v.bufferedTilespaceBounds,k=this.grid.query(S.min.x,S.min.y,S.max.x,S.max.y,(j,U,Q,ae)=>VE(v.bufferedTilespaceGeometry,j,U,Q,ae));k.sort(SO);let M=null;w.elevation&&k.length>0&&(M=ky.create(w.elevation,this.tileID));const P={};let B;for(let j=0;j<k.length;j++){const U=k[j];if(U===B)continue;B=U;const Q=this.featureIndexArray.get(U);let ae=null;this.loadMatchingFeature(P,Q,y,f.layers,f.availableImages,o,c,d,(ge,le,fe,be=0)=>(ae||(ae=Oa(ge,this.tileID.canonical,n.tileTransform)),le.queryIntersectsFeature(v,ge,fe,ae,this.z,n.transform,n.pixelPosMatrix,M,be)))}return P}loadMatchingFeature(n,o,c,d,f,y,v,w,S){const{featureIndex:k,bucketIndex:M,sourceLayerIndex:P,layoutVertexArrayOffset:B}=o,j=this.bucketLayerIDs[M];if(d&&!function(ge,le){for(let fe=0;fe<ge.length;fe++)if(le.indexOf(ge[fe])>=0)return!0;return!1}(d,j))return;const U=this.sourceLayerCoder.decode(P),Q=this.vtLayers[U].feature(k);if(c.needGeometry){const ge=Hc(Q,!0);if(!c.filter(new A(this.tileID.overscaledZ),ge,this.tileID.canonical))return}else if(!c.filter(new A(this.tileID.overscaledZ),Q))return;const ae=this.getId(Q,U);for(let ge=0;ge<j.length;ge++){const le=j[ge];if(d&&d.indexOf(le)<0)continue;const fe=y[le];if(!fe)continue;let be={};ae!==void 0&&w&&(be=w.getState(fe.sourceLayer||"_geojsonTileLayer",ae));const ve=zt({},v[le]);ve.paint=xC(ve.paint,fe.paint,Q,be,f),ve.layout=xC(ve.layout,fe.layout,Q,be,f);const Ne=!S||S(Q,fe,be,B);if(!Ne)continue;const Be=new iC(Q,this.z,this.x,this.y,ae);Be.layer=ve;let He=n[le];He===void 0&&(He=n[le]=[]),He.push({featureIndex:k,feature:Be,intersectionZ:Ne})}}lookupSymbolFeatures(n,o,c,d,f,y,v,w){const S={};this.loadVTLayers();const k=nd(f);for(const M of n)this.loadMatchingFeature(S,{bucketIndex:c,sourceLayerIndex:d,featureIndex:M,layoutVertexArrayOffset:0},k,y,v,w,o);return S}loadFeature(n){const{featureIndex:o,sourceLayerIndex:c}=n;this.loadVTLayers();const d=this.sourceLayerCoder.decode(c),f=this.vtFeatures[d];if(f[o])return f[o];const y=this.vtLayers[d].feature(o);return f[o]=y,y}hasLayer(n){for(const o of this.bucketLayerIDs)for(const c of o)if(n===c)return!0;return!1}getId(n,o){let c=n.id;if(this.promoteId){const d=typeof this.promoteId=="string"?this.promoteId:this.promoteId[o];d!=null&&(c=n.properties[d]),typeof c=="boolean"&&(c=Number(c))}return c}}function xC(i,n,o,c,d){return Rt(i,(f,y)=>{const v=n instanceof se?n.get(y):null;return v&&v.evaluate?v.evaluate(o,c,d):v})}function SO(i,n){return n-i}kt(_C,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class vC{constructor(n,o){this.width=n,this.height=o,this.nextRow=0,this.image=new Ba({width:n,height:o}),this.positions={},this.uploaded=!1}getDash(n,o){const c=this.getKey(n,o);return this.positions[c]}trim(){const n=this.width,o=this.height=Mn(this.nextRow);this.image.resize({width:n,height:o})}getKey(n,o){return n.join(",")+o}getDashRanges(n,o,c){const d=[];let f=n.length%2==1?-n[n.length-1]*c:0,y=n[0]*c,v=!0;d.push({left:f,right:y,isDash:v,zeroLength:n[0]===0});let w=n[0];for(let S=1;S<n.length;S++){v=!v;const k=n[S];f=w*c,w+=k,y=w*c,d.push({left:f,right:y,isDash:v,zeroLength:k===0})}return d}addRoundDash(n,o,c){const d=o/2;for(let f=-c;f<=c;f++){const y=this.width*(this.nextRow+c+f);let v=0,w=n[v];for(let S=0;S<this.width;S++){S/w.right>1&&(w=n[++v]);const k=Math.abs(S-w.left),M=Math.abs(S-w.right),P=Math.min(k,M);let B;const j=f/c*(d+1);if(w.isDash){const U=d-Math.abs(j);B=Math.sqrt(P*P+U*U)}else B=d-Math.sqrt(P*P+j*j);this.image.data[y+S]=Math.max(0,Math.min(255,B+128))}}}addRegularDash(n,o){for(let w=n.length-1;w>=0;--w){const S=n[w],k=n[w+1];S.zeroLength?n.splice(w,1):k&&k.isDash===S.isDash&&(k.left=S.left,n.splice(w,1))}const c=n[0],d=n[n.length-1];c.isDash===d.isDash&&(c.left=d.left-this.width,d.right=c.right+this.width);const f=this.width*this.nextRow;let y=0,v=n[y];for(let w=0;w<this.width;w++){w/v.right>1&&(v=n[++y]);const S=Math.abs(w-v.left),k=Math.abs(w-v.right),M=Math.min(S,k);this.image.data[f+w]=Math.max(0,Math.min(255,(v.isDash?M:-M)+o+128))}}addDash(n,o){const c=this.getKey(n,o);if(this.positions[c])return this.positions[c];const d=o==="round",f=d?7:0,y=2*f+1;if(this.nextRow+y>this.height)return Kt("LineAtlas out of space"),null;n.length===0&&n.push(1);let v=0;for(let k=0;k<n.length;k++)n[k]<0&&(Kt("Negative value is found in line dasharray, replacing values with 0"),n[k]=0),v+=n[k];if(v!==0){const k=this.width/v,M=this.getDashRanges(n,this.width,k);d?this.addRoundDash(M,k,f):this.addRegularDash(M,o==="square"?.5*k:0)}const w=this.nextRow+f;this.nextRow+=y;const S={tl:[w,f],br:[v,0]};return this.positions[c]=S,S}}kt(vC,"LineAtlas");const bC=1*Fs;class wC{constructor(n){const o={},c=[];for(const v in n){const w=n[v],S=o[v]={};for(const k in w.glyphs){const M=w.glyphs[+k];if(!M||M.bitmap.width===0||M.bitmap.height===0)continue;const P=M.metrics.localGlyph?bC:1,B={x:0,y:0,w:M.bitmap.width+2*P,h:M.bitmap.height+2*P};c.push(B),S[k]=B}}const{w:d,h:f}=i1(c),y=new Ba({width:d||1,height:f||1});for(const v in n){const w=n[v];for(const S in w.glyphs){const k=w.glyphs[+S];if(!k||k.bitmap.width===0||k.bitmap.height===0)continue;const M=o[v][S],P=k.metrics.localGlyph?bC:1;Ba.copy(k.bitmap,y,{x:0,y:0},{x:M.x+P,y:M.y+P},k.bitmap)}}this.image=y,this.positions=o}}kt(wC,"GlyphAtlas");class EO{constructor(n){this.tileID=new $i(n.tileID.overscaledZ,n.tileID.wrap,n.tileID.canonical.z,n.tileID.canonical.x,n.tileID.canonical.y),this.tileZoom=n.tileZoom,this.uid=n.uid,this.zoom=n.zoom,this.canonical=n.tileID.canonical,this.pixelRatio=n.pixelRatio,this.tileSize=n.tileSize,this.source=n.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=n.showCollisionBoxes,this.collectResourceTiming=!!n.collectResourceTiming,this.returnDependencies=!!n.returnDependencies,this.promoteId=n.promoteId,this.enableTerrain=!!n.enableTerrain,this.isSymbolTile=n.isSymbolTile,this.tileTransform=Kc(n.tileID.canonical,n.projection),this.projection=n.projection}parse(n,o,c,d,f){this.status="parsing",this.data=n,this.collisionBoxArray=new Nn;const y=new rC(Object.keys(n.layers).sort()),v=new _C(this.tileID,this.promoteId);v.bucketLayerIDs=[];const w={},S=new vC(256,256),k={featureIndex:v,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:S,availableImages:c},M=o.familiesBySource[this.source];for(const be in M){const ve=n.layers[be];if(!ve)continue;let Ne=!1,Be=!1;for(const Ue of M[be])Ue[0].type==="symbol"?Ne=!0:Be=!0;if(this.isSymbolTile===!0&&!Ne||this.isSymbolTile===!1&&!Be)continue;ve.version===1&&Kt(`Vector tile source "${this.source}" layer "${be}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const He=y.encode(be),it=[];for(let Ue=0;Ue<ve.length;Ue++){const Ye=ve.feature(Ue),Je=v.getId(Ye,be);it.push({feature:Ye,id:Je,index:Ue,sourceLayerIndex:He})}for(const Ue of M[be]){const Ye=Ue[0];this.isSymbolTile!==void 0&&Ye.type==="symbol"!==this.isSymbolTile||Ye.minzoom&&this.zoom<Math.floor(Ye.minzoom)||Ye.maxzoom&&this.zoom>=Ye.maxzoom||Ye.visibility!=="none"&&(b1(Ue,this.zoom,c),(w[Ye.id]=Ye.createBucket({index:v.bucketLayerIDs.length,layers:Ue,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:He,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:c})).populate(it,k,this.tileID.canonical,this.tileTransform),v.bucketLayerIDs.push(Ue.map(Je=>Je.id)))}}let P,B,j,U;S.trim();const Q={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ae=()=>{if(P)return f(P);if(B&&j&&U){const be=new wC(B),ve=new AT(j,U);for(const Ne in w){const Be=w[Ne];Be instanceof Il?(b1(Be.layers,this.zoom,c),K3(Be,B,be.positions,j,ve.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection)):Be.hasPattern&&(Be instanceof uy||Be instanceof oy||Be instanceof nf)&&(b1(Be.layers,this.zoom,c),Be.addFeatures(k,this.tileID.canonical,ve.patternPositions,c,this.tileTransform))}this.status="done",f(null,{buckets:Tt(w).filter(Ne=>!Ne.isEmpty()),featureIndex:v,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:be.image,lineAtlas:S,imageAtlas:ve,glyphMap:this.returnDependencies?B:null,iconMap:this.returnDependencies?j:null,glyphPositions:this.returnDependencies?be.positions:null})}},ge=Rt(k.glyphDependencies,be=>Object.keys(be).map(Number));Object.keys(ge).length?d.send("getGlyphs",{uid:this.uid,stacks:ge},(be,ve)=>{P||(P=be,B=ve,ae())},void 0,!1,Q):B={};const le=Object.keys(k.iconDependencies);le.length?d.send("getImages",{icons:le,source:this.source,tileID:this.tileID,type:"icons"},(be,ve)=>{P||(P=be,j=ve,ae())},void 0,!1,Q):j={};const fe=Object.keys(k.patternDependencies);fe.length?d.send("getImages",{icons:fe,source:this.source,tileID:this.tileID,type:"patterns"},(be,ve)=>{P||(P=be,U=ve,ae())},void 0,!1,Q):U={},ae()}}function b1(i,n,o){const c=new A(n);for(const d of i)d.recalculate(c,o)}class SC{constructor(n){this.entries={},this.scheduler=n}request(n,o,c,d){const f=this.entries[n]=this.entries[n]||{callbacks:[]};if(f.result){const[y,v]=f.result;return this.scheduler?this.scheduler.add(()=>{d(y,v)},o):d(y,v),()=>{}}return f.callbacks.push(d),f.cancel||(f.cancel=c((y,v)=>{f.result=[y,v];for(const w of f.callbacks)this.scheduler?this.scheduler.add(()=>{w(y,v)},o):w(y,v);setTimeout(()=>delete this.entries[n],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(y=>y!==d),f.callbacks.length||(f.cancel(),delete this.entries[n]))}}}function EC(i,n,o){const c=JSON.stringify(i.request);return i.data&&(this.deduped.entries[c]={result:[null,i.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},d=>{const f=vs(i.request,(y,v,w,S)=>{y?d(y):v&&d(null,{vectorTile:o?void 0:new e1(new py(v)),rawData:v,cacheControl:w,expires:S})});return()=>{f.cancel(),d()}},n)}const TC=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class w1{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,c]=new Uint8Array(n,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=c>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);const f=TC[15&c];if(!f)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(n,2,1),[v]=new Uint32Array(n,4,1);return new w1(v,y,f,n)}constructor(n,o=64,c=Float64Array,d){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=c,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const f=TC.indexOf(this.ArrayType),y=2*n*this.ArrayType.BYTES_PER_ELEMENT,v=n*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-v%8)%8;if(f<0)throw new Error(`Unexpected typed array class: ${c}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+v+w,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+y+v+w),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+v+w,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+f]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=n)}add(n,o){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=n,this.coords[this._pos++]=o,c}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return S1(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,o,c,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:y,nodeSize:v}=this,w=[0,f.length-1,0],S=[];for(;w.length;){const k=w.pop()||0,M=w.pop()||0,P=w.pop()||0;if(M-P<=v){for(let Q=P;Q<=M;Q++){const ae=y[2*Q],ge=y[2*Q+1];ae>=n&&ae<=c&&ge>=o&&ge<=d&&S.push(f[Q])}continue}const B=P+M>>1,j=y[2*B],U=y[2*B+1];j>=n&&j<=c&&U>=o&&U<=d&&S.push(f[B]),(k===0?n<=j:o<=U)&&(w.push(P),w.push(B-1),w.push(1-k)),(k===0?c>=j:d>=U)&&(w.push(B+1),w.push(M),w.push(1-k))}return S}within(n,o,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:f,nodeSize:y}=this,v=[0,d.length-1,0],w=[],S=c*c;for(;v.length;){const k=v.pop()||0,M=v.pop()||0,P=v.pop()||0;if(M-P<=y){for(let Q=P;Q<=M;Q++)kC(f[2*Q],f[2*Q+1],n,o)<=S&&w.push(d[Q]);continue}const B=P+M>>1,j=f[2*B],U=f[2*B+1];kC(j,U,n,o)<=S&&w.push(d[B]),(k===0?n-c<=j:o-c<=U)&&(v.push(P),v.push(B-1),v.push(1-k)),(k===0?n+c>=j:o+c>=U)&&(v.push(B+1),v.push(M),v.push(1-k))}return w}}function S1(i,n,o,c,d,f){if(d-c<=o)return;const y=c+d>>1;CC(i,n,y,c,d,f),S1(i,n,o,c,y-1,1-f),S1(i,n,o,y+1,d,1-f)}function CC(i,n,o,c,d,f){for(;d>c;){if(d-c>600){const S=d-c+1,k=o-c+1,M=Math.log(S),P=.5*Math.exp(2*M/3),B=.5*Math.sqrt(M*P*(S-P)/S)*(k-S/2<0?-1:1);CC(i,n,o,Math.max(c,Math.floor(o-k*P/S+B)),Math.min(d,Math.floor(o+(S-k)*P/S+B)),f)}const y=n[2*o+f];let v=c,w=d;for(gf(i,n,c,o),n[2*d+f]>y&&gf(i,n,c,d);v<w;){for(gf(i,n,v,w),v++,w--;n[2*v+f]<y;)v++;for(;n[2*w+f]>y;)w--}n[2*c+f]===y?gf(i,n,c,w):(w++,gf(i,n,w,d)),w<=o&&(c=w+1),o<=w&&(d=w-1)}}function gf(i,n,o,c){E1(i,o,c),E1(n,2*o,2*c),E1(n,2*o+1,2*c+1)}function E1(i,n,o){const c=i[n];i[n]=i[o],i[o]=c}function kC(i,n,o,c){const d=i-o,f=n-c;return d*d+f*f}a.ARRAY_TYPE=fo,a.AUTH_ERR_MSG=we,a.Aabb=Ni,a.Actor=class{constructor(i,n,o){this.target=i,this.parent=n,this.mapId=o,this.callbacks={},this.cancelCallbacks={},qn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Sr()?i:E,this.scheduler=new yO}send(i,n,o,c,d=!1,f){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(o.metadata=f,this.callbacks[y]=o);const v=On(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:i,hasCallback:!!o,targetMapId:c,mustQueue:d,sourceMapId:this.mapId,data:vl(n,v)},v),{cancel:()=>{o&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(i){const n=i.data,o=n.id;if(o&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){const c=this.cancelCallbacks[o];delete this.cancelCallbacks[o],c&&c.cancel()}else if(n.mustQueue||Sr()){const c=this.callbacks[o];this.cancelCallbacks[o]=this.scheduler.add(()=>this.processTask(o,n),c&&c.metadata||{type:"message"})}else this.processTask(o,n)}processTask(i,n){if(n.type==="<response>"){const o=this.callbacks[i];delete this.callbacks[i],o&&(n.error?o(Ma(n.error)):o(null,Ma(n.data)))}else{const o=On(this.globalScope)?void 0:[],c=n.hasCallback?(f,y)=>{delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:f?vl(f):null,data:vl(y,o)},o)}:f=>{},d=Ma(n.data);if(this.parent[n.type])this.parent[n.type](n.sourceMapId,d,c);else if(this.parent.getWorkerSource){const f=n.type.split(".");this.parent.getWorkerSource(n.sourceMapId,f[0],d.source)[f[1]](d,c)}else c(new Error(`Could not find function ${n.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=cy,a.Color=Tr,a.ColorMode=la,a.CullFaceMode=js,a.DEMData=Cy,a.DataConstantProperty=$,a.DedupedRequest=SC,a.DepthMode=kd,a.EXTENT=$t,a.Elevation=class{isDataAvailableAtPoint(i){const n=this._source();if(this.isUsingMockSource()||!n||i.y<0||i.y>1)return!1;const o=n.getSource().maxzoom,c=1<<o,d=Math.floor(i.x),f=Math.floor((i.x-d)*c),y=Math.floor(i.y*c),v=this.findDEMTileFor(new $i(o,d,o,f,y));return!(!v||!v.dem)}getAtPointOrZero(i,n=0){return this.getAtPoint(i,n)||0}getAtPoint(i,n,o=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const c=this._source();if(!c||i.y<0||i.y>1)return n;const d=c.getSource().maxzoom,f=1<<d,y=Math.floor(i.x),v=i.x-y,w=new $i(d,y,d,Math.floor(v*f),Math.floor(i.y*f)),S=this.findDEMTileFor(w);if(!S||!S.dem)return n;const k=S.dem,M=1<<S.tileID.canonical.z,P=(v*M-S.tileID.canonical.x)*k.dim,B=(i.y*M-S.tileID.canonical.y)*k.dim,j=Math.floor(P),U=Math.floor(B);return(o?this.exaggeration():1)*gn(gn(k.get(j,U),k.get(j,U+1),B-U),gn(k.get(j+1,U),k.get(j+1,U+1),B-U),P-j)}getAtTileOffset(i,n,o){const c=1<<i.canonical.z;return this.getAtPointOrZero(new pd(i.wrap+(i.canonical.x+n/$t)/c,(i.canonical.y+o/$t)/c))}getAtTileOffsetFunc(i,n,o,c){return d=>{const f=this.getAtTileOffset(i,d.x,d.y),y=c.upVector(i.canonical,d.x,d.y);return Ao(y,y,f*c.upVectorScale(i.canonical,n,o).metersToTile),y}}getForTilePoints(i,n,o,c){if(this.isUsingMockSource())return!1;const d=ky.create(this,i,c);return!!d&&(n.forEach(f=>{f[2]=this.exaggeration()*d.getElevationAt(f[0],f[1],o)}),!0)}getMinMaxForTile(i){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(i);if(!n||!n.dem)return null;const o=n.dem.tree,c=n.tileID,d=1<<i.canonical.z-c.canonical.z;let f=i.canonical.x/d-c.canonical.x,y=i.canonical.y/d-c.canonical.y,v=0;for(let w=0;w<i.canonical.z-c.canonical.z&&!o.leaves[v];w++){f*=2,y*=2;const S=2*Math.floor(y)+Math.floor(f);v=o.childOffsets[v]+S,f%=1,y%=1}return{min:this.exaggeration()*o.minimums[v],max:this.exaggeration()*o.maximums[v]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,n,o){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=ws,a.EvaluationParameters=A,a.Event=wa,a.Evented=fc,a.FillExtrusionBucket=nf,a.Frustum=Pv,a.FrustumCorners=Mv,a.GLOBE_RADIUS=na,a.GLOBE_SCALE_MATCH_LATITUDE=45,a.GLOBE_ZOOM_THRESHOLD_MAX=CE,a.GLOBE_ZOOM_THRESHOLD_MIN=Rv,a.GlobeSharedBuffers=class{constructor(i){this._createGrid(i),this._createPoles(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();for(const i of this._gridSegments)i.withSkirts.destroy(),i.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const i of this._wireframeSegments)i.destroy()}}_fillGridMeshWithLods(i,n){const o=new rt,c=new Lt,d=[],f=i+1+2,y=n[0]+1,v=n[0]+1+(1+n.length),w=(S,k,M)=>{let P=S===f-1?S-2:S===0?S:S-1;return P+=M?24575:0,[P,k]};for(let S=0;S<f;++S)o.emplaceBack(...w(S,0,!0));for(let S=0;S<y;++S)for(let k=0;k<f;++k)o.emplaceBack(...w(k,S,(k===0||k===f-1)&&!0));for(let S=0;S<n.length;++S){const k=n[S];for(let M=0;M<f;++M)o.emplaceBack(...w(M,k,!0))}for(let S=0;S<n.length;++S){const k=c.length,M=n[S]+1+2,P=new Lt;for(let U=0;U<M-1;U++){const Q=U===M-2,ae=Q?f*(v-n.length+S-U):f;for(let ge=0;ge<f-1;ge++){const le=U*f+ge;U===0||Q||ge===0||ge===f-2?(P.emplaceBack(le+1,le,le+ae),P.emplaceBack(le+ae,le+ae+1,le+1)):(c.emplaceBack(le+1,le,le+ae),c.emplaceBack(le+ae,le+ae+1,le+1))}}const B=Dr.simpleSegment(0,k,o.length,c.length-k);for(let U=0;U<P.uint16.length;U+=3)c.emplaceBack(P.uint16[U],P.uint16[U+1],P.uint16[U+2]);const j=Dr.simpleSegment(0,k,o.length,c.length-k);d.push({withoutSkirts:B,withSkirts:j})}return{vertices:o,indices:c,segments:d}}_createGrid(i){const n=this._fillGridMeshWithLods(Gc,qp);this._gridSegments=n.segments,this._gridBuffer=i.createVertexBuffer(n.vertices,Gp.members),this._gridIndexBuffer=i.createIndexBuffer(n.indices,!0)}_createPoles(i){const n=new Lt;for(let d=0;d<=Gc;d++)n.emplaceBack(0,d+1,d+2);this._poleIndexBuffer=i.createIndexBuffer(n,!0);const o=new jn,c=new jn;this._poleSegments=[];for(let d=0,f=0;d<Rv;d++){const y=360/(1<<d);o.emplaceBack(0,-na,0,.5,0),c.emplaceBack(0,-na,0,.5,1);for(let v=0;v<=Gc;v++){const w=v/Gc,S=gn(0,y,w),[k,M,P]=ud(yD,_D,S,na);o.emplaceBack(k,M,P,w,0),c.emplaceBack(k,M,P,w,1)}this._poleSegments.push(Dr.simpleSegment(f,0,66,64)),f+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(o,EE,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(c,EE,!1)}getGridBuffers(i,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[i].withSkirts:this._gridSegments[i].withoutSkirts]}getPoleBuffers(i){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}getWirefameBuffers(i,n){if(!this._wireframeSegments){const o=new ri,c=Gc,d=c+1+2,f=1;this._wireframeSegments=[];for(let y=0,v=0;y<qp.length;y++){const w=qp[y];for(let k=f;k<w+f;k++)for(let M=f;M<c+f;M++){const P=k*d+M;o.emplaceBack(P,P+1),o.emplaceBack(P,P+d),o.emplaceBack(P,P+d+1)}const S=w*c*3;this._wireframeSegments.push(Dr.simpleSegment(0,v,(w+1)*d,S)),v+=S}this._wireframeIndexBuffer=i.createIndexBuffer(o)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[n]]}},a.GlyphManager=wd,a.ImagePosition=o1,a.KDBush=w1,a.LivePerformanceUtils=Jx,a.LngLat=$n,a.LngLatBounds=El,a.LocalGlyphMode=l1,a.MAX_MERCATOR_LATITUDE=Si,a.MercatorCoordinate=pd,a.ONE_EM=fi,a.OverscaledTileID=$i,a.PerformanceMarkers=rl,a.Point=ye,a.Properties=de,a.RGBAImage=mo,a.Ray=Av,a.RequestManager=class{constructor(i,n,o){this._transformRequestFn=i,this._customAccessToken=n,this._silenceAuthErrors=!!o,this._createSkuToken()}_createSkuToken(){const i=function(){let n="";for(let o=0;o<10;o++)n+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",H,n].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,n){return this._transformRequestFn&&this._transformRequestFn(i,n)||{url:i}}normalizeStyleURL(i,n){if(!ke(i))return i;const o=mt(i);return o.path=`/styles/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||n)}normalizeGlyphsURL(i,n){if(!ke(i))return i;const o=mt(i);return o.path=`/fonts/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||n)}normalizeSourceURL(i,n,o,c){if(!ke(i))return i;const d=mt(i);return d.path=`/v4/${d.authority}.json`,d.params.push("secure"),o&&d.params.push(`language=${o}`),c&&d.params.push(`worldview=${c}`),this._makeAPIURL(d,this._customAccessToken||n)}normalizeSpriteURL(i,n,o,c){const d=mt(i);return ke(i)?(d.path=`/styles/v1${d.path}/sprite${n}${o}`,this._makeAPIURL(d,this._customAccessToken||c)):(d.path+=`${n}${o}`,ut(d))}normalizeTileURL(i,n,o){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!ke(i))return i;const c=mt(i);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${n||o&&c.authority!=="raster"&&o===512?"@2x":""}${F.supported?".webp":"$1"}`),c.authority==="raster"?c.path=`/${O.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${O.TILE_URL_VERSION}${c.path}`);const d=this._customAccessToken||function(f){for(const y of f){const v=y.match(/^access_token=(.*)$/);if(v)return v[1]}return null}(c.params)||O.ACCESS_TOKEN;return O.REQUIRE_ACCESS_TOKEN&&d&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,d)}canonicalizeTileURL(i,n){const o=mt(i);if(!o.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!o.path.match(/\.[\w]+$/))return i;let c="mapbox://";o.path.match(/^\/raster\/v1\//)?c+=`raster/${o.path.replace(`/${O.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${o.path.replace(`/${O.TILE_URL_VERSION}/`,"")}`;let d=o.params;return n&&(d=d.filter(f=>!f.match(/^access_token=/))),d.length&&(c+=`?${d.join("&")}`),c}canonicalizeTileset(i,n){const o=!!n&&ke(n),c=[];for(const d of i.tiles||[])Le(d)?c.push(this.canonicalizeTileURL(d,o)):c.push(d);return c}_makeAPIURL(i,n){const o="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=mt(O.API_URL);if(i.protocol=c.protocol,i.authority=c.authority,i.protocol==="http"){const d=i.params.indexOf("secure");d>=0&&i.params.splice(d,1)}if(c.path!=="/"&&(i.path=`${c.path}${i.path}`),!O.REQUIRE_ACCESS_TOKEN)return ut(i);if(n=n||O.ACCESS_TOKEN,!this._silenceAuthErrors){if(!n)throw new Error(`An API access token is required to use Mapbox GL. ${o}`);if(n[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${o}`)}return i.params=i.params.filter(d=>d.indexOf("access_token")===-1),i.params.push(`access_token=${n||""}`),ut(i)}},a.ResourceType=Gt,a.SegmentVector=Dr,a.SourceCache=Yc,a.StencilMode=_1,a.StructArrayLayout1ui2=po,a.StructArrayLayout2f1f2i16=Ut,a.StructArrayLayout2i4=rt,a.StructArrayLayout2ui4=ri,a.StructArrayLayout3f12=ln,a.StructArrayLayout3ui6=Lt,a.StructArrayLayout4i8=Ke,a.StructArrayLayout5f20=jn,a.Texture=ff,a.Tile=g1,a.Transitionable=N,a.Uniform1f=qg,a.Uniform1i=class extends za{constructor(i){super(i),this.current=0}set(i,n,o){this.fetchUniformLocation(i,n)&&this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},a.Uniform2f=class extends za{constructor(i){super(i),this.current=[0,0]}set(i,n,o){this.fetchUniformLocation(i,n)&&(o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1])))}},a.Uniform3f=class extends za{constructor(i){super(i),this.current=[0,0,0]}set(i,n,o){this.fetchUniformLocation(i,n)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2])))}},a.Uniform4f=aE,a.UniformColor=lE,a.UniformMatrix2f=class extends za{constructor(i){super(i),this.current=tD}set(i,n,o){if(this.fetchUniformLocation(i,n)){for(let c=0;c<4;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix2fv(this.location,!1,o);break}}}},a.UniformMatrix3f=class extends za{constructor(i){super(i),this.current=eD}set(i,n,o){if(this.fetchUniformLocation(i,n)){for(let c=0;c<9;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}},a.UniformMatrix4f=class extends za{constructor(i){super(i),this.current=QL}set(i,n,o){if(this.fetchUniformLocation(i,n)){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let c=1;c<16;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}}},a.UnwrappedTileID=fT,a.ValidationError=Et,a.VectorTileFeature=ay,a.VectorTileWorkerSource=class extends fc{constructor(i,n,o,c,d){super(),this.actor=i,this.layerIndex=n,this.availableImages=o,this.loadVectorData=d||EC,this.loading={},this.loaded={},this.deduped=new SC(i.scheduler),this.isSpriteLoaded=c,this.scheduler=i.scheduler}loadTile(i,n){const o=i.uid,c=i&&i.request,d=c&&c.collectResourceTiming,f=this.loading[o]=new EO(i);f.abort=this.loadVectorData(i,(y,v)=>{const w=!this.loading[o];if(delete this.loading[o],w||y||!v)return f.status="done",w||(this.loaded[o]=f),n(y);const S=v.rawData,k={};v.expires&&(k.expires=v.expires),v.cacheControl&&(k.cacheControl=v.cacheControl),f.vectorTile=v.vectorTile||new e1(new py(S));const M=()=>{f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,(P,B)=>{if(P||!B)return n(P);const j={};if(d){const U=Uh(c);U.length>0&&(j.resourceTiming=JSON.parse(JSON.stringify(U)))}n(null,zt({rawTileData:S.slice(0)},B,k,j))})};this.isSpriteLoaded?M():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(M,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):M()}),this.loaded=this.loaded||{},this.loaded[o]=f})}reloadTile(i,n){const o=this.loaded,c=i.uid,d=this;if(o&&o[c]){const f=o[c];f.showCollisionBoxes=i.showCollisionBoxes,f.enableTerrain=!!i.enableTerrain,f.projection=i.projection,f.tileTransform=Kc(i.tileID.canonical,i.projection);const y=(v,w)=>{const S=f.reloadCallback;S&&(delete f.reloadCallback,f.parse(f.vectorTile,d.layerIndex,this.availableImages,d.actor,S)),n(v,w)};f.status==="parsing"?f.reloadCallback=y:f.status==="done"&&(f.vectorTile?f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,y):y())}}abortTile(i,n){const o=i.uid,c=this.loading[o];c&&(c.abort&&c.abort(),delete this.loading[o]),n()}removeTile(i,n){const o=this.loaded,c=i.uid;o&&o[c]&&delete o[c],n()}},a.WritingMode=Po,a.ZoomDependentExpression=Rc,a.add=Da,a.addDynamicAttributes=Sy,a.adjoint=function(i,n){var o=n[0],c=n[1],d=n[2],f=n[3],y=n[4],v=n[5],w=n[6],S=n[7],k=n[8];return i[0]=y*k-v*S,i[1]=d*S-c*k,i[2]=c*v-d*y,i[3]=v*w-f*k,i[4]=o*k-d*w,i[5]=d*f-o*v,i[6]=f*S-y*w,i[7]=c*w-o*S,i[8]=o*y-c*f,i},a.asyncAll=st,a.bezier=St,a.bindAll=qn,a.boundsAttributes=sC,a.bufferConvexPolygon=function(i,n){const o=[];for(let c=0;c<i.length;c++){const d=Ie(c-1,-1,i.length-1),f=Ie(c+1,-1,i.length-1),y=i[c],v=i[f],w=i[d].sub(y).unit(),S=v.sub(y).unit(),k=S.angleWithSep(w.x,w.y),M=w.add(S).unit().mult(-1*n/Math.sin(k/2));o.push(y.add(M))}return o},a.cacheEntryPossiblyAdded=function(i){To++,To>Ji&&(i.getActor().send("enforceCacheSizeLimit",Ii),To=0)},a.calculateGlobeLabelMatrix=function(i,n){const{x:o,y:c}=i.point,d=PE(o,c,i.worldSize/i._pixelsPerMercatorPixel,0,0);return Uc(d,d,Dv(ra(n)))},a.calculateGlobeMatrix=function(i){const{x:n,y:o}=i.point,{lng:c,lat:d}=i._center;return PE(n,o,i.worldSize,c,d)},a.calculateGlobeMercatorMatrix=function(i){const n=i.pixelsPerMeter,o=n/Os(1,i.center.lat),c=Ls(new Float64Array(16));return jp(c,c,[i.point.x,i.point.y,0]),Vc(c,c,[o,o,n]),Float32Array.from(c)},a.circumferenceAtLatitude=Bv,a.clamp=Re,a.clearTileCache=function(i){if(!qt())return;const n=E.caches.delete(zn);i&&n.catch(i).then(()=>i())},a.clipLine=UT,a.clone=function(i){var n=new fo(16);return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],n},a.clone$1=Xt,a.collisionCircleLayout=w3,a.config=O,a.conjugate=function(i,n){return i[0]=-n[0],i[1]=-n[1],i[2]=-n[2],i[3]=n[3],i},a.create=function(){var i=new fo(16);return fo!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},a.create$1=dE,a.createExpression=yl,a.createLayout=Me,a.createStyleLayer=function(i){return i.type==="custom"?new pO(i):new mO[i.type](i)},a.cross=Iv,a.degToRad=Ge,a.distance=function(i,n){return Math.hypot(n[0]-i[0],n[1]-i[1],n[2]-i[2])},a.div=function(i,n,o){return i[0]=n[0]/o[0],i[1]=n[1]/o[1],i[2]=n[2]/o[2],i},a.dot=Qo,a.earthRadius=Xp,a.ease=It,a.easeCubicInOut=gt,a.ecefToLatLng=function([i,n,o]){const c=Math.hypot(i,n,o),d=Math.atan2(i,o),f=.5*Math.PI-Math.acos(-n/c);return new $n(et(d),et(f))},a.emitValidationErrors=Ng,a.endsWith=Mr,a.enforceCacheSizeLimit=function(i){hi(),Er&&Er.then(n=>{n.keys().then(o=>{for(let c=0;c<o.length-i;c++)n.delete(o[c])})})},a.evaluateSizeForFeature=dy,a.evaluateSizeForZoom=_d,a.evaluateVariableOffset=HT,a.evented=_,a.exactEquals=function(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]},a.exactEquals$1=function(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]},a.exported=bs,a.exported$1=F,a.extend=zt,a.extend$1=Ss,a.fillExtrusionHeightLift=dT,a.filterObject=Dn,a.fromMat4=function(i,n){return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[4],i[4]=n[5],i[5]=n[6],i[6]=n[8],i[7]=n[9],i[8]=n[10],i},a.fromQuat=function(i,n){var o=n[0],c=n[1],d=n[2],f=n[3],y=o+o,v=c+c,w=d+d,S=o*y,k=c*y,M=c*v,P=d*y,B=d*v,j=d*w,U=f*y,Q=f*v,ae=f*w;return i[0]=1-M-j,i[1]=k+ae,i[2]=P-Q,i[3]=0,i[4]=k-ae,i[5]=1-S-j,i[6]=B+U,i[7]=0,i[8]=P+Q,i[9]=B-U,i[10]=1-S-M,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},a.fromRotation=function(i,n){var o=Math.sin(n),c=Math.cos(n);return i[0]=c,i[1]=o,i[2]=0,i[3]=-o,i[4]=c,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},a.fromScaling=pE,a.furthestTileCorner=function(i){const n=Math.round((i+45+360)%360/90)%4;return lt[n]},a.getAABBPointSquareDist=function(i,n,o){let c=0;for(let d=0;d<2;++d){const f=o?o[d]:0;i[d]>f&&(c+=(i[d]-f)*(i[d]-f)),n[d]<f&&(c+=(f-n[d])*(f-n[d]))}return c},a.getAnchorAlignment=a1,a.getAnchorJustification=u1,a.getBounds=function(i){let n=1/0,o=1/0,c=-1/0,d=-1/0;for(const f of i)n=Math.min(n,f.x),o=Math.min(o,f.y),c=Math.max(c,f.x),d=Math.max(d,f.y);return{min:new ye(n,o),max:new ye(c,d)}},a.getColumn=gr,a.getDefaultExportFromCjs=V,a.getGridMatrix=function(i,n,o,c){const d=n.getNorth(),f=n.getSouth(),y=n.getWest(),v=n.getEast(),w=1<<i.z,S=v-y,k=d-f,M=S/Gc,P=-k/qp[o],B=[0,M,0,P,0,0,d,y,0];if(i.z>0){const j=180/c;hE(B,B,[j/S+1,0,0,0,j/k+1,0,-.5*j/M,.5*j/P,1])}return B[2]=w,B[5]=i.x,B[8]=i.y,B},a.getImage=he,a.getJSON=function(i,n){return Di(zt(i,{type:"json"}),n)},a.getLatitudinalLod=function(i){const n=Si-5;i=Re(i,-n,n)/n*90;const o=Math.pow(Math.abs(Math.sin(Ge(i))),3);return Math.round(o*(qp.length-1))},a.getMapSessionAPI=ei,a.getPerformanceMeasurement=Uh,a.getProjection=tC,a.getRTLTextPluginStatus=b,a.getReferrer=cr,a.getTilePoint=function(i,{x:n,y:o},c=0){return new ye(((n-c)*i.scale-i.x)*$t,(o*i.scale-i.y)*$t)},a.getTileVec3=function(i,n,o=0){return cd(((n.x-o)*i.scale-i.x)*$t,(n.y*i.scale-i.y)*$t,DE(n.z,n.y))},a.getVideo=function(i,n){const o=E.document.createElement("video");o.muted=!0,o.onloadstart=function(){n(null,o)};for(let c=0;c<i.length;c++){const d=E.document.createElement("source");Pu(i[c])||(o.crossOrigin="Anonymous"),d.src=i[c],o.appendChild(d)}return{cancel:()=>{}}},a.globeCenterToScreenPoint=function(i){const n=[0,0,0],o=Ls(new Float64Array(16));return Uc(o,i.pixelMatrix,i.globeMatrix),Cr(n,n,o),new ye(n[0],n[1])},a.globeDenormalizeECEF=Dv,a.globeECEFOrigin=function(i,n){const o=[0,0,0];return Cr(o,o,Zp(ra(n.canonical))),Cr(o,o,i),o},a.globeMetersToEcef=Xg,a.globeNormalizeECEF=Zp,a.globePixelsToTileUnits=function(i,n){return $t/(512*Math.pow(2,i))*Yg(ra(n))},a.globePoleMatrixForTile=function(i,n,o){const c=Ls(new Float64Array(16)),d=(n/(1<<i)-.5)*Math.PI*2;return Zg(c,o.globeMatrix,d),Float32Array.from(c)},a.globeTileBounds=ra,a.globeTiltAtLngLat=RE,a.globeToMercatorTransition=hd,a.globeUseCustomAntiAliasing=function(i,n,o){const c=hd(o.zoom),d=i.style.map._antialias,f=!!n.extStandardDerivatives,y=n.extStandardDerivativesForceOff||i.terrain&&i.terrain.exaggeration()>0;return c===0&&!d&&!y&&f},a.identity=Ls,a.identity$1=bE,a.invert=Ev,a.isFullscreen=function(){return!!E.document.fullscreenElement||!!E.document.webkitFullscreenElement},a.isLngLatBehindGlobe=Ov,a.isMapAuthenticated=function(i){return Ai.has(i)},a.isMapboxURL=ke,a.isSafariWithAntialiasingBug=function(i){const n=i.navigator?i.navigator.userAgent:null;return!!On(i)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.latFromMercatorY=wi,a.latLngToECEF=dd,a.len=uD,a.length=Np,a.length$1=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},a.lngFromMercatorX=Mo,a.loadVectorTile=EC,a.makeRequest=Di,a.mapValue=function(i,n,o,c,d){return Re((i-n)/(o-n)*(d-c)+c,c,d)},a.mercatorScale=OE,a.mercatorXfromLng=ia,a.mercatorYfromLat=oa,a.mercatorZfromAltitude=Os,a.mul=lD,a.mul$1=cD,a.multiply=Uc,a.multiply$1=hE,a.multiply$2=gE,a.nextPowerOfTwo=Mn,a.normalize=ji,a.normalize$1=dD,a.normalize$2=xE,a.number=gn,a.ortho=function(i,n,o,c,d,f,y){var v=1/(n-o),w=1/(c-d),S=1/(f-y);return i[0]=-2*v,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*w,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*S,i[11]=0,i[12]=(n+o)*v,i[13]=(d+c)*w,i[14]=(y+f)*S,i[15]=1,i},a.pbf=bT,a.perspective=function(i,n,o,c,d){var f,y=1/Math.tan(n/2);return i[0]=y/o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=y,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,d!=null&&d!==1/0?(i[10]=(d+c)*(f=1/(c-d)),i[14]=2*d*c*f):(i[10]=-1,i[14]=-2*c),i},a.pick=function(i,n){const o={};for(let c=0;c<n.length;c++){const d=n[c];d in i&&(o[d]=i[d])}return o},a.plugin=C,a.pointGeometry=xe,a.polesInViewport=function(i){const n=Ls(new Float64Array(16));Uc(n,i.pixelMatrix,i.globeMatrix);const o=[0,es,0],c=[0,ts,0];return Cr(o,o,n),Cr(c,c,n),[o[0]>0&&o[0]<=i.width&&o[1]>0&&o[1]<=i.height&&!Ov(i,new $n(i.center.lat,90)),c[0]>0&&c[0]<=i.width&&c[1]>0&&c[1]<=i.height&&!Ov(i,new $n(i.center.lat,-90))]},a.polygonContainsPoint=Zc,a.polygonIntersectsBox=VE,a.polygonIntersectsPolygon=jE,a.polygonizeBounds=function(i,n,o=0,c=!0){const d=new ye(o,o),f=i.sub(d),y=n.add(d),v=[f,new ye(y.x,f.y),y,new ye(f.x,y.y)];return c&&v.push(f.clone()),v},a.posAttributes=Gp,a.postMapLoadEvent=Rr,a.postPerformanceEvent=Gr,a.postTurnstileEvent=pn,a.potpack=i1,a.prevPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},a.radToDeg=et,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(i){return i({pluginStatus:p,pluginURL:s}),_.on("pluginStateChange",i),i},a.removeAuthState=function(i){Ai.delete(i)},a.renderColorRamp=Gv,a.resample=BE,a.rotateX=Tv,a.rotateX$1=wE,a.rotateY=Zg,a.rotateY$1=SE,a.rotateZ=function(i,n,o){var c=Math.sin(o),d=Math.cos(o),f=n[0],y=n[1],v=n[2],w=n[3],S=n[4],k=n[5],M=n[6],P=n[7];return n!==i&&(i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[0]=f*d+S*c,i[1]=y*d+k*c,i[2]=v*d+M*c,i[3]=w*d+P*c,i[4]=S*d-f*c,i[5]=k*d-y*c,i[6]=M*d-v*c,i[7]=P*d-w*c,i},a.rotateZ$1=function(i,n,o){o*=.5;var c=n[0],d=n[1],f=n[2],y=n[3],v=Math.sin(o),w=Math.cos(o);return i[0]=c*w+d*v,i[1]=d*w-c*v,i[2]=f*w+y*v,i[3]=y*w-f*v,i},a.scale=Vc,a.scale$1=_E,a.scale$2=Ao,a.scaleAndAdd=Vp,a.set=function(i,n,o,c){return i[0]=n,i[1]=o,i[2]=c,i},a.setCacheLimits=function(i,n){Ii=i,Ji=n},a.setColumn=function(i,n,o){i[4*n+0]=o[0],i[4*n+1]=o[1],i[4*n+2]=o[2],i[4*n+3]=o[3]},a.setRTLTextPlugin=function(i,n,o=!1){if(p===Lp||p===Dp||p===Op)throw new Error("setRTLTextPlugin cannot be called multiple times.");s=bs.resolveURL(i),p=Lp,bl=n,g(),o||T()},a.smoothstep=ct,a.spec=qe,a.squaredLength=function(i){var n=i[0],o=i[1],c=i[2];return n*n+o*o+c*c},a.storeAuthState=function(i,n){n?Ai.add(i):Ai.delete(i)},a.sub=Ds,a.subtract=kv,a.symbolSize=S3,a.tileAABB=function(i,n,o,c,d,f,y,v,w){if(w.name==="globe")return gD(i,n,new cy(o,c,d));const S=Kc({z:o,x:c,y:d},w);return new Ni([(f+S.x/S.scale)*n,n*(S.y/S.scale),y],[(f+S.x2/S.scale)*n,n*(S.y2/S.scale),v])},a.tileCornersToBounds=Kg,a.tileTransform=Kc,a.transformMat3=function(i,n,o){var c=n[0],d=n[1],f=n[2];return i[0]=c*o[0]+d*o[3]+f*o[6],i[1]=c*o[1]+d*o[4]+f*o[7],i[2]=c*o[2]+d*o[5]+f*o[8],i},a.transformMat4=Cr,a.transformMat4$1=Wc,a.transformQuat=yE,a.transitionTileAABBinECEF=IE,a.translate=jp,a.transpose=function(i,n){if(i===n){var o=n[1],c=n[2],d=n[5];i[1]=n[3],i[2]=n[6],i[3]=o,i[5]=n[7],i[6]=c,i[7]=d}else i[0]=n[0],i[1]=n[3],i[2]=n[6],i[3]=n[1],i[4]=n[4],i[5]=n[7],i[6]=n[2],i[7]=n[5],i[8]=n[8];return i},a.triggerPluginCompletionEvent=u,a.uniqueId=en,a.updateGlobeVertexNormal=function(i,n,o,c,d){const f=5*n+2;i.float32[f+0]=o,i.float32[f+1]=c,i.float32[f+2]=d},a.validateCustomStyleLayer=function(i){const n=[],o=i.id;return o===void 0&&n.push({message:`layers.${o}: missing required property "id"`}),i.render===void 0&&n.push({message:`layers.${o}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&n.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),n},a.validateFilter=i=>ho(Bc(i)),a.validateFog=i=>ho(Bg(i)),a.validateLayer=i=>ho(zg(i)),a.validateLight=i=>ho(Og(i)),a.validateSource=i=>ho(Dg(i)),a.validateStyle=jg,a.validateTerrain=i=>ho(Ap(i)),a.values=Tt,a.vectorTile=sy,a.version=I,a.warnOnce=Kt,a.window=E,a.wrap=Ie}),m(["./shared"],function(a){function E(me){if(typeof me=="number"||typeof me=="boolean"||typeof me=="string"||me==null)return JSON.stringify(me);if(Array.isArray(me)){let X="[";for(const he of me)X+=`${E(he)},`;return`${X}]`}let q="{";for(const X of Object.keys(me).sort())q+=`${X}:${E(me[X])},`;return`${q}}`}function I(me){let q="";for(const X of a.refProperties)q+=`/${E(me[X])}`;return q}class L{constructor(q){this.keyCache={},q&&this.replace(q)}replace(q){this._layerConfigs={},this._layers={},this.update(q,[])}update(q,X){for(const we of q)this._layerConfigs[we.id]=we,(this._layers[we.id]=a.createStyleLayer(we)).compileFilter(),this.keyCache[we.id]&&delete this.keyCache[we.id];for(const we of X)delete this.keyCache[we],delete this._layerConfigs[we],delete this._layers[we];this.familiesBySource={};const he=function(we,ke){const Le={};for(let Ce=0;Ce<we.length;Ce++){const Ve=ke&&ke[we[Ce].id]||I(we[Ce]);ke&&(ke[we[Ce].id]=Ve);let pt=Le[Ve];pt||(pt=Le[Ve]=[]),pt.push(we[Ce])}const ze=[];for(const Ce in Le)ze.push(Le[Ce]);return ze}(a.values(this._layerConfigs),this.keyCache);for(const we of he){const ke=we.map(mt=>this._layers[mt.id]),Le=ke[0];if(Le.visibility==="none")continue;const ze=Le.source||"";let Ce=this.familiesBySource[ze];Ce||(Ce=this.familiesBySource[ze]={});const Ve=Le.sourceLayer||"_geojsonTileLayer";let pt=Ce[Ve];pt||(pt=Ce[Ve]=[]),pt.push(ke)}}}class O{loadTile(q,X){const{uid:he,encoding:we,rawImageData:ke,padding:Le,buildQuadTree:ze}=q,Ce=a.window.ImageBitmap&&ke instanceof a.window.ImageBitmap?this.getImageData(ke,Le):ke;X(null,new a.DEMData(he,Ce,we,Le<1,ze))}getImageData(q,X){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(q.width,q.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=q.width,this.offscreenCanvas.height=q.height,this.offscreenCanvasContext.drawImage(q,0,0,q.width,q.height);const he=this.offscreenCanvasContext.getImageData(-X,-X,q.width+2*X,q.height+2*X);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),he}}function F(me,q){if(me.length!==0){K(me[0],q);for(var X=1;X<me.length;X++)K(me[X],!q)}}function K(me,q){for(var X=0,he=0,we=0,ke=me.length,Le=ke-1;we<ke;Le=we++){var ze=(me[we][0]-me[Le][0])*(me[Le][1]+me[we][1]),Ce=X+ze;he+=Math.abs(X)>=Math.abs(ze)?X-Ce+ze:ze-Ce+X,X=Ce}X+he>=0!=!!q&&me.reverse()}var W=a.getDefaultExportFromCjs(function me(q,X){var he,we=q&&q.type;if(we==="FeatureCollection")for(he=0;he<q.features.length;he++)me(q.features[he],X);else if(we==="GeometryCollection")for(he=0;he<q.geometries.length;he++)me(q.geometries[he],X);else if(we==="Feature")me(q.geometry,X);else if(we==="Polygon")F(q.coordinates,X);else if(we==="MultiPolygon")for(he=0;he<q.coordinates.length;he++)F(q.coordinates[he],X);return q});const G=a.VectorTileFeature.prototype.toGeoJSON;var ne={exports:{}},Z=a.pointGeometry,H=a.vectorTile.VectorTileFeature,V=oe;function oe(me,q){this.options=q||{},this.features=me,this.length=me.length}function pe(me,q){this.id=typeof me.id=="number"?me.id:void 0,this.type=me.type,this.rawGeometry=me.type===1?[me.geometry]:me.geometry,this.properties=me.tags,this.extent=q||4096}oe.prototype.feature=function(me){return new pe(this.features[me],this.options.extent)},pe.prototype.loadGeometry=function(){var me=this.rawGeometry;this.geometry=[];for(var q=0;q<me.length;q++){for(var X=me[q],he=[],we=0;we<X.length;we++)he.push(new Z(X[we][0],X[we][1]));this.geometry.push(he)}return this.geometry},pe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var me=this.geometry,q=1/0,X=-1/0,he=1/0,we=-1/0,ke=0;ke<me.length;ke++)for(var Le=me[ke],ze=0;ze<Le.length;ze++){var Ce=Le[ze];q=Math.min(q,Ce.x),X=Math.max(X,Ce.x),he=Math.min(he,Ce.y),we=Math.max(we,Ce.y)}return[q,he,X,we]},pe.prototype.toGeoJSON=H.prototype.toGeoJSON;var _e=a.pbf,xe=V;function De(me){var q=new _e;return function(X,he){for(var we in X.layers)he.writeMessage(3,ye,X.layers[we])}(me,q),q.finish()}function ye(me,q){var X;q.writeVarintField(15,me.version||1),q.writeStringField(1,me.name||""),q.writeVarintField(5,me.extent||4096);var he={keys:[],values:[],keycache:{},valuecache:{}};for(X=0;X<me.length;X++)he.feature=me.feature(X),q.writeMessage(2,Ae,he);var we=he.keys;for(X=0;X<we.length;X++)q.writeStringField(3,we[X]);var ke=he.values;for(X=0;X<ke.length;X++)q.writeMessage(4,gt,ke[X])}function Ae(me,q){var X=me.feature;X.id!==void 0&&q.writeVarintField(1,X.id),q.writeMessage(2,ft,me),q.writeVarintField(3,X.type),q.writeMessage(4,lt,X)}function ft(me,q){var X=me.feature,he=me.keys,we=me.values,ke=me.keycache,Le=me.valuecache;for(var ze in X.properties){var Ce=X.properties[ze],Ve=ke[ze];if(Ce!==null){Ve===void 0&&(he.push(ze),ke[ze]=Ve=he.length-1),q.writeVarint(Ve);var pt=typeof Ce;pt!=="string"&&pt!=="boolean"&&pt!=="number"&&(Ce=JSON.stringify(Ce));var mt=pt+":"+Ce,ut=Le[mt];ut===void 0&&(we.push(Ce),Le[mt]=ut=we.length-1),q.writeVarint(ut)}}}function Ge(me,q){return(q<<3)+(7&me)}function et(me){return me<<1^me>>31}function lt(me,q){for(var X=me.loadGeometry(),he=me.type,we=0,ke=0,Le=X.length,ze=0;ze<Le;ze++){var Ce=X[ze],Ve=1;he===1&&(Ve=Ce.length),q.writeVarint(Ge(1,Ve));for(var pt=he===3?Ce.length-1:Ce.length,mt=0;mt<pt;mt++){mt===1&&he!==1&&q.writeVarint(Ge(2,pt-1));var ut=Ce[mt].x-we,tn=Ce[mt].y-ke;q.writeVarint(et(ut)),q.writeVarint(et(tn)),we+=ut,ke+=tn}he===3&&q.writeVarint(Ge(7,1))}}function gt(me,q){var X=typeof me;X==="string"?q.writeStringField(1,me):X==="boolean"?q.writeBooleanField(7,me):X==="number"&&(me%1!=0?q.writeDoubleField(3,me):me<0?q.writeSVarintField(6,me):q.writeVarintField(5,me))}ne.exports=De,ne.exports.fromVectorTileJs=De,ne.exports.fromGeojsonVt=function(me,q){q=q||{};var X={};for(var he in me)X[he]=new xe(me[he].features,q),X[he].name=he,X[he].version=q.version,X[he].extent=q.extent;return De({layers:X})},ne.exports.GeoJSONWrapper=xe;var St=a.getDefaultExportFromCjs(ne.exports);const It={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:me=>me},Re=Math.fround||(ct=new Float32Array(1),me=>(ct[0]=+me,ct[0]));var ct;const Ie=3,st=5,Tt=6;class zt{constructor(q){this.options=Object.assign(Object.create(It),q),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(q){const{log:X,minZoom:he,maxZoom:we}=this.options;X&&console.time("total time");const ke=`prepare ${q.length} points`;X&&console.time(ke),this.points=q;const Le=[];for(let Ce=0;Ce<q.length;Ce++){const Ve=q[Ce];if(!Ve.geometry)continue;const[pt,mt]=Ve.geometry.coordinates,ut=Re(Zt(pt)),tn=Re(Mn(mt));Le.push(ut,tn,1/0,Ce,-1,1),this.options.reduce&&Le.push(0)}let ze=this.trees[we+1]=this._createTree(Le);X&&console.timeEnd(ke);for(let Ce=we;Ce>=he;Ce--){const Ve=+Date.now();ze=this.trees[Ce]=this._createTree(this._cluster(ze,Ce)),X&&console.log("z%d: %d clusters in %dms",Ce,ze.numItems,+Date.now()-Ve)}return X&&console.timeEnd("total time"),this}getClusters(q,X){let he=((q[0]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,q[1]));let ke=q[2]===180?180:((q[2]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,q[3]));if(q[2]-q[0]>=360)he=-180,ke=180;else if(he>ke){const mt=this.getClusters([he,we,180,Le],X),ut=this.getClusters([-180,we,ke,Le],X);return mt.concat(ut)}const ze=this.trees[this._limitZoom(X)],Ce=ze.range(Zt(he),Mn(Le),Zt(ke),Mn(we)),Ve=ze.data,pt=[];for(const mt of Ce){const ut=this.stride*mt;pt.push(Ve[ut+st]>1?Nt(Ve,ut,this.clusterProps):this.points[Ve[ut+Ie]])}return pt}getChildren(q){const X=this._getOriginId(q),he=this._getOriginZoom(q),we="No cluster with the specified id.",ke=this.trees[he];if(!ke)throw new Error(we);const Le=ke.data;if(X*this.stride>=Le.length)throw new Error(we);const ze=this.options.radius/(this.options.extent*Math.pow(2,he-1)),Ce=ke.within(Le[X*this.stride],Le[X*this.stride+1],ze),Ve=[];for(const pt of Ce){const mt=pt*this.stride;Le[mt+4]===q&&Ve.push(Le[mt+st]>1?Nt(Le,mt,this.clusterProps):this.points[Le[mt+Ie]])}if(Ve.length===0)throw new Error(we);return Ve}getLeaves(q,X,he){const we=[];return this._appendLeaves(we,q,X=X||10,he=he||0,0),we}getTile(q,X,he){const we=this.trees[this._limitZoom(q)],ke=Math.pow(2,q),{extent:Le,radius:ze}=this.options,Ce=ze/Le,Ve=(he-Ce)/ke,pt=(he+1+Ce)/ke,mt={features:[]};return this._addTileFeatures(we.range((X-Ce)/ke,Ve,(X+1+Ce)/ke,pt),we.data,X,he,ke,mt),X===0&&this._addTileFeatures(we.range(1-Ce/ke,Ve,1,pt),we.data,ke,he,ke,mt),X===ke-1&&this._addTileFeatures(we.range(0,Ve,Ce/ke,pt),we.data,-1,he,ke,mt),mt.features.length?mt:null}getClusterExpansionZoom(q){let X=this._getOriginZoom(q)-1;for(;X<=this.options.maxZoom;){const he=this.getChildren(q);if(X++,he.length!==1)break;q=he[0].properties.cluster_id}return X}_appendLeaves(q,X,he,we,ke){const Le=this.getChildren(X);for(const ze of Le){const Ce=ze.properties;if(Ce&&Ce.cluster?ke+Ce.point_count<=we?ke+=Ce.point_count:ke=this._appendLeaves(q,Ce.cluster_id,he,we,ke):ke<we?ke++:q.push(ze),q.length===he)break}return ke}_createTree(q){const X=new a.KDBush(q.length/this.stride|0,this.options.nodeSize,Float32Array);for(let he=0;he<q.length;he+=this.stride)X.add(q[he],q[he+1]);return X.finish(),X.data=q,X}_addTileFeatures(q,X,he,we,ke,Le){for(const ze of q){const Ce=ze*this.stride,Ve=X[Ce+st]>1;let pt,mt,ut;if(Ve)pt=en(X,Ce,this.clusterProps),mt=X[Ce],ut=X[Ce+1];else{const nn=this.points[X[Ce+Ie]];pt=nn.properties;const[an,pn]=nn.geometry.coordinates;mt=Zt(an),ut=Mn(pn)}const tn={type:1,geometry:[[Math.round(this.options.extent*(mt*ke-he)),Math.round(this.options.extent*(ut*ke-we))]],tags:pt};let sn;sn=Ve||this.options.generateId?X[Ce+Ie]:this.points[X[Ce+Ie]].id,sn!==void 0&&(tn.id=sn),Le.features.push(tn)}}_limitZoom(q){return Math.max(this.options.minZoom,Math.min(Math.floor(+q),this.options.maxZoom+1))}_cluster(q,X){const{radius:he,extent:we,reduce:ke,minPoints:Le}=this.options,ze=he/(we*Math.pow(2,X)),Ce=q.data,Ve=[],pt=this.stride;for(let mt=0;mt<Ce.length;mt+=pt){if(Ce[mt+2]<=X)continue;Ce[mt+2]=X;const ut=Ce[mt],tn=Ce[mt+1],sn=q.within(Ce[mt],Ce[mt+1],ze),nn=Ce[mt+st];let an=nn;for(const pn of sn){const ur=pn*pt;Ce[ur+2]>X&&(an+=Ce[ur+st])}if(an>nn&&an>=Le){let pn,ur=ut*nn,Rr=tn*nn,xi=-1;const Gr=((mt/pt|0)<<5)+(X+1)+this.points.length;for(const qo of sn){const ei=qo*pt;if(Ce[ei+2]<=X)continue;Ce[ei+2]=X;const Ai=Ce[ei+st];ur+=Ce[ei]*Ai,Rr+=Ce[ei+1]*Ai,Ce[ei+4]=Gr,ke&&(pn||(pn=this._map(Ce,mt,!0),xi=this.clusterProps.length,this.clusterProps.push(pn)),ke(pn,this._map(Ce,ei)))}Ce[mt+4]=Gr,Ve.push(ur/an,Rr/an,1/0,Gr,-1,an),ke&&Ve.push(xi)}else{for(let pn=0;pn<pt;pn++)Ve.push(Ce[mt+pn]);if(an>1)for(const pn of sn){const ur=pn*pt;if(!(Ce[ur+2]<=X)){Ce[ur+2]=X;for(let Rr=0;Rr<pt;Rr++)Ve.push(Ce[ur+Rr])}}}}return Ve}_getOriginId(q){return q-this.points.length>>5}_getOriginZoom(q){return(q-this.points.length)%32}_map(q,X,he){if(q[X+st]>1){const Le=this.clusterProps[q[X+Tt]];return he?Object.assign({},Le):Le}const we=this.points[q[X+Ie]].properties,ke=this.options.map(we);return he&&ke===we?Object.assign({},ke):ke}}function Nt(me,q,X){return{type:"Feature",id:me[q+Ie],properties:en(me,q,X),geometry:{type:"Point",coordinates:[(he=me[q],360*(he-.5)),Wr(me[q+1])]}};var he}function en(me,q,X){const he=me[q+st],we=he>=1e4?`${Math.round(he/1e3)}k`:he>=1e3?Math.round(he/100)/10+"k":he,ke=me[q+Tt],Le=ke===-1?{}:Object.assign({},X[ke]);return Object.assign(Le,{cluster:!0,cluster_id:me[q+Ie],point_count:he,point_count_abbreviated:we})}function Zt(me){return me/360+.5}function Mn(me){const q=Math.sin(me*Math.PI/180),X=.5-.25*Math.log((1+q)/(1-q))/Math.PI;return X<0?0:X>1?1:X}function Wr(me){const q=(180-360*me)*Math.PI/180;return 360*Math.atan(Math.exp(q))/Math.PI-90}function qn(me,q,X,he){for(var we,ke=he,Le=X-q>>1,ze=X-q,Ce=me[q],Ve=me[q+1],pt=me[X],mt=me[X+1],ut=q+3;ut<X;ut+=3){var tn=Mr(me[ut],me[ut+1],Ce,Ve,pt,mt);if(tn>ke)we=ut,ke=tn;else if(tn===ke){var sn=Math.abs(ut-Le);sn<ze&&(we=ut,ze=sn)}}ke>he&&(we-q>3&&qn(me,q,we,he),me[we+2]=ke,X-we>3&&qn(me,we,X,he))}function Mr(me,q,X,he,we,ke){var Le=we-X,ze=ke-he;if(Le!==0||ze!==0){var Ce=((me-X)*Le+(q-he)*ze)/(Le*Le+ze*ze);Ce>1?(X=we,he=ke):Ce>0&&(X+=Le*Ce,he+=ze*Ce)}return(Le=me-X)*Le+(ze=q-he)*ze}function Rt(me,q,X,he){var we={id:me===void 0?null:me,type:q,geometry:X,tags:he,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ke){var Le=ke.geometry,ze=ke.type;if(ze==="Point"||ze==="MultiPoint"||ze==="LineString")Dn(ke,Le);else if(ze==="Polygon"||ze==="MultiLineString")for(var Ce=0;Ce<Le.length;Ce++)Dn(ke,Le[Ce]);else if(ze==="MultiPolygon")for(Ce=0;Ce<Le.length;Ce++)for(var Ve=0;Ve<Le[Ce].length;Ve++)Dn(ke,Le[Ce][Ve])}(we),we}function Dn(me,q){for(var X=0;X<q.length;X+=3)me.minX=Math.min(me.minX,q[X]),me.minY=Math.min(me.minY,q[X+1]),me.maxX=Math.max(me.maxX,q[X]),me.maxY=Math.max(me.maxY,q[X+1])}function Xt(me,q,X,he){if(q.geometry){var we=q.geometry.coordinates,ke=q.geometry.type,Le=Math.pow(X.tolerance/((1<<X.maxZoom)*X.extent),2),ze=[],Ce=q.id;if(X.promoteId?Ce=q.properties[X.promoteId]:X.generateId&&(Ce=he||0),ke==="Point")Cn(we,ze);else if(ke==="MultiPoint")for(var Ve=0;Ve<we.length;Ve++)Cn(we[Ve],ze);else if(ke==="LineString")Kt(we,ze,Le,!1);else if(ke==="MultiLineString"){if(X.lineMetrics){for(Ve=0;Ve<we.length;Ve++)Kt(we[Ve],ze=[],Le,!1),me.push(Rt(Ce,"LineString",ze,q.properties));return}Pr(we,ze,Le,!1)}else if(ke==="Polygon")Pr(we,ze,Le,!0);else{if(ke!=="MultiPolygon"){if(ke==="GeometryCollection"){for(Ve=0;Ve<q.geometry.geometries.length;Ve++)Xt(me,{id:Ce,geometry:q.geometry.geometries[Ve],properties:q.properties},X,he);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ve=0;Ve<we.length;Ve++){var pt=[];Pr(we[Ve],pt,Le,!0),ze.push(pt)}}me.push(Rt(Ce,ke,ze,q.properties))}}function Cn(me,q){q.push(di(me[0])),q.push(Sr(me[1])),q.push(0)}function Kt(me,q,X,he){for(var we,ke,Le=0,ze=0;ze<me.length;ze++){var Ce=di(me[ze][0]),Ve=Sr(me[ze][1]);q.push(Ce),q.push(Ve),q.push(0),ze>0&&(Le+=he?(we*Ve-Ce*ke)/2:Math.sqrt(Math.pow(Ce-we,2)+Math.pow(Ve-ke,2))),we=Ce,ke=Ve}var pt=q.length-3;q[2]=1,qn(q,0,pt,X),q[pt+2]=1,q.size=Math.abs(Le),q.start=0,q.end=q.size}function Pr(me,q,X,he){for(var we=0;we<me.length;we++){var ke=[];Kt(me[we],ke,X,he),q.push(ke)}}function di(me){return me/360+.5}function Sr(me){var q=Math.sin(me*Math.PI/180),X=.5-.25*Math.log((1+q)/(1-q))/Math.PI;return X<0?0:X>1?1:X}function lr(me,q,X,he,we,ke,Le,ze){if(he/=q,ke>=(X/=q)&&Le<he)return me;if(Le<X||ke>=he)return null;for(var Ce=[],Ve=0;Ve<me.length;Ve++){var pt=me[Ve],mt=pt.geometry,ut=pt.type,tn=we===0?pt.minX:pt.minY,sn=we===0?pt.maxX:pt.maxY;if(tn>=X&&sn<he)Ce.push(pt);else if(!(sn<X||tn>=he)){var nn=[];if(ut==="Point"||ut==="MultiPoint")Qr(mt,nn,X,he,we);else if(ut==="LineString")On(mt,nn,X,he,we,!1,ze.lineMetrics);else if(ut==="MultiLineString")gr(mt,nn,X,he,we,!1);else if(ut==="Polygon")gr(mt,nn,X,he,we,!0);else if(ut==="MultiPolygon")for(var an=0;an<mt.length;an++){var pn=[];gr(mt[an],pn,X,he,we,!0),pn.length&&nn.push(pn)}if(nn.length){if(ze.lineMetrics&&ut==="LineString"){for(an=0;an<nn.length;an++)Ce.push(Rt(pt.id,ut,nn[an],pt.tags));continue}ut!=="LineString"&&ut!=="MultiLineString"||(nn.length===1?(ut="LineString",nn=nn[0]):ut="MultiLineString"),ut!=="Point"&&ut!=="MultiPoint"||(ut=nn.length===3?"Point":"MultiPoint"),Ce.push(Rt(pt.id,ut,nn,pt.tags))}}}return Ce.length?Ce:null}function Qr(me,q,X,he,we){for(var ke=0;ke<me.length;ke+=3){var Le=me[ke+we];Le>=X&&Le<=he&&(q.push(me[ke]),q.push(me[ke+1]),q.push(me[ke+2]))}}function On(me,q,X,he,we,ke,Le){for(var ze,Ce,Ve=ki(me),pt=we===0?Ii:Ji,mt=me.start,ut=0;ut<me.length-3;ut+=3){var tn=me[ut],sn=me[ut+1],nn=me[ut+2],an=me[ut+3],pn=me[ut+4],ur=we===0?tn:sn,Rr=we===0?an:pn,xi=!1;Le&&(ze=Math.sqrt(Math.pow(tn-an,2)+Math.pow(sn-pn,2))),ur<X?Rr>X&&(Ce=pt(Ve,tn,sn,an,pn,X),Le&&(Ve.start=mt+ze*Ce)):ur>he?Rr<he&&(Ce=pt(Ve,tn,sn,an,pn,he),Le&&(Ve.start=mt+ze*Ce)):zn(Ve,tn,sn,nn),Rr<X&&ur>=X&&(Ce=pt(Ve,tn,sn,an,pn,X),xi=!0),Rr>he&&ur<=he&&(Ce=pt(Ve,tn,sn,an,pn,he),xi=!0),!ke&&xi&&(Le&&(Ve.end=mt+ze*Ce),q.push(Ve),Ve=ki(me)),Le&&(mt+=ze)}var Gr=me.length-3;tn=me[Gr],sn=me[Gr+1],nn=me[Gr+2],(ur=we===0?tn:sn)>=X&&ur<=he&&zn(Ve,tn,sn,nn),Gr=Ve.length-3,ke&&Gr>=3&&(Ve[Gr]!==Ve[0]||Ve[Gr+1]!==Ve[1])&&zn(Ve,Ve[0],Ve[1],Ve[2]),Ve.length&&q.push(Ve)}function ki(me){var q=[];return q.size=me.size,q.start=me.start,q.end=me.end,q}function gr(me,q,X,he,we,ke){for(var Le=0;Le<me.length;Le++)On(me[Le],q,X,he,we,ke,!1)}function zn(me,q,X,he){me.push(q),me.push(X),me.push(he)}function Ii(me,q,X,he,we,ke){var Le=(ke-q)/(he-q);return me.push(ke),me.push(X+(we-X)*Le),me.push(1),Le}function Ji(me,q,X,he,we,ke){var Le=(ke-X)/(we-X);return me.push(q+(he-q)*Le),me.push(ke),me.push(1),Le}function Er(me,q){for(var X=[],he=0;he<me.length;he++){var we,ke=me[he],Le=ke.type;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")we=wn(ke.geometry,q);else if(Le==="MultiLineString"||Le==="Polygon"){we=[];for(var ze=0;ze<ke.geometry.length;ze++)we.push(wn(ke.geometry[ze],q))}else if(Le==="MultiPolygon")for(we=[],ze=0;ze<ke.geometry.length;ze++){for(var Ce=[],Ve=0;Ve<ke.geometry[ze].length;Ve++)Ce.push(wn(ke.geometry[ze][Ve],q));we.push(Ce)}X.push(Rt(ke.id,Le,we,ke.tags))}return X}function wn(me,q){var X=[];X.size=me.size,me.start!==void 0&&(X.start=me.start,X.end=me.end);for(var he=0;he<me.length;he+=3)X.push(me[he]+q,me[he+1],me[he+2]);return X}function qt(me,q){if(me.transformed)return me;var X,he,we,ke=1<<me.z,Le=me.x,ze=me.y;for(X=0;X<me.features.length;X++){var Ce=me.features[X],Ve=Ce.geometry,pt=Ce.type;if(Ce.geometry=[],pt===1)for(he=0;he<Ve.length;he+=2)Ce.geometry.push(hi(Ve[he],Ve[he+1],q,ke,Le,ze));else for(he=0;he<Ve.length;he++){var mt=[];for(we=0;we<Ve[he].length;we+=2)mt.push(hi(Ve[he][we],Ve[he][we+1],q,ke,Le,ze));Ce.geometry.push(mt)}}return me.transformed=!0,me}function hi(me,q,X,he,we,ke){return[Math.round(X*(me*he-we)),Math.round(X*(q*he-ke))]}function ao(me,q,X,he,we){for(var ke=q===we.maxZoom?0:we.tolerance/((1<<q)*we.extent),Le={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:X,y:he,z:q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ze=0;ze<me.length;ze++){Le.numFeatures++,To(Le,me[ze],ke,we);var Ce=me[ze].minX,Ve=me[ze].minY,pt=me[ze].maxX,mt=me[ze].maxY;Ce<Le.minX&&(Le.minX=Ce),Ve<Le.minY&&(Le.minY=Ve),pt>Le.maxX&&(Le.maxX=pt),mt>Le.maxY&&(Le.maxY=mt)}return Le}function To(me,q,X,he){var we=q.geometry,ke=q.type,Le=[];if(ke==="Point"||ke==="MultiPoint")for(var ze=0;ze<we.length;ze+=3)Le.push(we[ze]),Le.push(we[ze+1]),me.numPoints++,me.numSimplified++;else if(ke==="LineString")Gt(Le,we,me,X,!1,!1);else if(ke==="MultiLineString"||ke==="Polygon")for(ze=0;ze<we.length;ze++)Gt(Le,we[ze],me,X,ke==="Polygon",ze===0);else if(ke==="MultiPolygon")for(var Ce=0;Ce<we.length;Ce++){var Ve=we[Ce];for(ze=0;ze<Ve.length;ze++)Gt(Le,Ve[ze],me,X,!0,ze===0)}if(Le.length){var pt=q.tags||null;if(ke==="LineString"&&he.lineMetrics){for(var mt in pt={},q.tags)pt[mt]=q.tags[mt];pt.mapbox_clip_start=we.start/we.size,pt.mapbox_clip_end=we.end/we.size}var ut={geometry:Le,type:ke==="Polygon"||ke==="MultiPolygon"?3:ke==="LineString"||ke==="MultiLineString"?2:1,tags:pt};q.id!==null&&(ut.id=q.id),me.features.push(ut)}}function Gt(me,q,X,he,we,ke){var Le=he*he;if(he>0&&q.size<(we?Le:he))X.numPoints+=q.length/3;else{for(var ze=[],Ce=0;Ce<q.length;Ce+=3)(he===0||q[Ce+2]>Le)&&(X.numSimplified++,ze.push(q[Ce]),ze.push(q[Ce+1])),X.numPoints++;we&&function(Ve,pt){for(var mt=0,ut=0,tn=Ve.length,sn=tn-2;ut<tn;sn=ut,ut+=2)mt+=(Ve[ut]-Ve[sn])*(Ve[ut+1]+Ve[sn+1]);if(mt>0===pt)for(ut=0,tn=Ve.length;ut<tn/2;ut+=2){var nn=Ve[ut],an=Ve[ut+1];Ve[ut]=Ve[tn-2-ut],Ve[ut+1]=Ve[tn-1-ut],Ve[tn-2-ut]=nn,Ve[tn-1-ut]=an}}(ze,ke),me.push(ze)}}function kn(me,q){var X=(q=this.options=function(we,ke){for(var Le in ke)we[Le]=ke[Le];return we}(Object.create(this.options),q)).debug;if(X&&console.time("preprocess data"),q.maxZoom<0||q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(q.promoteId&&q.generateId)throw new Error("promoteId and generateId cannot be used together.");var he=function(we,ke){var Le=[];if(we.type==="FeatureCollection")for(var ze=0;ze<we.features.length;ze++)Xt(Le,we.features[ze],ke,ze);else Xt(Le,we.type==="Feature"?we:{geometry:we},ke);return Le}(me,q);this.tiles={},this.tileCoords=[],X&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",q.indexMaxZoom,q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),he=function(we,ke){var Le=ke.buffer/ke.extent,ze=we,Ce=lr(we,1,-1-Le,Le,0,-1,2,ke),Ve=lr(we,1,1-Le,2+Le,0,-1,2,ke);return(Ce||Ve)&&(ze=lr(we,1,-Le,1+Le,0,-1,2,ke)||[],Ce&&(ze=Er(Ce,1).concat(ze)),Ve&&(ze=ze.concat(Er(Ve,-1)))),ze}(he,q),he.length&&this.splitTile(he,0,0,0),X&&(he.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function cr(me,q,X){return 32*((1<<me)*X+q)+me}function Di(me,q){const X=me.tileID.canonical;if(!this._geoJSONIndex)return q(null,null);const he=this._geoJSONIndex.getTile(X.z,X.x,X.y);if(!he)return q(null,null);const we=new class{constructor(Le){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=Le.length,this._features=Le}feature(Le){return new class{constructor(ze){this._feature=ze,this.extent=a.EXTENT,this.type=ze.type,this.properties=ze.tags,"id"in ze&&!isNaN(ze.id)&&(this.id=parseInt(ze.id,10))}loadGeometry(){if(this._feature.type===1){const ze=[];for(const Ce of this._feature.geometry)ze.push([new a.Point(Ce[0],Ce[1])]);return ze}{const ze=[];for(const Ce of this._feature.geometry){const Ve=[];for(const pt of Ce)Ve.push(new a.Point(pt[0],pt[1]));ze.push(Ve)}return ze}}toGeoJSON(ze,Ce,Ve){return G.call(this,ze,Ce,Ve)}}(this._features[Le])}}(he.features);let ke=St(we);ke.byteOffset===0&&ke.byteLength===ke.buffer.byteLength||(ke=new Uint8Array(ke)),q(null,{vectorTile:we,rawData:ke.buffer})}kn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},kn.prototype.splitTile=function(me,q,X,he,we,ke,Le){for(var ze=[me,q,X,he],Ce=this.options,Ve=Ce.debug;ze.length;){he=ze.pop(),X=ze.pop(),q=ze.pop(),me=ze.pop();var pt=1<<q,mt=cr(q,X,he),ut=this.tiles[mt];if(!ut&&(Ve>1&&console.time("creation"),ut=this.tiles[mt]=ao(me,q,X,he,Ce),this.tileCoords.push({z:q,x:X,y:he}),Ve)){Ve>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",q,X,he,ut.numFeatures,ut.numPoints,ut.numSimplified),console.timeEnd("creation"));var tn="z"+q;this.stats[tn]=(this.stats[tn]||0)+1,this.total++}if(ut.source=me,we){if(q===Ce.maxZoom||q===we)continue;var sn=1<<we-q;if(X!==Math.floor(ke/sn)||he!==Math.floor(Le/sn))continue}else if(q===Ce.indexMaxZoom||ut.numPoints<=Ce.indexMaxPoints)continue;if(ut.source=null,me.length!==0){Ve>1&&console.time("clipping");var nn,an,pn,ur,Rr,xi,Gr=.5*Ce.buffer/Ce.extent,qo=.5-Gr,ei=.5+Gr,Ai=1+Gr;nn=an=pn=ur=null,Rr=lr(me,pt,X-Gr,X+ei,0,ut.minX,ut.maxX,Ce),xi=lr(me,pt,X+qo,X+Ai,0,ut.minX,ut.maxX,Ce),me=null,Rr&&(nn=lr(Rr,pt,he-Gr,he+ei,1,ut.minY,ut.maxY,Ce),an=lr(Rr,pt,he+qo,he+Ai,1,ut.minY,ut.maxY,Ce),Rr=null),xi&&(pn=lr(xi,pt,he-Gr,he+ei,1,ut.minY,ut.maxY,Ce),ur=lr(xi,pt,he+qo,he+Ai,1,ut.minY,ut.maxY,Ce),xi=null),Ve>1&&console.timeEnd("clipping"),ze.push(nn||[],q+1,2*X,2*he),ze.push(an||[],q+1,2*X,2*he+1),ze.push(pn||[],q+1,2*X+1,2*he),ze.push(ur||[],q+1,2*X+1,2*he+1)}}},kn.prototype.getTile=function(me,q,X){var he=this.options,we=he.extent,ke=he.debug;if(me<0||me>24)return null;var Le=1<<me,ze=cr(me,q=(q%Le+Le)%Le,X);if(this.tiles[ze])return qt(this.tiles[ze],we);ke>1&&console.log("drilling down to z%d-%d-%d",me,q,X);for(var Ce,Ve=me,pt=q,mt=X;!Ce&&Ve>0;)Ve--,pt=Math.floor(pt/2),mt=Math.floor(mt/2),Ce=this.tiles[cr(Ve,pt,mt)];return Ce&&Ce.source?(ke>1&&console.log("found parent tile z%d-%d-%d",Ve,pt,mt),ke>1&&console.time("drilling down"),this.splitTile(Ce.source,Ve,pt,mt,me,q,X),ke>1&&console.timeEnd("drilling down"),this.tiles[ze]?qt(this.tiles[ze],we):null):null};class vs extends a.VectorTileWorkerSource{constructor(q,X,he,we,ke){super(q,X,he,we,Di),ke&&(this.loadGeoJSON=ke)}loadData(q,X){const he=q&&q.request,we=he&&he.collectResourceTiming;this.loadGeoJSON(q,(ke,Le)=>{if(ke||!Le)return X(ke);if(typeof Le!="object")return X(new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`));{W(Le,!0);try{if(q.filter){const Ce=a.createExpression(q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ce.result==="error")throw new Error(Ce.value.map(pt=>`${pt.key}: ${pt.message}`).join(", "));Le={type:"FeatureCollection",features:Le.features.filter(pt=>Ce.value.evaluate({zoom:0},pt))}}this._geoJSONIndex=q.cluster?new zt(function({superclusterOptions:Ce,clusterProperties:Ve}){if(!Ve||!Ce)return Ce;const pt={},mt={},ut={accumulated:null,zoom:0},tn={properties:null},sn=Object.keys(Ve);for(const nn of sn){const[an,pn]=Ve[nn],ur=a.createExpression(pn),Rr=a.createExpression(typeof an=="string"?[an,["accumulated"],["get",nn]]:an);pt[nn]=ur.value,mt[nn]=Rr.value}return Ce.map=nn=>{tn.properties=nn;const an={};for(const pn of sn)an[pn]=pt[pn].evaluate(ut,tn);return an},Ce.reduce=(nn,an)=>{tn.properties=an;for(const pn of sn)ut.accumulated=nn[pn],nn[pn]=mt[pn].evaluate(ut,tn)},Ce}(q)).load(Le.features):function(Ce,Ve){return new kn(Ce,Ve)}(Le,q.geojsonVtOptions)}catch(Ce){return X(Ce)}this.loaded={};const ze={};if(we){const Ce=a.getPerformanceMeasurement(he);Ce&&(ze.resourceTiming={},ze.resourceTiming[q.source]=JSON.parse(JSON.stringify(Ce)))}X(null,ze)}})}reloadTile(q,X){const he=this.loaded;return he&&he[q.uid]?super.reloadTile(q,X):this.loadTile(q,X)}loadGeoJSON(q,X){if(q.request)a.getJSON(q.request,X);else{if(typeof q.data!="string")return X(new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`));try{return X(null,JSON.parse(q.data))}catch{return X(new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(q,X){try{X(null,this._geoJSONIndex.getClusterExpansionZoom(q.clusterId))}catch(he){X(he)}}getClusterChildren(q,X){try{X(null,this._geoJSONIndex.getChildren(q.clusterId))}catch(he){X(he)}}getClusterLeaves(q,X){try{X(null,this._geoJSONIndex.getLeaves(q.clusterId,q.limit,q.offset))}catch(he){X(he)}}}class Pu{constructor(q){this.self=q,this.actor=new a.Actor(q,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:vs},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(X,he)=>{if(this.workerSourceTypes[X])throw new Error(`Worker source with name "${X}" already registered.`);this.workerSourceTypes[X]=he},this.self.registerRTLTextPlugin=X=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=X.applyArabicShaping,a.plugin.processBidirectionalText=X.processBidirectionalText,a.plugin.processStyledBidirectionalText=X.processStyledBidirectionalText}}clearCaches(q,X,he){delete this.layerIndexes[q],delete this.availableImages[q],delete this.workerSources[q],delete this.demWorkerSources[q],he()}checkIfReady(q,X,he){he()}setReferrer(q,X){this.referrer=X}spriteLoaded(q,X){this.isSpriteLoaded[q]=X;for(const he in this.workerSources[q]){const we=this.workerSources[q][he];for(const ke in we)we[ke]instanceof a.VectorTileWorkerSource&&(we[ke].isSpriteLoaded=X,we[ke].fire(new a.Event("isSpriteLoaded")))}}setImages(q,X,he){this.availableImages[q]=X;for(const we in this.workerSources[q]){const ke=this.workerSources[q][we];for(const Le in ke)ke[Le].availableImages=X}he()}enableTerrain(q,X,he){this.terrain=X,he()}setProjection(q,X){this.projections[q]=a.getProjection(X)}setLayers(q,X,he){this.getLayerIndex(q).replace(X),he()}updateLayers(q,X,he){this.getLayerIndex(q).update(X.layers,X.removedIds),he()}loadTile(q,X,he){const we=this.enableTerrain?a.extend({enableTerrain:this.terrain},X):X;we.projection=this.projections[q]||this.defaultProjection,this.getWorkerSource(q,X.type,X.source).loadTile(we,he)}loadDEMTile(q,X,he){const we=this.enableTerrain?a.extend({buildQuadTree:this.terrain},X):X;this.getDEMWorkerSource(q,X.source).loadTile(we,he)}reloadTile(q,X,he){const we=this.enableTerrain?a.extend({enableTerrain:this.terrain},X):X;we.projection=this.projections[q]||this.defaultProjection,this.getWorkerSource(q,X.type,X.source).reloadTile(we,he)}abortTile(q,X,he){this.getWorkerSource(q,X.type,X.source).abortTile(X,he)}removeTile(q,X,he){this.getWorkerSource(q,X.type,X.source).removeTile(X,he)}removeSource(q,X,he){if(!this.workerSources[q]||!this.workerSources[q][X.type]||!this.workerSources[q][X.type][X.source])return;const we=this.workerSources[q][X.type][X.source];delete this.workerSources[q][X.type][X.source],we.removeSource!==void 0?we.removeSource(X,he):he()}loadWorkerSource(q,X,he){try{this.self.importScripts(X.url),he()}catch(we){he(we.toString())}}syncRTLPluginState(q,X,he){try{a.plugin.setState(X);const we=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&we!=null){this.self.importScripts(we);const ke=a.plugin.isParsed();he(ke?void 0:new Error(`RTL Text Plugin failed to import scripts from ${we}`),ke)}}catch(we){he(we.toString())}}getAvailableImages(q){let X=this.availableImages[q];return X||(X=[]),X}getLayerIndex(q){let X=this.layerIndexes[q];return X||(X=this.layerIndexes[q]=new L),X}getWorkerSource(q,X,he){if(this.workerSources[q]||(this.workerSources[q]={}),this.workerSources[q][X]||(this.workerSources[q][X]={}),!this.workerSources[q][X][he]){const we={send:(ke,Le,ze,Ce,Ve,pt)=>{this.actor.send(ke,Le,ze,q,Ve,pt)},scheduler:this.actor.scheduler};this.workerSources[q][X][he]=new this.workerSourceTypes[X](we,this.getLayerIndex(q),this.getAvailableImages(q),this.isSpriteLoaded[q])}return this.workerSources[q][X][he]}getDEMWorkerSource(q,X){return this.demWorkerSources[q]||(this.demWorkerSources[q]={}),this.demWorkerSources[q][X]||(this.demWorkerSources[q][X]=new O),this.demWorkerSources[q][X]}enforceCacheSizeLimit(q,X){a.enforceCacheSizeLimit(X)}getWorkerPerformanceMetrics(q,X,he){he(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Pu(self)),Pu}),m(["./shared"],function(a){function E(p,s){if(Array.isArray(p)){if(!Array.isArray(s)||p.length!==s.length)return!1;for(let u=0;u<p.length;u++)if(!E(p[u],s[u]))return!1;return!0}if(typeof p=="object"&&p!==null&&s!==null){if(typeof s!="object"||Object.keys(p).length!==Object.keys(s).length)return!1;for(const u in p)if(!E(p[u],s[u]))return!1;return!0}return p===s}var I=L;function L(p){return!function(s){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,_,b=new Blob([""],{type:"text/javascript"}),T=URL.createObjectURL(b);try{_=new Worker(T),g=!0}catch{g=!1}return _&&_.terminate(),URL.revokeObjectURL(T),g}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var g=document.createElement("canvas");g.width=g.height=1;var _=g.getContext("2d");if(!_)return!1;var b=_.getImageData(0,0,1,1);return b&&b.width===g.width}()?(O[u=s&&s.failIfMajorPerformanceCaveat]===void 0&&(O[u]=function(g){var _,b=function(T){var C=document.createElement("canvas"),A=Object.create(L.webGLContextAttributes);return A.failIfMajorPerformanceCaveat=T,C.getContext("webgl",A)||C.getContext("experimental-webgl",A)}(g);if(!b)return!1;try{_=b.createShader(b.VERTEX_SHADER)}catch{return!1}return!(!_||b.isContextLost())&&(b.shaderSource(_,"void main() {}"),b.compileShader(_),b.getShaderParameter(_,b.COMPILE_STATUS)===!0)}(u)),O[u]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var u}(p)}var O={};function F(p,s,u){const g=a.window.document.createElement(p);return s!==void 0&&(g.className=s),u&&u.appendChild(g),g}function K(p,s,u){const g=a.window.document.createElementNS("http://www.w3.org/2000/svg",p);for(const _ of Object.keys(s))g.setAttributeNS(null,_,s[_]);return u&&u.appendChild(g),g}L.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const W=a.window.document&&a.window.document.documentElement.style,G=W&&W.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ne;function Z(){W&&G&&(ne=W[G],W[G]="none")}function H(){W&&G&&(W[G]=ne)}function V(p){p.preventDefault(),p.stopPropagation(),a.window.removeEventListener("click",V,!0)}function oe(){a.window.addEventListener("click",V,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",V,!0)},0)}function pe(p,s){const u=p.getBoundingClientRect();return De(p,u,s)}function _e(p,s){const u=p.getBoundingClientRect(),g=[];for(let _=0;_<s.length;_++)g.push(De(p,u,s[_]));return g}function xe(p){return a.window.InstallTrigger!==void 0&&p.button===2&&p.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:p.button}function De(p,s,u){const g=p.offsetWidth===s.width?1:p.offsetWidth/s.width;return new a.Point((u.clientX-s.left)*g,(u.clientY-s.top)*g)}function ye(p,s){var u=s[0],g=s[1],_=s[2],b=s[3],T=u*b-_*g;return T?(p[0]=b*(T=1/T),p[1]=-g*T,p[2]=-_*T,p[3]=u*T,p):null}function Ae(p){const{userImage:s}=p;return!!(s&&s.render&&s.render())&&(p.data.replace(new Uint8Array(s.data.buffer)),!0)}class ft extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(s){if(this.loaded!==s&&(this.loaded=s,s)){for(const{ids:u,callback:g}of this.requestors)this._notify(u,g);this.requestors=[]}}hasImage(s){return!!this.getImage(s)}getImage(s){return this.images[s]}addImage(s,u){this._validate(s,u)&&(this.images[s]=u)}_validate(s,u){let g=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${s}" has invalid "stretchX" value`))),g=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${s}" has invalid "stretchY" value`))),g=!1),this._validateContent(u.content,u)||(this.fire(new a.ErrorEvent(new Error(`Image "${s}" has invalid "content" value`))),g=!1),g}_validateStretch(s,u){if(!s)return!0;let g=0;for(const _ of s){if(_[0]<g||_[1]<_[0]||u<_[1])return!1;g=_[1]}return!0}_validateContent(s,u){return!(s&&(s.length!==4||s[0]<0||u.data.width<s[0]||s[1]<0||u.data.height<s[1]||s[2]<0||u.data.width<s[2]||s[3]<0||u.data.height<s[3]||s[2]<s[0]||s[3]<s[1]))}updateImage(s,u){u.version=this.images[s].version+1,this.images[s]=u,this.updatedImages[s]=!0}removeImage(s){const u=this.images[s];delete this.images[s],delete this.patterns[s],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(s,u){let g=!0;if(!this.isLoaded())for(const _ of s)this.images[_]||(g=!1);this.isLoaded()||g?this._notify(s,u):this.requestors.push({ids:s,callback:u})}_notify(s,u){const g={};for(const _ of s){this.images[_]||this.fire(new a.Event("styleimagemissing",{id:_}));const b=this.images[_];b?g[_]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:!!(b.userImage&&b.userImage.render)}:a.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,g)}getPixelSize(){const{width:s,height:u}=this.atlasImage;return{width:s,height:u}}getPattern(s){const u=this.patterns[s],g=this.getImage(s);if(!g)return null;if(u&&u.position.version===g.version)return u.position;if(u)u.position.version=g.version;else{const _={w:g.data.width+2,h:g.data.height+2,x:0,y:0},b=new a.ImagePosition(_,g);this.patterns[s]={bin:_,position:b}}return this._updatePatternAtlas(),this.patterns[s].position}bind(s){const u=s.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(s,this.atlasImage,u.RGBA),this.atlasTexture&&this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const s=[];for(const b in this.patterns)s.push(this.patterns[b].bin);const{w:u,h:g}=a.potpack(s),_=this.atlasImage;_.resize({width:u||1,height:g||1});for(const b in this.patterns){const{bin:T}=this.patterns[b],C=T.x+1,A=T.y+1,z=this.images[b].data,R=z.width,N=z.height;a.RGBAImage.copy(z,_,{x:0,y:0},{x:C,y:A},{width:R,height:N}),a.RGBAImage.copy(z,_,{x:0,y:N-1},{x:C,y:A-1},{width:R,height:1}),a.RGBAImage.copy(z,_,{x:0,y:0},{x:C,y:A+N},{width:R,height:1}),a.RGBAImage.copy(z,_,{x:R-1,y:0},{x:C-1,y:A},{width:1,height:N}),a.RGBAImage.copy(z,_,{x:0,y:0},{x:C+R,y:A},{width:1,height:N})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(s){for(const u of s){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const g=this.images[u];Ae(g)&&this.updateImage(u,g)}}}const Ge=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(p,s){return function([u,g,_]){const b=a.degToRad(g+90),T=a.degToRad(_);return{x:u*Math.cos(b)*Math.sin(T),y:u*Math.sin(b)*Math.sin(T),z:u*Math.cos(T),azimuthal:g,polar:_}}(p.expression.evaluate(s))}interpolate(p,s,u){return{x:a.number(p.x,s.x,u),y:a.number(p.y,s.y,u),z:a.number(p.z,s.z,u),azimuthal:a.number(p.azimuthal,s.azimuthal,u),polar:a.number(p.polar,s.polar,u)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)});class et extends a.Evented{constructor(s){super(),this._transitionable=new a.Transitionable(Ge),this.setLight(s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,u={}){if(!this._validate(a.validateLight,s,u))for(const g in s){const _=s[g];a.endsWith(g,"-transition")?this._transitionable.setTransition(g.slice(0,-11),_):this._transitionable.setValue(g,_)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,u,g){return(!g||g.validate!==!1)&&a.emitValidationErrors(this,s.call(a.validateStyle,a.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const lt=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)});let gt=class extends a.Evented{constructor(p,s){super(),this._transitionable=new a.Transitionable(lt),this.set(p),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s}get(){return this._transitionable.serialize()}set(p){for(const s in p){const u=p[s];a.endsWith(s,"-transition")?this._transitionable.setTransition(s.slice(0,-11),u):this._transitionable.setValue(s,u)}}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}};function St(p,s,u,g){const _=a.smoothstep(45,65,u),[b,T]=It(p,g),C=a.length(s);let A=1-Math.min(1,Math.exp((C-b)/(T-b)*-6));return A*=A*A,A=Math.min(1,1.00747*A),A*_*p.alpha}function It(p,s){const u=.5/Math.tan(.5*s);return[p.range[0]+u,p.range[1]+u]}const Re=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"high-color":new a.DataConstantProperty(a.spec.fog["high-color"]),"space-color":new a.DataConstantProperty(a.spec.fog["space-color"]),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"]),"star-intensity":new a.DataConstantProperty(a.spec.fog["star-intensity"])});class ct extends a.Evented{constructor(s,u){super(),this._transitionable=new a.Transitionable(Re),this.set(s),this._transitioning=this._transitionable.untransitioned(),this._transform=u}get state(){const s=this._transform,u=s.projection.name==="globe",g=a.globeToMercatorTransition(s.zoom),_=this.properties.get("range"),b=[.5,3];return{range:u?[a.number(b[0],_[0],g),a.number(b[1],_[1],g)]:_,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(s,u={}){if(!this._validate(a.validateFog,s,u)){for(const g of Object.keys(a.spec.fog))s&&s[g]===void 0&&(s[g]=a.spec.fog[g].default);for(const g in s){const _=s[g];a.endsWith(g,"-transition")?this._transitionable.setTransition(g.slice(0,-11),_):this._transitionable.setValue(g,_)}}}getOpacity(s){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.smoothstep(45,65,s))*u.a}getOpacityAtLatLng(s,u){return this._transform.projection.supportsFog?function(g,_,b){const T=a.MercatorCoordinate.fromLngLat(_),C=b.elevation?b.elevation.getAtPointOrZero(T):0,A=[T.x,T.y,C];return a.transformMat4(A,A,b.mercatorFogMatrix),St(g,A,b.pitch,b._fov)}(this.state,s,u):0}getFovAdjustedRange(s){return this._transform.projection.supportsFog?It(this.state,s):[0,1]}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,u,g){return(!g||g.validate!==!1)&&a.emitValidationErrors(this,s.call(a.validateStyle,a.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class Ie{constructor(s,u){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const g=this.workerPool.acquire(this.id);for(let _=0;_<g.length;_++){const b=new Ie.Actor(g[_],u,this.id);b.name=`Worker ${_}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(s,u,g){a.asyncAll(this.actors,(_,b)=>{_.send(s,u,b)},g=g||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(s=>{s.remove()}),this.actors=[],this.workerPool.release(this.id)}}function st(p,s,u){return s*(a.EXTENT/(p.tileSize*Math.pow(2,u-p.tileID.overscaledZ)))}Ie.Actor=a.Actor;class Tt{constructor(s,u,g,_){this.screenBounds=s,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,_)}static createFromScreenPoints(s,u){let g,_;if(s instanceof a.Point||typeof s[0]=="number"){const b=a.Point.convert(s);g=[b],_=u.isPointAboveHorizon(b)}else{const b=a.Point.convert(s[0]),T=a.Point.convert(s[1]);g=[b,T],_=a.polygonizeBounds(b,T).every(C=>u.isPointAboveHorizon(C))}return new Tt(g,u.getCameraPoint(),_,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(s){return a.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],s)}bufferedCameraGeometry(s){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new a.Point(1,1)):this.screenBounds[1],_=a.polygonizeBounds(u,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<g.x?_.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?_[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(_[3]=this.cameraPoint)),a.bufferConvexPolygon(_,s)}bufferedCameraGeometryGlobe(s){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new a.Point(1,1)):this.screenBounds[1],_=a.polygonizeBounds(u,g,s),b=this.cameraPoint.clone();switch(3*((b.y>u.y)+(b.y>g.y))+((b.x>u.x)+(b.x>g.x))){case 0:_[0]=b,_[4]=b.clone();break;case 1:_.splice(1,0,b);break;case 2:_[1]=b;break;case 3:_.splice(4,0,b);break;case 5:_.splice(2,0,b);break;case 6:_[3]=b;break;case 7:_.splice(3,0,b);break;case 8:_[2]=b}return _}containsTile(s,u,g,_=0){const b=s.queryPadding/u._pixelsPerMercatorPixel+1,T=g?this._bufferedCameraMercator(b,u):this._bufferedScreenMercator(b,u);let C=s.tileID.wrap+(T.unwrapped?_:0);const A=T.polygon.map(se=>a.getTilePoint(s.tileTransform,se,C));if(!a.polygonIntersectsBox(A,0,0,a.EXTENT,a.EXTENT))return;C=s.tileID.wrap+(this.screenGeometryMercator.unwrapped?_:0);const z=this.screenGeometryMercator.polygon.map(se=>a.getTileVec3(s.tileTransform,se,C)),R=z.map(se=>new a.Point(se[0],se[1])),N=u.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),Y=a.getTileVec3(s.tileTransform,N,C),te=z.map(se=>{const $=a.sub(se,se,Y);return a.normalize($,$),new a.Ray(Y,$)}),ie=st(s,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:R,tilespaceRays:te,bufferedTilespaceGeometry:A,bufferedTilespaceBounds:(re=a.getBounds(A),re.min.x=a.clamp(re.min.x,0,a.EXTENT),re.min.y=a.clamp(re.min.y,0,a.EXTENT),re.max.x=a.clamp(re.max.x,0,a.EXTENT),re.max.y=a.clamp(re.max.y,0,a.EXTENT),re),tile:s,tileID:s.tileID,pixelToTileUnitsFactor:ie};var re}_bufferedScreenMercator(s,u){const g=en(s);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let _;return _=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(s),u):{polygon:this.bufferedScreenGeometry(s).map(b=>u.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[g]=_,_}}_bufferedCameraMercator(s,u){const g=en(s);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let _;return _=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(s),u):{polygon:this.bufferedCameraGeometry(s).map(b=>u.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[g]=_,_}}_projectAndResample(s,u){const g=function(b,T){const C=a.multiply([],T.pixelMatrix,T.globeMatrix),A=[0,-a.GLOBE_RADIUS,0,1],z=[0,a.GLOBE_RADIUS,0,1],R=[0,0,0,1];a.transformMat4$1(A,A,C),a.transformMat4$1(z,z,C),a.transformMat4$1(R,R,C);const N=new a.Point(A[0]/A[3],A[1]/A[3]),Y=new a.Point(z[0]/z[3],z[1]/z[3]),te=a.polygonContainsPoint(b,N)&&A[3]<R[3],ie=a.polygonContainsPoint(b,Y)&&z[3]<R[3];if(!te&&!ie)return null;const re=function(Ee,Pe,Me){for(let je=1;je<Ee.length;je++){const rt=Nt(Pe.pointCoordinate3D(Ee[je-1]).x),Oe=Nt(Pe.pointCoordinate3D(Ee[je]).x);if(Me<0){if(rt<Oe)return{idx:je,t:-rt/(Oe-1-rt)}}else if(Oe<rt)return{idx:je,t:(1-rt)/(Oe+1-rt)}}return null}(b,T,te?-1:1);if(!re)return null;const{idx:se,t:$}=re;let ee=se>1?zt(b.slice(0,se),T):[],ue=se<b.length?zt(b.slice(se),T):[];ee=ee.map(Ee=>new a.Point(Nt(Ee.x),Ee.y)),ue=ue.map(Ee=>new a.Point(Nt(Ee.x),Ee.y));const de=[...ee];de.length===0&&de.push(ue[ue.length-1]);const Se=a.number(de[de.length-1].y,(ue.length===0?ee[0]:ue[0]).y,$);let Te;return Te=te?[new a.Point(0,Se),new a.Point(0,0),new a.Point(1,0),new a.Point(1,Se)]:[new a.Point(1,Se),new a.Point(1,1),new a.Point(0,1),new a.Point(0,Se)],de.push(...Te),ue.length===0?de.push(ee[0]):de.push(...ue),{polygon:de.map(Ee=>new a.MercatorCoordinate(Ee.x,Ee.y)),unwrapped:!1}}(s,u);if(g)return g;const _=function(b,T){let C=!1,A=-1/0,z=0;for(let N=0;N<b.length-1;N++)b[N].x>A&&(A=b[N].x,z=N);for(let N=0;N<b.length-1;N++){const Y=(z+N)%(b.length-1),te=b[Y],ie=b[Y+1];Math.abs(te.x-ie.x)>.5&&(te.x<ie.x?(te.x+=1,Y===0&&(b[b.length-1].x+=1)):(ie.x+=1,Y+1===b.length-1&&(b[0].x+=1)),C=!0)}const R=a.mercatorXfromLng(T.center.lng);return C&&R<Math.abs(R-1)&&b.forEach(N=>{N.x-=1}),{polygon:b,unwrapped:C}}(zt(s,u).map(b=>new a.Point(Nt(b.x),b.y)),u);return{polygon:_.polygon.map(b=>new a.MercatorCoordinate(b.x,b.y)),unwrapped:_.unwrapped}}}function zt(p,s){return a.resample(p,u=>{const g=s.pointCoordinate3D(u);u.x=g.x,u.y=g.y},1/256)}function Nt(p){return p<0?1+p%1:p%1}function en(p){return 100*p|0}function Zt(p,s,u,g,_){const b=function(T,C){if(T)return _(T);if(C){p.url&&C.tiles&&p.tiles&&delete p.tiles;const A=a.pick(a.extend(C,p),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);C.vector_layers&&(A.vectorLayers=C.vector_layers,A.vectorLayerIds=A.vectorLayers.map(z=>z.id)),A.tiles=s.canonicalizeTileset(A,p.url),_(null,A)}};return p.url?a.getJSON(s.transformRequest(s.normalizeSourceURL(p.url,null,u,g),a.ResourceType.Source),b):a.exported.frame(()=>b(null,p))}class Mn{constructor(s,u,g){this.bounds=a.LngLatBounds.convert(this.validateBounds(s)),this.minzoom=u||0,this.maxzoom=g||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const u=Math.pow(2,s.z),g=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*u),_=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*u),b=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*u),T=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*u);return s.x>=g&&s.x<b&&s.y>=_&&s.y<T}}class Wr{constructor(s,u,g){this.context=s;const _=s.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const qn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Mr{constructor(s,u,g,_){this.length=u.length,this.attributes=g,this.itemSize=u.bytesPerElement,this.dynamicDraw=_,this.context=s;const b=s.gl;this.buffer=b.createBuffer(),s.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,u){for(let g=0;g<this.attributes.length;g++){const _=u.attributes[this.attributes[g].name];_!==void 0&&s.enableVertexAttribArray(_)}}setVertexAttribPointers(s,u,g){for(let _=0;_<this.attributes.length;_++){const b=this.attributes[_],T=u.attributes[b.name];T!==void 0&&s.vertexAttribPointer(T,b.components,s[qn[b.type]],!1,this.itemSize,b.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Rt{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Dn extends Rt{getDefault(){return a.Color.transparent}set(s){const u=this.current;(s.r!==u.r||s.g!==u.g||s.b!==u.b||s.a!==u.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Xt extends Rt{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class Cn extends Rt{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class Kt extends Rt{getDefault(){return[!0,!0,!0,!0]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Pr extends Rt{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class di extends Rt{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class Sr extends Rt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const u=this.current;(s.func!==u.func||s.ref!==u.ref||s.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class lr extends Rt{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class Qr extends Rt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=s,this.dirty=!1}}class On extends Rt{getDefault(){return[0,1]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class ki extends Rt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=s,this.dirty=!1}}class gr extends Rt{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class zn extends Rt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.BLEND):u.disable(u.BLEND),this.current=s,this.dirty=!1}}class Ii extends Rt{getDefault(){const s=this.gl;return[s.ONE,s.ZERO]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(s[0],s[1]),this.current=s,this.dirty=!1)}}class Ji extends Rt{getDefault(){return a.Color.transparent}set(s){const u=this.current;(s.r!==u.r||s.g!==u.g||s.b!==u.b||s.a!==u.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Er extends Rt{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquation(s),this.current=s,this.dirty=!1)}}class wn extends Rt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=s,this.dirty=!1}}class qt extends Rt{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class hi extends Rt{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}let ao,To=class extends Rt{getDefault(){return null}set(p){(p!==this.current||this.dirty)&&(this.gl.useProgram(p),this.current=p,this.dirty=!1)}};class Gt extends Rt{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class kn extends Rt{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class cr extends Rt{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class Di extends Rt{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class vs extends Rt{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class Pu extends Rt{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class me extends Rt{getDefault(){return null}set(s){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class q extends Rt{constructor(s){super(s),this.vao=s.extVertexArrayObject}getDefault(){return null}set(s){this.vao&&(s!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(s),this.current=s,this.dirty=!1)}}class X extends Rt{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class he extends Rt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class we extends Rt{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class ke extends Rt{constructor(s,u){super(s),this.context=s,this.parent=u}getDefault(){return null}}class Le extends ke{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class ze extends ke{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Ce extends ze{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ve{constructor(s,u,g,_){this.context=s,this.width=u,this.height=g;const b=this.framebuffer=s.gl.createFramebuffer();this.colorAttachment=new Le(s,b),_&&(this.depthAttachment=new ze(s,b))}destroy(){const s=this.context.gl,u=this.colorAttachment.get();if(u&&s.deleteTexture(u),this.depthAttachment){const g=this.depthAttachment.get();g&&s.deleteRenderbuffer(g)}s.deleteFramebuffer(this.framebuffer)}}class pt{constructor(s,u=!1){if(this.gl=s,this.isWebGL2=u,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),u){const g=s;this.extVertexArrayObject={createVertexArrayOES:g.createVertexArray.bind(s),deleteVertexArrayOES:g.deleteVertexArray.bind(s),bindVertexArrayOES:g.bindVertexArray.bind(s)}}this.clearColor=new Dn(this),this.clearDepth=new Xt(this),this.clearStencil=new Cn(this),this.colorMask=new Kt(this),this.depthMask=new Pr(this),this.stencilMask=new di(this),this.stencilFunc=new Sr(this),this.stencilOp=new lr(this),this.stencilTest=new Qr(this),this.depthRange=new On(this),this.depthTest=new ki(this),this.depthFunc=new gr(this),this.blend=new zn(this),this.blendFunc=new Ii(this),this.blendColor=new Ji(this),this.blendEquation=new Er(this),this.cullFace=new wn(this),this.cullFaceSide=new qt(this),this.frontFace=new hi(this),this.program=new To(this),this.activeTexture=new Gt(this),this.viewport=new kn(this),this.bindFramebuffer=new cr(this),this.bindRenderbuffer=new Di(this),this.bindTexture=new vs(this),this.bindVertexBuffer=new Pu(this),this.bindElementBuffer=new me(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new q(this),this.pixelStoreUnpack=new X(this),this.pixelStoreUnpackPremultiplyAlpha=new he(this),this.pixelStoreUnpackFlipY=new we(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=s.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=s.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=s.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),u||(this.extTextureHalfFloat=s.getExtension("OES_texture_half_float")),(u||this.extTextureHalfFloat&&s.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=u||s.getExtension("OES_standard_derivatives"),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,u){return new Wr(this,s,u)}createVertexBuffer(s,u,g){return new Mr(this,s,u,g)}createRenderbuffer(s,u,g){const _=this.gl,b=_.createRenderbuffer();return this.bindRenderbuffer.set(b),_.renderbufferStorage(_.RENDERBUFFER,s,u,g),this.bindRenderbuffer.set(null),b}createFramebuffer(s,u,g){return new Ve(this,s,u,g)}clear({color:s,depth:u,stencil:g}){const _=this.gl;let b=0;s&&(b|=_.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(b|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),g!==void 0&&(b|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),_.clear(b)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){E(s.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class mt extends a.Evented{constructor(s,u,g,_){if(super(),this.id=s,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(u,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(s){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map._worldview;this._tileJSONRequest=Zt(this._options,this.map._requestManager,u,g,(_,b)=>{this._tileJSONRequest=null,this._loaded=!0,_?(u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),g&&g.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new a.ErrorEvent(_))):b&&(a.extend(this,b),b.bounds&&(this.tileBounds=new Mn(b.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(b.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),s&&s(_)})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}loadTile(s,u){const g=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(g,a.ResourceType.Tile),data:void 0,uid:s.uid,tileID:s.tileID,tileZoom:s.tileZoom,zoom:s.tileID.overscaledZ,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:s.isSymbolTile};if(_.request.collectResourceTiming=this._collectResourceTiming,s.actor&&s.state!=="expired")s.state==="loading"?s.reloadCallback=u:s.request=s.actor.send("reloadTile",_,b.bind(this));else if(s.actor=this._tileWorkers[g]=this._tileWorkers[g]||this.dispatcher.getActor(),this.dispatcher.ready)s.request=s.actor.send("loadTile",_,b.bind(this),void 0,!0);else{const T=a.loadVectorTile.call({deduped:this._deduped},_,(C,A)=>{C||!A?b.call(this,C):(_.data={cacheControl:A.cacheControl,expires:A.expires,rawData:A.rawData.slice(0)},s.actor&&s.actor.send("loadTile",_,b.bind(this),void 0,!0))},!0);s.request={cancel:T}}function b(T,C){return delete s.request,s.aborted?u(null):T&&T.status!==404?u(T):(C&&C.resourceTiming&&(s.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&s.setExpiryData(C),s.loadVectorData(C,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id})}unloadTile(s){s.unloadVectorData(),s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ut extends a.Evented{constructor(s,u,g,_){super(),this.id=s,this.dispatcher=g,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},u),a.extend(this,a.pick(u,["url","scheme","tileSize"]))}load(s){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Zt(this._options,this.map._requestManager,null,null,(u,g)=>{this._tileJSONRequest=null,this._loaded=!0,u?this.fire(new a.ErrorEvent(u)):g&&(a.extend(this,g),g.bounds&&(this.tileBounds=new Mn(g.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(g.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),s&&s(u)})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,u){const g=a.exported.devicePixelRatio>=2,_=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);s.request=a.getImage(this.map._requestManager.transformRequest(_,a.ResourceType.Tile),(b,T,C,A)=>(delete s.request,s.aborted?(s.state="unloaded",u(null)):b?(s.state="errored",u(b)):T?(this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:C,expires:A}),s.setTexture(T,this.map.painter),s.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),void u(null)):u(null)))}static loadTileData(s,u,g){s.setTexture(u,g)}static unloadTileData(s,u){s.texture&&u.saveTileTexture(s.texture)}abortTile(s,u){s.request&&(s.request.cancel(),delete s.request),u()}unloadTile(s,u){s.texture&&this.map.painter.saveTileTexture(s.texture),u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function tn(p,s,u,g,_,b,T,C){const A=[p,u,_,s,g,b,1,1,1],z=[T,C,1],R=a.adjoint([],A),[N,Y,te]=a.transformMat3(z,z,a.transpose(R,R));return a.multiply$1(A,[N,0,0,0,Y,0,0,0,te],A)}class sn extends a.Evented{constructor(s,u,g,_){super(),this.id=s,this.dispatcher=g,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=u,this._dirty=!1}load(s,u){this._loaded=u||!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(g,_)=>{if(this._imageRequest=null,this._loaded=!0,g)this.fire(new a.ErrorEvent(g));else if(_){const{HTMLImageElement:b}=a.window;this.image=_ instanceof b?a.exported.getImageData(_):_,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,s&&(this.coordinates=s),this._finishLoading()}})}loaded(){return this._loaded}updateImage(s){return this.image&&s.url?(this._imageRequest&&s.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=s.url,this.load(s.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(s){this.coordinates=s,this._boundsArray=void 0;const u=s.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(g){let _=1/0,b=1/0,T=-1/0,C=-1/0;for(const N of g)_=Math.min(_,N.x),b=Math.min(b,N.y),T=Math.max(T,N.x),C=Math.max(C,N.y);const A=Math.max(T-_,C-b),z=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),R=Math.pow(2,z);return new a.CanonicalTileID(z,Math.floor((_+T)/2*R),Math.floor((b+C)/2*R))}(u),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(s){for(const A in this.tiles){const z=this.tiles[A];z.state!=="loaded"&&(z.state="loaded",z.texture=this.texture)}if(this._boundsArray)return;const u=a.tileTransform(this.tileID,this.map.transform.projection),[g,_,b,T]=this.coordinates.map(A=>{const z=u.projection.project(A[0],A[1]);return a.getTilePoint(u,z)._round()});this.perspectiveTransform=function(A,z,R,N,Y,te,ie,re,se,$){const ee=tn(0,0,A,0,0,z,A,z),ue=tn(R,N,Y,te,ie,re,se,$);return a.multiply$1(ue,a.adjoint(ee,ee),ue),[ue[6]/ue[8]*A/a.EXTENT,ue[7]/ue[8]*z/a.EXTENT]}(this.width,this.height,g.x,g.y,_.x,_.y,T.x,T.y,b.x,b.y);const C=this._boundsArray=new a.StructArrayLayout4i8;C.emplaceBack(g.x,g.y,0,0),C.emplaceBack(_.x,_.y,a.EXTENT,0),C.emplaceBack(T.x,T.y,0,a.EXTENT),C.emplaceBack(b.x,b.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=s.createVertexBuffer(C,a.boundsAttributes.members),this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const s=this.map.painter.context,u=s.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new a.Texture(s,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(s)}loadTile(s,u){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={},u(null)):(s.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const nn={vector:mt,raster:ut,"raster-dem":class extends ut{constructor(p,s,u,g){super(p,s,u,g),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}loadTile(p,s){const u=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(_,b){_&&(p.state="errored",s(_)),b&&(p.dem=b,p.dem.onDeserialize(),p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0,p.state="loaded",s(null))}p.request=a.getImage(this.map._requestManager.transformRequest(u,a.ResourceType.Tile),(function(_,b,T,C){if(delete p.request,p.aborted)p.state="unloaded",s(null);else if(_)p.state="errored",s(_);else if(b){this.map._refreshExpiredTiles&&p.setExpiryData({cacheControl:T,expires:C});const A=a.window.ImageBitmap&&b instanceof a.window.ImageBitmap&&(ao==null&&(ao=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&typeof a.window.createImageBitmap=="function"),ao),z=1-(b.width-a.prevPowerOfTwo(b.width))/2;z<1||p.neighboringTiles||(p.neighboringTiles=this._getNeighboringTiles(p.tileID));const R=A?b:a.exported.getImageData(b,z),N={uid:p.uid,coord:p.tileID,source:this.id,rawImageData:R,encoding:this.encoding,padding:z};p.actor&&p.state!=="expired"||(p.actor=this.dispatcher.getActor(),p.actor.send("loadDEMTile",N,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(p){const s=p.canonical,u=Math.pow(2,s.z),g=(s.x-1+u)%u,_=s.x===0?p.wrap-1:p.wrap,b=(s.x+1+u)%u,T=s.x+1===u?p.wrap+1:p.wrap,C={};return C[new a.OverscaledTileID(p.overscaledZ,_,s.z,g,s.y).key]={backfilled:!1},C[new a.OverscaledTileID(p.overscaledZ,T,s.z,b,s.y).key]={backfilled:!1},s.y>0&&(C[new a.OverscaledTileID(p.overscaledZ,_,s.z,g,s.y-1).key]={backfilled:!1},C[new a.OverscaledTileID(p.overscaledZ,p.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},C[new a.OverscaledTileID(p.overscaledZ,T,s.z,b,s.y-1).key]={backfilled:!1}),s.y+1<u&&(C[new a.OverscaledTileID(p.overscaledZ,_,s.z,g,s.y+1).key]={backfilled:!1},C[new a.OverscaledTileID(p.overscaledZ,p.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},C[new a.OverscaledTileID(p.overscaledZ,T,s.z,b,s.y+1).key]={backfilled:!1}),C}unloadTile(p){p.demTexture&&this.map.painter.saveTileTexture(p.demTexture),p.fbo&&(p.fbo.destroy(),delete p.fbo),p.dem&&delete p.dem,delete p.neighboringTiles,p.state="unloaded"}},geojson:class extends a.Evented{constructor(p,s,u,g){super(),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(g),this._data=s.data,this._options=a.extend({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const _=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*_,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*_,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:a.EXTENT,radius:(s.clusterRadius!==void 0?s.clusterRadius:50)*_,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions)}onAdd(p){this.map=p,this.setData(this._data)}setData(p){return this._data=p,this._updateWorkerData(),this}getClusterExpansionZoom(p,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id},s),this}getClusterChildren(p,s){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id},s),this}getClusterLeaves(p,s,u,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:p,limit:s,offset:u},g),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const p=a.extend({},this.workerOptions),s=this._data;typeof s=="string"?(p.request=this.map._requestManager.transformRequest(a.exported.resolveURL(s),a.ResourceType.Source),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(s),this._pendingLoad=this.actor.send(`${this.type}.loadData`,p,(u,g)=>{if(this._loaded=!0,this._pendingLoad=null,u)this.fire(new a.ErrorEvent(u));else{const _={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&g&&g.resourceTiming&&g.resourceTiming[this.id]&&(_.resourceTiming=g.resourceTiming[this.id]),this.fire(new a.Event("data",_)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(p,s){const u=p.actor?"reloadTile":"loadTile";p.actor=this.actor,p.request=this.actor.send(u,{type:this.type,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(g,_)=>(delete p.request,p.unloadVectorData(),p.aborted?s(null):g?s(g):(p.loadVectorData(_,this.map.painter,u==="reloadTile"),s(null))),void 0,u==="loadTile")}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0}unloadTile(p){p.unloadVectorData(),this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends sn{constructor(p,s,u,g){super(p,s,u,g),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const p=this.options;this.urls=[];for(const s of p.urls)this.urls.push(this.map._requestManager.transformRequest(s,a.ResourceType.Source).url);a.getVideo(this.urls,(s,u)=>{this._loaded=!0,s?this.fire(new a.ErrorEvent(s)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(p){if(this.video){const s=this.video.seekable;p<s.start(0)||p>s.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=p}}getVideo(){return this.video}onAdd(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const p=this.map.painter.context,s=p.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(p,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(p)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:sn,canvas:class extends sn{constructor(p,s,u,g){super(p,s,u,g),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(b=>typeof b!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${p}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${p}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${p}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${p}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${p}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context;this.texture?(p||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(s,this.canvas,s.gl.RGBA,{premultiply:!0}),this._prepareData(s)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const p of[this.canvas.width,this.canvas.height])if(isNaN(p)||p<=0)return!0;return!1}},custom:class extends a.Evented{constructor(p,s,u,g){super(),this.id=p,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=s,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Mn(this._implementation.bounds,this.minzoom,this.maxzoom)),s.update=this._update.bind(this),s.clearTiles=this._clearTiles.bind(this),s.coveringTiles=this._coveringTiles.bind(this),a.extend(this,a.pick(s,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(p){this._map=p,this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(p),this.load()}onRemove(p){this._implementation.onRemove&&this._implementation.onRemove(p)}hasTile(p){if(this._implementation.hasTile){const{x:s,y:u,z:g}=p.canonical;return this._implementation.hasTile({x:s,y:u,z:g})}return!this.tileBounds||this.tileBounds.contains(p.canonical)}loadTile(p,s){const{x:u,y:g,z:_}=p.tileID.canonical,b=new a.window.AbortController;p.request=Promise.resolve(this._implementation.loadTile({x:u,y:g,z:_},{signal:b.signal})).then((function(T){return delete p.request,p.aborted?(p.state="unloaded",s(null)):T===void 0?(p.state="errored",s(null)):T===null?(this.loadTileData(p,{width:this.tileSize,height:this.tileSize,data:null}),p.state="loaded",s(null)):function(C){return C instanceof a.window.ImageData||C instanceof a.window.HTMLCanvasElement||C instanceof a.window.ImageBitmap||C instanceof a.window.HTMLImageElement}(T)?(this.loadTileData(p,T),p.state="loaded",void s(null)):(p.state="errored",s(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(T=>{T.code!==20&&(p.state="errored",s(T))}),p.request.cancel=()=>b.abort()}loadTileData(p,s){ut.loadTileData(p,s,this._map.painter)}unloadTileData(p){ut.unloadTileData(p,this._map.painter)}unloadTile(p,s){if(this.unloadTileData(p),this._implementation.unloadTile){const{x:u,y:g,z:_}=p.tileID.canonical;this._implementation.unloadTile({x:u,y:g,z:_})}s()}abortTile(p,s){p.request&&p.request.cancel&&(p.request.cancel(),delete p.request),s()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(p=>({x:p.canonical.x,y:p.canonical.y,z:p.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}}},an=function(p,s,u,g){const _=new nn[s.type](p,s,u,g);if(_.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${_.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],_),_};function pn(p,s){const u=a.identity([]);return a.scale(u,u,[.5*p.width,.5*-p.height,1]),a.translate(u,u,[1,-1,0]),a.multiply(u,u,p.calculateProjMatrix(s.toUnwrapped())),Float32Array.from(u)}function ur(p,s,u,g,_,b,T,C=!1){const A=p.tilesIn(g,T,C);A.sort(xi);const z=[];for(const N of A)z.push({wrappedTileID:N.tile.tileID.wrapped().key,queryResults:N.tile.queryRenderedFeatures(s,u,p._state,N,_,b,pn(p.transform,N.tile.tileID),C)});const R=function(N){const Y={},te={};for(const ie of N){const re=ie.queryResults,se=ie.wrappedTileID,$=te[se]=te[se]||{};for(const ee in re){const ue=re[ee],de=$[ee]=$[ee]||{},Se=Y[ee]=Y[ee]||[];for(const Te of ue)de[Te.featureIndex]||(de[Te.featureIndex]=!0,Se.push(Te))}}return Y}(z);for(const N in R)R[N].forEach(Y=>{const te=Y.feature,ie=te.layer;ie&&ie.type!=="background"&&ie.type!=="sky"&&(te.source=ie.source,ie["source-layer"]&&(te.sourceLayer=ie["source-layer"]),te.state=te.id!==void 0?p.getFeatureState(ie["source-layer"],te.id):{})});return R}function Rr(p,s){const u=p.getRenderableIds().map(b=>p.getTileByID(b)),g=[],_={};for(let b=0;b<u.length;b++){const T=u[b],C=T.tileID.canonical.key;_[C]||(_[C]=!0,T.querySourceFeatures(g,s))}return g}function xi(p,s){const u=p.tileID,g=s.tileID;return u.overscaledZ-g.overscaledZ||u.canonical.y-g.canonical.y||u.wrap-g.wrap||u.canonical.x-g.canonical.x}function Gr(){return bl.workerClass!=null?new bl.workerClass:new a.window.Worker(bl.workerUrl)}const qo="mapboxgl_preloaded_worker_pool";class ei{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<ei.workerCount;)this.workers.push(new Gr);return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[qo]}numActive(){return Object.keys(this.active).length}}let Ai;function rl(){return Ai||(Ai=new ei),Ai}function Jx(p,s){const u={};for(const g in p)g!=="ref"&&(u[g]=p[g]);return a.refProperties.forEach(g=>{g in s&&(u[g]=s[g])}),u}function rg(p){p=p.slice();const s=Object.create(null);for(let u=0;u<p.length;u++)s[p[u].id]=p[u];for(let u=0;u<p.length;u++)"ref"in p[u]&&(p[u]=Jx(p[u],s[p[u].ref]));return p}ei.workerCount=2;const In={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Uh(p,s,u){u.push({command:In.addSource,args:[p,s[p]]})}function pc(p,s,u){s.push({command:In.removeSource,args:[p]}),u[p]=!0}function Vh(p,s,u,g){pc(p,u,g),Uh(p,s,u)}function Ru(p,s,u){let g;for(g in p[u])if(p[u].hasOwnProperty(g)&&g!=="data"&&!E(p[u][g],s[u][g]))return!1;for(g in s[u])if(s[u].hasOwnProperty(g)&&g!=="data"&&!E(p[u][g],s[u][g]))return!1;return!0}function Ho(p,s,u,g,_,b){let T;for(T in s=s||{},p=p||{})p.hasOwnProperty(T)&&(E(p[T],s[T])||u.push({command:b,args:[g,T,s[T],_]}));for(T in s)s.hasOwnProperty(T)&&!p.hasOwnProperty(T)&&(E(p[T],s[T])||u.push({command:b,args:[g,T,s[T],_]}))}function bs(p){return p.id}function Wh(p,s){return p[s.id]=s,p}class Gh{constructor(s,u){this.reset(s,u)}reset(s,u){this.points=s||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=a.clamp(s,0,1);let u=1,g=this._distances[u];const _=s*this.paddedLength+this.padding;for(;g<_&&u<this._distances.length;)g=this._distances[++u];const b=u-1,T=this._distances[b],C=g-T,A=C>0?(_-T)/C:0;return this.points[b].mult(1-A).add(this.points[u].mult(A))}}class wa{constructor(s,u,g){const _=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(s/g),this.yCellCount=Math.ceil(u/g);for(let T=0;T<this.xCellCount*this.yCellCount;T++)_.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=u,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,u,g,_,b){this._forEachCell(u,g,_,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(_),this.bboxes.push(b)}insertCircle(s,u,g,_){this._forEachCell(u-_,g-_,u+_,g+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(u),this.circles.push(g),this.circles.push(_)}_insertBoxCell(s,u,g,_,b,T){this.boxCells[b].push(T)}_insertCircleCell(s,u,g,_,b,T){this.circleCells[b].push(T)}_query(s,u,g,_,b,T){if(g<0||s>this.width||_<0||u>this.height)return!b&&[];const C=[];if(s<=0&&u<=0&&this.width<=g&&this.height<=_){if(b)return!0;for(let A=0;A<this.boxKeys.length;A++)C.push({key:this.boxKeys[A],x1:this.bboxes[4*A],y1:this.bboxes[4*A+1],x2:this.bboxes[4*A+2],y2:this.bboxes[4*A+3]});for(let A=0;A<this.circleKeys.length;A++){const z=this.circles[3*A],R=this.circles[3*A+1],N=this.circles[3*A+2];C.push({key:this.circleKeys[A],x1:z-N,y1:R-N,x2:z+N,y2:R+N})}return T?C.filter(T):C}return this._forEachCell(s,u,g,_,this._queryCell,C,{hitTest:b,seenUids:{box:{},circle:{}}},T),b?C.length>0:C}_queryCircle(s,u,g,_,b){const T=s-g,C=s+g,A=u-g,z=u+g;if(C<0||T>this.width||z<0||A>this.height)return!_&&[];const R=[];return this._forEachCell(T,A,C,z,this._queryCellCircle,R,{hitTest:_,circle:{x:s,y:u,radius:g},seenUids:{box:{},circle:{}}},b),_?R.length>0:R}query(s,u,g,_,b){return this._query(s,u,g,_,!1,b)}hitTest(s,u,g,_,b){return this._query(s,u,g,_,!0,b)}hitTestCircle(s,u,g,_){return this._queryCircle(s,u,g,!0,_)}_queryCell(s,u,g,_,b,T,C,A){const z=C.seenUids,R=this.boxCells[b];if(R!==null){const Y=this.bboxes;for(const te of R)if(!z.box[te]){z.box[te]=!0;const ie=4*te;if(s<=Y[ie+2]&&u<=Y[ie+3]&&g>=Y[ie+0]&&_>=Y[ie+1]&&(!A||A(this.boxKeys[te]))){if(C.hitTest)return T.push(!0),!0;T.push({key:this.boxKeys[te],x1:Y[ie],y1:Y[ie+1],x2:Y[ie+2],y2:Y[ie+3]})}}}const N=this.circleCells[b];if(N!==null){const Y=this.circles;for(const te of N)if(!z.circle[te]){z.circle[te]=!0;const ie=3*te;if(this._circleAndRectCollide(Y[ie],Y[ie+1],Y[ie+2],s,u,g,_)&&(!A||A(this.circleKeys[te]))){if(C.hitTest)return T.push(!0),!0;{const re=Y[ie],se=Y[ie+1],$=Y[ie+2];T.push({key:this.circleKeys[te],x1:re-$,y1:se-$,x2:re+$,y2:se+$})}}}}}_queryCellCircle(s,u,g,_,b,T,C,A){const z=C.circle,R=C.seenUids,N=this.boxCells[b];if(N!==null){const te=this.bboxes;for(const ie of N)if(!R.box[ie]){R.box[ie]=!0;const re=4*ie;if(this._circleAndRectCollide(z.x,z.y,z.radius,te[re+0],te[re+1],te[re+2],te[re+3])&&(!A||A(this.boxKeys[ie])))return T.push(!0),!0}}const Y=this.circleCells[b];if(Y!==null){const te=this.circles;for(const ie of Y)if(!R.circle[ie]){R.circle[ie]=!0;const re=3*ie;if(this._circlesCollide(te[re],te[re+1],te[re+2],z.x,z.y,z.radius)&&(!A||A(this.circleKeys[ie])))return T.push(!0),!0}}}_forEachCell(s,u,g,_,b,T,C,A){const z=this._convertToXCellCoord(s),R=this._convertToYCellCoord(u),N=this._convertToXCellCoord(g),Y=this._convertToYCellCoord(_);for(let te=z;te<=N;te++)for(let ie=R;ie<=Y;ie++)if(b.call(this,s,u,g,_,this.xCellCount*ie+te,T,C,A))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,u,g,_,b,T){const C=_-s,A=b-u,z=g+T;return z*z>C*C+A*A}_circleAndRectCollide(s,u,g,_,b,T,C){const A=(T-_)/2,z=Math.abs(s-(_+A));if(z>A+g)return!1;const R=(C-b)/2,N=Math.abs(u-(b+R));if(N>R+g)return!1;if(z<=A||N<=R)return!0;const Y=z-A,te=N-R;return Y*Y+te*te<=g*g}}const ws={unknown:0,flipRequired:1,flipNotRequired:2},fc=Math.tan(85*Math.PI/180);function qe(p,s,u,g,_,b,T){const C=a.create();if(u)if(b.name==="globe"){const A=a.calculateGlobeLabelMatrix(_,s);a.multiply(C,C,A)}else{const A=ye([],T);C[0]=A[0],C[1]=A[1],C[4]=A[2],C[5]=A[3],g||a.rotateZ(C,C,_.angle)}else a.multiply(C,_.labelPlaneMatrix,p);return C}function Ss(p,s,u,g,_,b,T){const C=qe(p,s,u,g,_,b,T);return b.name==="globe"&&u||(C[2]=C[6]=C[10]=C[14]=0),C}function zr(p,s,u,g,_,b,T){if(u){if(b.name==="globe"){const C=qe(p,s,u,g,_,b,T);return a.invert(C,C),a.multiply(C,p,C),C}{const C=a.clone(p),A=a.identity([]);return A[0]=T[0],A[1]=T[1],A[4]=T[2],A[5]=T[3],a.multiply(C,C,A),g||a.rotateZ(C,C,-_.angle),C}}return _.glCoordMatrix}function ti(p,s,u,g){const _=[p,s,u,1];u?a.transformMat4$1(_,_,g):un(_,_,g);const b=_[3];return _[0]/=b,_[1]/=b,_[2]/=b,_}function ig(p,s){return Math.min(.5+p/s*.5,1.5)}function Zo(p,s){const u=p[0]/p[3],g=p[1]/p[3];return u>=-s[0]&&u<=s[0]&&g>=-s[1]&&g<=s[1]}function qh(p,s,u,g,_,b,T,C,A,z){const R=u.transform,N=g?p.textSizeData:p.iconSizeData,Y=a.evaluateSizeForZoom(N,u.transform.zoom),te=R.projection.name==="globe",ie=[256/u.width*2+1,256/u.height*2+1],re=g?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;re.clear();let se=null;te&&(se=g?p.text.globeExtVertexArray:p.icon.globeExtVertexArray);const $=p.lineVertexArray,ee=g?p.text.placedSymbolArray:p.icon.placedSymbolArray,ue=u.transform.width/u.transform.height;let de,Se=!1;for(let Te=0;Te<ee.length;Te++){const Ee=ee.get(Te),{numGlyphs:Pe,writingMode:Me}=Ee;if(Me!==a.WritingMode.vertical||Se||de===a.WritingMode.horizontal||(Se=!0),de=Me,(Ee.hidden||Me===a.WritingMode.vertical)&&!Se){Co(Pe,re);continue}Se=!1;const je=new a.Point(Ee.tileAnchorX,Ee.tileAnchorY);let{x:rt,y:Oe,z:Ke}=R.projection.projectTilePoint(je.x,je.y,z.canonical);if(A){const[Ht,At,Ut]=A(je);rt+=Ht,Oe+=At,Ke+=Ut}const $e=[rt,Oe,Ke,1];if(a.transformMat4$1($e,$e,s),!Zo($e,ie)){Co(Pe,re);continue}const nt=ig(u.transform.cameraToCenterDistance,$e[3]),Fe=a.evaluateSizeForFeature(N,Y,Ee),Ze=T?Fe/nt:Fe*nt,ot=ti(rt,Oe,Ke,_);if(ot[3]<=0){Co(Pe,re);continue}let Qe={};const at=T?null:A,Ot=wt(Ee,Ze,!1,C,s,_,b,p.glyphOffsetArray,$,re,se,ot,je,Qe,ue,at,R.projection,z,T);Se=Ot.useVertical,at&&Ot.needsFlipping&&(Qe={}),(Ot.notEnoughRoom||Se||Ot.needsFlipping&&wt(Ee,Ze,!0,C,s,_,b,p.glyphOffsetArray,$,re,se,ot,je,Qe,ue,at,R.projection,z,T).notEnoughRoom)&&Co(Pe,re)}g?(p.text.dynamicLayoutVertexBuffer.updateData(re),se&&p.text.globeExtVertexBuffer.updateData(se)):(p.icon.dynamicLayoutVertexBuffer.updateData(re),se&&p.icon.globeExtVertexBuffer.updateData(se))}function og(p,s,u,g,_,b,T,C,A,z,R,N,Y,te,ie,re){const{lineStartIndex:se,glyphStartIndex:$,segment:ee}=C,ue=$+C.numGlyphs,de=se+C.lineLength,Se=s.getoffsetX($),Te=s.getoffsetX(ue-1),Ee=Qi(p*Se,u,g,_,b,T,ee,se,de,A,z,R,N,Y,!0,te,ie,re);if(!Ee)return null;const Pe=Qi(p*Te,u,g,_,b,T,ee,se,de,A,z,R,N,Y,!0,te,ie,re);return Pe?{first:Ee,last:Pe}:null}function il(p,s,u,g){return p===a.WritingMode.horizontal&&Math.abs(g)>Math.abs(u)?{useVertical:!0}:p===a.WritingMode.vertical?g>0?{needsFlipping:!0}:null:s!==ws.unknown&&function(_,b){return _===0||Math.abs(b/_)>fc}(u,g)?s===ws.flipRequired?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function wt(p,s,u,g,_,b,T,C,A,z,R,N,Y,te,ie,re,se,$,ee){const ue=s/24,de=p.lineOffsetX*ue,Se=p.lineOffsetY*ue,{lineStartIndex:Te,glyphStartIndex:Ee,numGlyphs:Pe,segment:Me,writingMode:je,flipState:rt}=p,Oe=Te+p.lineLength,Ke=$e=>{if(R){const[ot,Qe,at]=$e.up,Ot=z.length;a.updateGlobeVertexNormal(R,Ot+0,ot,Qe,at),a.updateGlobeVertexNormal(R,Ot+1,ot,Qe,at),a.updateGlobeVertexNormal(R,Ot+2,ot,Qe,at),a.updateGlobeVertexNormal(R,Ot+3,ot,Qe,at)}const[nt,Fe,Ze]=$e.point;a.addDynamicAttributes(z,nt,Fe,Ze,$e.angle)};if(Pe>1){const $e=og(ue,C,de,Se,u,N,Y,p,A,b,te,re,!1,se,$,ee);if(!$e)return{notEnoughRoom:!0};if(g&&!u){let[nt,Fe,Ze]=$e.first.point,[ot,Qe,at]=$e.last.point;[nt,Fe]=ti(nt,Fe,Ze,T),[ot,Qe]=ti(ot,Qe,at,T);const Ot=il(je,rt,(ot-nt)*ie,Qe-Fe);if(p.flipState=Ot&&Ot.needsFlipping?ws.flipRequired:ws.flipNotRequired,Ot)return Ot}Ke($e.first);for(let nt=Ee+1;nt<Ee+Pe-1;nt++){const Fe=Qi(ue*C.getoffsetX(nt),de,Se,u,N,Y,Me,Te,Oe,A,b,te,re,!1,!1,se,$,ee);if(!Fe)return z.length-=4*(nt-Ee),{notEnoughRoom:!0};Ke(Fe)}Ke($e.last)}else{if(g&&!u){const nt=ti(Y.x,Y.y,0,_),Fe=Te+Me+1,Ze=new a.Point(A.getx(Fe),A.gety(Fe)),ot=ti(Ze.x,Ze.y,0,_),Qe=ot[3]>0?ot:cn(Y,Ze,nt,1,_,void 0,se,$.canonical),at=il(je,rt,(Qe[0]-nt[0])*ie,Qe[1]-nt[1]);if(p.flipState=at&&at.needsFlipping?ws.flipRequired:ws.flipNotRequired,at)return at}const $e=Qi(ue*C.getoffsetX(Ee),de,Se,u,N,Y,Me,Te,Oe,A,b,te,re,!1,!1,se,$,ee);if(!$e)return{notEnoughRoom:!0};Ke($e)}return{}}function hn(p,s,u,g,_){const{x:b,y:T,z:C}=g.projectTilePoint(p.x,p.y,s);if(!_)return ti(b,T,C,u);const[A,z,R]=_(p);return ti(b+A,T+z,C+R,u)}function cn(p,s,u,g,_,b,T,C){const A=hn(p.sub(s)._unit()._add(p),C,_,T,b);return a.sub(A,u,A),a.normalize(A,A),a.scaleAndAdd(A,u,A,g)}function Qi(p,s,u,g,_,b,T,C,A,z,R,N,Y,te,ie,re,se,$){const ee=g?p-s:p+s;let ue=ee>0?1:-1,de=0;g&&(ue*=-1,de=Math.PI),ue<0&&(de+=Math.PI);let Se=C+T+(ue>0?0:1)|0,Te=_,Ee=_,Pe=0,Me=0;const je=Math.abs(ee),rt=[],Oe=[];let Ke=b,$e=Ke;const nt=()=>cn($e,Ke,Ee,je-Pe+1,R,Y,re,se.canonical);for(;Pe+Me<=je;){if(Se+=ue,Se<C||Se>=A)return null;if(Ee=Te,$e=Ke,rt.push(Ee),te&&Oe.push($e),Ke=new a.Point(z.getx(Se),z.gety(Se)),Te=N[Se],!Te){const Ut=hn(Ke,se.canonical,R,re,Y);Te=Ut[3]>0?N[Se]=Ut:nt()}Pe+=Me,Me=a.distance(Ee,Te)}ie&&Y&&(N[Se]&&(Te=nt(),Me=a.distance(Ee,Te)),N[Se]=Te);const Fe=(je-Pe)/Me,Ze=Ke.sub($e)._mult(Fe)._add($e),ot=a.sub([],Te,Ee),Qe=a.scaleAndAdd([],Ee,ot,Fe);let at=[0,0,1],Ot=ot[0],Ht=ot[1];if($&&(at=re.upVector(se.canonical,Ze.x,Ze.y),at[0]!==0||at[1]!==0||at[2]!==1)){const Ut=[at[2],0,-at[0]],dn=a.cross([],at,Ut);a.normalize(Ut,Ut),a.normalize(dn,dn),Ot=a.dot(ot,Ut),Ht=a.dot(ot,dn)}if(u){const Ut=a.cross([],at,ot);a.normalize(Ut,Ut),a.scaleAndAdd(Qe,Qe,Ut,u*ue)}const At=de+Math.atan2(Ht,Ot);return rt.push(Qe),te&&Oe.push(Ze),{point:Qe,angle:At,path:rt,tilePath:Oe,up:at}}function Co(p,s){const u=s.length,g=u+4*p;s.resize(g),s.float32.fill(-1/0,4*u,4*g)}function un(p,s,u){const g=s[0],_=s[1];return p[0]=u[0]*g+u[4]*_+u[12],p[1]=u[1]*g+u[5]*_+u[13],p[3]=u[3]*g+u[7]*_+u[15],p}const eo=100;class mc{constructor(s,u,g=new wa(s.width+200,s.height+200,25),_=new wa(s.width+200,s.height+200,25)){this.transform=s,this.grid=g,this.ignoredGrid=_,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+eo,this.screenBottomBoundary=s.height+eo,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.fogState=u}placeCollisionBox(s,u,g,_,b,T,C,A){let z=g.projectedAnchorX,R=g.projectedAnchorY,N=g.projectedAnchorZ;const Y=g.elevation,te=g.tileID,ie=s.getProjection();if(Y&&te){const[Te,Ee,Pe]=ie.upVector(te.canonical,g.tileAnchorX,g.tileAnchorY),Me=ie.upVectorScale(te.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;z+=Te*Y*Me,R+=Ee*Y*Me,N+=Pe*Y*Me}const re=this.projectAndGetPerspectiveRatio(C,z,R,N,g.tileID,ie.name==="globe"||!!Y||this.transform.pitch>0,ie),se=T*re.perspectiveRatio,$=(g.x1*u+_.x-g.padding)*se+re.point.x,ee=(g.y1*u+_.y-g.padding)*se+re.point.y,ue=(g.x2*u+_.x+g.padding)*se+re.point.x,de=(g.y2*u+_.y+g.padding)*se+re.point.y,Se=re.perspectiveRatio<=.55||re.occluded;return!this.isInsideGrid($,ee,ue,de)||!b&&this.grid.hitTest($,ee,ue,de,A)||Se?{box:[],offscreen:!1,occluded:re.occluded}:{box:[$,ee,ue,de],offscreen:this.isOffscreen($,ee,ue,de),occluded:!1}}placeCollisionCircles(s,u,g,_,b,T,C,A,z,R,N,Y,te,ie,re){const se=[],$=this.transform.elevation,ee=s.getProjection(),ue=$?$.getAtTileOffsetFunc(re,this.transform.center.lat,this.transform.worldSize,ee):null,de=new a.Point(g.tileAnchorX,g.tileAnchorY);let{x:Se,y:Te,z:Ee}=ee.projectTilePoint(de.x,de.y,re.canonical);if(ue){const[Ze,ot,Qe]=ue(de);Se+=Ze,Te+=ot,Ee+=Qe}const Pe=ee.name==="globe",Me=this.projectAndGetPerspectiveRatio(C,Se,Te,Ee,re,Pe||!!$||this.transform.pitch>0,ee),{perspectiveRatio:je}=Me,rt=(N?T/je:T*je)/a.ONE_EM,Oe=ti(Se,Te,Ee,A),Ke=Me.signedDistanceFromCamera>0?og(rt,b,g.lineOffsetX*rt,g.lineOffsetY*rt,!1,Oe,de,g,_,A,{},$&&!N?ue:null,N&&!!$,ee,re,N):null;let $e=!1,nt=!1,Fe=!0;if(Ke&&!Me.occluded){const Ze=.5*te*je+ie,ot=new a.Point(-100,-100),Qe=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),at=new Gh,{first:Ot,last:Ht}=Ke,At=Ot.path.length;let Ut=[];for(let Lt=At-1;Lt>=1;Lt--)Ut.push(Ot.path[Lt]);for(let Lt=1;Lt<Ht.path.length;Lt++)Ut.push(Ht.path[Lt]);const dn=2.5*Ze;z&&(Ut=Ut.map(([Lt,Pn,Bn],Fn)=>(ue&&!Pe&&(Bn=ue(Fn<At-1?Ot.tilePath[At-1-Fn]:Ht.tilePath[Fn-At+2])[2]),ti(Lt,Pn,Bn,z))),Ut.some(Lt=>Lt[3]<=0)&&(Ut=[]));let ln=[];if(Ut.length>0){let Lt=1/0,Pn=-1/0,Bn=1/0,Fn=-1/0;for(const jn of Ut)Lt=Math.min(Lt,jn[0]),Bn=Math.min(Bn,jn[1]),Pn=Math.max(Pn,jn[0]),Fn=Math.max(Fn,jn[1]);Pn>=ot.x&&Lt<=Qe.x&&Fn>=ot.y&&Bn<=Qe.y&&(ln=[Ut.map(jn=>new a.Point(jn[0],jn[1]))],(Lt<ot.x||Pn>Qe.x||Bn<ot.y||Fn>Qe.y)&&(ln=a.clipLine(ln,ot.x,ot.y,Qe.x,Qe.y)))}for(const Lt of ln){at.reset(Lt,.25*Ze);let Pn=0;Pn=at.length<=.5*Ze?1:Math.ceil(at.paddedLength/dn)+1;for(let Bn=0;Bn<Pn;Bn++){const Fn=Bn/Math.max(Pn-1,1),jn=at.lerp(Fn),bi=jn.x+eo,ri=jn.y+eo;se.push(bi,ri,Ze,0);const po=bi-Ze,Jo=ri-Ze,or=bi+Ze,Nn=ri+Ze;if(Fe=Fe&&this.isOffscreen(po,Jo,or,Nn),nt=nt||this.isInsideGrid(po,Jo,or,Nn),!u&&this.grid.hitTestCircle(bi,ri,Ze,Y)&&($e=!0,!R))return{circles:[],offscreen:!1,collisionDetected:$e,occluded:!1}}}}return{circles:!R&&$e||!nt?[]:se,offscreen:Fe,collisionDetected:$e,occluded:Me.occluded}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let g=1/0,_=1/0,b=-1/0,T=-1/0;for(const R of s){const N=new a.Point(R.x+eo,R.y+eo);g=Math.min(g,N.x),_=Math.min(_,N.y),b=Math.max(b,N.x),T=Math.max(T,N.y),u.push(N)}const C=this.grid.query(g,_,b,T).concat(this.ignoredGrid.query(g,_,b,T)),A={},z={};for(const R of C){const N=R.key;if(A[N.bucketInstanceId]===void 0&&(A[N.bucketInstanceId]={}),A[N.bucketInstanceId][N.featureIndex])continue;const Y=[new a.Point(R.x1,R.y1),new a.Point(R.x2,R.y1),new a.Point(R.x2,R.y2),new a.Point(R.x1,R.y2)];a.polygonIntersectsPolygon(u,Y)&&(A[N.bucketInstanceId][N.featureIndex]=!0,z[N.bucketInstanceId]===void 0&&(z[N.bucketInstanceId]=[]),z[N.bucketInstanceId].push(N.featureIndex))}return z}insertCollisionBox(s,u,g,_,b){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:_,collisionGroupID:b},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,u,g,_,b){const T=u?this.ignoredGrid:this.grid,C={bucketInstanceId:g,featureIndex:_,collisionGroupID:b};for(let A=0;A<s.length;A+=4)T.insertCircle(C,s[A],s[A+1],s[A+2])}projectAndGetPerspectiveRatio(s,u,g,_,b,T,C){const A=[u,g,_,1];let z=!1;_||this.transform.pitch>0?(a.transformMat4$1(A,A,s),this.fogState&&b&&C.name!=="globe"&&(z=function(Y,te,ie,re,se,$){const ee=$.calculateFogTileMatrix(se),ue=[te,ie,re];return a.transformMat4(ue,ue,ee),St(Y,ue,$.pitch,$._fov)}(this.fogState,u,g,_,b.toUnwrapped(),this.transform)>.9)):un(A,A,s);const R=A[3];return{point:new a.Point((A[0]/R+1)/2*this.transform.width+eo,(-A[1]/R+1)/2*this.transform.height+eo),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(C)/R*.5,1.5),signedDistanceFromCamera:R,occluded:T&&A[2]>R||z}}isOffscreen(s,u,g,_){return g<eo||s>=this.screenRightBoundary||_<eo||u>this.screenBottomBoundary}isInsideGrid(s,u,g,_){return g>=0&&s<this.gridRightBoundary&&_>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const s=a.identity([]);return a.translate(s,s,[-100,-100,0]),s}}function Sa(p,s,u){const g=s.createTileMatrix(p,p.worldSize,u.toUnwrapped());return a.multiply(new Float32Array(16),p.projMatrix,g)}function lo(p,s,u){if(s.projection.name===u.projection.name)return p.projMatrix;const g=u.clone();return g.setProjection(s.projection),Sa(g,s.getProjection(),p)}function ir(p,s,u){return s.name===u.projection.name?p.projMatrix:Sa(u,s,p)}class sg{constructor(s,u,g,_){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?u:-u))):_&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class Es{constructor(s,u,g,_,b,T=!1){this.text=new sg(s?s.text:null,u,g,b),this.icon=new sg(s?s.icon:null,u,_,b),this.clipped=T}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class gc{constructor(s,u,g,_=!1){this.text=s,this.icon=u,this.skipFade=g,this.clipped=_}}class yc{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class Hh{constructor(s,u,g,_,b){this.bucketInstanceId=s,this.featureIndex=u,this.sourceLayerIndex=g,this.bucketIndex=_,this.tileID=b}}class ag{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const u=++this.maxGroupID;this.collisionGroups[s]={ID:u,predicate:g=>g.collisionGroupID===u}}return this.collisionGroups[s]}}function _c(p,s,u,g,_){const{horizontalAlign:b,verticalAlign:T}=a.getAnchorAlignment(p),C=-(b-.5)*s,A=-(T-.5)*u,z=a.evaluateVariableOffset(p,g);return new a.Point(C+z[0]*_,A+z[1]*_)}function xc(p,s,u,g,_){const b=new a.Point(p,s);return u&&b._rotate(g?_:-_),b}class zu{constructor(s,u,g,_,b){this.transform=s.clone(),this.projection=s.projection.name,this.collisionIndex=new mc(this.transform,b),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new ag(g),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,u,g,_){const b=g.getBucket(u),T=g.latestFeatureIndex;if(!b||!T||u.id!==b.layerIds[0])return;const C=b.layers[0].layout,A=g.collisionBoxArray,z=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),R=g.tileSize/a.EXTENT,N=g.tileID.toUnwrapped();this.transform.setProjection(b.projection);const Y=(te=g.tileID,ie=b.getProjection(),re=this.transform,ie.name===this.projection?re.calculateProjMatrix(te.toUnwrapped()):Sa(re,ie,te));var te,ie,re;const se=C.get("text-pitch-alignment")==="map",$=C.get("text-rotation-alignment")==="map";u.compileFilter();const ee=u.dynamicFilter(),ue=u.dynamicFilterNeedsFeature(),de=this.transform.calculatePixelsToTileUnitsMatrix(g),Se=Ss(Y,g.tileID.canonical,se,$,this.transform,b.getProjection(),de);let Te=null;if(se){const Me=zr(Y,g.tileID.canonical,se,$,this.transform,b.getProjection(),de);Te=a.multiply([],this.transform.labelPlaneMatrix,Me)}let Ee=null;ee&&g.latestFeatureIndex&&(Ee={unwrappedTileID:N,dynamicFilter:ee,dynamicFilterNeedsFeature:ue,featureIndex:g.latestFeatureIndex}),this.retainedQueryData[b.bucketInstanceId]=new Hh(b.bucketInstanceId,T,b.sourceLayerIndex,b.index,g.tileID);const Pe={bucket:b,layout:C,posMatrix:Y,textLabelPlaneMatrix:Se,labelToScreenMatrix:Te,clippingData:Ee,scale:z,textPixelRatio:R,holdingForFade:g.holdingForFade(),collisionBoxArray:A,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(b.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(_)for(const Me of b.sortKeyRanges){const{sortKey:je,symbolInstanceStart:rt,symbolInstanceEnd:Oe}=Me;s.push({sortKey:je,symbolInstanceStart:rt,symbolInstanceEnd:Oe,parameters:Pe})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Pe})}attemptAnchorPlacement(s,u,g,_,b,T,C,A,z,R,N,Y,te,ie,re,se,$,ee){const{textOffset0:ue,textOffset1:de,crossTileID:Se}=Y,Te=[ue,de],Ee=_c(s,g,_,Te,b),Pe=this.collisionIndex.placeCollisionBox(ie,b,u,xc(Ee.x,Ee.y,T,C,this.transform.angle),N,A,z,R.predicate);if(se){const Me=ie.getSymbolInstanceIconSize(ee,this.transform.zoom,Y.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ie,Me,se,xc(Ee.x,Ee.y,T,C,this.transform.angle),N,A,z,R.predicate).box.length===0)return}if(Pe.box.length>0){let Me;return this.prevPlacement&&this.prevPlacement.variableOffsets[Se]&&this.prevPlacement.placements[Se]&&this.prevPlacement.placements[Se].text&&(Me=this.prevPlacement.variableOffsets[Se].anchor),this.variableOffsets[Se]={textOffset:Te,width:g,height:_,anchor:s,textScale:b,prevAnchor:Me},this.markUsedJustification(ie,s,Y,re),ie.allowVerticalPlacement&&(this.markUsedOrientation(ie,re,Y),this.placedOrientations[Se]=re),{shift:Ee,placedGlyphBoxes:Pe}}}placeLayerBucketPart(s,u,g,_){const{bucket:b,layout:T,posMatrix:C,textLabelPlaneMatrix:A,labelToScreenMatrix:z,clippingData:R,textPixelRatio:N,holdingForFade:Y,collisionBoxArray:te,partiallyEvaluatedTextSize:ie,partiallyEvaluatedIconSize:re,collisionGroup:se}=s.parameters,$=T.get("text-optional"),ee=T.get("icon-optional"),ue=T.get("text-allow-overlap"),de=T.get("icon-allow-overlap"),Se=T.get("text-rotation-alignment")==="map",Te=T.get("text-pitch-alignment")==="map",Ee=T.get("icon-text-fit")!=="none",Pe=T.get("symbol-z-order")==="viewport-y";this.transform.setProjection(b.projection);let Me=ue&&(de||!b.hasIconData()||ee),je=de&&(ue||!b.hasTextData()||$);!b.collisionArrays&&te&&b.deserializeCollisionBoxes(te),g&&_&&b.updateCollisionDebugBuffers(this.transform.zoom,te);const rt=(Oe,Ke,$e)=>{const{crossTileID:nt,numVerticalGlyphVertices:Fe}=Oe;if(R){const or={zoom:this.transform.zoom,pitch:this.transform.pitch};let Nn=null;if(R.dynamicFilterNeedsFeature){const Sn=this.retainedQueryData[b.bucketInstanceId];Nn=R.featureIndex.loadFeature({featureIndex:Oe.featureIndex,bucketIndex:Sn.bucketIndex,sourceLayerIndex:Sn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,R.dynamicFilter)(or,Nn,this.retainedQueryData[b.bucketInstanceId].tileID.canonical,new a.Point(Oe.tileAnchorX,Oe.tileAnchorY),this.transform.calculateDistanceTileData(R.unwrappedTileID)))return this.placements[nt]=new gc(!1,!1,!1,!0),void u.add(nt)}if(u.has(nt))return;if(Y)return void(this.placements[nt]=new gc(!1,!1,!1));let Ze=!1,ot=!1,Qe=!0,at=!1,Ot=!1,Ht=null,At={box:null,offscreen:null,occluded:null},Ut={box:null,offscreen:null,occluded:null},dn=null,ln=null,Lt=null,Pn=0,Bn=0,Fn=0;$e.textFeatureIndex?Pn=$e.textFeatureIndex:Oe.useRuntimeCollisionCircles&&(Pn=Oe.featureIndex),$e.verticalTextFeatureIndex&&(Bn=$e.verticalTextFeatureIndex);const jn=or=>{or.tileID=this.retainedQueryData[b.bucketInstanceId].tileID;const Nn=this.transform.elevation;(Nn||or.elevation)&&(or.elevation=Nn?Nn.getAtTileOffset(or.tileID,or.tileAnchorX,or.tileAnchorY):0)},bi=$e.textBox;if(bi){jn(bi);const or=Sn=>{let Lr=a.WritingMode.horizontal;if(b.allowVerticalPlacement&&!Sn&&this.prevPlacement){const Mi=this.prevPlacement.placedOrientations[nt];Mi&&(this.placedOrientations[nt]=Mi,Lr=Mi,this.markUsedOrientation(b,Lr,Oe))}return Lr},Nn=(Sn,Lr)=>{if(b.allowVerticalPlacement&&Fe>0&&$e.verticalTextBox){for(const Mi of b.writingModes)if(Mi===a.WritingMode.vertical?(At=Lr(),Ut=At):At=Sn(),At&&At.box&&At.box.length)break}else At=Sn()};if(T.get("text-variable-anchor")){let Sn=T.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[nt]){const tr=this.prevPlacement.variableOffsets[nt];Sn.indexOf(tr.anchor)>0&&(Sn=Sn.filter(Fi=>Fi!==tr.anchor),Sn.unshift(tr.anchor))}const Lr=(tr,Fi,sd)=>{const Pa=b.getSymbolInstanceTextSize(ie,Oe,this.transform.zoom,Ke),jc=(tr.x2-tr.x1)*Pa+2*tr.padding,Ps=(tr.y2-tr.y1)*Pa+2*tr.padding,ta=Ee&&!de?Fi:null;ta&&jn(ta);let Ra={box:[],offscreen:!1,occluded:!1};const ad=ue?2*Sn.length:Sn.length;for(let Nc=0;Nc<ad;++Nc){const Bp=this.attemptAnchorPlacement(Sn[Nc%Sn.length],tr,jc,Ps,Pa,Se,Te,N,C,se,Nc>=Sn.length,Oe,Ke,b,sd,ta,ie,re);if(Bp&&(Ra=Bp.placedGlyphBoxes,Ra&&Ra.box&&Ra.box.length)){Ze=!0,Ht=Bp.shift;break}}return Ra};Nn(()=>Lr(bi,$e.iconBox,a.WritingMode.horizontal),()=>{const tr=$e.verticalTextBox;return tr&&jn(tr),b.allowVerticalPlacement&&!(At&&At.box&&At.box.length)&&Fe>0&&tr?Lr(tr,$e.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),At&&(Ze=At.box,Qe=At.offscreen,at=At.occluded);const Mi=or(!(!At||!At.box));if(!Ze&&this.prevPlacement){const tr=this.prevPlacement.variableOffsets[nt];tr&&(this.variableOffsets[nt]=tr,this.markUsedJustification(b,tr.anchor,Oe,Mi))}}else{const Sn=(Lr,Mi)=>{const tr=b.getSymbolInstanceTextSize(ie,Oe,this.transform.zoom,Ke),Fi=this.collisionIndex.placeCollisionBox(b,tr,Lr,new a.Point(0,0),ue,N,C,se.predicate);return Fi&&Fi.box&&Fi.box.length&&(this.markUsedOrientation(b,Mi,Oe),this.placedOrientations[nt]=Mi),Fi};Nn(()=>Sn(bi,a.WritingMode.horizontal),()=>{const Lr=$e.verticalTextBox;return b.allowVerticalPlacement&&Fe>0&&Lr?(jn(Lr),Sn(Lr,a.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),or(!!(At&&At.box&&At.box.length))}}if(dn=At,Ze=dn&&dn.box&&dn.box.length>0,Qe=dn&&dn.offscreen,at=dn&&dn.occluded,Oe.useRuntimeCollisionCircles){const or=b.text.placedSymbolArray.get(Oe.centerJustifiedTextSymbolIndex>=0?Oe.centerJustifiedTextSymbolIndex:Oe.verticalPlacedTextSymbolIndex),Nn=a.evaluateSizeForFeature(b.textSizeData,ie,or),Sn=T.get("text-padding");ln=this.collisionIndex.placeCollisionCircles(b,ue,or,b.lineVertexArray,b.glyphOffsetArray,Nn,C,A,z,g,Te,se.predicate,Oe.collisionCircleDiameter*Nn/a.ONE_EM,Sn,this.retainedQueryData[b.bucketInstanceId].tileID),Ze=ue||ln.circles.length>0&&!ln.collisionDetected,Qe=Qe&&ln.offscreen,at=ln.occluded}if($e.iconFeatureIndex&&(Fn=$e.iconFeatureIndex),$e.iconBox){const or=Nn=>{jn(Nn);const Sn=Ee&&Ht?xc(Ht.x,Ht.y,Se,Te,this.transform.angle):new a.Point(0,0),Lr=b.getSymbolInstanceIconSize(re,this.transform.zoom,Oe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(b,Lr,Nn,Sn,de,N,C,se.predicate)};Ut&&Ut.box&&Ut.box.length&&$e.verticalIconBox?(Lt=or($e.verticalIconBox),ot=Lt.box.length>0):(Lt=or($e.iconBox),ot=Lt.box.length>0),Qe=Qe&&Lt.offscreen,Ot=Lt.occluded}const ri=$||Oe.numHorizontalGlyphVertices===0&&Fe===0,po=ee||Oe.numIconVertices===0;if(ri||po?po?ri||(ot=ot&&Ze):Ze=ot&&Ze:ot=Ze=ot&&Ze,Ze&&dn&&dn.box&&this.collisionIndex.insertCollisionBox(dn.box,T.get("text-ignore-placement"),b.bucketInstanceId,Ut&&Ut.box&&Bn?Bn:Pn,se.ID),ot&&Lt&&this.collisionIndex.insertCollisionBox(Lt.box,T.get("icon-ignore-placement"),b.bucketInstanceId,Fn,se.ID),ln&&(Ze&&this.collisionIndex.insertCollisionCircles(ln.circles,T.get("text-ignore-placement"),b.bucketInstanceId,Pn,se.ID),g)){const or=b.bucketInstanceId;let Nn=this.collisionCircleArrays[or];Nn===void 0&&(Nn=this.collisionCircleArrays[or]=new yc);for(let Sn=0;Sn<ln.circles.length;Sn+=4)Nn.circles.push(ln.circles[Sn+0]),Nn.circles.push(ln.circles[Sn+1]),Nn.circles.push(ln.circles[Sn+2]),Nn.circles.push(ln.collisionDetected?1:0)}const Jo=b.projection.name!=="globe";Me=Me&&(Jo||!at),je=je&&(Jo||!Ot),this.placements[nt]=new gc(Ze||Me,ot||je,Qe||b.justReloaded),u.add(nt)};if(Pe){const Oe=b.getSortedSymbolIndexes(this.transform.angle);for(let Ke=Oe.length-1;Ke>=0;--Ke){const $e=Oe[Ke];rt(b.symbolInstances.get($e),$e,b.collisionArrays[$e])}}else for(let Oe=s.symbolInstanceStart;Oe<s.symbolInstanceEnd;Oe++)rt(b.symbolInstances.get(Oe),Oe,b.collisionArrays[Oe]);if(g&&b.bucketInstanceId in this.collisionCircleArrays){const Oe=this.collisionCircleArrays[b.bucketInstanceId];a.invert(Oe.invProjMatrix,C),Oe.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1}markUsedJustification(s,u,g,_){const{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:T,rightJustifiedTextSymbolIndex:C,verticalPlacedTextSymbolIndex:A,crossTileID:z}=g,R=a.getAnchorJustification(u),N=_===a.WritingMode.vertical?A:R==="left"?b:R==="center"?T:R==="right"?C:-1;b>=0&&(s.text.placedSymbolArray.get(b).crossTileID=N>=0&&b!==N?0:z),T>=0&&(s.text.placedSymbolArray.get(T).crossTileID=N>=0&&T!==N?0:z),C>=0&&(s.text.placedSymbolArray.get(C).crossTileID=N>=0&&C!==N?0:z),A>=0&&(s.text.placedSymbolArray.get(A).crossTileID=N>=0&&A!==N?0:z)}markUsedOrientation(s,u,g){const _=u===a.WritingMode.horizontal||u===a.WritingMode.horizontalOnly?u:0,b=u===a.WritingMode.vertical?u:0,{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:A,verticalPlacedTextSymbolIndex:z}=g,R=s.text.placedSymbolArray;T>=0&&(R.get(T).placedOrientation=_),C>=0&&(R.get(C).placedOrientation=_),A>=0&&(R.get(A).placedOrientation=_),z>=0&&(R.get(z).placedOrientation=b)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let g=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const _=u?u.symbolFadeChange(s):1,b=u?u.opacities:{},T=u?u.variableOffsets:{},C=u?u.placedOrientations:{};for(const A in this.placements){const z=this.placements[A],R=b[A];R?(this.opacities[A]=new Es(R,_,z.text,z.icon,null,z.clipped),g=g||z.text!==R.text.placed||z.icon!==R.icon.placed):(this.opacities[A]=new Es(null,_,z.text,z.icon,z.skipFade,z.clipped),g=g||z.text||z.icon)}for(const A in b){const z=b[A];if(!this.opacities[A]){const R=new Es(z,_,!1,!1);R.isHidden()||(this.opacities[A]=R,g=g||z.text.placed||z.icon.placed)}}for(const A in T)this.variableOffsets[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.variableOffsets[A]=T[A]);for(const A in C)this.placedOrientations[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.placedOrientations[A]=C[A]);g?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:s)}updateLayerOpacities(s,u){const g=new Set;for(const _ of u){const b=_.getBucket(s);b&&_.latestFeatureIndex&&s.id===b.layerIds[0]&&this.updateBucketOpacities(b,g,_.collisionBoxArray)}}updateBucketOpacities(s,u,g){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const _=s.layers[0].layout,b=!!s.layers[0].dynamicFilter(),T=new Es(null,0,!1,!1,!0),C=_.get("text-allow-overlap"),A=_.get("icon-allow-overlap"),z=_.get("text-variable-anchor"),R=_.get("text-rotation-alignment")==="map",N=_.get("text-pitch-alignment")==="map",Y=_.get("icon-text-fit")!=="none",te=new Es(null,0,C&&(A||!s.hasIconData()||_.get("icon-optional")),A&&(C||!s.hasTextData()||_.get("text-optional")),!0);!s.collisionArrays&&g&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(g);const ie=(se,$,ee)=>{for(let ue=0;ue<$/4;ue++)se.opacityVertexArray.emplaceBack(ee)};let re=0;for(let se=0;se<s.symbolInstances.length;se++){const $=s.symbolInstances.get(se),{numHorizontalGlyphVertices:ee,numVerticalGlyphVertices:ue,crossTileID:de,numIconVertices:Se}=$,Te=u.has(de);let Ee=this.opacities[de];Te?Ee=T:Ee||(Ee=te,this.opacities[de]=Ee),u.add(de);const Pe=ee>0||ue>0,Me=Se>0,je=this.placedOrientations[de],rt=je===a.WritingMode.vertical,Oe=je===a.WritingMode.horizontal||je===a.WritingMode.horizontalOnly;if(!Pe&&!Me||Ee.isHidden()||re++,Pe){const Ke=vc(Ee.text);ie(s.text,ee,rt?yr:Ke),ie(s.text,ue,Oe?yr:Ke);const $e=Ee.text.isHidden(),{leftJustifiedTextSymbolIndex:nt,centerJustifiedTextSymbolIndex:Fe,rightJustifiedTextSymbolIndex:Ze,verticalPlacedTextSymbolIndex:ot}=$,Qe=s.text.placedSymbolArray,at=$e||rt?1:0;nt>=0&&(Qe.get(nt).hidden=at),Fe>=0&&(Qe.get(Fe).hidden=at),Ze>=0&&(Qe.get(Ze).hidden=at),ot>=0&&(Qe.get(ot).hidden=$e||Oe?1:0);const Ot=this.variableOffsets[de];Ot&&this.markUsedJustification(s,Ot.anchor,$,je);const Ht=this.placedOrientations[de];Ht&&(this.markUsedJustification(s,"left",$,Ht),this.markUsedOrientation(s,Ht,$))}if(Me){const Ke=vc(Ee.icon),{placedIconSymbolIndex:$e,verticalPlacedIconSymbolIndex:nt}=$,Fe=s.icon.placedSymbolArray,Ze=Ee.icon.isHidden()?1:0;$e>=0&&(ie(s.icon,Se,rt?yr:Ke),Fe.get($e).hidden=Ze),nt>=0&&(ie(s.icon,$.numVerticalIconVertices,Oe?yr:Ke),Fe.get(nt).hidden=Ze)}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const Ke=s.collisionArrays[se];if(Ke){let $e=new a.Point(0,0),nt=!0;if(Ke.textBox||Ke.verticalTextBox){if(z){const Ze=this.variableOffsets[de];Ze?($e=_c(Ze.anchor,Ze.width,Ze.height,Ze.textOffset,Ze.textScale),R&&$e._rotate(N?this.transform.angle:-this.transform.angle)):nt=!1}b&&(nt=!Ee.clipped),Ke.textBox&&ol(s.textCollisionBox.collisionVertexArray,Ee.text.placed,!nt||rt,$e.x,$e.y),Ke.verticalTextBox&&ol(s.textCollisionBox.collisionVertexArray,Ee.text.placed,!nt||Oe,$e.x,$e.y)}const Fe=nt&&!!(!Oe&&Ke.verticalIconBox);Ke.iconBox&&ol(s.iconCollisionBox.collisionVertexArray,Ee.icon.placed,Fe,Y?$e.x:0,Y?$e.y:0),Ke.verticalIconBox&&ol(s.iconCollisionBox.collisionVertexArray,Ee.icon.placed,!Fe,Y?$e.x:0,Y?$e.y:0)}}}if(s.fullyClipped=re===0,s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){const se=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=se.invProjMatrix,s.placementViewportMatrix=se.viewportMatrix,s.collisionCircleArray=se.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,u){const g=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*g>s}setStale(){this.stale=!0}}function ol(p,s,u,g,_){p.emplaceBack(s?1:0,u?1:0,g||0,_||0),p.emplaceBack(s?1:0,u?1:0,g||0,_||0),p.emplaceBack(s?1:0,u?1:0,g||0,_||0),p.emplaceBack(s?1:0,u?1:0,g||0,_||0)}const Oi=Math.pow(2,25),Tr=Math.pow(2,24),Zh=Math.pow(2,17),Xh=Math.pow(2,16),Bi=Math.pow(2,9),co=Math.pow(2,8),lg=Math.pow(2,1);function vc(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const s=p.placed?1:0,u=Math.floor(127*p.opacity);return u*Oi+s*Tr+u*Zh+s*Xh+u*Bi+s*co+u*lg+s}const yr=0;class bc{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&s.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(s,u,g,_,b){const T=this._bucketParts;for(;this._currentTileIndex<s.length;)if(u.getBucketParts(T,_,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort((C,A)=>C.sortKey-A.sortKey));this._currentPartIndex<T.length;){const C=T[this._currentPartIndex];if(u.placeLayerBucketPart(C,this._seenCrossTileIDs,g,C.symbolInstanceStart===0),this._currentPartIndex++,b())return!0}return!1}}class Kh{constructor(s,u,g,_,b,T,C,A){this.placement=new zu(s,b,T,C,A),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(s,u,g){const _=a.exported.now(),b=()=>{const T=a.exported.now()-_;return!this._forceFullPlacement&&T>2};for(;this._currentPlacementIndex>=0;){const T=u[s[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(T.type==="symbol"&&(!T.minzoom||T.minzoom<=C)&&(!T.maxzoom||T.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new bc(T)),this._inProgressLayer.continuePlacement(g[T.source],this.placement,this._showCollisionBoxes,T,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const Ea=512/a.EXTENT/2;class pi{constructor(s,u,g){this.tileID=s,this.bucketInstanceId=g,this.index=new a.KDBush(u.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const _=s.canonical.x*a.EXTENT,b=s.canonical.y*a.EXTENT;for(let T=0;T<u.length;T++){const{key:C,crossTileID:A,tileAnchorX:z,tileAnchorY:R}=u.get(T),N=Math.floor((_+z)*Ea),Y=Math.floor((b+R)*Ea);this.index.add(N,Y),this.keys.push(C),this.crossTileIDs.push(A)}this.index.finish()}findMatches(s,u,g){const _=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),b=Ea/Math.pow(2,u.canonical.z-this.tileID.canonical.z),T=u.canonical.x*a.EXTENT,C=u.canonical.y*a.EXTENT;for(let A=0;A<s.length;A++){const z=s.get(A);if(z.crossTileID)continue;const{key:R,tileAnchorX:N,tileAnchorY:Y}=z,te=Math.floor((T+N)*b),ie=Math.floor((C+Y)*b),re=this.index.range(te-_,ie-_,te+_,ie+_);for(const se of re){const $=this.crossTileIDs[se];if(this.keys[se]===R&&!g.has($)){g.add($),z.crossTileID=$;break}}}}}class Yh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Jh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const u=Math.round((s-this.lng)/360);if(u!==0)for(const g in this.indexes){const _=this.indexes[g],b={};for(const T in _){const C=_[T];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+u),b[C.tileID.key]=C}this.indexes[g]=b}this.lng=s}addBucket(s,u,g){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let b=0;b<u.symbolInstances.length;b++)u.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]=new Set);const _=this.usedCrossTileIDs[s.overscaledZ];for(const b in this.indexes){const T=this.indexes[b];if(Number(b)>s.overscaledZ)for(const C in T){const A=T[C];A.tileID.isChildOf(s)&&A.findMatches(u.symbolInstances,s,_)}else{const C=T[s.scaledTo(Number(b)).key];C&&C.findMatches(u.symbolInstances,s,_)}}for(let b=0;b<u.symbolInstances.length;b++){const T=u.symbolInstances.get(b);T.crossTileID||(T.crossTileID=g.generate(),_.add(T.crossTileID))}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new pi(s,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(s,u){for(const g of u.crossTileIDs)this.usedCrossTileIDs[s].delete(g)}removeStaleBuckets(s){let u=!1;for(const g in this.indexes){const _=this.indexes[g];for(const b in _)s[_[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,_[b]),delete _[b],u=!0)}return u}}class Ts{constructor(){this.layerIndexes={},this.crossTileIDs=new Yh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,u,g,_){let b=this.layerIndexes[s.id];b===void 0&&(b=this.layerIndexes[s.id]=new Jh);let T=!1;const C={};_.name!=="globe"&&b.handleWrapJump(g);for(const A of u){const z=A.getBucket(s);z&&s.id===z.layerIds[0]&&(z.bucketInstanceId||(z.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(A.tileID,z,this.crossTileIDs)&&(T=!0),C[z.bucketInstanceId]=!0)}return b.removeStaleBuckets(C)&&(T=!0),T}pruneUnusedLayers(s){const u={};s.forEach(g=>{u[g]=!0});for(const g in this.layerIndexes)u[g]||delete this.layerIndexes[g]}}const Qs=(p,s)=>a.emitValidationErrors(p,s&&s.filter(u=>u.identifier!=="source.canvas")),Lu=a.pick(In,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Qx=a.pick(In,["setCenter","setZoom","setBearing","setPitch"]),Qh={version:8,layers:[],sources:{}},sl={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Xo extends a.Evented{constructor(s,u={}){super(),this.map=s,this.dispatcher=new Ie(rl(),this),this.imageManager=new ft,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(s._requestManager,u.localFontFamily?a.LocalGlyphMode.all:u.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,u.localFontFamily||u.localIdeographFontFamily),this.crossTileSymbolIndex=new Ts,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const g=this;this._rtlTextPluginCallback=Xo.registerForPluginStateChange(_=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(b,T)=>{if(a.triggerPluginCompletionEvent(b),T&&T.every(C=>C))for(const C in g._sourceCaches){const A=g._sourceCaches[C],z=A.getSource().type;z!=="vector"&&z!=="geojson"||A.reload()}})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const b=this.getSource(_.sourceId);if(b&&b.vectorLayerIds)for(const T in this._layers){const C=this._layers[T];C.source===b.id&&this._validateLayer(C)}})}loadURL(s,u={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const g=typeof u.validate=="boolean"?u.validate:!a.isMapboxURL(s);s=this.map._requestManager.normalizeStyleURL(s,u.accessToken);const _=this.map._requestManager.transformRequest(s,a.ResourceType.Style);this._request=a.getJSON(_,(b,T)=>{this._request=null,b?this.fire(new a.ErrorEvent(b)):T&&this._load(T,g)})}loadJSON(s,u={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(s,u.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Qh,!1)}_updateLayerCount(s,u){const g=u?1:-1;s.is3D()&&(this._num3DLayers+=g),s.type==="circle"&&(this._numCircleLayers+=g),s.type==="symbol"&&(this._numSymbolLayers+=g)}_load(s,u){if(u&&Qs(this,a.validateStyle(s)))return;this._loaded=!0,this.stylesheet=a.clone$1(s),this._updateMapProjection();for(const _ in s.sources)this.addSource(_,s.sources[_],{validate:!1});this._changed=!1,s.sprite?this._loadSprite(s.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(s.glyphs);const g=rg(this.stylesheet.layers);this._order=g.map(_=>_.id),this._layers={},this._serializedLayers={};for(const _ of g){const b=a.createStyleLayer(_);b.setEventedParent(this,{layer:{id:b.id}}),this._layers[b.id]=b,this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new et(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(s){s?this.stylesheet.projection=s:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(s){this._spriteRequest=function(u,g,_){let b,T,C;const A=a.exported.devicePixelRatio>1?"@2x":"";let z=a.getJSON(g.transformRequest(g.normalizeSpriteURL(u,A,".json"),a.ResourceType.SpriteJSON),(Y,te)=>{z=null,C||(C=Y,b=te,N())}),R=a.getImage(g.transformRequest(g.normalizeSpriteURL(u,A,".png"),a.ResourceType.SpriteImage),(Y,te)=>{R=null,C||(C=Y,T=te,N())});function N(){if(C)_(C);else if(b&&T){const Y=a.exported.getImageData(T),te={};for(const ie in b){const{width:re,height:se,x:$,y:ee,sdf:ue,pixelRatio:de,stretchX:Se,stretchY:Te,content:Ee}=b[ie],Pe=new a.RGBAImage({width:re,height:se});a.RGBAImage.copy(Y,Pe,{x:$,y:ee},{x:0,y:0},{width:re,height:se}),te[ie]={data:Pe,pixelRatio:de,sdf:ue,stretchX:Se,stretchY:Te,content:Ee}}_(null,te)}}return{cancel(){z&&(z.cancel(),z=null),R&&(R.cancel(),R=null)}}}(s,this.map._requestManager,(u,g)=>{if(this._spriteRequest=null,u)this.fire(new a.ErrorEvent(u));else if(g)for(const _ in g)this.imageManager.addImage(_,g[_]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(s){const u=this.getSource(s.source);if(!u)return;const g=s.sourceLayer;g&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(g)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${g}" does not exist on source "${u.id}" as specified by style layer "${s.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const s in this._sourceCaches)if(!this._sourceCaches[s].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(s){const u=[];for(const g of s){const _=this._layers[g];_.type!=="custom"&&u.push(_.serialize())}return u}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const s in this._sourceCaches)if(this._sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(s){return!!this.terrain&&(typeof s.isLayerDraped=="function"?s.isLayerDraped():sl[s.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(s){if(!this._loaded)return;const u=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(_.length||b.length)&&this._updateWorkerLayers(_,b);for(const T in this._updatedSources){const C=this._updatedSources[T];C==="reload"?this._reloadSource(T):C==="clear"&&this._clearSource(T)}this._updateTilesForChangedImages();for(const T in this._updatedPaintProps)this._layers[T].updateTransitions(s);this.light.updateTransitions(s),this.fog&&this.fog.updateTransitions(s),this._resetUpdates()}const g={};for(const _ in this._sourceCaches){const b=this._sourceCaches[_];g[_]=b.used,b.used=!1}for(const _ of this._order){const b=this._layers[_];if(b.recalculate(s,this._availableImages),!b.isHidden(s.zoom)){const C=this._getLayerSourceCache(b);C&&(C.used=!0)}const T=this.map.painter;if(T){const C=b.getProgramIds();if(!C)continue;const A=b.getProgramConfiguration(s.zoom);for(const z of C)T.useProgram(z,A)}}for(const _ in g){const b=this._sourceCaches[_];g[_]!==b.used&&b.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:b.getSource().id}))}this.light.recalculate(s),this.terrain&&this.terrain.recalculate(s),this.fog&&this.fog.recalculate(s),this.z=s.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),u&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=Object.keys(this._changedImages);if(s.length){for(const u in this._sourceCaches)this._sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],s);this._changedImages={}}}_updateWorkerLayers(s,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(s),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(s){if(this._checkLoaded(),Qs(this,a.validateStyle(s)))return!1;(s=a.clone$1(s)).layers=rg(s.layers);const u=function(_,b){if(!_)return[{command:In.setStyle,args:[b]}];let T=[];try{if(!E(_.version,b.version))return[{command:In.setStyle,args:[b]}];E(_.center,b.center)||T.push({command:In.setCenter,args:[b.center]}),E(_.zoom,b.zoom)||T.push({command:In.setZoom,args:[b.zoom]}),E(_.bearing,b.bearing)||T.push({command:In.setBearing,args:[b.bearing]}),E(_.pitch,b.pitch)||T.push({command:In.setPitch,args:[b.pitch]}),E(_.sprite,b.sprite)||T.push({command:In.setSprite,args:[b.sprite]}),E(_.glyphs,b.glyphs)||T.push({command:In.setGlyphs,args:[b.glyphs]}),E(_.transition,b.transition)||T.push({command:In.setTransition,args:[b.transition]}),E(_.light,b.light)||T.push({command:In.setLight,args:[b.light]}),E(_.fog,b.fog)||T.push({command:In.setFog,args:[b.fog]}),E(_.projection,b.projection)||T.push({command:In.setProjection,args:[b.projection]});const C={},A=[];(function(N,Y,te,ie){let re;for(re in Y=Y||{},N=N||{})N.hasOwnProperty(re)&&(Y.hasOwnProperty(re)||pc(re,te,ie));for(re in Y){if(!Y.hasOwnProperty(re))continue;const se=Y[re];N.hasOwnProperty(re)?E(N[re],se)||(N[re].type==="geojson"&&se.type==="geojson"&&Ru(N,Y,re)?te.push({command:In.setGeoJSONSourceData,args:[re,se.data]}):Vh(re,Y,te,ie)):Uh(re,Y,te)}})(_.sources,b.sources,A,C);const z=[];_.layers&&_.layers.forEach(N=>{N.source&&C[N.source]?T.push({command:In.removeLayer,args:[N.id]}):z.push(N)});let R=_.terrain;R&&C[R.source]&&(T.push({command:In.setTerrain,args:[void 0]}),R=void 0),T=T.concat(A),E(R,b.terrain)||T.push({command:In.setTerrain,args:[b.terrain]}),function(N,Y,te){Y=Y||[];const ie=(N=N||[]).map(bs),re=Y.map(bs),se=N.reduce(Wh,{}),$=Y.reduce(Wh,{}),ee=ie.slice(),ue=Object.create(null);let de,Se,Te,Ee,Pe,Me,je;for(de=0,Se=0;de<ie.length;de++)Te=ie[de],$.hasOwnProperty(Te)?Se++:(te.push({command:In.removeLayer,args:[Te]}),ee.splice(ee.indexOf(Te,Se),1));for(de=0,Se=0;de<re.length;de++)Te=re[re.length-1-de],ee[ee.length-1-de]!==Te&&(se.hasOwnProperty(Te)?(te.push({command:In.removeLayer,args:[Te]}),ee.splice(ee.lastIndexOf(Te,ee.length-Se),1)):Se++,Me=ee[ee.length-de],te.push({command:In.addLayer,args:[$[Te],Me]}),ee.splice(ee.length-de,0,Te),ue[Te]=!0);for(de=0;de<re.length;de++)if(Te=re[de],Ee=se[Te],Pe=$[Te],!ue[Te]&&!E(Ee,Pe))if(E(Ee.source,Pe.source)&&E(Ee["source-layer"],Pe["source-layer"])&&E(Ee.type,Pe.type)){for(je in Ho(Ee.layout,Pe.layout,te,Te,null,In.setLayoutProperty),Ho(Ee.paint,Pe.paint,te,Te,null,In.setPaintProperty),E(Ee.filter,Pe.filter)||te.push({command:In.setFilter,args:[Te,Pe.filter]}),E(Ee.minzoom,Pe.minzoom)&&E(Ee.maxzoom,Pe.maxzoom)||te.push({command:In.setLayerZoomRange,args:[Te,Pe.minzoom,Pe.maxzoom]}),Ee)Ee.hasOwnProperty(je)&&je!=="layout"&&je!=="paint"&&je!=="filter"&&je!=="metadata"&&je!=="minzoom"&&je!=="maxzoom"&&(je.indexOf("paint.")===0?Ho(Ee[je],Pe[je],te,Te,je.slice(6),In.setPaintProperty):E(Ee[je],Pe[je])||te.push({command:In.setLayerProperty,args:[Te,je,Pe[je]]}));for(je in Pe)Pe.hasOwnProperty(je)&&!Ee.hasOwnProperty(je)&&je!=="layout"&&je!=="paint"&&je!=="filter"&&je!=="metadata"&&je!=="minzoom"&&je!=="maxzoom"&&(je.indexOf("paint.")===0?Ho(Ee[je],Pe[je],te,Te,je.slice(6),In.setPaintProperty):E(Ee[je],Pe[je])||te.push({command:In.setLayerProperty,args:[Te,je,Pe[je]]}))}else te.push({command:In.removeLayer,args:[Te]}),Me=ee[ee.lastIndexOf(Te)+1],te.push({command:In.addLayer,args:[Pe,Me]})}(z,b.layers,T)}catch(C){console.warn("Unable to compute style diff:",C),T=[{command:In.setStyle,args:[b]}]}return T}(this.serialize(),s).filter(_=>!(_.command in Qx));if(u.length===0)return!1;const g=u.filter(_=>!(_.command in Lu));if(g.length>0)throw new Error(`Unimplemented: ${g.map(_=>_.command).join(", ")}.`);return u.forEach(_=>{_.command!=="setTransition"&&_.command!=="setProjection"&&this[_.command].apply(this,_.args)}),this.stylesheet=s,this._updateMapProjection(),!0}addImage(s,u){return this.getImage(s)?this.fire(new a.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(s,u),this._afterImageUpdated(s),this)}updateImage(s,u){this.imageManager.updateImage(s,u)}getImage(s){return this.imageManager.getImage(s)}removeImage(s){return this.getImage(s)?(this.imageManager.removeImage(s),this._afterImageUpdated(s),this):this.fire(new a.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(),this._changedImages[s]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(s,u,g={}){if(this._checkLoaded(),this.getSource(s)!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(a.validateSource,`sources.${s}`,u,null,g))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const _=an(s,u,this.dispatcher,this);_.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(s),source:_.serialize(),sourceId:s}));const b=T=>{const C=(T?"symbol:":"other:")+s,A=this._sourceCaches[C]=new a.SourceCache(C,_,T);(T?this._symbolSourceCaches:this._otherSourceCaches)[s]=A,A.style=this,A.onAdd(this.map)};b(!1),u.type!=="vector"&&u.type!=="geojson"||b(!0),_.onAdd&&_.onAdd(this.map),this._changed=!0}removeSource(s){this._checkLoaded();const u=this.getSource(s);if(!u)throw new Error("There is no source with this ID");for(const _ in this._layers)if(this._layers[_].source===s)return this.fire(new a.ErrorEvent(new Error(`Source "${s}" cannot be removed while layer "${_}" is using it.`)));if(this.terrain&&this.terrain.get().source===s)return this.fire(new a.ErrorEvent(new Error(`Source "${s}" cannot be removed while terrain is using it.`)));const g=this._getSourceCaches(s);for(const _ of g)delete this._sourceCaches[_.id],delete this._updatedSources[_.id],_.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:_.getSource().id})),_.setEventedParent(null),_.clearTiles();return delete this._otherSourceCaches[s],delete this._symbolSourceCaches[s],u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(s,u){this._checkLoaded(),this.getSource(s).setData(u),this._changed=!0}getSource(s){const u=this._getSourceCache(s);return u&&u.getSource()}_getSources(){const s=[];for(const u in this._otherSourceCaches){const g=this._getSourceCache(u);g&&s.push(g.getSource())}return s}addLayer(s,u,g={}){this._checkLoaded();const _=s.id;if(this.getLayer(_))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${_}" already exists on this map`)));let b;if(s.type==="custom"){if(Qs(this,a.validateCustomStyleLayer(s)))return;b=a.createStyleLayer(s)}else{if(typeof s.source=="object"&&(this.addSource(_,s.source),s=a.clone$1(s),s=a.extend(s,{source:_})),this._validate(a.validateLayer,`layers.${_}`,s,{arrayIndex:-1},g))return;b=a.createStyleLayer(s),this._validateLayer(b),b.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0)}const T=u?this._order.indexOf(u):this._order.length;if(u&&T===-1)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`)));this._order.splice(T,0,_),this._layerOrderChanged=!0,this._layers[_]=b;const C=this._getLayerSourceCache(b);if(this._removedLayers[_]&&b.source&&C&&b.type!=="custom"){const A=this._removedLayers[_];delete this._removedLayers[_],A.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",C.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(s,u){if(this._checkLoaded(),this._changed=!0,!this._layers[s])return void this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be moved.`)));if(s===u)return;const g=this._order.indexOf(s);this._order.splice(g,1);const _=u?this._order.indexOf(u):this._order.length;u&&_===-1?this.fire(new a.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`))):(this._order.splice(_,0,s),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(s){this._checkLoaded();const u=this._layers[s];if(!u)return void this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be removed.`)));u.setEventedParent(null),this._updateLayerCount(u,!1);const g=this._order.indexOf(s);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[s]=u,delete this._layers[s],delete this._serializedLayers[s],delete this._updatedLayers[s],delete this._updatedPaintProps[s],u.onRemove&&u.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(s){return this._layers[s]}hasLayer(s){return s in this._layers}hasLayerType(s){for(const u in this._layers)if(this._layers[u].type===s)return!0;return!1}setLayerZoomRange(s,u,g){this._checkLoaded();const _=this.getLayer(s);_?_.minzoom===u&&_.maxzoom===g||(u!=null&&(_.minzoom=u),g!=null&&(_.maxzoom=g),this._updateLayer(_)):this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(s,u,g={}){this._checkLoaded();const _=this.getLayer(s);if(_){if(!E(_.filter,u))return u==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(a.validateFilter,`layers.${_.id}.filter`,u,{layerType:_.type},g)||(_.filter=a.clone$1(u),this._updateLayer(_)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be filtered.`)))}getFilter(s){const u=this.getLayer(s);return u&&a.clone$1(u.filter)}setLayoutProperty(s,u,g,_={}){this._checkLoaded();const b=this.getLayer(s);b?E(b.getLayoutProperty(u),g)||(b.setLayoutProperty(u,g,_),this._updateLayer(b)):this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(s,u){const g=this.getLayer(s);if(g)return g.getLayoutProperty(u);this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style.`)))}setPaintProperty(s,u,g,_={}){this._checkLoaded();const b=this.getLayer(s);b?E(b.getPaintProperty(u),g)||(b.setPaintProperty(u,g,_)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[s]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(s,u){const g=this.getLayer(s);return g&&g.getPaintProperty(u)}setFeatureState(s,u){this._checkLoaded();const g=s.source,_=s.sourceLayer,b=this.getSource(g);if(!b)return void this.fire(new a.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const T=b.type;if(T==="geojson"&&_)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(T==="vector"&&!_)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));s.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const C=this._getSourceCaches(g);for(const A of C)A.setFeatureState(_,s.id,u)}removeFeatureState(s,u){this._checkLoaded();const g=s.source,_=this.getSource(g);if(!_)return void this.fire(new a.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const b=_.type,T=b==="vector"?s.sourceLayer:void 0;if(b==="vector"&&!T)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof s.id!="string"&&typeof s.id!="number")return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const C=this._getSourceCaches(g);for(const A of C)A.removeFeatureState(T,s.id,u)}getFeatureState(s){this._checkLoaded();const u=s.source,g=s.sourceLayer,_=this.getSource(u);if(_){if(_.type!=="vector"||g)return s.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(u)[0].getFeatureState(g,s.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const s={};for(const u in this._sourceCaches){const g=this._sourceCaches[u].getSource();s[g.id]||(s[g.id]=g.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:s,layers:this._serializeLayers(this._order)},u=>u!==void 0)}_updateLayer(s){this._updatedLayers[s.id]=!0;const u=this._getLayerSourceCache(s);s.source&&!this._updatedSources[s.source]&&u&&u.getSource().type!=="raster"&&(this._updatedSources[s.source]="reload",u.pause()),this._changed=!0,s.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(s){const u=T=>this._layers[T].type==="fill-extrusion",g={},_=[];for(let T=this._order.length-1;T>=0;T--){const C=this._order[T];if(u(C)){g[C]=T;for(const A of s){const z=A[C];if(z)for(const R of z)_.push(R)}}}_.sort((T,C)=>C.intersectionZ-T.intersectionZ);const b=[];for(let T=this._order.length-1;T>=0;T--){const C=this._order[T];if(u(C))for(let A=_.length-1;A>=0;A--){const z=_[A].feature;if(g[z.layer.id]<T)break;b.push(z),_.pop()}else for(const A of s){const z=A[C];if(z)for(const R of z)b.push(R.feature)}}return b}queryRenderedFeatures(s,u,g){u&&u.filter&&this._validate(a.validateFilter,"queryRenderedFeatures.filter",u.filter,null,u);const _={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const A of u.layers){const z=this._layers[A];if(!z)return this.fire(new a.ErrorEvent(new Error(`The layer '${A}' does not exist in the map's style and cannot be queried for features.`))),[];_[z.source]=!0}}const b=[];u.availableImages=this._availableImages;const T=u&&u.layers?u.layers.some(A=>{const z=this.getLayer(A);return z&&z.is3D()}):this.has3DLayers(),C=Tt.createFromScreenPoints(s,g);for(const A in this._sourceCaches){const z=this._sourceCaches[A].getSource().id;u.layers&&!_[z]||b.push(ur(this._sourceCaches[A],this._layers,this._serializedLayers,C,u,g,T,!!this.map._showQueryGeometry))}return this.placement&&b.push(function(A,z,R,N,Y,te,ie){const re={},se=te.queryRenderedSymbols(N),$=[];for(const ee of Object.keys(se).map(Number))$.push(ie[ee]);$.sort(xi);for(const ee of $){const ue=ee.featureIndex.lookupSymbolFeatures(se[ee.bucketInstanceId],z,ee.bucketIndex,ee.sourceLayerIndex,Y.filter,Y.layers,Y.availableImages,A);for(const de in ue){const Se=re[de]=re[de]||[],Te=ue[de];Te.sort((Ee,Pe)=>{const Me=ee.featureSortOrder;if(Me){const je=Me.indexOf(Ee.featureIndex);return Me.indexOf(Pe.featureIndex)-je}return Pe.featureIndex-Ee.featureIndex});for(const Ee of Te)Se.push(Ee)}}for(const ee in re)re[ee].forEach(ue=>{const de=ue.feature,Se=R(A[ee]);if(!Se)return;const Te=Se.getFeatureState(de.layer["source-layer"],de.id);de.source=de.layer.source,de.layer["source-layer"]&&(de.sourceLayer=de.layer["source-layer"]),de.state=Te});return re}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),C.screenGeometry,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(s,u){u&&u.filter&&this._validate(a.validateFilter,"querySourceFeatures.filter",u.filter,null,u);const g=this._getSourceCaches(s);let _=[];for(const b of g)_=_.concat(Rr(b,u));return _}addSourceType(s,u,g){return Xo.getSourceType(s)?g(new Error(`A source type called "${s}" already exists.`)):(Xo.setSourceType(s,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:u.workerSourceURL},g):g(null,null))}getLight(){return this.light.getLight()}setLight(s,u={}){this._checkLoaded();const g=this.light.getLight();let _=!1;for(const T in s)if(!E(s[T],g[T])){_=!0;break}if(!_)return;const b=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(s,u),this.light.updateTransitions(b)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(s,u=1){if(this._checkLoaded(),!s)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let g=s;if(u===1){if(typeof g.source=="object"){const _="terrain-dem-src";this.addSource(_,g.source),g=a.clone$1(g),g=a.extend(g,{source:_})}if(this._validate(a.validateTerrain,"terrain",g))return}if(!this.terrain||this.terrain&&u!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,u)}else{const _=this.terrain,b=_.get();for(const T of Object.keys(a.spec.terrain))!g.hasOwnProperty(T)&&a.spec.terrain[T].default&&(g[T]=a.spec.terrain[T].default);for(const T in g)if(!E(g[T],b[T])){_.set(g),this.stylesheet.terrain=g;const C=this._setTransitionParameters({duration:0});_.updateTransitions(C);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(s){const u=this.fog=new ct(s,this.map.transform);this.stylesheet.fog=s;const g=this._setTransitionParameters({duration:0});u.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const s of this.map._markers)s._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(s){if(this._checkLoaded(),!s)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog,g=u.get();Object.keys(s).length===0&&u.set(s);for(const _ in s)if(!E(s[_],g[_])){u.set(s),this.stylesheet.fog=s;const b=this._setTransitionParameters({duration:0});u.updateTransitions(b);break}}else this._createFog(s);this._markersNeedUpdate=!0}_setTransitionParameters(s){return{now:a.exported.now(),transition:a.extend(s,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const s=this._order.filter(g=>this.isLayerDraped(this._layers[g])),u=this._order.filter(g=>!this.isLayerDraped(this._layers[g]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...s),this._drapedFirstOrder.push(...u)}_createTerrain(s,u){const g=this.terrain=new gt(s,u);this.stylesheet.terrain=s,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const _=this._setTransitionParameters({duration:0});g.updateTransitions(_)}_force3DLayerUpdate(){for(const s in this._layers){const u=this._layers[s];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const s in this._layers){const u=this._layers[s];u.type==="symbol"&&this._updateLayer(u)}}_validate(s,u,g,_,b={}){return(!b||b.validate!==!1)&&Qs(this,s.call(a.validateStyle,a.extend({key:u,style:this.serialize(),value:g,styleSpec:a.spec},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this._sourceCaches)this._sourceCaches[s].clearTiles(),this._sourceCaches[s].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(s){const u=this._getSourceCaches(s);for(const g of u)g.clearTiles()}_reloadSource(s){const u=this._getSourceCaches(s);for(const g of u)g.resume(),g.reload()}_reloadSources(){for(const s of this._getSources())s.reload&&s.reload()}_updateSources(s){for(const u in this._sourceCaches)this._sourceCaches[u].update(s)}_generateCollisionBoxes(){for(const s in this._sourceCaches){const u=this._sourceCaches[s];u.resume(),u.reload()}}_updatePlacement(s,u,g,_,b=!1){let T=!1,C=!1;const A={};for(const z of this._order){const R=this._layers[z];if(R.type!=="symbol")continue;if(!A[R.source]){const Y=this._getLayerSourceCache(R);if(!Y)continue;A[R.source]=Y.getRenderableIds(!0).map(te=>Y.getTileByID(te)).sort((te,ie)=>ie.tileID.overscaledZ-te.tileID.overscaledZ||(te.tileID.isLessThan(ie.tileID)?-1:1))}const N=this.crossTileSymbolIndex.addLayer(R,A[R.source],s.center.lng,s.projection);T=T||N}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),b=b||this._layerOrderChanged||g===0,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(b||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),s.zoom))&&(this.pauseablePlacement=new Kh(s,this._order,b,u,g,_,this.placement,this.fog&&s.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,A),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),C=!0),T&&this.pauseablePlacement.placement.setStale()),C||T)for(const z of this._order){const R=this._layers[z];R.type==="symbol"&&this.placement.updateLayerOpacities(R,A[R.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const s in this._sourceCaches)this._sourceCaches[s].releaseSymbolFadeTiles()}getImages(s,u,g){this.imageManager.getImages(u.icons,g),this._updateTilesForChangedImages();const _=b=>{b&&b.setDependencies(u.tileID.key,u.type,u.icons)};_(this._otherSourceCaches[u.source]),_(this._symbolSourceCaches[u.source])}getGlyphs(s,u,g){this.glyphManager.getGlyphs(u.stacks,g)}getResource(s,u,g){return a.makeRequest(u,g)}_getSourceCache(s){return this._otherSourceCaches[s]}_getLayerSourceCache(s){return s.type==="symbol"?this._symbolSourceCaches[s.source]:this._otherSourceCaches[s.source]}_getSourceCaches(s){const u=[];return this._otherSourceCaches[s]&&u.push(this._otherSourceCaches[s]),this._symbolSourceCaches[s]&&u.push(this._symbolSourceCaches[s]),u}_isSourceCacheLoaded(s){const u=this._getSourceCaches(s);return u.length===0?(this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${s}'`))),!1):u.every(g=>g.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Xo.getSourceType=function(p){return nn[p]},Xo.setSourceType=function(p,s){nn[p]=s},Xo.registerForPluginStateChange=a.registerForPluginStateChange;var ep=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Ta="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Cs=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,wc=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,ks=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Du={},al={};const Sc=[];ll(ep,Sc),ll(Cs,Sc),ll(wc,Sc),ll(ks,Sc),Du=An("",Cs),al=An(ks,wc);const cg=An(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Ou=ep,tp=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var np={background:An(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:An(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:An(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:An("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:An(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:An(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:An("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:An("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:An("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:An(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:An(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:An(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:An(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:An(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:An(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:An(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:An(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:An(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:An(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:An(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:An(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:An(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:An(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:An(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:An(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:An(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ta),skyboxGradient:An(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ta),skyboxCapture:An(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:An(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:An(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function ll(p,s){const u=p.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of u)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const _=g.split(" ");for(const b of _)s.includes(b)||s.push(b)}}function An(p,s){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=s.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),_={},b=[...Sc];return ll(p,b),ll(s,b),{fragmentSource:p=p.replace(u,(T,C,A,z,R)=>(_[R]=!0,C==="define"?`
#ifndef HAS_UNIFORM_u_${R}
varying ${A} ${z} ${R};
#else
uniform ${A} ${z} u_${R};
#endif
`:`
#ifdef HAS_UNIFORM_u_${R}
    ${A} ${z} ${R} = u_${R};
#endif
`)),vertexSource:s=s.replace(u,(T,C,A,z,R)=>{const N=z==="float"?"vec2":"vec4",Y=R.match(/color/)?"color":N;return _[R]?C==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${A} ${N} a_${R};
varying ${A} ${z} ${R};
#else
uniform ${A} ${z} u_${R};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = a_${R};
#else
    ${A} ${z} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = unpack_mix_${Y}(a_${R}, u_${R}_t);
#else
    ${A} ${z} ${R} = u_${R};
#endif
`:C==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${A} ${N} a_${R};
#else
uniform ${A} ${z} u_${R};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${A} ${z} ${R} = a_${R};
#else
    ${A} ${z} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${A} ${z} ${R} = unpack_mix_${Y}(a_${R}, u_${R}_t);
#else
    ${A} ${z} ${R} = u_${R};
#endif
`}),staticAttributes:g,usedDefines:b}}class ev{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(s,u,g,_,b,T,C){this.context=s;let A=this.boundPaintVertexBuffers.length!==_.length;for(let R=0;!A&&R<_.length;R++)this.boundPaintVertexBuffers[R]!==_[R]&&(A=!0);let z=this.boundDynamicVertexBuffers.length!==C.length;for(let R=0;!z&&R<C.length;R++)this.boundDynamicVertexBuffers[R]!==C[R]&&(z=!0);if(!s.extVertexArrayObject||!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==g||A||z||this.boundIndexBuffer!==b||this.boundVertexOffset!==T)this.freshBind(u,g,_,b,T,C);else{s.bindVertexArrayOES.set(this.vao);for(const R of C)R&&R.bind();b&&b.dynamicDraw&&b.bind()}}freshBind(s,u,g,_,b,T){let C;const A=s.numAttributes,z=this.context,R=z.gl;if(z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=z.extVertexArrayObject.createVertexArrayOES(),z.bindVertexArrayOES.set(this.vao),C=0,this.boundProgram=s,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=_,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=T;else{C=z.currentNumAttributes||0;for(let N=A;N<C;N++)R.disableVertexAttribArray(N)}u.enableAttributes(R,s),u.bind(),u.setVertexAttribPointers(R,s,b);for(const N of g)N.enableAttributes(R,s),N.bind(),N.setVertexAttribPointers(R,s,b);for(const N of T)N&&(N.enableAttributes(R,s),N.bind(),N.setVertexAttribPointers(R,s,b));_&&_.bind(),z.currentNumAttributes=A}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function rp(p,s){const u=Math.pow(2,s.canonical.z),g=s.canonical.y;return[new a.MercatorCoordinate(0,g/u).toLngLat().lat,new a.MercatorCoordinate(0,(g+1)/u).toLngLat().lat]}function ug(p,s,u,g,_,b,T){const C=p.context,A=C.gl,z=u.fbo;if(!z)return;p.prepareDrawTile();const R=p.useProgram("hillshade");C.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,z.colorAttachment.get());const N=((re,se,$,ee)=>{const ue=$.paint.get("hillshade-shadow-color"),de=$.paint.get("hillshade-highlight-color"),Se=$.paint.get("hillshade-accent-color");let Te=$.paint.get("hillshade-illumination-direction")*(Math.PI/180);$.paint.get("hillshade-illumination-anchor")==="viewport"&&(Te-=re.transform.angle);const Ee=!re.options.moving;return{u_matrix:ee||re.transform.calculateProjMatrix(se.tileID.toUnwrapped(),Ee),u_image:0,u_latrange:rp(0,se.tileID),u_light:[$.paint.get("hillshade-exaggeration"),Te],u_shadow:ue,u_highlight:de,u_accent:Se}})(p,u,g,p.terrain?s.projMatrix:null);p.prepareDrawProgram(C,R,s.toUnwrapped());const{tileBoundsBuffer:Y,tileBoundsIndexBuffer:te,tileBoundsSegments:ie}=p.getTileBoundsBuffers(u);R.draw(C,A.TRIANGLES,_,b,T,a.CullFaceMode.disabled,N,g.id,Y,te,ie)}function ip(p,s,u){if(!s.needsDEMTextureUpload)return;const g=p.context,_=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||p.getTileTexture(u.stride);const b=u.getPixels();s.demTexture?s.demTexture.update(b,{premultiply:!1}):s.demTexture=new a.Texture(g,b,_.RGBA,{premultiply:!1}),s.needsDEMTextureUpload=!1}function dg(p,s,u,g,_,b){const T=p.context,C=T.gl;if(!s.dem)return;const A=s.dem;if(T.activeTexture.set(C.TEXTURE1),ip(p,s,A),!s.demTexture)return;s.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);const z=A.dim;T.activeTexture.set(C.TEXTURE0);let R=s.fbo;if(!R){const ie=new a.Texture(T,{width:z,height:z,data:null},C.RGBA);ie.bind(C.LINEAR,C.CLAMP_TO_EDGE),R=s.fbo=T.createFramebuffer(z,z,!0),R.colorAttachment.set(ie.texture)}T.bindFramebuffer.set(R.framebuffer),T.viewport.set([0,0,z,z]);const{tileBoundsBuffer:N,tileBoundsIndexBuffer:Y,tileBoundsSegments:te}=p.getMercatorTileBoundsBuffers();p.useProgram("hillshadePrepare").draw(T,C.TRIANGLES,g,_,b,a.CullFaceMode.disabled,((ie,re)=>{const se=re.stride,$=a.create();return a.ortho($,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate($,$,[0,-a.EXTENT,0]),{u_matrix:$,u_image:1,u_dimension:[se,se],u_zoom:ie.overscaledZ,u_unpack:re.unpackVector}})(s.tileID,A),u.id,N,Y,te),s.needsHillshadePrepare=!1}const op=p=>({u_matrix:new a.UniformMatrix4f(p),u_image0:new a.Uniform1i(p),u_skirt_height:new a.Uniform1f(p)}),cl=(p,s)=>({u_matrix:p,u_image0:0,u_skirt_height:s}),Bu=(p,s,u,g,_,b,T,C,A,z,R,N,Y,te,ie)=>({u_proj_matrix:Float32Array.from(p),u_globe_matrix:s,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:u,u_zoom_transition:_,u_merc_center:b,u_image0:0,u_frustum_tl:T,u_frustum_tr:C,u_frustum_br:A,u_frustum_bl:z,u_globe_pos:R,u_globe_radius:N,u_viewport:Y,u_grid_matrix:ie?Float32Array.from(ie):new Float32Array(9),u_skirt_height:te});function ul(p,s){return p!=null&&s!=null&&!(!p.hasData()||!s.hasData())&&p.demTexture!=null&&s.demTexture!=null&&p.tileID.key!==s.tileID.key}const Is=new class{constructor(){this.operations={}}newMorphing(p,s,u,g,_){if(p in this.operations){const b=this.operations[p];b.to.tileID.key!==u.tileID.key&&(b.queued=u)}else this.operations[p]={startTime:g,phase:0,duration:_,from:s,to:u,queued:null}}getMorphValuesForProxy(p){if(!(p in this.operations))return null;const s=this.operations[p];return{from:s.from,to:s.to,phase:s.phase}}update(p){for(const s in this.operations){const u=this.operations[s];for(u.phase=(p-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,p)){delete this.operations[s];break}}}_nextOp(p,s){return!!p.queued&&(p.from=p.to,p.to=p.queued,p.queued=null,p.phase=0,p.startTime=s,!0)}_validOp(p){return p.from.hasData()&&p.to.hasData()}},Ca={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Fu(p){return 6*Math.pow(1.5,22-p)}function hg(p,s){const u=1<<p.z;return!s&&(p.x===0||p.x===u-1)||p.y===0||p.y===u-1}const Ec=p=>({u_matrix:p});function sp(p,s,u,g,_){if(_>0){const b=a.exported.now(),T=(b-p.timeAdded)/_,C=s?(b-s.timeAdded)/_:-1,A=u.getSource(),z=g.coveringZoomLevel({tileSize:A.tileSize,roundZoom:A.roundZoom}),R=!s||Math.abs(s.tileID.overscaledZ-z)>Math.abs(p.tileID.overscaledZ-z),N=R&&p.refreshedUponExpiration?1:a.clamp(R?T:1-C,0,1);return p.refreshedUponExpiration&&T>=1&&(p.refreshedUponExpiration=!1),s?{opacity:1,mix:1-N}:{opacity:N,mix:0}}return{opacity:1,mix:0}}class ap extends a.SourceCache{constructor(s){const u={type:"raster-dem",maxzoom:s.transform.maxZoom},g=new Ie(rl(),null),_=an("mock-dem",u,g,s.style);super("mock-dem",_,!1),_.setEventedParent(this),this._sourceLoaded=!0}_loadTile(s,u){s.state="loaded",u(null)}}class ju extends a.SourceCache{constructor(s){const u=an("proxy",{type:"geojson",maxzoom:s.transform.maxZoom},new Ie(rl(),null),s.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=s,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(s,u,g){if(s.freezeTileCoverage)return;this.transform=s;const _=s.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,T)=>{if(b[T.key]="",!this._tiles[T.key]){const C=new a.Tile(T,this._source.tileSize*T.overscaleFactor(),s.tileZoom);C.state="loaded",this._tiles[T.key]=C}return b},{});for(const b in this._tiles)b in _||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(s){const u=this.proxyCachedFBO[s];if(u!==void 0){const g=Object.values(u);this.renderCachePool.push(...g),delete this.proxyCachedFBO[s]}}deallocRenderCache(){this.renderCache.forEach(s=>s.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Nu extends a.OverscaledTileID{constructor(s,u,g){super(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y),this.proxyTileKey=u,this.projMatrix=g}}class lp extends a.Elevation{constructor(s,u){super(),this.painter=s,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,_,b]=function(A){const z=new a.StructArrayLayout2i4,R=new a.StructArrayLayout3ui6,N=131;z.reserve(17161),R.reserve(33800);const Y=a.EXTENT/128,te=a.EXTENT+Y/2,ie=te+Y;for(let se=-Y;se<ie;se+=Y)for(let $=-Y;$<ie;$+=Y){const ee=$<0||$>te||se<0||se>te?24575:0,ue=a.clamp(Math.round($),0,a.EXTENT),de=a.clamp(Math.round(se),0,a.EXTENT);z.emplaceBack(ue+ee,de)}const re=(se,$)=>{const ee=$*N+se;R.emplaceBack(ee+1,ee,ee+N),R.emplaceBack(ee+N,ee+N+1,ee+1)};for(let se=1;se<129;se++)for(let $=1;$<129;$++)re($,se);return[0,129].forEach(se=>{for(let $=0;$<130;$++)re($,se),re(se,$)}),[z,R,32768]}(),T=s.context;this.gridBuffer=T.createVertexBuffer(g,a.posAttributes.members),this.gridIndexBuffer=T.createIndexBuffer(_),this.gridSegments=a.SegmentVector.simpleSegment(0,0,g.length,_.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,g.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ju(u.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.EXTENT,0,a.EXTENT,0,1);const C=T.gl;this._overlapStencilMode=new a.StencilMode({func:C.GEQUAL,mask:255},0,255,C.KEEP,C.KEEP,C.REPLACE),this._previousZoom=s.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ap(u.map)}set style(s){s.on("data",this._onStyleDataEvent.bind(this)),s.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=s,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(s,u,g){if(s&&s.terrain){this._style!==s&&(this.style=s),this.enabled=!0;const _=s.terrain.properties;this.sourceCache=s.terrain.drapeRenderMode===0?this._mockSourceCache:s._getSourceCache(_.get("source")),this._exaggeration=_.get("exaggeration");const b=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const T=this.getScaledDemTileSize();this.sourceCache.update(u,T,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,b(),this._initializing=!0),b(),u.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(s){this._findCoveringTileCache[s]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const s=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||s.efficiency!==100&&a.warnOnce(`Terrain render cache efficiency is not optimal (${s.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${s.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(s){s.coord&&s.dataType==="source"?this._clearRenderCacheForTile(s.sourceCacheId,s.coord):s.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const s in this._style._sourceCaches)this._style._sourceCaches[s].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(s=>s.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const s=2*this.proxySourceCache.getSource().tileSize;return[s,s]}set useVertexMorphing(s){this._useVertexMorphing=s}updateTileBinding(s){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const _=this.proxyCoords=u.getIds().map(A=>{const z=u.getTileByID(A).tileID;return z.projMatrix=g.calculateProjMatrix(z.toUnwrapped()),z});(function(A,z){const R=z.transform.pointCoordinate(z.transform.getCameraPoint()),N=new a.Point(R.x,R.y);A.sort((Y,te)=>{if(te.overscaledZ-Y.overscaledZ)return te.overscaledZ-Y.overscaledZ;const ie=new a.Point(Y.canonical.x+(1<<Y.canonical.z)*Y.wrap,Y.canonical.y),re=new a.Point(te.canonical.x+(1<<te.canonical.z)*te.wrap,te.canonical.y),se=N.mult(1<<Y.canonical.z);return se.x-=.5,se.y-=.5,se.distSqr(ie)-se.distSqr(re)})})(_,this.painter),this._previousZoom=g.zoom;const b=this.proxyToSource||{};this.proxyToSource={},_.forEach(A=>{this.proxyToSource[A.key]={}}),this.terrainTileForTile={};const T=this._style._sourceCaches;for(const A in T){const z=T[A];if(!z.used||(z!==this.sourceCache&&this.resetTileLookupCache(z.id),this._setupProxiedCoordsForOrtho(z,s[A],b),z.usedForTerrain))continue;const R=s[A];z.getSource().reparseOverscaled&&this._assignTerrainTiles(R)}this.proxiedCoords[u.id]=_.map(A=>new Nu(A,A.key,this.orthoMatrix)),this._assignTerrainTiles(_),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const C={};this._visibleDemTiles=[];for(const A of this.proxyCoords){const z=this.terrainTileForTile[A.key];if(!z)continue;const R=z.tileID.key;R in C||(this._visibleDemTiles.push(z),C[R]=R)}}_assignTerrainTiles(s){this._initializing||s.forEach(u=>{if(this.terrainTileForTile[u.key])return;const g=this._findTileCoveringTileID(u,this.sourceCache);g&&(this.terrainTileForTile[u.key]=g)})}_prepareDEMTextures(){const s=this.painter.context,u=s.gl;for(const g in this.terrainTileForTile){const _=this.terrainTileForTile[g],b=_.dem;!b||_.demTexture&&!_.needsDEMTextureUpload||(s.activeTexture.set(u.TEXTURE1),ip(this.painter,_,b))}}_prepareDemTileUniforms(s,u,g,_){if(!u||u.demTexture==null)return!1;const b=s.tileID.canonical,T=Math.pow(2,u.tileID.canonical.z-b.z),C=_||"";return g[`u_dem_tl${C}`]=[b.x*T%1,b.y*T%1],g[`u_dem_scale${C}`]=T,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const s=this.painter.context,u=s.gl;if(!this._emptyDepthBufferTexture){const g=new a.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.Texture(s,g,u.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let s=0;const u=this._visibleDemTiles.reduce((g,_)=>{if(!_.dem)return g;const b=_.dem.tree.minimums[0];return b>0&&s++,g+b},0);return s?u/s:0}_updateEmptyDEMTexture(){const s=this.painter.context,u=s.gl;s.activeTexture.set(u.TEXTURE2);const g=this._getLoadedAreaMinimum(),_=new a.RGBAImage({width:1,height:1},new Uint8Array(a.DEMData.pack(g,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(_,{premultiply:!1}):b=this._emptyDEMTexture=new a.Texture(s,_,u.RGBA,{premultiply:!1}),b}setupElevationDraw(s,u,g){const _=this.painter.context,b=_.gl,T=(C=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(C),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var C;T.u_dem_size=this.sourceCache.getSource().tileSize,T.u_exaggeration=this.exaggeration();let A=null,z=null,R=1;if(g&&g.morphing&&this._useVertexMorphing){const N=g.morphing.srcDemTile,Y=g.morphing.dstDemTile;R=g.morphing.phase,N&&Y&&(this._prepareDemTileUniforms(s,N,T,"_prev")&&(z=N),this._prepareDemTileUniforms(s,Y,T)&&(A=Y))}if(z&&A?(_.activeTexture.set(b.TEXTURE2),A.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),_.activeTexture.set(b.TEXTURE4),z.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),T.u_dem_lerp=R):(A=this.terrainTileForTile[s.tileID.key],_.activeTexture.set(b.TEXTURE2),(this._prepareDemTileUniforms(s,A,T)?A.demTexture:this.emptyDEMTexture).bind(b.NEAREST,b.CLAMP_TO_EDGE)),_.activeTexture.set(b.TEXTURE3),g&&g.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),this._depthFBO&&(T.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),T.u_depth_size_inv=[1,1]),g&&g.useMeterToDem&&A){const N=(1<<A.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;T.u_meter_to_dem=N}if(g&&g.labelPlaneMatrixInv&&(T.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),u.setTerrainUniformValues(_,T),this.painter.transform.projection.name==="globe"){const N=this.globeUniformValues(this.painter.transform,s.tileID.canonical,g&&g.useDenormalizedUpVectorScale);u.setGlobeUniformValues(_,N)}}globeUniformValues(s,u,g){const _=s.projection;return{u_tile_tl_up:_.upVector(u,0,0),u_tile_tr_up:_.upVector(u,a.EXTENT,0),u_tile_br_up:_.upVector(u,a.EXTENT,a.EXTENT),u_tile_bl_up:_.upVector(u,0,a.EXTENT),u_tile_up_scale:g?a.globeMetersToEcef(1):_.upVectorScale(u,s.center.lat,s.worldSize).metersToTile}}renderToBackBuffer(s){const u=this.painter,g=this.painter.context;s.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(_,b,T,C,A){if(_.transform.projection.name==="globe")(function(z,R,N,Y,te){const ie=z.context,re=ie.gl;let se,$;const ee=z.options.showTerrainWireframe?2:0,ue=z.transform,de=a.globeUseCustomAntiAliasing(z,ie,ue),Se=(nt,Fe)=>{if($===nt)return;const Ze=[Ca[nt],"PROJECTION_GLOBE_VIEW"];de&&Ze.push("CUSTOM_ANTIALIASING"),Fe&&Ze.push(Ca[ee]),se=z.useProgram("globeRaster",null,Ze),$=nt},Te=z.colorModeForRenderPass(),Ee=new a.DepthMode(re.LEQUAL,a.DepthMode.ReadWrite,z.depthRangeFor3D);Is.update(te);const Pe=a.calculateGlobeMercatorMatrix(ue),Me=[a.mercatorXfromLng(ue.center.lng),a.mercatorYfromLat(ue.center.lat)],je=ee?[!1,!0]:[!1],rt=z.globeSharedBuffers,Oe=[ue.width*a.exported.devicePixelRatio,ue.height*a.exported.devicePixelRatio],Ke=Float32Array.from(ue.globeMatrix),$e={useDenormalizedUpVectorScale:!0};if(je.forEach(nt=>{const Fe=z.transform,Ze=Fu(Fe.zoom)*R.exaggeration();$=-1;const ot=nt?re.LINES:re.TRIANGLES;for(const Qe of Y){const at=N.getTile(Qe),Ot=a.StencilMode.disabled,Ht=R.prevTerrainTileForTile[Qe.key],At=R.terrainTileForTile[Qe.key];ul(Ht,At)&&Is.newMorphing(Qe.key,Ht,At,te,250),ie.activeTexture.set(re.TEXTURE0),at.texture.bind(re.LINEAR,re.CLAMP_TO_EDGE);const Ut=Is.getMorphValuesForProxy(Qe.key),dn=Ut?1:0;Ut&&a.extend$1($e,{morphing:{srcDemTile:Ut.from,dstDemTile:Ut.to,phase:a.easeCubicInOut(Ut.phase)}});const ln=a.tileCornersToBounds(Qe.canonical),Lt=a.getLatitudinalLod(ln.getCenter().lat),Pn=a.getGridMatrix(Qe.canonical,ln,Lt,Fe.worldSize/Fe._pixelsPerMercatorPixel),Bn=a.globeNormalizeECEF(a.globeTileBounds(Qe.canonical)),Fn=Bu(Fe.projMatrix,Ke,Pe,Bn,a.globeToMercatorTransition(Fe.zoom),Me,Fe.frustumCorners.TL,Fe.frustumCorners.TR,Fe.frustumCorners.BR,Fe.frustumCorners.BL,Fe.globeCenterInViewSpace,Fe.globeRadius,Oe,Ze,Pn);if(Se(dn,nt),R.setupElevationDraw(at,se,$e),z.prepareDrawProgram(ie,se,Qe.toUnwrapped()),rt){const[jn,bi,ri]=nt?rt.getWirefameBuffers(z.context,Lt):rt.getGridBuffers(Lt,Ze!==0);se.draw(ie,ot,Ee,Ot,Te,a.CullFaceMode.backCCW,Fn,"globe_raster",jn,bi,ri)}}}),rt){const nt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];de&&nt.push("CUSTOM_ANTIALIASING"),se=z.useProgram("globeRaster",null,nt);for(const Fe of Y){const{x:Ze,y:ot,z:Qe}=Fe.canonical,at=ot===0,Ot=ot===(1<<Qe)-1,[Ht,At,Ut,dn]=rt.getPoleBuffers(Qe);if(dn&&(at||Ot)){const ln=N.getTile(Fe);ie.activeTexture.set(re.TEXTURE0),ln.texture.bind(re.LINEAR,re.CLAMP_TO_EDGE);let Lt=a.globePoleMatrixForTile(Qe,Ze,ue);const Pn=a.globeNormalizeECEF(a.globeTileBounds(Fe.canonical)),Bn=(Fn,jn)=>Fn.draw(ie,re.TRIANGLES,Ee,a.StencilMode.disabled,Te,a.CullFaceMode.disabled,Bu(ue.projMatrix,Lt,Lt,Pn,0,Me,ue.frustumCorners.TL,ue.frustumCorners.TR,ue.frustumCorners.BR,ue.frustumCorners.BL,ue.globeCenterInViewSpace,ue.globeRadius,Oe,0),"globe_pole_raster",jn,Ut,dn);R.setupElevationDraw(ln,se,$e),z.prepareDrawProgram(ie,se,Fe.toUnwrapped()),at&&Bn(se,Ht),Ot&&(Lt=a.scale(a.create(),Lt,[1,-1,1]),Bn(se,At))}}}})(_,b,T,C,A);else{const z=_.context,R=z.gl;let N,Y;const te=_.options.showTerrainWireframe?2:0,ie=(ue,de)=>{if(Y===ue)return;const Se=[Ca[ue]];de&&Se.push(Ca[te]),N=_.useProgram("terrainRaster",null,Se),Y=ue},re=_.colorModeForRenderPass(),se=new a.DepthMode(R.LEQUAL,a.DepthMode.ReadWrite,_.depthRangeFor3D);Is.update(A);const $=_.transform,ee=Fu($.zoom)*b.exaggeration();(te?[!1,!0]:[!1]).forEach(ue=>{Y=-1;const de=ue?R.LINES:R.TRIANGLES,[Se,Te]=ue?b.getWirefameBuffer():[b.gridIndexBuffer,b.gridSegments];for(const Ee of C){const Pe=T.getTile(Ee),Me=a.StencilMode.disabled,je=b.prevTerrainTileForTile[Ee.key],rt=b.terrainTileForTile[Ee.key];ul(je,rt)&&Is.newMorphing(Ee.key,je,rt,A,250),z.activeTexture.set(R.TEXTURE0),Pe.texture.bind(R.LINEAR,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST);const Oe=Is.getMorphValuesForProxy(Ee.key),Ke=Oe?1:0;let $e;Oe&&($e={morphing:{srcDemTile:Oe.from,dstDemTile:Oe.to,phase:a.easeCubicInOut(Oe.phase)}});const nt=cl(Ee.projMatrix,hg(Ee.canonical,$.renderWorldCopies)?ee/10:ee);ie(Ke,ue),b.setupElevationDraw(Pe,N,$e),_.prepareDrawProgram(z,N,Ee.toUnwrapped()),N.draw(z,de,se,Me,re,a.CullFaceMode.backCCW,nt,"terrain_raster",b.gridBuffer,Se,Te)}})}}(u,this,this.proxySourceCache,s,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),s.splice(0,s.length))}renderBatch(s){if(this._drapedRenderBatches.length===0)return s+1;this.renderingToTexture=!0;const u=this.painter,g=this.painter.context,_=this.proxySourceCache,b=this.proxiedCoords[_.id],T=this._drapedRenderBatches.shift(),C=[],A=u.style.order;let z=0;for(const R of b){const N=_.getTileByID(R.proxyTileKey),Y=_.proxyCachedFBO[R.key]?_.proxyCachedFBO[R.key][s]:void 0,te=Y!==void 0?_.renderCache[Y]:this.pool[z++],ie=Y!==void 0;if(N.texture=te.tex,ie&&!te.dirty){C.push(N.tileID);continue}let re;g.bindFramebuffer.set(te.fb.framebuffer),this.renderedToTile=!1,te.dirty&&(g.clear({color:a.Color.transparent,stencil:0}),te.dirty=!1);for(let se=T.start;se<=T.end;++se){const $=u.style._layers[A[se]];if($.isHidden(u.transform.zoom))continue;const ee=u.style._getLayerSourceCache($),ue=ee?this.proxyToSource[R.key][ee.id]:[R];if(!ue)continue;const de=ue;g.viewport.set([0,0,te.fb.width,te.fb.height]),re!==(ee?ee.id:null)&&(this._setupStencil(te,ue,$,ee),re=ee?ee.id:null),u.renderLayer(u,ee,$,de)}this.renderedToTile?(te.dirty=!0,C.push(N.tileID)):ie||--z,z===5&&(z=0,this.renderToBackBuffer(C))}return this.renderToBackBuffer(C),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),T.end+1}postRender(){}renderCacheEfficiency(s){const u=s.order.length;if(u===0)return{efficiency:100};let g,_=0,b=0,T=!1;for(let C=0;C<u;++C){const A=s._layers[s.order[C]];this._style.isLayerDraped(A)?(T&&++_,++b):T||(T=!0,g=A.id)}return b===0?{efficiency:100}:{efficiency:100*(1-_/b),firstUndrapedLayer:g}}getMinElevationBelowMSL(){let s=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{s=Math.min(s,u.dem.tree.minimums[0])}),s===0?s:(s-30)*this._exaggeration}raycast(s,u,g){if(!this._visibleDemTiles)return null;const _=this._visibleDemTiles.filter(b=>b.dem).map(b=>{const T=b.tileID,C=1<<T.overscaledZ,{x:A,y:z}=T.canonical,R=A/C,N=(A+1)/C,Y=z/C,te=(z+1)/C;return{minx:R,miny:Y,maxx:N,maxy:te,t:b.dem.tree.raycastRoot(R,Y,N,te,s,u,g),tile:b}});_.sort((b,T)=>(b.t!==null?b.t:Number.MAX_VALUE)-(T.t!==null?T.t:Number.MAX_VALUE));for(const b of _){if(b.t==null)return null;const T=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,s,u,g);if(T!=null)return T}return null}_createFBO(){const s=this.painter.context,u=s.gl,g=this.drapeBufferSize;s.activeTexture.set(u.TEXTURE0);const _=new a.Texture(s,{width:g[0],height:g[1],data:null},u.RGBA);_.bind(u.LINEAR,u.CLAMP_TO_EDGE);const b=s.createFramebuffer(g[0],g[1],!1);return b.colorAttachment.set(_.texture),b.depthAttachment=new Ce(s,b.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=s.createRenderbuffer(s.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),s.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),s.extTextureFilterAnisotropic&&!s.extTextureFilterAnisotropicForceOff&&u.texParameterf(u.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax),{fb:b,tex:_,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const s in this._style._sourceCaches)if(this._style._sourceCaches[s].hasTransition())return!0;return this._style.order.some(s=>{const u=this._style._layers[s],g=u.isHidden(this.painter.transform.zoom);return u.type==="custom"?!g&&u.shouldRedrape():!g&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let s=!1;for(const g of this._style._getSources())if(g instanceof mt){s=!0;break}if(!s)return;const u={};for(let g=0;g<this._style.order.length;++g){const _=this._style._layers[this._style.order[g]],b=this._style._getLayerSourceCache(_);if(b&&!u[b.id]&&!_.isHidden(this.painter.transform.zoom)&&_.type==="line"&&_.widthExpression()instanceof a.ZoomDependentExpression){u[b.id]=!0;for(const T of this.proxyCoords){const C=this.proxyToSource[T.key][b.id];if(C)for(const A of C)this._clearRenderCacheForTile(b.id,A)}}}}_clearRasterLayersFromRenderCache(){let s=!1;for(const g in this._style._sourceCaches)if(this._style._sourceCaches[g]._source instanceof ut){s=!0;break}if(!s)return;const u={};for(let g=0;g<this._style.order.length;++g){const _=this._style._layers[this._style.order[g]],b=this._style._getLayerSourceCache(_);if(!b||u[b.id]||_.isHidden(this.painter.transform.zoom)||_.type!=="raster")continue;const T=_.paint.get("raster-fade-duration");for(const C of this.proxyCoords){const A=this.proxyToSource[C.key][b.id];if(A)for(const z of A){const R=sp(b.getTile(z),b.findLoadedParent(z,0),b,this.painter.transform,T);(R.opacity!==1||R.mix!==0)&&this._clearRenderCacheForTile(b.id,z)}}}}_setupDrapedRenderBatches(){const s=this._style.order,u=s.length;if(u===0)return;const g=[];let _,b=0,T=this._style._layers[s[b]];for(;!this._style.isLayerDraped(T)&&T.isHidden(this.painter.transform.zoom)&&++b<u;)T=this._style._layers[s[b]];for(;b<u;++b){const C=this._style._layers[s[b]];C.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(C)?_===void 0&&(_=b):_!==void 0&&(g.push({start:_,end:b-1}),_=void 0))}_!==void 0&&g.push({start:_,end:b-1}),this._drapedRenderBatches=g}_setupRenderCache(s){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const T=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let C=0;C<T.length;++C){const A=Object.values(T[C]);u.renderCachePool.push(...A)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,_=this._tilesDirty;for(let T=g.length-1;T>=0;T--){const C=g[T];if(u.getTileByID(C.key),u.proxyCachedFBO[C.key]!==void 0){const A=s[C.key],z=this.proxyToSource[C.key];let R=0;for(const N in z){const Y=z[N],te=A[N];if(!te||te.length!==Y.length||Y.some((ie,re)=>ie!==te[re]||_[N]&&_[N].hasOwnProperty(ie.key))){R=-1;break}++R}for(const N in u.proxyCachedFBO[C.key])u.renderCache[u.proxyCachedFBO[C.key][N]].dirty=R<0||R!==Object.values(A).length}}const b=[...this._drapedRenderBatches];b.sort((T,C)=>C.end-C.start-(T.end-T.start));for(const T of b)for(const C of g){if(u.proxyCachedFBO[C.key])continue;let A=u.renderCachePool.pop();A===void 0&&u.renderCache.length<50&&(A=u.renderCache.length,u.renderCache.push(this._createFBO())),A!==void 0&&(u.proxyCachedFBO[C.key]={},u.proxyCachedFBO[C.key][T.start]=A,u.renderCache[A].dirty=!0)}this._tilesDirty={}}_setupStencil(s,u,g,_){if(!_||!this._sourceTilesOverlap[_.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const b=this.painter.context,T=b.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let C;if(g.isTileClipped())C=u.length,this._overlapStencilMode.test={func:T.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);C=1,this._overlapStencilMode.test={func:T.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+C>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=C,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(s){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[s.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(s,u){const g=this.painter,_=this.painter.context,b=_.gl;g._tileClippingMaskIDs={},_.setColorMode(a.ColorMode.disabled),_.setDepthMode(a.DepthMode.disabled);const T=g.useProgram("clippingMask");for(const C of s){const A=g._tileClippingMaskIDs[C.key]=--u;T.draw(_,b.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:b.ALWAYS,mask:0},A,255,b.KEEP,b.KEEP,b.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Ec(C.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(s){const u=this.painter.transform;if(s.x<0||s.x>u.width||s.y<0||s.y>u.height)return null;const g=[s.x,s.y,1,1];a.transformMat4$1(g,g,u.pixelMatrixInverse),a.scale$1(g,g,1/g[3]),g[0]/=u.worldSize,g[1]/=u.worldSize;const _=u._camera.position,b=a.mercatorZfromAltitude(1,u.center.lat),T=[_[0],_[1],_[2]/b,0],C=a.subtract([],g.slice(0,3),T);a.normalize(C,C);const A=this.raycast(T,C,this._exaggeration);return A!==null&&A?(a.scaleAndAdd(T,T,C,A),T[3]=T[2],T[2]*=b,T):null}drawDepth(){const s=this.painter,u=s.context,g=this.proxySourceCache,_=Math.ceil(s.width),b=Math.ceil(s.height);if(!this._depthFBO||this._depthFBO.width===_&&this._depthFBO.height===b||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const T=u.gl,C=u.createFramebuffer(_,b,!0);u.activeTexture.set(T.TEXTURE0);const A=new a.Texture(u,{width:_,height:b,data:null},T.RGBA);A.bind(T.NEAREST,T.CLAMP_TO_EDGE),C.colorAttachment.set(A.texture);const z=u.createRenderbuffer(u.gl.DEPTH_COMPONENT16,_,b);C.depthAttachment.set(z),this._depthFBO=C,this._depthTexture=A}u.bindFramebuffer.set(this._depthFBO.framebuffer),u.viewport.set([0,0,_,b]),function(T,C,A,z){if(T.transform.projection.name==="globe")return;const R=T.context,N=R.gl;R.clear({depth:1});const Y=T.useProgram("terrainDepth"),te=new a.DepthMode(N.LESS,a.DepthMode.ReadWrite,T.depthRangeFor3D);for(const ie of z){const re=A.getTile(ie),se=cl(ie.projMatrix,0);C.setupElevationDraw(re,Y),Y.draw(R,N.TRIANGLES,te,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,se,"terrain_depth",C.gridBuffer,C.gridIndexBuffer,C.gridNoSkirtSegments)}}(s,this,g,this.proxyCoords)}_setupProxiedCoordsForOrtho(s,u,g){if(s.getSource()instanceof sn)return this._setupProxiedCoordsForImageSource(s,u,g);this._findCoveringTileCache[s.id]=this._findCoveringTileCache[s.id]||{};const _=this.proxiedCoords[s.id]=[],b=this.proxyCoords;for(let C=0;C<b.length;C++){const A=b[C],z=this._findTileCoveringTileID(A,s);if(z){const R=this._createProxiedId(A,z,g[A.key]&&g[A.key][s.id]);_.push(R),this.proxyToSource[A.key][s.id]=[R]}}let T=!1;for(let C=0;C<u.length;C++){const A=s.getTile(u[C]);if(!A||!A.hasData())continue;const z=this._findTileCoveringTileID(A.tileID,this.proxySourceCache);if(z&&z.tileID.canonical.z!==A.tileID.canonical.z){const R=this.proxyToSource[z.tileID.key][s.id],N=this._createProxiedId(z.tileID,A,g[z.tileID.key]&&g[z.tileID.key][s.id]);R?R.splice(R.length-1,0,N):this.proxyToSource[z.tileID.key][s.id]=[N],_.push(N),T=!0}}this._sourceTilesOverlap[s.id]=T}_setupProxiedCoordsForImageSource(s,u,g){if(!s.getSource().loaded())return;const _=this.proxiedCoords[s.id]=[],b=this.proxyCoords,T=s.getSource(),C=new a.Point(T.tileID.x,T.tileID.y)._div(1<<T.tileID.z),A=T.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((R,N)=>(R.min.x=Math.min(R.min.x,N.x-C.x),R.min.y=Math.min(R.min.y,N.y-C.y),R.max.x=Math.max(R.max.x,N.x-C.x),R.max.y=Math.max(R.max.y,N.y-C.y),R),{min:new a.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),z=(R,N)=>{const Y=R.wrap+R.canonical.x/(1<<R.canonical.z),te=R.canonical.y/(1<<R.canonical.z),ie=a.EXTENT/(1<<R.canonical.z),re=N.wrap+N.canonical.x/(1<<N.canonical.z),se=N.canonical.y/(1<<N.canonical.z);return Y+ie<re+A.min.x||Y>re+A.max.x||te+ie<se+A.min.y||te>se+A.max.y};for(let R=0;R<b.length;R++){const N=b[R];for(let Y=0;Y<u.length;Y++){const te=s.getTile(u[Y]);if(!te||!te.hasData()||z(N,te.tileID))continue;const ie=this._createProxiedId(N,te,g[N.key]&&g[N.key][s.id]),re=this.proxyToSource[N.key][s.id];re?re.push(ie):this.proxyToSource[N.key][s.id]=[ie],_.push(ie)}}}_createProxiedId(s,u,g){let _=this.orthoMatrix;if(g){const b=g.find(T=>T.key===u.tileID.key);if(b)return b}if(u.tileID.key!==s.key){const b=s.canonical.z-u.tileID.canonical.z;let T,C,A;_=a.create();const z=u.tileID.wrap-s.wrap<<s.overscaledZ;b>0?(T=a.EXTENT>>b,C=T*((u.tileID.canonical.x<<b)-s.canonical.x+z),A=T*((u.tileID.canonical.y<<b)-s.canonical.y)):(T=a.EXTENT<<-b,C=a.EXTENT*(u.tileID.canonical.x-(s.canonical.x+z<<-b)),A=a.EXTENT*(u.tileID.canonical.y-(s.canonical.y<<-b))),a.ortho(_,0,T,0,T,0,1),a.translate(_,_,[C,A,0])}return new Nu(u.tileID,s.key,_)}_findTileCoveringTileID(s,u){let g=u.getTile(s);if(g&&g.hasData())return g;const _=this._findCoveringTileCache[u.id],b=_[s.key];if(g=b?u.getTileByID(b):null,g&&g.hasData()||b===null)return g;let T=g?g.tileID:s,C=T.overscaledZ;const A=u.getSource().minzoom,z=[];if(!b){const N=u.getSource().maxzoom;if(s.canonical.z>=N){const Y=s.canonical.z-N;u.getSource().reparseOverscaled?(C=Math.max(s.canonical.z+2,u.transform.tileZoom),T=new a.OverscaledTileID(C,s.wrap,N,s.canonical.x>>Y,s.canonical.y>>Y)):Y!==0&&(C=N,T=new a.OverscaledTileID(C,s.wrap,N,s.canonical.x>>Y,s.canonical.y>>Y))}T.key!==s.key&&(z.push(T.key),g=u.getTile(T))}const R=N=>{z.forEach(Y=>{_[Y]=N}),z.length=0};for(C-=1;C>=A&&(!g||!g.hasData());C--){g&&R(g.tileID.key);const N=T.calculateScaledKey(C);if(g=u.getTileByID(N),g&&g.hasData())break;const Y=_[N];if(Y===null)break;Y===void 0?z.push(N):g=u.getTileByID(Y)}return R(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(s){return this.enabled?this._findTileCoveringTileID(s,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(s,u){let g=this._tilesDirty[s];g||(g=this._tilesDirty[s]={}),g[u.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const s=function(u){let g=0;const _=new a.StructArrayLayout2ui4,b=131;for(let T=1;T<129;T++){for(let C=1;C<129;C++)g=T*b+C,_.emplaceBack(g,g+1),_.emplaceBack(g,g+b),_.emplaceBack(g+1,g+b),T===128&&_.emplaceBack(g+b,g+b+1);_.emplaceBack(g+1,g+1+b)}return _}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(s),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,s.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class gn{static cacheKey(s,u,g,_){let b=`${u}${_?_.cacheKey:""}`;for(const T of g)s.usedDefines.includes(T)&&(b+=`/${T}`);return b}constructor(s,u,g,_,b,T){const C=s.gl;this.program=C.createProgram();const A=function($){const ee=[];for(let ue=0;ue<$.length;ue++){if($[ue]===null)continue;const de=$[ue].split(" ");ee.push(de.pop())}return ee}(g.staticAttributes),z=_?_.getBinderAttributes():[],R=A.concat(z);let N=_?_.defines():[];N=N.concat(T.map($=>`#define ${$}`));const Y=s.isWebGL2?`#version 300 es
`:"",te=Y+N.concat(s.extStandardDerivatives&&Y.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(tp):tp,tp,Ou,cg.fragmentSource,al.fragmentSource,g.fragmentSource).join(`
`),ie=Y+N.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Ou,cg.vertexSource,al.vertexSource,Du.vertexSource,g.vertexSource).join(`
`),re=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource(re,te),C.compileShader(re),C.attachShader(this.program,re);const se=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())this.failedToCreate=!0;else{C.shaderSource(se,ie),C.compileShader(se),C.attachShader(this.program,se),this.attributes={},this.numAttributes=R.length;for(let $=0;$<this.numAttributes;$++)R[$]&&(C.bindAttribLocation(this.program,$,R[$]),this.attributes[R[$]]=$);C.linkProgram(this.program),C.deleteShader(se),C.deleteShader(re),this.fixedUniforms=b(s),this.binderUniforms=_?_.getUniforms(s):[],T.includes("TERRAIN")&&(this.terrainUniforms=($=>({u_dem:new a.Uniform1i($),u_dem_prev:new a.Uniform1i($),u_dem_unpack:new a.Uniform4f($),u_dem_tl:new a.Uniform2f($),u_dem_scale:new a.Uniform1f($),u_dem_tl_prev:new a.Uniform2f($),u_dem_scale_prev:new a.Uniform1f($),u_dem_size:new a.Uniform1f($),u_dem_lerp:new a.Uniform1f($),u_exaggeration:new a.Uniform1f($),u_depth:new a.Uniform1i($),u_depth_size_inv:new a.Uniform2f($),u_meter_to_dem:new a.Uniform1f($),u_label_plane_matrix_inv:new a.UniformMatrix4f($)}))(s)),T.includes("GLOBE")&&(this.globeUniforms=($=>({u_tile_tl_up:new a.Uniform3f($),u_tile_tr_up:new a.Uniform3f($),u_tile_br_up:new a.Uniform3f($),u_tile_bl_up:new a.Uniform3f($),u_tile_up_scale:new a.Uniform1f($)}))(s)),T.includes("FOG")&&(this.fogUniforms=($=>({u_fog_matrix:new a.UniformMatrix4f($),u_fog_range:new a.Uniform2f($),u_fog_color:new a.Uniform4f($),u_fog_horizon_blend:new a.Uniform1f($),u_fog_temporal_offset:new a.Uniform1f($),u_frustum_tl:new a.Uniform3f($),u_frustum_tr:new a.Uniform3f($),u_frustum_br:new a.Uniform3f($),u_frustum_bl:new a.Uniform3f($),u_globe_pos:new a.Uniform3f($),u_globe_radius:new a.Uniform1f($),u_globe_transition:new a.Uniform1f($),u_is_globe:new a.Uniform1i($),u_viewport:new a.Uniform2f($)}))(s))}}setTerrainUniformValues(s,u){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const _ in u)g[_]&&g[_].set(this.program,_,u[_])}}setGlobeUniformValues(s,u){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const _ in u)g[_]&&g[_].set(this.program,_,u[_])}}setFogUniformValues(s,u){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const _ in u)g[_].set(this.program,_,u[_])}}draw(s,u,g,_,b,T,C,A,z,R,N,Y,te,ie,re){const se=s.gl;if(this.failedToCreate)return;s.program.set(this.program),s.setDepthMode(g),s.setStencilMode(_),s.setColorMode(b),s.setCullFace(T);for(const ee of Object.keys(this.fixedUniforms))this.fixedUniforms[ee].set(this.program,ee,C[ee]);ie&&ie.setUniforms(this.program,s,this.binderUniforms,Y,{zoom:te});const $={[se.LINES]:2,[se.TRIANGLES]:3,[se.LINE_STRIP]:1}[u];for(const ee of N.get()){const ue=ee.vaos||(ee.vaos={});(ue[A]||(ue[A]=new ev)).bind(s,this,z,ie?ie.getPaintVertexBuffers():[],R,ee.vertexOffset,re||[]),se.drawElements(u,ee.primitiveLength*$,se.UNSIGNED_SHORT,ee.primitiveOffset*$*2)}}}function Tc(p,s){const u=Math.pow(2,s.tileID.overscaledZ),g=s.tileSize*Math.pow(2,p.transform.tileZoom)/u,_=g*(s.tileID.canonical.x+s.tileID.wrap*u),b=g*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_tile_units_to_pixels:1/st(s,1,p.transform.tileZoom),u_pixel_coord_upper:[_>>16,b>>16],u_pixel_coord_lower:[65535&_,65535&b]}}const pg=a.create(),cp=(p,s,u,g,_,b,T,C,A,z,R)=>{const N=s.style.light,Y=N.properties.get("position"),te=[Y.x,Y.y,Y.z],ie=a.create$1();N.properties.get("anchor")==="viewport"&&(a.fromRotation(ie,-s.transform.angle),a.transformMat3(te,te,ie));const re=N.properties.get("color"),se=s.transform,$={u_matrix:p,u_lightpos:te,u_lightintensity:N.properties.get("intensity"),u_lightcolor:[re.r,re.g,re.b],u_vertical_gradient:+u,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:pg,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:_,u_edge_radius:b};return se.projection.name==="globe"&&($.u_tile_id=[T.canonical.x,T.canonical.y,1<<T.canonical.z],$.u_zoom_transition=A,$.u_inv_rot_matrix=R,$.u_merc_center=z,$.u_up_dir=se.projection.upVector(new a.CanonicalTileID(0,0,0),z[0]*a.EXTENT,z[1]*a.EXTENT),$.u_height_lift=C),$},fg=(p,s,u,g,_,b,T,C,A,z,R,N)=>{const Y=cp(p,s,u,g,_,b,T,A,z,R,N),te={u_height_factor:-Math.pow(2,T.overscaledZ)/C.tileSize/8};return a.extend(Y,Tc(s,C),te)},ka=p=>({u_matrix:p}),up=(p,s,u)=>a.extend(ka(p),Tc(s,u)),tv=(p,s)=>({u_matrix:p,u_world:s}),nv=(p,s,u,g)=>a.extend(up(p,s,u),{u_world:g}),rv=a.create(),dp=(p,s,u,g,_,b)=>{const T=p.transform,C=T.projection.name==="globe";let A;if(b.paint.get("circle-pitch-alignment")==="map")if(C){const R=a.globePixelsToTileUnits(T.zoom,s.canonical)*T._pixelsPerMercatorPixel;A=Float32Array.from([R,0,0,R])}else A=T.calculatePixelsToTileUnitsMatrix(u);else A=new Float32Array([T.pixelsToGLUnits[0],0,0,T.pixelsToGLUnits[1]]);const z={u_camera_to_center_distance:T.cameraToCenterDistance,u_matrix:p.translatePosMatrix(s.projMatrix,u,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:A,u_inv_rot_matrix:rv,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(C){z.u_inv_rot_matrix=g,z.u_merc_center=_,z.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],z.u_zoom_transition=a.globeToMercatorTransition(T.zoom);const R=_[0]*a.EXTENT,N=_[1]*a.EXTENT;z.u_up_dir=T.projection.upVector(new a.CanonicalTileID(0,0,0),R,N)}return z},hp=p=>{const s=[];return p.paint.get("circle-pitch-alignment")==="map"&&s.push("PITCH_WITH_MAP"),p.paint.get("circle-pitch-scale")==="map"&&s.push("SCALE_WITH_MAP"),s},pp=(p,s,u,g)=>{const _=a.EXTENT/u.tileSize;return{u_matrix:p,u_camera_to_center_distance:s.getCameraToCenterDistance(g),u_extrude_scale:[s.pixelsToGLUnits[0]/_,s.pixelsToGLUnits[1]/_]}},$u=(p,s,u=1)=>({u_matrix:p,u_color:s,u_overlay:0,u_overlay_scale:u}),mg=a.create(),gg=(p,s,u,g,_,b,T)=>{const C=p.transform,A=C.projection.name==="globe",z=A?a.globePixelsToTileUnits(C.zoom,s.canonical)*C._pixelsPerMercatorPixel:st(u,1,b),R={u_matrix:s.projMatrix,u_extrude_scale:z,u_intensity:T,u_inv_rot_matrix:mg,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(A){R.u_inv_rot_matrix=g,R.u_merc_center=_,R.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],R.u_zoom_transition=a.globeToMercatorTransition(C.zoom);const N=_[0]*a.EXTENT,Y=_[1]*a.EXTENT;R.u_up_dir=C.projection.upVector(new a.CanonicalTileID(0,0,0),N,Y)}return R},iv=(p,s,u,g,_,b,T)=>{const C=p.transform,A=C.calculatePixelsToTileUnitsMatrix(s);return{u_matrix:fp(p,s,u,g),u_pixels_to_tile_units:A,u_device_pixel_ratio:b,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:_,u_texsize:kc(u)?s.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:dl(s,p.transform),u_alpha_discard_threshold:0,u_trim_offset:T}},Cc=(p,s,u,g,_)=>{const b=p.transform;return{u_matrix:fp(p,s,u,g),u_texsize:s.imageAtlasTexture.size,u_pixels_to_tile_units:b.calculatePixelsToTileUnitsMatrix(s),u_device_pixel_ratio:_,u_image:0,u_tile_units_to_pixels:dl(s,b),u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function dl(p,s){return 1/st(p,1,s.tileZoom)}function fp(p,s,u,g){return p.translatePosMatrix(g||s.tileID.projMatrix,s,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}function kc(p){const s=p.paint.get("line-dasharray").value;return s.value||s.kind!=="constant"}const mp=(p,s,u,g,_,b)=>{return{u_matrix:p,u_tl_parent:s,u_scale_parent:u,u_fade_t:g.mix,u_opacity:g.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(C=_.paint.get("raster-saturation"),C>0?1-1/(1.001-C):-C),u_contrast_factor:(T=_.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:Ko(_.paint.get("raster-hue-rotate")),u_perspective_transform:b};var T,C};function Ko(p){p*=Math.PI/180;const s=Math.sin(p),u=Math.cos(p);return[(2*u+1)/3,(-Math.sqrt(3)*s-u+1)/3,(Math.sqrt(3)*s-u+1)/3]}const Uu=a.create(),gp=(p,s,u,g,_,b,T,C,A,z,R,N,Y,te,ie,re)=>{const se=_.transform,$={u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:se.cameraToCenterDistance,u_rotate_symbol:+u,u_aspect_ratio:se.width/se.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:T,u_coord_matrix:C,u_is_text:+A,u_pitch_with_map:+g,u_texsize:z,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Uu,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Uu,u_up_vector:[0,-1,0]};return re.name==="globe"&&($.u_tile_id=[R.canonical.x,R.canonical.y,1<<R.canonical.z],$.u_zoom_transition=N,$.u_inv_rot_matrix=te,$.u_merc_center=Y,$.u_camera_forward=se._camera.forward(),$.u_ecef_origin=a.globeECEFOrigin(se.globeMatrix,R.toUnwrapped()),$.u_tile_matrix=Float32Array.from(se.globeMatrix),$.u_up_vector=ie),$},Vu=(p,s,u,g,_,b,T,C,A,z,R,N,Y,te,ie,re,se)=>a.extend(gp(p,s,u,g,_,b,T,C,A,z,N,Y,te,ie,re,se),{u_gamma_scale:g?_.transform.cameraToCenterDistance*Math.cos(_.terrain?0:_.transform._pitch):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+R}),yg=(p,s,u,g,_,b,T,C,A,z,R,N,Y,te,ie,re)=>a.extend(Vu(p,s,u,g,_,b,T,C,!0,A,!0,R,N,Y,te,ie,re),{u_texsize_icon:z,u_texture_icon:1}),yp=(p,s,u)=>({u_matrix:p,u_opacity:s,u_color:u}),ov=(p,s,u,g,_)=>a.extend(function(b,T,C){const A=T.imageManager.getPattern(b.toString()),{width:z,height:R}=T.imageManager.getPixelSize(),N=Math.pow(2,C.tileID.overscaledZ),Y=C.tileSize*Math.pow(2,T.transform.tileZoom)/N,te=Y*(C.tileID.canonical.x+C.tileID.wrap*N),ie=Y*C.tileID.canonical.y;return{u_image:0,u_pattern_tl:A.tl,u_pattern_br:A.br,u_texsize:[z,R],u_pattern_size:A.displaySize,u_tile_units_to_pixels:1/st(C,1,T.transform.tileZoom),u_pixel_coord_upper:[te>>16,ie>>16],u_pixel_coord_lower:[65535&te,65535&ie]}}(g,u,_),{u_matrix:p,u_opacity:s}),_p={fillExtrusion:p=>({u_matrix:new a.UniformMatrix4f(p),u_lightpos:new a.Uniform3f(p),u_lightintensity:new a.Uniform1f(p),u_lightcolor:new a.Uniform3f(p),u_vertical_gradient:new a.Uniform1f(p),u_opacity:new a.Uniform1f(p),u_edge_radius:new a.Uniform1f(p),u_ao:new a.Uniform2f(p),u_tile_id:new a.Uniform3f(p),u_zoom_transition:new a.Uniform1f(p),u_inv_rot_matrix:new a.UniformMatrix4f(p),u_merc_center:new a.Uniform2f(p),u_up_dir:new a.Uniform3f(p),u_height_lift:new a.Uniform1f(p)}),fillExtrusionPattern:p=>({u_matrix:new a.UniformMatrix4f(p),u_lightpos:new a.Uniform3f(p),u_lightintensity:new a.Uniform1f(p),u_lightcolor:new a.Uniform3f(p),u_vertical_gradient:new a.Uniform1f(p),u_height_factor:new a.Uniform1f(p),u_edge_radius:new a.Uniform1f(p),u_ao:new a.Uniform2f(p),u_tile_id:new a.Uniform3f(p),u_zoom_transition:new a.Uniform1f(p),u_inv_rot_matrix:new a.UniformMatrix4f(p),u_merc_center:new a.Uniform2f(p),u_up_dir:new a.Uniform3f(p),u_height_lift:new a.Uniform1f(p),u_image:new a.Uniform1i(p),u_texsize:new a.Uniform2f(p),u_pixel_coord_upper:new a.Uniform2f(p),u_pixel_coord_lower:new a.Uniform2f(p),u_tile_units_to_pixels:new a.Uniform1f(p),u_opacity:new a.Uniform1f(p)}),fill:p=>({u_matrix:new a.UniformMatrix4f(p)}),fillPattern:p=>({u_matrix:new a.UniformMatrix4f(p),u_image:new a.Uniform1i(p),u_texsize:new a.Uniform2f(p),u_pixel_coord_upper:new a.Uniform2f(p),u_pixel_coord_lower:new a.Uniform2f(p),u_tile_units_to_pixels:new a.Uniform1f(p)}),fillOutline:p=>({u_matrix:new a.UniformMatrix4f(p),u_world:new a.Uniform2f(p)}),fillOutlinePattern:p=>({u_matrix:new a.UniformMatrix4f(p),u_world:new a.Uniform2f(p),u_image:new a.Uniform1i(p),u_texsize:new a.Uniform2f(p),u_pixel_coord_upper:new a.Uniform2f(p),u_pixel_coord_lower:new a.Uniform2f(p),u_tile_units_to_pixels:new a.Uniform1f(p)}),circle:p=>({u_camera_to_center_distance:new a.Uniform1f(p),u_extrude_scale:new a.UniformMatrix2f(p),u_device_pixel_ratio:new a.Uniform1f(p),u_matrix:new a.UniformMatrix4f(p),u_inv_rot_matrix:new a.UniformMatrix4f(p),u_merc_center:new a.Uniform2f(p),u_tile_id:new a.Uniform3f(p),u_zoom_transition:new a.Uniform1f(p),u_up_dir:new a.Uniform3f(p)}),collisionBox:p=>({u_matrix:new a.UniformMatrix4f(p),u_camera_to_center_distance:new a.Uniform1f(p),u_extrude_scale:new a.Uniform2f(p)}),collisionCircle:p=>({u_matrix:new a.UniformMatrix4f(p),u_inv_matrix:new a.UniformMatrix4f(p),u_camera_to_center_distance:new a.Uniform1f(p),u_viewport_size:new a.Uniform2f(p)}),debug:p=>({u_color:new a.UniformColor(p),u_matrix:new a.UniformMatrix4f(p),u_overlay:new a.Uniform1i(p),u_overlay_scale:new a.Uniform1f(p)}),clippingMask:p=>({u_matrix:new a.UniformMatrix4f(p)}),heatmap:p=>({u_extrude_scale:new a.Uniform1f(p),u_intensity:new a.Uniform1f(p),u_matrix:new a.UniformMatrix4f(p),u_inv_rot_matrix:new a.UniformMatrix4f(p),u_merc_center:new a.Uniform2f(p),u_tile_id:new a.Uniform3f(p),u_zoom_transition:new a.Uniform1f(p),u_up_dir:new a.Uniform3f(p)}),heatmapTexture:p=>({u_image:new a.Uniform1i(p),u_color_ramp:new a.Uniform1i(p),u_opacity:new a.Uniform1f(p)}),hillshade:p=>({u_matrix:new a.UniformMatrix4f(p),u_image:new a.Uniform1i(p),u_latrange:new a.Uniform2f(p),u_light:new a.Uniform2f(p),u_shadow:new a.UniformColor(p),u_highlight:new a.UniformColor(p),u_accent:new a.UniformColor(p)}),hillshadePrepare:p=>({u_matrix:new a.UniformMatrix4f(p),u_image:new a.Uniform1i(p),u_dimension:new a.Uniform2f(p),u_zoom:new a.Uniform1f(p),u_unpack:new a.Uniform4f(p)}),line:p=>({u_matrix:new a.UniformMatrix4f(p),u_pixels_to_tile_units:new a.UniformMatrix2f(p),u_device_pixel_ratio:new a.Uniform1f(p),u_units_to_pixels:new a.Uniform2f(p),u_dash_image:new a.Uniform1i(p),u_gradient_image:new a.Uniform1i(p),u_image_height:new a.Uniform1f(p),u_texsize:new a.Uniform2f(p),u_tile_units_to_pixels:new a.Uniform1f(p),u_alpha_discard_threshold:new a.Uniform1f(p),u_trim_offset:new a.Uniform2f(p)}),linePattern:p=>({u_matrix:new a.UniformMatrix4f(p),u_texsize:new a.Uniform2f(p),u_pixels_to_tile_units:new a.UniformMatrix2f(p),u_device_pixel_ratio:new a.Uniform1f(p),u_image:new a.Uniform1i(p),u_units_to_pixels:new a.Uniform2f(p),u_tile_units_to_pixels:new a.Uniform1f(p),u_alpha_discard_threshold:new a.Uniform1f(p)}),raster:p=>({u_matrix:new a.UniformMatrix4f(p),u_tl_parent:new a.Uniform2f(p),u_scale_parent:new a.Uniform1f(p),u_fade_t:new a.Uniform1f(p),u_opacity:new a.Uniform1f(p),u_image0:new a.Uniform1i(p),u_image1:new a.Uniform1i(p),u_brightness_low:new a.Uniform1f(p),u_brightness_high:new a.Uniform1f(p),u_saturation_factor:new a.Uniform1f(p),u_contrast_factor:new a.Uniform1f(p),u_spin_weights:new a.Uniform3f(p),u_perspective_transform:new a.Uniform2f(p)}),symbolIcon:p=>({u_is_size_zoom_constant:new a.Uniform1i(p),u_is_size_feature_constant:new a.Uniform1i(p),u_size_t:new a.Uniform1f(p),u_size:new a.Uniform1f(p),u_camera_to_center_distance:new a.Uniform1f(p),u_rotate_symbol:new a.Uniform1i(p),u_aspect_ratio:new a.Uniform1f(p),u_fade_change:new a.Uniform1f(p),u_matrix:new a.UniformMatrix4f(p),u_label_plane_matrix:new a.UniformMatrix4f(p),u_coord_matrix:new a.UniformMatrix4f(p),u_is_text:new a.Uniform1i(p),u_pitch_with_map:new a.Uniform1i(p),u_texsize:new a.Uniform2f(p),u_tile_id:new a.Uniform3f(p),u_zoom_transition:new a.Uniform1f(p),u_inv_rot_matrix:new a.UniformMatrix4f(p),u_merc_center:new a.Uniform2f(p),u_camera_forward:new a.Uniform3f(p),u_tile_matrix:new a.UniformMatrix4f(p),u_up_vector:new a.Uniform3f(p),u_ecef_origin:new a.Uniform3f(p),u_texture:new a.Uniform1i(p)}),symbolSDF:p=>({u_is_size_zoom_constant:new a.Uniform1i(p),u_is_size_feature_constant:new a.Uniform1i(p),u_size_t:new a.Uniform1f(p),u_size:new a.Uniform1f(p),u_camera_to_center_distance:new a.Uniform1f(p),u_rotate_symbol:new a.Uniform1i(p),u_aspect_ratio:new a.Uniform1f(p),u_fade_change:new a.Uniform1f(p),u_matrix:new a.UniformMatrix4f(p),u_label_plane_matrix:new a.UniformMatrix4f(p),u_coord_matrix:new a.UniformMatrix4f(p),u_is_text:new a.Uniform1i(p),u_pitch_with_map:new a.Uniform1i(p),u_texsize:new a.Uniform2f(p),u_texture:new a.Uniform1i(p),u_gamma_scale:new a.Uniform1f(p),u_device_pixel_ratio:new a.Uniform1f(p),u_tile_id:new a.Uniform3f(p),u_zoom_transition:new a.Uniform1f(p),u_inv_rot_matrix:new a.UniformMatrix4f(p),u_merc_center:new a.Uniform2f(p),u_camera_forward:new a.Uniform3f(p),u_tile_matrix:new a.UniformMatrix4f(p),u_up_vector:new a.Uniform3f(p),u_ecef_origin:new a.Uniform3f(p),u_is_halo:new a.Uniform1i(p)}),symbolTextAndIcon:p=>({u_is_size_zoom_constant:new a.Uniform1i(p),u_is_size_feature_constant:new a.Uniform1i(p),u_size_t:new a.Uniform1f(p),u_size:new a.Uniform1f(p),u_camera_to_center_distance:new a.Uniform1f(p),u_rotate_symbol:new a.Uniform1i(p),u_aspect_ratio:new a.Uniform1f(p),u_fade_change:new a.Uniform1f(p),u_matrix:new a.UniformMatrix4f(p),u_label_plane_matrix:new a.UniformMatrix4f(p),u_coord_matrix:new a.UniformMatrix4f(p),u_is_text:new a.Uniform1i(p),u_pitch_with_map:new a.Uniform1i(p),u_texsize:new a.Uniform2f(p),u_texsize_icon:new a.Uniform2f(p),u_texture:new a.Uniform1i(p),u_texture_icon:new a.Uniform1i(p),u_gamma_scale:new a.Uniform1f(p),u_device_pixel_ratio:new a.Uniform1f(p),u_is_halo:new a.Uniform1i(p)}),background:p=>({u_matrix:new a.UniformMatrix4f(p),u_opacity:new a.Uniform1f(p),u_color:new a.UniformColor(p)}),backgroundPattern:p=>({u_matrix:new a.UniformMatrix4f(p),u_opacity:new a.Uniform1f(p),u_image:new a.Uniform1i(p),u_pattern_tl:new a.Uniform2f(p),u_pattern_br:new a.Uniform2f(p),u_texsize:new a.Uniform2f(p),u_pattern_size:new a.Uniform2f(p),u_pixel_coord_upper:new a.Uniform2f(p),u_pixel_coord_lower:new a.Uniform2f(p),u_tile_units_to_pixels:new a.Uniform1f(p)}),terrainRaster:op,terrainDepth:op,skybox:p=>({u_matrix:new a.UniformMatrix4f(p),u_sun_direction:new a.Uniform3f(p),u_cubemap:new a.Uniform1i(p),u_opacity:new a.Uniform1f(p),u_temporal_offset:new a.Uniform1f(p)}),skyboxGradient:p=>({u_matrix:new a.UniformMatrix4f(p),u_color_ramp:new a.Uniform1i(p),u_center_direction:new a.Uniform3f(p),u_radius:new a.Uniform1f(p),u_opacity:new a.Uniform1f(p),u_temporal_offset:new a.Uniform1f(p)}),skyboxCapture:p=>({u_matrix_3f:new a.UniformMatrix3f(p),u_sun_direction:new a.Uniform3f(p),u_sun_intensity:new a.Uniform1f(p),u_color_tint_r:new a.Uniform4f(p),u_color_tint_m:new a.Uniform4f(p),u_luminance:new a.Uniform1f(p)}),globeRaster:p=>({u_proj_matrix:new a.UniformMatrix4f(p),u_globe_matrix:new a.UniformMatrix4f(p),u_normalize_matrix:new a.UniformMatrix4f(p),u_merc_matrix:new a.UniformMatrix4f(p),u_zoom_transition:new a.Uniform1f(p),u_merc_center:new a.Uniform2f(p),u_image0:new a.Uniform1i(p),u_grid_matrix:new a.UniformMatrix3f(p),u_skirt_height:new a.Uniform1f(p),u_frustum_tl:new a.Uniform3f(p),u_frustum_tr:new a.Uniform3f(p),u_frustum_br:new a.Uniform3f(p),u_frustum_bl:new a.Uniform3f(p),u_globe_pos:new a.Uniform3f(p),u_globe_radius:new a.Uniform1f(p),u_viewport:new a.Uniform2f(p)}),globeAtmosphere:p=>({u_frustum_tl:new a.Uniform3f(p),u_frustum_tr:new a.Uniform3f(p),u_frustum_br:new a.Uniform3f(p),u_frustum_bl:new a.Uniform3f(p),u_horizon:new a.Uniform1f(p),u_transition:new a.Uniform1f(p),u_fadeout_range:new a.Uniform1f(p),u_color:new a.Uniform4f(p),u_high_color:new a.Uniform4f(p),u_space_color:new a.Uniform4f(p),u_star_intensity:new a.Uniform1f(p),u_star_density:new a.Uniform1f(p),u_star_size:new a.Uniform1f(p),u_temporal_offset:new a.Uniform1f(p),u_horizon_angle:new a.Uniform1f(p),u_rotation_matrix:new a.UniformMatrix4f(p)})};let Wu;function Ic(p,s,u,g,_,b,T){const C=p.context,A=C.gl,z=p.transform,R=p.useProgram("collisionBox"),N=[];let Y=0,te=0;for(let de=0;de<g.length;de++){const Se=g[de],Te=s.getTile(Se),Ee=Te.getBucket(u);if(!Ee)continue;const Pe=lo(Se,Ee,z);let Me=Pe;_[0]===0&&_[1]===0||(Me=p.translatePosMatrix(Pe,Te,_,b));const je=T?Ee.textCollisionBox:Ee.iconCollisionBox,rt=Ee.collisionCircleArray;if(rt.length>0){const Oe=a.create(),Ke=Me;a.mul(Oe,Ee.placementInvProjMatrix,z.glCoordMatrix),a.mul(Oe,Oe,Ee.placementViewportMatrix),N.push({circleArray:rt,circleOffset:te,transform:Ke,invTransform:Oe,projection:Ee.getProjection()}),Y+=rt.length/4,te=Y}je&&(p.terrain&&p.terrain.setupElevationDraw(Te,R),R.draw(C,A.LINES,a.DepthMode.disabled,a.StencilMode.disabled,p.colorModeForRenderPass(),a.CullFaceMode.disabled,pp(Me,z,Te,Ee.getProjection()),u.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,null,z.zoom,null,[je.collisionVertexBuffer,je.collisionVertexBufferExt]))}if(!T||!N.length)return;const ie=p.useProgram("collisionCircle"),re=new a.StructArrayLayout2f1f2i16;re.resize(4*Y),re._trim();let se=0;for(const de of N)for(let Se=0;Se<de.circleArray.length/4;Se++){const Te=4*Se,Ee=de.circleArray[Te+0],Pe=de.circleArray[Te+1],Me=de.circleArray[Te+2],je=de.circleArray[Te+3];re.emplace(se++,Ee,Pe,Me,je,0),re.emplace(se++,Ee,Pe,Me,je,1),re.emplace(se++,Ee,Pe,Me,je,2),re.emplace(se++,Ee,Pe,Me,je,3)}(!Wu||Wu.length<2*Y)&&(Wu=function(de){const Se=2*de,Te=new a.StructArrayLayout3ui6;Te.resize(Se),Te._trim();for(let Ee=0;Ee<Se;Ee++){const Pe=6*Ee;Te.uint16[Pe+0]=4*Ee+0,Te.uint16[Pe+1]=4*Ee+1,Te.uint16[Pe+2]=4*Ee+2,Te.uint16[Pe+3]=4*Ee+2,Te.uint16[Pe+4]=4*Ee+3,Te.uint16[Pe+5]=4*Ee+0}return Te}(Y));const $=C.createIndexBuffer(Wu,!0),ee=C.createVertexBuffer(re,a.collisionCircleLayout.members,!0);for(const de of N){const Se={u_matrix:de.transform,u_inv_matrix:de.invTransform,u_camera_to_center_distance:(ue=z).getCameraToCenterDistance(de.projection),u_viewport_size:[ue.width,ue.height]};ie.draw(C,A.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,p.colorModeForRenderPass(),a.CullFaceMode.disabled,Se,u.id,ee,$,a.SegmentVector.simpleSegment(0,2*de.circleOffset,de.circleArray.length,de.circleArray.length/2),null,z.zoom)}var ue;ee.destroy(),$.destroy()}const _g=a.create();function xp({width:p,height:s,anchor:u,textOffset:g,textScale:_},b){const{horizontalAlign:T,verticalAlign:C}=a.getAnchorAlignment(u),A=-(T-.5)*p,z=-(C-.5)*s,R=a.evaluateVariableOffset(u,g);return new a.Point((A/_+R[0])*b,(z/_+R[1])*b)}function sv(p,s,u,g,_,b,T,C,A,z,R){const N=p.text.placedSymbolArray,Y=p.text.dynamicLayoutVertexArray,te=p.icon.dynamicLayoutVertexArray,ie={},re=p.getProjection(),se=ir(C,re,b),$=b.elevation,ee=re.upVectorScale(C.canonical,b.center.lat,b.worldSize).metersToTile;Y.clear();for(let ue=0;ue<N.length;ue++){const de=N.get(ue),{tileAnchorX:Se,tileAnchorY:Te,numGlyphs:Ee}=de,Pe=de.hidden||!de.crossTileID||p.allowVerticalPlacement&&!de.placedOrientation?null:g[de.crossTileID];if(Pe){let Me=0,je=0,rt=0;if($){const at=$?$.getAtTileOffset(C,Se,Te):0,[Ot,Ht,At]=re.upVector(C.canonical,Se,Te);Me=at*Ot*ee,je=at*Ht*ee,rt=at*At*ee}let[Oe,Ke,$e,nt]=ti(de.projectedAnchorX+Me,de.projectedAnchorY+je,de.projectedAnchorZ+rt,u?se:T);const Fe=ig(b.getCameraToCenterDistance(re),nt);let Ze=_.evaluateSizeForFeature(p.textSizeData,z,de)*Fe/a.ONE_EM;u&&(Ze*=p.tilePixelRatio/A);const ot=xp(Pe,Ze);u?({x:Oe,y:Ke,z:$e}=re.projectTilePoint(Se+ot.x,Te+ot.y,C.canonical),[Oe,Ke,$e]=ti(Oe+Me,Ke+je,$e+rt,T)):(s&&ot._rotate(-b.angle),Oe+=ot.x,Ke+=ot.y,$e=0);const Qe=p.allowVerticalPlacement&&de.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let at=0;at<Ee;at++)a.addDynamicAttributes(Y,Oe,Ke,$e,Qe);R&&de.associatedIconIndex>=0&&(ie[de.associatedIconIndex]={x:Oe,y:Ke,z:$e,angle:Qe})}else Co(Ee,Y)}if(R){te.clear();const ue=p.icon.placedSymbolArray;for(let de=0;de<ue.length;de++){const Se=ue.get(de),{numGlyphs:Te}=Se,Ee=ie[de];if(Se.hidden||!Ee)Co(Te,te);else{const{x:Pe,y:Me,z:je,angle:rt}=Ee;for(let Oe=0;Oe<Te;Oe++)a.addDynamicAttributes(te,Pe,Me,je,rt)}}p.icon.dynamicLayoutVertexBuffer.updateData(te)}p.text.dynamicLayoutVertexBuffer.updateData(Y)}function vp(p,s,u){return u.iconsInText&&s?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function xg(p,s,u,g,_,b,T,C,A,z,R,N){const Y=p.context,te=Y.gl,ie=p.transform,re=C==="map",se=A==="map",$=re&&u.layout.get("symbol-placement")!=="point",ee=re&&!se&&!$,ue=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let de=!1;const Se=p.depthModeForSublayer(0,a.DepthMode.ReadOnly),Te=[a.mercatorXfromLng(ie.center.lng),a.mercatorYfromLat(ie.center.lat)],Ee=u.layout.get("text-variable-anchor"),Pe=ie.projection.name==="globe",Me=[],je=[0,-1,0];let rt=je;!Pe&&!ie.mercatorFromTransition||re||(rt=function(Oe){const Ke=Oe._camera.getWorldToCamera(Oe.worldSize,1),$e=a.multiply([],Ke,Oe.globeMatrix);a.invert($e,$e);const nt=[0,0,0],Fe=[0,1,0,0];return a.transformMat4$1(Fe,Fe,$e),nt[0]=Fe[0],nt[1]=Fe[1],nt[2]=Fe[2],a.normalize(nt,nt),nt}(ie));for(const Oe of g){const Ke=s.getTile(Oe),$e=Ke.getBucket(u);if(!$e||$e.projection.name==="mercator"&&Pe)continue;const nt=_?$e.text:$e.icon;if(!nt||$e.fullyClipped||!nt.segments.get().length)continue;const Fe=nt.programConfigurations.get(u.id),Ze=_||$e.sdfIcons,ot=_?$e.textSizeData:$e.iconSizeData,Qe=se||ie.pitch!==0,at=a.evaluateSizeForZoom(ot,ie.zoom);let Ot,Ht,At,Ut,dn=[0,0],ln=null;if(_)Ht=Ke.glyphAtlasTexture,At=te.LINEAR,Ot=Ke.glyphAtlasTexture.size,$e.iconsInText&&(dn=Ke.imageAtlasTexture.size,ln=Ke.imageAtlasTexture,Ut=Qe||p.options.rotating||p.options.zooming||ot.kind==="composite"||ot.kind==="camera"?te.LINEAR:te.NEAREST);else{const Ps=u.layout.get("icon-size").constantOr(0)!==1||$e.iconsNeedLinear;Ht=Ke.imageAtlasTexture,At=Ze||p.options.rotating||p.options.zooming||Ps||Qe?te.LINEAR:te.NEAREST,Ot=Ke.imageAtlasTexture.size}const Lt=$e.projection.name==="globe",Pn=Lt?rt:je,Bn=Lt?a.globeToMercatorTransition(ie.zoom):0,Fn=ir(Oe,$e.getProjection(),ie),jn=ie.calculatePixelsToTileUnitsMatrix(Ke),bi=qe(Fn,Ke.tileID.canonical,se,re,ie,$e.getProjection(),jn),ri=p.terrain&&se&&$?a.invert(a.create(),bi):_g,po=zr(Fn,Ke.tileID.canonical,se,re,ie,$e.getProjection(),jn),Jo=Ee&&$e.hasTextData(),or=u.layout.get("icon-text-fit")!=="none"&&Jo&&$e.hasIconData();if($){const Ps=ie.elevation,ta=Ps?Ps.getAtTileOffsetFunc(Oe,ie.center.lat,ie.worldSize,$e.getProjection()):null,Ra=Ss(Fn,Ke.tileID.canonical,se,re,ie,$e.getProjection(),jn);qh($e,Fn,p,_,Ra,po,se,z,ta,Oe)}const Nn=$||_&&Ee||or,Sn=p.translatePosMatrix(Fn,Ke,b,T),Lr=Nn?_g:bi,Mi=p.translatePosMatrix(po,Ke,b,T,!0),tr=$e.getProjection().createInversionMatrix(ie,Oe.canonical),Fi=[];p.terrainRenderModeElevated()&&se&&Fi.push("PITCH_WITH_MAP_TERRAIN"),Lt&&Fi.push("PROJECTION_GLOBE_VIEW"),Nn&&Fi.push("PROJECTED_POS_ON_VIEWPORT");const sd=Ze&&u.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Pa;Pa=Ze?$e.iconsInText?yg(ot.kind,at,ee,se,p,Sn,Lr,Mi,Ot,dn,Oe,Bn,Te,tr,Pn,$e.getProjection()):Vu(ot.kind,at,ee,se,p,Sn,Lr,Mi,_,Ot,!0,Oe,Bn,Te,tr,Pn,$e.getProjection()):gp(ot.kind,at,ee,se,p,Sn,Lr,Mi,_,Ot,Oe,Bn,Te,tr,Pn,$e.getProjection());const jc={program:p.useProgram(vp(Ze,_,$e),Fe,Fi),buffers:nt,uniformValues:Pa,atlasTexture:Ht,atlasTextureIcon:ln,atlasInterpolation:At,atlasInterpolationIcon:Ut,isSDF:Ze,hasHalo:sd,tile:Ke,labelPlaneMatrixInv:ri};if(ue&&$e.canOverlap){de=!0;const Ps=nt.segments.get();for(const ta of Ps)Me.push({segments:new a.SegmentVector([ta]),sortKey:ta.sortKey,state:jc})}else Me.push({segments:nt.segments,sortKey:0,state:jc})}de&&Me.sort((Oe,Ke)=>Oe.sortKey-Ke.sortKey);for(const Oe of Me){const Ke=Oe.state;if(p.terrain&&p.terrain.setupElevationDraw(Ke.tile,Ke.program,{useDepthForOcclusion:!Pe,labelPlaneMatrixInv:Ke.labelPlaneMatrixInv}),Y.activeTexture.set(te.TEXTURE0),Ke.atlasTexture.bind(Ke.atlasInterpolation,te.CLAMP_TO_EDGE),Ke.atlasTextureIcon&&(Y.activeTexture.set(te.TEXTURE1),Ke.atlasTextureIcon&&Ke.atlasTextureIcon.bind(Ke.atlasInterpolationIcon,te.CLAMP_TO_EDGE)),Ke.isSDF){const $e=Ke.uniformValues;Ke.hasHalo&&($e.u_is_halo=1,Ac(Ke.buffers,Oe.segments,u,p,Ke.program,Se,R,N,$e)),$e.u_is_halo=0}Ac(Ke.buffers,Oe.segments,u,p,Ke.program,Se,R,N,Ke.uniformValues)}}function Ac(p,s,u,g,_,b,T,C,A){const z=g.context,R=[p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer,p.globeExtVertexBuffer];_.draw(z,z.gl.TRIANGLES,b,T,C,a.CullFaceMode.disabled,A,u.id,p.layoutVertexBuffer,p.indexBuffer,s,u.paint,g.transform.zoom,p.programConfigurations.get(u.id),R)}function vg(p,s,u,g,_,b,T){const C=p.context.gl,A=u.paint.get("fill-pattern"),z=A&&A.constantOr(1);let R,N,Y,te,ie;T?(N=z&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",R=C.LINES):(N=z?"fillPattern":"fill",R=C.TRIANGLES);for(const re of g){const se=s.getTile(re);if(z&&!se.patternsLoaded())continue;const $=se.getBucket(u);if(!$)continue;p.prepareDrawTile();const ee=$.programConfigurations.get(u.id),ue=p.useProgram(N,ee);z&&(p.context.activeTexture.set(C.TEXTURE0),se.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),ee.updatePaintBuffers());const de=A.constantOr(null);if(de&&se.imageAtlas){const Te=se.imageAtlas.patternPositions[de.toString()];Te&&ee.setConstantPatternPositions(Te)}const Se=p.translatePosMatrix(re.projMatrix,se,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(T){te=$.indexBuffer2,ie=$.segments2;const Te=p.terrain&&p.terrain.renderingToTexture?p.terrain.drapeBufferSize:[C.drawingBufferWidth,C.drawingBufferHeight];Y=N==="fillOutlinePattern"&&z?nv(Se,p,se,Te):tv(Se,Te)}else te=$.indexBuffer,ie=$.segments,Y=z?up(Se,p,se):ka(Se);p.prepareDrawProgram(p.context,ue,re.toUnwrapped()),ue.draw(p.context,R,_,p.stencilModeForClipping(re),b,a.CullFaceMode.disabled,Y,u.id,$.layoutVertexBuffer,te,ie,u.paint,p.transform.zoom,ee)}}function Gu(p,s,u,g,_,b,T){const C=p.context,A=C.gl,z=p.transform,R=u.paint.get("fill-extrusion-pattern"),N=R.constantOr(1),Y=u.paint.get("fill-extrusion-opacity"),te=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),u.paint.get("fill-extrusion-ambient-occlusion-radius")],ie=u.layout.get("fill-extrusion-edge-radius"),re=ie>0&&!u.paint.get("fill-extrusion-rounded-roof"),se=re?0:ie,$=z.projection.name==="globe"?a.fillExtrusionHeightLift():0,ee=z.projection.name==="globe",ue=ee?a.globeToMercatorTransition(z.zoom):0,de=[a.mercatorXfromLng(z.center.lng),a.mercatorYfromLat(z.center.lat)],Se=[];ee&&Se.push("PROJECTION_GLOBE_VIEW"),te[0]>0&&Se.push("FAUX_AO"),re&&Se.push("ZERO_ROOF_RADIUS");for(const Te of g){const Ee=s.getTile(Te),Pe=Ee.getBucket(u);if(!Pe||Pe.projection.name!==z.projection.name)continue;const Me=Pe.programConfigurations.get(u.id),je=p.useProgram(N?"fillExtrusionPattern":"fillExtrusion",Me,Se);if(p.terrain){const Ze=p.terrain;if(p.style.terrainSetForDrapingOnly())Ze.setupElevationDraw(Ee,je,{useMeterToDem:!0});else{if(!Pe.enableTerrain)continue;if(Ze.setupElevationDraw(Ee,je,{useMeterToDem:!0}),bg(C,s,Te,Pe,u,Ze),!Pe.centroidVertexBuffer){const ot=je.attributes.a_centroid_pos;ot!==void 0&&A.vertexAttrib2f(ot,0,0)}}}N&&(p.context.activeTexture.set(A.TEXTURE0),Ee.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),Me.updatePaintBuffers());const rt=R.constantOr(null);if(rt&&Ee.imageAtlas){const Ze=Ee.imageAtlas.patternPositions[rt.toString()];Ze&&Me.setConstantPatternPositions(Ze)}const Oe=p.translatePosMatrix(Te.projMatrix,Ee,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Ke=z.projection.createInversionMatrix(z,Te.canonical),$e=u.paint.get("fill-extrusion-vertical-gradient"),nt=N?fg(Oe,p,$e,Y,te,se,Te,Ee,$,ue,de,Ke):cp(Oe,p,$e,Y,te,se,Te,$,ue,de,Ke);p.prepareDrawProgram(C,je,Te.toUnwrapped());const Fe=[];p.terrain&&Fe.push(Pe.centroidVertexBuffer),ee&&Fe.push(Pe.layoutVertexExtBuffer),je.draw(C,C.gl.TRIANGLES,_,b,T,a.CullFaceMode.backCCW,nt,u.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,u.paint,p.transform.zoom,Me,Fe)}}function bg(p,s,u,g,_,b){const T=[$=>{let ee=$.canonical.x-1,ue=$.wrap;return ee<0&&(ee=(1<<$.canonical.z)-1,ue--),new a.OverscaledTileID($.overscaledZ,ue,$.canonical.z,ee,$.canonical.y)},$=>{let ee=$.canonical.x+1,ue=$.wrap;return ee===1<<$.canonical.z&&(ee=0,ue++),new a.OverscaledTileID($.overscaledZ,ue,$.canonical.z,ee,$.canonical.y)},$=>new a.OverscaledTileID($.overscaledZ,$.wrap,$.canonical.z,$.canonical.x,($.canonical.y===0?1<<$.canonical.z:$.canonical.y)-1),$=>new a.OverscaledTileID($.overscaledZ,$.wrap,$.canonical.z,$.canonical.x,$.canonical.y===(1<<$.canonical.z)-1?0:$.canonical.y+1)],C=$=>{const ee=s.getSource().minzoom,ue=Se=>{const Te=s.getTileByID(Se);if(Te&&Te.hasData())return Te.getBucket(_)},de=[0,-1,1];for(const Se of de){if($.overscaledZ+Se<ee)continue;const Te=ue($.calculateScaledKey($.overscaledZ+Se));if(Te)return Te}},A=[0,0,0],z=($,ee)=>(A[0]=Math.min($.min.y,ee.min.y),A[1]=Math.max($.max.y,ee.max.y),A[2]=a.EXTENT-ee.min.x>$.max.x?ee.min.x-a.EXTENT:$.max.x,A),R=($,ee)=>(A[0]=Math.min($.min.x,ee.min.x),A[1]=Math.max($.max.x,ee.max.x),A[2]=a.EXTENT-ee.min.y>$.max.y?ee.min.y-a.EXTENT:$.max.y,A),N=[($,ee)=>z($,ee),($,ee)=>z(ee,$),($,ee)=>R($,ee),($,ee)=>R(ee,$)],Y=new a.Point(0,0);let te,ie,re;const se=($,ee,ue,de,Se)=>{const Te=[[de?ue:$,de?$:ue,0],[de?ue:ee,de?ee:ue,0]],Ee=Se<0?a.EXTENT+Se:Se,Pe=[de?Ee:($+ee)/2,de?($+ee)/2:Ee,0];return ue===0&&Se<0||ue!==0&&Se>0?b.getForTilePoints(re,[Pe],!0,ie):Te.push(Pe),b.getForTilePoints(u,Te,!0,te),Math.max(Te[0][2],Te[1][2],Pe[2])/b.exaggeration()};for(let $=0;$<4;$++){const ee=($<2?1:5)-$,ue=g.borders[$];if(ue.length===0)continue;const de=re=T[$](u),Se=C(de);if(!(Se&&Se instanceof a.FillExtrusionBucket&&Se.enableTerrain)||g.borderDoneWithNeighborZ[$]===Se.canonical.z&&Se.borderDoneWithNeighborZ[ee]===g.canonical.z||(ie=b.findDEMTileFor(de),!ie||!ie.dem))continue;if(!te){const Me=b.findDEMTileFor(u);if(!Me||!Me.dem)return;te=Me}const Te=Se.borders[ee];let Ee=0;const Pe=Se.borderDoneWithNeighborZ[ee]!==g.canonical.z;if(g.canonical.z===Se.canonical.z){for(let Me=0;Me<ue.length;Me++){const je=g.featuresOnBorder[ue[Me]],rt=je.borders[$];let Oe;for(;Ee<Te.length&&(Oe=Se.featuresOnBorder[Te[Ee]],!(Oe.borders[ee][1]>rt[0]+3));)Pe&&Se.encodeCentroid(void 0,Oe,!1),Ee++;if(Oe&&Ee<Te.length){const Ke=Ee;let $e=0;for(;!(Oe.borders[ee][0]>rt[1]-3)&&($e++,++Ee!==Te.length);)Oe=Se.featuresOnBorder[Te[Ee]];if(Oe=Se.featuresOnBorder[Te[Ke]],je.intersectsCount()>1||Oe.intersectsCount()>1||$e!==1){$e!==1&&(Ee=Ke),g.encodeCentroid(void 0,je,!1),Pe&&Se.encodeCentroid(void 0,Oe,!1);continue}const nt=N[$](je,Oe),Fe=$%2?a.EXTENT-1:0;Y.x=se(nt[0],Math.min(a.EXTENT-1,nt[1]),Fe,$<2,nt[2]),Y.y=0,g.encodeCentroid(Y,je,!1),Pe&&Se.encodeCentroid(Y,Oe,!1)}else g.encodeCentroid(void 0,je,!1)}g.borderDoneWithNeighborZ[$]=Se.canonical.z,g.needsCentroidUpdate=!0,Pe&&(Se.borderDoneWithNeighborZ[ee]=g.canonical.z,Se.needsCentroidUpdate=!0)}else{for(const Me of ue)g.encodeCentroid(void 0,g.featuresOnBorder[Me],!1);if(Pe){for(const Me of Te)Se.encodeCentroid(void 0,Se.featuresOnBorder[Me],!1);Se.borderDoneWithNeighborZ[ee]=g.canonical.z,Se.needsCentroidUpdate=!0}g.borderDoneWithNeighborZ[$]=Se.canonical.z,g.needsCentroidUpdate=!0}}(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(p)}const hl=new a.Color(1,0,0,1),av=new a.Color(0,1,0,1),lv=new a.Color(0,0,1,1),cv=new a.Color(1,0,1,1),uv=new a.Color(0,1,1,1);function dv(p,s,u){const g=p.context,_=p.transform,b=g.gl,T=_.projection.name==="globe",C=T?["PROJECTION_GLOBE_VIEW"]:null;let A=u.projMatrix;if(T&&a.globeToMercatorTransition(_.zoom)>0){const je=a.transitionTileAABBinECEF(u.canonical,_),rt=a.globeDenormalizeECEF(je);A=a.multiply(new Float32Array(16),_.globeMatrix,rt),a.multiply(A,_.projMatrix,A)}const z=p.useProgram("debug",null,C),R=s.getTileByID(u.key);p.terrain&&p.terrain.setupElevationDraw(R,z);const N=a.DepthMode.disabled,Y=a.StencilMode.disabled,te=p.colorModeForRenderPass(),ie="$debug";g.activeTexture.set(b.TEXTURE0),p.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),T?R._makeGlobeTileDebugBuffers(p.context,_):R._makeDebugTileBoundsBuffers(p.context,_.projection);const re=R._tileDebugBuffer||p.debugBuffer,se=R._tileDebugIndexBuffer||p.debugIndexBuffer,$=R._tileDebugSegments||p.debugSegments;z.draw(g,b.LINE_STRIP,N,Y,te,a.CullFaceMode.disabled,$u(A,a.Color.red),ie,re,se,$,null,null,null,[R._globeTileDebugBorderBuffer]);const ee=R.latestRawTileData,ue=Math.floor((ee&&ee.byteLength||0)/1024),de=s.getTile(u).tileSize,Se=512/Math.min(de,512)*(u.overscaledZ/_.zoom)*.5;let Te=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(Te+=` => ${u.overscaledZ}`),Te+=` ${ue}kb`,function(je,rt){je.initDebugOverlayCanvas();const Oe=je.debugOverlayCanvas,Ke=je.context.gl,$e=je.debugOverlayCanvas.getContext("2d");$e.clearRect(0,0,Oe.width,Oe.height),$e.shadowColor="white",$e.shadowBlur=2,$e.lineWidth=1.5,$e.strokeStyle="white",$e.textBaseline="top",$e.font="bold 36px Open Sans, sans-serif",$e.fillText(rt,5,5),$e.strokeText(rt,5,5),je.debugOverlayTexture.update(Oe),je.debugOverlayTexture.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE)}(p,Te);const Ee=R._tileDebugTextBuffer||p.debugBuffer,Pe=R._tileDebugTextIndexBuffer||p.quadTriangleIndexBuffer,Me=R._tileDebugTextSegments||p.debugSegments;z.draw(g,b.TRIANGLES,N,Y,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,$u(A,a.Color.transparent,Se),ie,Ee,Pe,Me,null,null,null,[R._globeTileDebugTextBuffer])}function wg(p,s,u,g){pl(p,0,s+u/2,p.transform.width,u,g)}function qu(p,s,u,g){pl(p,s-u/2,0,u,p.transform.height,g)}function pl(p,s,u,g,_,b){const T=p.context,C=T.gl;C.enable(C.SCISSOR_TEST),C.scissor(s*a.exported.devicePixelRatio,u*a.exported.devicePixelRatio,g*a.exported.devicePixelRatio,_*a.exported.devicePixelRatio),T.clear({color:b}),C.disable(C.SCISSOR_TEST)}const Sg=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Eg}=Sg;function As(p,s,u,g){p.emplaceBack(s,u,g)}class Hu{constructor(s){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,As(this.vertexArray,-1,-1,1),As(this.vertexArray,1,-1,1),As(this.vertexArray,-1,1,1),As(this.vertexArray,1,1,1),As(this.vertexArray,-1,-1,-1),As(this.vertexArray,1,-1,-1),As(this.vertexArray,-1,1,-1),As(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=s.createVertexBuffer(this.vertexArray,Eg),this.indexBuffer=s.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function uo(p,s,u,g,_,b){const T=p.gl,C=s.paint.get("sky-atmosphere-color"),A=s.paint.get("sky-atmosphere-halo-color"),z=s.paint.get("sky-atmosphere-sun-intensity"),R=((N,Y,te,ie,re)=>({u_matrix_3f:N,u_sun_direction:Y,u_sun_intensity:te,u_color_tint_r:[ie.r,ie.g,ie.b,ie.a],u_color_tint_m:[re.r,re.g,re.b,re.a],u_luminance:5e-5}))(a.fromMat4(a.create$1(),g),_,z,C,A);T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_CUBE_MAP_POSITIVE_X+b,s.skyboxTexture,0),u.draw(p,T.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,R,"skyboxCapture",s.skyboxGeometry.vertexBuffer,s.skyboxGeometry.indexBuffer,s.skyboxGeometry.segment)}const Mc=a.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Tg{constructor(s){const u=new a.StructArrayLayout5f20;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const g=new a.StructArrayLayout3ui6;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=s.createVertexBuffer(u,Mc.members),this.indexBuffer=s.createIndexBuffer(g),this.segments=a.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ia={symbol:function(p,s,u,g,_){if(p.renderPass!=="translucent")return;const b=a.StencilMode.disabled,T=p.colorModeForRenderPass();u.layout.get("text-variable-anchor")&&function(C,A,z,R,N,Y,te){const ie=A.transform,re=N==="map",se=Y==="map";for(const $ of C){const ee=R.getTile($),ue=ee.getBucket(z);if(!ue||!ue.text||!ue.text.segments.get().length)continue;const de=a.evaluateSizeForZoom(ue.textSizeData,ie.zoom),Se=ir($,ue.getProjection(),ie),Te=ie.calculatePixelsToTileUnitsMatrix(ee),Ee=qe(Se,ee.tileID.canonical,se,re,ie,ue.getProjection(),Te),Pe=z.layout.get("icon-text-fit")!=="none"&&ue.hasIconData();if(de){const Me=Math.pow(2,ie.zoom-ee.tileID.overscaledZ);sv(ue,re,se,te,a.symbolSize,ie,Ee,$,Me,de,Pe)}}}(g,p,u,s,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),_),u.paint.get("icon-opacity").constantOr(1)!==0&&xg(p,s,u,g,!1,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),u.layout.get("icon-rotation-alignment"),u.layout.get("icon-pitch-alignment"),u.layout.get("icon-keep-upright"),b,T),u.paint.get("text-opacity").constantOr(1)!==0&&xg(p,s,u,g,!0,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),u.layout.get("text-keep-upright"),b,T),s.map.showCollisionBoxes&&(Ic(p,s,u,g,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),Ic(p,s,u,g,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(p,s,u,g){if(p.renderPass!=="translucent")return;const _=u.paint.get("circle-opacity"),b=u.paint.get("circle-stroke-width"),T=u.paint.get("circle-stroke-opacity"),C=u.layout.get("circle-sort-key").constantOr(1)!==void 0;if(_.constantOr(1)===0&&(b.constantOr(1)===0||T.constantOr(1)===0))return;const A=p.context,z=A.gl,R=p.transform,N=p.depthModeForSublayer(0,a.DepthMode.ReadOnly),Y=a.StencilMode.disabled,te=p.colorModeForRenderPass(),ie=R.projection.name==="globe",re=[a.mercatorXfromLng(R.center.lng),a.mercatorYfromLat(R.center.lat)],se=[];for(let ee=0;ee<g.length;ee++){const ue=g[ee],de=s.getTile(ue),Se=de.getBucket(u);if(!Se||Se.projection.name!==R.projection.name)continue;const Te=Se.programConfigurations.get(u.id),Ee=hp(u);ie&&Ee.push("PROJECTION_GLOBE_VIEW");const Pe=p.useProgram("circle",Te,Ee),Me=Se.layoutVertexBuffer,je=Se.globeExtVertexBuffer,rt=Se.indexBuffer,Oe=R.projection.createInversionMatrix(R,ue.canonical),Ke={programConfiguration:Te,program:Pe,layoutVertexBuffer:Me,globeExtVertexBuffer:je,indexBuffer:rt,uniformValues:dp(p,ue,de,Oe,re,u),tile:de};if(C){const $e=Se.segments.get();for(const nt of $e)se.push({segments:new a.SegmentVector([nt]),sortKey:nt.sortKey,state:Ke})}else se.push({segments:Se.segments,sortKey:0,state:Ke})}C&&se.sort((ee,ue)=>ee.sortKey-ue.sortKey);const $={useDepthForOcclusion:!ie};for(const ee of se){const{programConfiguration:ue,program:de,layoutVertexBuffer:Se,globeExtVertexBuffer:Te,indexBuffer:Ee,uniformValues:Pe,tile:Me}=ee.state,je=ee.segments;p.terrain&&p.terrain.setupElevationDraw(Me,de,$),p.prepareDrawProgram(A,de,Me.tileID.toUnwrapped()),de.draw(A,z.TRIANGLES,N,Y,te,a.CullFaceMode.disabled,Pe,u.id,Se,Ee,je,u.paint,R.zoom,ue,[Te])}},heatmap:function(p,s,u,g){if(u.paint.get("heatmap-opacity")!==0)if(p.renderPass==="offscreen"){const _=p.context,b=_.gl,T=a.StencilMode.disabled,C=new a.ColorMode([b.ONE,b.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(te,ie,re,se){const $=te.gl,ee=ie.width*se,ue=ie.height*se;te.activeTexture.set($.TEXTURE1),te.viewport.set([0,0,ee,ue]);let de=re.heatmapFbo;if(!de||de&&(de.width!==ee||de.height!==ue)){de&&de.destroy();const Se=$.createTexture();$.bindTexture($.TEXTURE_2D,Se),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_S,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_T,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MIN_FILTER,$.LINEAR),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MAG_FILTER,$.LINEAR),de=re.heatmapFbo=te.createFramebuffer(ee,ue,!1),function(Te,Ee,Pe,Me,je,rt){const Oe=Te.gl;Oe.texImage2D(Oe.TEXTURE_2D,0,Te.isWebGL2&&Te.extRenderToTextureHalfFloat?Oe.RGBA16F:Oe.RGBA,je,rt,0,Oe.RGBA,Te.extRenderToTextureHalfFloat?Te.isWebGL2?Oe.HALF_FLOAT:Te.extTextureHalfFloat.HALF_FLOAT_OES:Oe.UNSIGNED_BYTE,null),Me.colorAttachment.set(Pe)}(te,0,Se,de,ee,ue)}else $.bindTexture($.TEXTURE_2D,de.colorAttachment.get()),te.bindFramebuffer.set(de.framebuffer)})(_,p,u,p.transform.projection.name==="globe"?.5:.25),_.clear({color:a.Color.transparent});const A=p.transform,z=A.projection.name==="globe",R=z?["PROJECTION_GLOBE_VIEW"]:null,N=z?a.CullFaceMode.frontCCW:a.CullFaceMode.disabled,Y=[a.mercatorXfromLng(A.center.lng),a.mercatorYfromLat(A.center.lat)];for(let te=0;te<g.length;te++){const ie=g[te];if(s.hasRenderableParent(ie))continue;const re=s.getTile(ie),se=re.getBucket(u);if(!se||se.projection.name!==A.projection.name)continue;const $=se.programConfigurations.get(u.id),ee=p.useProgram("heatmap",$,R),{zoom:ue}=p.transform;p.terrain&&p.terrain.setupElevationDraw(re,ee),p.prepareDrawProgram(_,ee,ie.toUnwrapped());const de=A.projection.createInversionMatrix(A,ie.canonical);ee.draw(_,b.TRIANGLES,a.DepthMode.disabled,T,C,N,gg(p,ie,re,de,Y,ue,u.paint.get("heatmap-intensity")),u.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,u.paint,p.transform.zoom,$,z?[se.globeExtVertexBuffer]:null)}_.viewport.set([0,0,p.width,p.height])}else p.renderPass==="translucent"&&(p.context.setColorMode(p.colorModeForRenderPass()),function(_,b){const T=_.context,C=T.gl,A=b.heatmapFbo;if(!A)return;T.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,A.colorAttachment.get()),T.activeTexture.set(C.TEXTURE1);let z=b.colorRampTexture;z||(z=b.colorRampTexture=new a.Texture(T,b.colorRamp,C.RGBA)),z.bind(C.LINEAR,C.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(T,C.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,_.colorModeForRenderPass(),a.CullFaceMode.disabled,((R,N,Y,te)=>({u_image:0,u_color_ramp:1,u_opacity:N.paint.get("heatmap-opacity")}))(0,b),b.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,b.paint,_.transform.zoom)}(p,u))},line:function(p,s,u,g){if(p.renderPass!=="translucent")return;const _=u.paint.get("line-opacity"),b=u.paint.get("line-width");if(_.constantOr(1)===0||b.constantOr(1)===0)return;const T=p.depthModeForSublayer(0,a.DepthMode.ReadOnly),C=p.colorModeForRenderPass(),A=p.terrain&&p.terrain.renderingToTexture?1:a.exported.devicePixelRatio,z=u.paint.get("line-dasharray"),R=z.constantOr(1),N=u.layout.get("line-cap"),Y=u.paint.get("line-pattern"),te=Y.constantOr(1),ie=u.paint.get("line-gradient"),re=te?"linePattern":"line",se=p.context,$=se.gl,ee=(de=>{const Se=[];kc(de)&&Se.push("RENDER_LINE_DASH"),de.paint.get("line-gradient")&&Se.push("RENDER_LINE_GRADIENT");const Te=de.paint.get("line-trim-offset");Te[0]===0&&Te[1]===0||Se.push("RENDER_LINE_TRIM_OFFSET");const Ee=de.paint.get("line-pattern").constantOr(1),Pe=de.paint.get("line-opacity").constantOr(1)!==1;return!Ee&&Pe&&Se.push("RENDER_LINE_ALPHA_DISCARD"),Se})(u);let ue=ee.includes("RENDER_LINE_ALPHA_DISCARD");p.terrain&&p.terrain.clipOrMaskOverlapStencilType()&&(ue=!1);for(const de of g){const Se=s.getTile(de);if(te&&!Se.patternsLoaded())continue;const Te=Se.getBucket(u);if(!Te)continue;p.prepareDrawTile();const Ee=Te.programConfigurations.get(u.id),Pe=p.useProgram(re,Ee,ee),Me=Y.constantOr(null);if(Me&&Se.imageAtlas){const Ze=Se.imageAtlas.patternPositions[Me.toString()];Ze&&Ee.setConstantPatternPositions(Ze)}const je=z.constantOr(null),rt=N.constantOr(null);if(!te&&je&&rt&&Se.lineAtlas){const Ze=Se.lineAtlas.getDash(je,rt);Ze&&Ee.setConstantPatternPositions(Ze)}let[Oe,Ke]=u.paint.get("line-trim-offset");(rt==="round"||rt==="square")&&Oe!==Ke&&(Oe===0&&(Oe-=1),Ke===1&&(Ke+=1));const $e=p.terrain?de.projMatrix:null,nt=te?Cc(p,Se,u,$e,A):iv(p,Se,u,$e,Te.lineClipsArray.length,A,[Oe,Ke]);if(ie){const Ze=Te.gradients[u.id];let ot=Ze.texture;if(u.gradientVersion!==Ze.version){let Qe=256;if(u.stepInterpolant){const at=s.getSource().maxzoom,Ot=de.canonical.z===at?Math.ceil(1<<p.transform.maxZoom-de.canonical.z):1;Qe=a.clamp(a.nextPowerOfTwo(Te.maxLineLength/a.EXTENT*1024*Ot),256,se.maxTextureSize)}Ze.gradient=a.renderColorRamp({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:Qe,image:Ze.gradient||void 0,clips:Te.lineClipsArray}),Ze.texture?Ze.texture.update(Ze.gradient):Ze.texture=new a.Texture(se,Ze.gradient,$.RGBA),Ze.version=u.gradientVersion,ot=Ze.texture}se.activeTexture.set($.TEXTURE1),ot.bind(u.stepInterpolant?$.NEAREST:$.LINEAR,$.CLAMP_TO_EDGE)}R&&(se.activeTexture.set($.TEXTURE0),Se.lineAtlasTexture.bind($.LINEAR,$.REPEAT),Ee.updatePaintBuffers()),te&&(se.activeTexture.set($.TEXTURE0),Se.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),Ee.updatePaintBuffers()),p.prepareDrawProgram(se,Pe,de.toUnwrapped());const Fe=Ze=>{Pe.draw(se,$.TRIANGLES,T,Ze,C,a.CullFaceMode.disabled,nt,u.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,u.paint,p.transform.zoom,Ee,[Te.layoutVertexBuffer2])};if(ue){const Ze=p.stencilModeForClipping(de).ref;Ze===0&&p.terrain&&se.clear({stencil:0});const ot={func:$.EQUAL,mask:255};nt.u_alpha_discard_threshold=.8,Fe(new a.StencilMode(ot,Ze,255,$.KEEP,$.KEEP,$.INVERT)),nt.u_alpha_discard_threshold=0,Fe(new a.StencilMode(ot,Ze,255,$.KEEP,$.KEEP,$.KEEP))}else Fe(p.stencilModeForClipping(de))}ue&&(p.resetStencilClippingMasks(),p.terrain&&se.clear({stencil:0}))},fill:function(p,s,u,g){const _=u.paint.get("fill-color"),b=u.paint.get("fill-opacity");if(b.constantOr(1)===0)return;const T=p.colorModeForRenderPass(),C=u.paint.get("fill-pattern"),A=p.opaquePassEnabledForLayer()&&!C.constantOr(1)&&_.constantOr(a.Color.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent";if(p.renderPass===A){const z=p.depthModeForSublayer(1,p.renderPass==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);vg(p,s,u,g,z,T,!1)}if(p.renderPass==="translucent"&&u.paint.get("fill-antialias")){const z=p.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);vg(p,s,u,g,z,T,!0)}},"fill-extrusion":function(p,s,u,g){const _=u.paint.get("fill-extrusion-opacity");if(_!==0&&p.renderPass==="translucent"){const b=new a.DepthMode(p.context.gl.LEQUAL,a.DepthMode.ReadWrite,p.depthRangeFor3D);if(_!==1||u.paint.get("fill-extrusion-pattern").constantOr(1))Gu(p,s,u,g,b,a.StencilMode.disabled,a.ColorMode.disabled),Gu(p,s,u,g,b,p.stencilModeFor3D(),p.colorModeForRenderPass()),p.resetStencilClippingMasks();else{const T=p.colorModeForRenderPass();Gu(p,s,u,g,b,a.StencilMode.disabled,T)}}},hillshade:function(p,s,u,g){if(p.renderPass!=="offscreen"&&p.renderPass!=="translucent")return;const _=p.context,b=p.depthModeForSublayer(0,a.DepthMode.ReadOnly),T=p.colorModeForRenderPass(),C=p.terrain&&p.terrain.renderingToTexture,[A,z]=p.renderPass!=="translucent"||C?[{},g]:p.stencilConfigForOverlap(g);for(const R of z){const N=s.getTile(R);if(N.needsHillshadePrepare&&p.renderPass==="offscreen")dg(p,N,u,b,a.StencilMode.disabled,T);else if(p.renderPass==="translucent"){const Y=C&&p.terrain?p.terrain.stencilModeForRTTOverlap(R):A[R.overscaledZ];ug(p,R,N,u,b,Y,T)}}_.viewport.set([0,0,p.width,p.height]),p.resetStencilClippingMasks()},raster:function(p,s,u,g,_,b){if(p.renderPass!=="translucent"||u.paint.get("raster-opacity")===0||!g.length)return;const T=p.context,C=T.gl,A=s.getSource(),z=p.useProgram("raster"),R=p.colorModeForRenderPass(),N=p.terrain&&p.terrain.renderingToTexture,[Y,te]=A instanceof sn||N?[{},g]:p.stencilConfigForOverlap(g),ie=te[te.length-1].overscaledZ,re=!p.options.moving;for(const se of te){const $=N?a.DepthMode.disabled:p.depthModeForSublayer(se.overscaledZ-ie,u.paint.get("raster-opacity")===1?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,C.LESS),ee=se.toUnwrapped(),ue=s.getTile(se);if(N&&(!ue||!ue.hasData()))continue;const de=N?se.projMatrix:p.transform.calculateProjMatrix(ee,re),Se=p.terrain&&N?p.terrain.stencilModeForRTTOverlap(se):Y[se.overscaledZ],Te=b?0:u.paint.get("raster-fade-duration");ue.registerFadeDuration(Te);const Ee=s.findLoadedParent(se,0),Pe=sp(ue,Ee,s,p.transform,Te);let Me,je;p.terrain&&p.terrain.prepareDrawTile();const rt=u.paint.get("raster-resampling")==="nearest"?C.NEAREST:C.LINEAR;T.activeTexture.set(C.TEXTURE0),ue.texture.bind(rt,C.CLAMP_TO_EDGE),T.activeTexture.set(C.TEXTURE1),Ee?(Ee.texture.bind(rt,C.CLAMP_TO_EDGE),Me=Math.pow(2,Ee.tileID.overscaledZ-ue.tileID.overscaledZ),je=[ue.tileID.canonical.x*Me%1,ue.tileID.canonical.y*Me%1]):ue.texture.bind(rt,C.CLAMP_TO_EDGE),ue.texture.useMipmap&&T.extTextureFilterAnisotropic&&p.transform.pitch>20&&C.texParameterf(C.TEXTURE_2D,T.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,T.extTextureFilterAnisotropicMax);const Oe=mp(de,je||[0,0],Me||1,Pe,u,A instanceof sn?A.perspectiveTransform:[0,0]);if(p.prepareDrawProgram(T,z,ee),A instanceof sn)A.boundsBuffer&&A.boundsSegments&&z.draw(T,C.TRIANGLES,$,a.StencilMode.disabled,R,a.CullFaceMode.disabled,Oe,u.id,A.boundsBuffer,p.quadTriangleIndexBuffer,A.boundsSegments);else{const{tileBoundsBuffer:Ke,tileBoundsIndexBuffer:$e,tileBoundsSegments:nt}=p.getTileBoundsBuffers(ue);z.draw(T,C.TRIANGLES,$,Se,R,a.CullFaceMode.disabled,Oe,u.id,Ke,$e,nt)}}p.resetStencilClippingMasks()},background:function(p,s,u,g){const _=u.paint.get("background-color"),b=u.paint.get("background-opacity");if(b===0)return;const T=p.context,C=T.gl,A=p.transform,z=A.tileSize,R=u.paint.get("background-pattern");if(p.isPatternMissing(R))return;const N=!R&&_.a===1&&b===1&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==N)return;const Y=a.StencilMode.disabled,te=p.depthModeForSublayer(0,N==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),ie=p.colorModeForRenderPass(),re=p.useProgram(R?"backgroundPattern":"background");let se,$=g;$||(se=p.getBackgroundTiles(),$=Object.values(se).map(ee=>ee.tileID)),R&&(T.activeTexture.set(C.TEXTURE0),p.imageManager.bind(p.context));for(const ee of $){const ue=ee.toUnwrapped(),de=g?ee.projMatrix:p.transform.calculateProjMatrix(ue);p.prepareDrawTile();const Se=s?s.getTile(ee):se?se[ee.key]:new a.Tile(ee,z,A.zoom,p),Te=R?ov(de,b,p,R,{tileID:ee,tileSize:z}):yp(de,b,_);p.prepareDrawProgram(T,re,ue);const{tileBoundsBuffer:Ee,tileBoundsIndexBuffer:Pe,tileBoundsSegments:Me}=p.getTileBoundsBuffers(Se);re.draw(T,C.TRIANGLES,te,Y,ie,a.CullFaceMode.disabled,Te,u.id,Ee,Pe,Me)}},sky:function(p,s,u){const g=p.transform,_=g.projection.name==="mercator"||g.projection.name==="globe"?1:a.smoothstep(7,8,g.zoom),b=u.paint.get("sky-opacity")*_;if(b===0)return;const T=p.context,C=u.paint.get("sky-type"),A=new a.DepthMode(T.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),z=p.frameCounter/1e3%1;C==="atmosphere"?p.renderPass==="offscreen"?u.needsSkyboxCapture(p)&&(function(R,N,Y,te){const ie=R.context,re=ie.gl;let se=N.skyboxFbo;if(!se){se=N.skyboxFbo=ie.createFramebuffer(32,32,!1),N.skyboxGeometry=new Hu(ie),N.skyboxTexture=ie.gl.createTexture(),re.bindTexture(re.TEXTURE_CUBE_MAP,N.skyboxTexture),re.texParameteri(re.TEXTURE_CUBE_MAP,re.TEXTURE_WRAP_S,re.CLAMP_TO_EDGE),re.texParameteri(re.TEXTURE_CUBE_MAP,re.TEXTURE_WRAP_T,re.CLAMP_TO_EDGE),re.texParameteri(re.TEXTURE_CUBE_MAP,re.TEXTURE_MIN_FILTER,re.LINEAR),re.texParameteri(re.TEXTURE_CUBE_MAP,re.TEXTURE_MAG_FILTER,re.LINEAR);for(let de=0;de<6;++de)re.texImage2D(re.TEXTURE_CUBE_MAP_POSITIVE_X+de,0,re.RGBA,32,32,0,re.RGBA,re.UNSIGNED_BYTE,null)}ie.bindFramebuffer.set(se.framebuffer),ie.viewport.set([0,0,32,32]);const $=N.getCenter(R,!0),ee=R.useProgram("skyboxCapture"),ue=new Float64Array(16);a.identity(ue),a.rotateY(ue,ue,.5*-Math.PI),uo(ie,N,ee,ue,$,0),a.identity(ue),a.rotateY(ue,ue,.5*Math.PI),uo(ie,N,ee,ue,$,1),a.identity(ue),a.rotateX(ue,ue,.5*-Math.PI),uo(ie,N,ee,ue,$,2),a.identity(ue),a.rotateX(ue,ue,.5*Math.PI),uo(ie,N,ee,ue,$,3),a.identity(ue),uo(ie,N,ee,ue,$,4),a.identity(ue),a.rotateY(ue,ue,Math.PI),uo(ie,N,ee,ue,$,5),ie.viewport.set([0,0,R.width,R.height])}(p,u),u.markSkyboxValid(p)):p.renderPass==="sky"&&function(R,N,Y,te,ie){const re=R.context,se=re.gl,$=R.transform,ee=R.useProgram("skybox");re.activeTexture.set(se.TEXTURE0),se.bindTexture(se.TEXTURE_CUBE_MAP,N.skyboxTexture);const ue=((de,Se,Te,Ee,Pe)=>({u_matrix:de,u_sun_direction:Se,u_cubemap:0,u_opacity:Ee,u_temporal_offset:Pe}))($.skyboxMatrix,N.getCenter(R,!1),0,te,ie);R.prepareDrawProgram(re,ee),ee.draw(re,se.TRIANGLES,Y,a.StencilMode.disabled,R.colorModeForRenderPass(),a.CullFaceMode.backCW,ue,"skybox",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)}(p,u,A,b,z):C==="gradient"&&p.renderPass==="sky"&&function(R,N,Y,te,ie){const re=R.context,se=re.gl,$=R.transform,ee=R.useProgram("skyboxGradient");N.skyboxGeometry||(N.skyboxGeometry=new Hu(re)),re.activeTexture.set(se.TEXTURE0);let ue=N.colorRampTexture;ue||(ue=N.colorRampTexture=new a.Texture(re,N.colorRamp,se.RGBA)),ue.bind(se.LINEAR,se.CLAMP_TO_EDGE);const de=((Se,Te,Ee,Pe,Me)=>({u_matrix:Se,u_color_ramp:0,u_center_direction:Te,u_radius:a.degToRad(Ee),u_opacity:Pe,u_temporal_offset:Me}))($.skyboxMatrix,N.getCenter(R,!1),N.paint.get("sky-gradient-radius"),te,ie);R.prepareDrawProgram(re,ee),ee.draw(re,se.TRIANGLES,Y,a.StencilMode.disabled,R.colorModeForRenderPass(),a.CullFaceMode.backCW,de,"skyboxGradient",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)}(p,u,A,b,z)},debug:function(p,s,u){for(let g=0;g<u.length;g++)dv(p,s,u[g])},custom:function(p,s,u,g){const _=p.context,b=u.implementation;if(!p.transform.projection.unsupportedLayers||!p.transform.projection.unsupportedLayers.includes("custom")||p.terrain&&(p.terrain.renderingToTexture||p.renderPass==="offscreen")&&u.isLayerDraped()){if(p.renderPass==="offscreen"){const T=b.prerender;if(T){if(p.setCustomLayerDefaults(),_.setColorMode(p.colorModeForRenderPass()),p.transform.projection.name==="globe"){const C=p.transform.pointMerc;T.call(b,_.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(p.transform.zoom),[C.x,C.y],p.transform.pixelsPerMeterRatio)}else T.call(b,_.gl,p.transform.customLayerMatrix());_.setDirty(),p.setBaseState()}}else if(p.renderPass==="translucent"){if(p.terrain&&p.terrain.renderingToTexture){const C=b.renderToTile;if(C){const A=g[0].canonical,z=new a.MercatorCoordinate(A.x+g[0].wrap*(1<<A.z),A.y,A.z);_.setDepthMode(a.DepthMode.disabled),_.setStencilMode(a.StencilMode.disabled),_.setColorMode(p.colorModeForRenderPass()),p.setCustomLayerDefaults(),C.call(b,_.gl,z),_.setDirty(),p.setBaseState()}return}p.setCustomLayerDefaults(),_.setColorMode(p.colorModeForRenderPass()),_.setStencilMode(a.StencilMode.disabled);const T=b.renderingMode==="3d"?new a.DepthMode(p.context.gl.LEQUAL,a.DepthMode.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,a.DepthMode.ReadOnly);if(_.setDepthMode(T),p.transform.projection.name==="globe"){const C=p.transform.pointMerc;b.render(_.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(p.transform.zoom),[C.x,C.y],p.transform.pixelsPerMeterRatio)}else b.render(_.gl,p.transform.customLayerMatrix());_.setDirty(),p.setBaseState(),_.bindFramebuffer.set(null)}}else a.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class fl{constructor(s,u,g=!1){this.context=new pt(s,g),this.transform=u,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(s,u){const g=!!s&&!!s.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new lp(this,s));const _=this._terrain;this.transform.elevation=g?_:null,_.update(s,this.transform,u)}_updateFog(s){const u=s.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,_]=u.getFovAdjustedRange(this.transform._fov);if(g>_)return void(this.transform.fogCullDistSq=null);const b=g+.78*(_-g);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(s,u){if(this.width=s*a.exported.devicePixelRatio,this.height=u*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._layers[g].resize()}setup(){const s=this.context,u=new a.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(a.EXTENT,0),u.emplaceBack(0,a.EXTENT),u.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(u,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const g=new a.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(a.EXTENT,0),g.emplaceBack(0,a.EXTENT),g.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=s.createVertexBuffer(g,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const _=new a.StructArrayLayout2i4;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(_,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const b=new a.StructArrayLayout4i8;b.emplaceBack(0,0,0,0),b.emplaceBack(a.EXTENT,0,a.EXTENT,0),b.emplaceBack(0,a.EXTENT,0,a.EXTENT),b.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=s.createVertexBuffer(b,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const T=new a.StructArrayLayout3ui6;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(T);const C=new a.StructArrayLayout1ui2;for(const z of[0,1,3,2,0])C.emplaceBack(z);this.debugIndexBuffer=s.createIndexBuffer(C),this.emptyTexture=new a.Texture(s,new a.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),s.gl.RGBA),this.identityMat=a.create();const A=this.context.gl;this.stencilClearMode=new a.StencilMode({func:A.ALWAYS,mask:0},0,255,A.ZERO,A.ZERO,A.ZERO),this.loadTimeStamps.push(a.window.performance.now()),this.atmosphereBuffer=new Tg(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(s){return s._makeTileBoundsBuffers(this.context,this.transform.projection),s._tileBoundsBuffer?{tileBoundsBuffer:s._tileBoundsBuffer,tileBoundsIndexBuffer:s._tileBoundsIndexBuffer,tileBoundsSegments:s._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const s=this.context,u=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(s,u.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,Ec(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(s,u,g){if(!u||this.currentStencilSource===u.id||!s.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let C=!1;for(const A of g)if(this._tileClippingMaskIDs[A.key]===void 0){C=!0;break}if(!C)return}this.currentStencilSource=u.id;const _=this.context,b=_.gl;this.nextStencilID+g.length>256&&this.clearStencil(),_.setColorMode(a.ColorMode.disabled),_.setDepthMode(a.DepthMode.disabled);const T=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const C of g){const A=u.getTile(C),z=this._tileClippingMaskIDs[C.key]=this.nextStencilID++,{tileBoundsBuffer:R,tileBoundsIndexBuffer:N,tileBoundsSegments:Y}=this.getTileBoundsBuffers(A);T.draw(_,b.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:b.ALWAYS,mask:0},z,255,b.KEEP,b.KEEP,b.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Ec(C.projMatrix),"$clipping",R,N,Y)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,u=this.context.gl;return new a.StencilMode({func:u.NOTEQUAL,mask:255},s,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(s){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(s);const u=this.context.gl;return new a.StencilMode({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(s){const u=this.context.gl,g=s.sort((T,C)=>C.overscaledZ-T.overscaledZ),_=g[g.length-1].overscaledZ,b=g[0].overscaledZ-_+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const T={};for(let C=0;C<b;C++)T[C+_]=new a.StencilMode({func:u.GEQUAL,mask:255},C+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=b,[T,g]}return[{[_]:a.StencilMode.disabled},g]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new a.ColorMode([s.CONSTANT_COLOR,s.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(s,u,g){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new a.DepthMode(g||this.context.gl.LEQUAL,u,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(s,u){this.style=s,this.options=u,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const g=this.style.order,_=this.style._sourceCaches;for(const z in _){const R=_[z];R.used&&R.prepare(this.context)}const b={},T={},C={};for(const z in _){const R=_[z];b[z]=R.getVisibleCoordinates(),T[z]=b[z].slice().reverse(),C[z]=R.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let z=0;z<g.length;z++)if(this.style._layers[g[z]].is3D()){this.opaquePassCutoff=z;break}if(this.terrain&&(this.terrain.updateTileBinding(C),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),!a.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const z of g){const R=this.style._layers[z],N=s._getLayerSourceCache(R);if(!R.hasOffscreenPass()||R.isHidden(this.transform.zoom))continue;const Y=N?T[N.id]:void 0;(R.type==="custom"||R.isSky()||Y&&Y.length)&&this.renderLayer(this,N,R,Y)}this.depthRangeFor3D=[0,1-(s.order.length+2)*this.numSublayers*this.depthEpsilon];const A=this.terrain;if(A&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&A.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:u.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const z=this.style._layers[g[this.currentLayer]],R=s._getLayerSourceCache(z);if(z.isSky())continue;const N=R?T[R.id]:void 0;this._renderTileClippingMasks(z,R,N),this.renderLayer(this,R,z,N)}if(this.style.fog&&this.transform.projection.supportsFog&&function(z,R){const N=z.context,Y=N.gl,te=z.transform,ie=new a.DepthMode(Y.LEQUAL,a.DepthMode.ReadOnly,[0,1]),re=z.useProgram("globeAtmosphere",null,te.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),se=a.globeToMercatorTransition(te.zoom),$=R.properties.get("color").toArray01(),ee=R.properties.get("high-color").toArray01(),ue=R.properties.get("space-color").toArray01PremultipliedAlpha(),de=a.identity$1([]);a.rotateY$1(de,de,-a.degToRad(te._center.lng)),a.rotateX$1(de,de,a.degToRad(te._center.lat)),a.rotateZ$1(de,de,te.angle),a.rotateX$1(de,de,-te._pitch);const Se=a.fromQuat(new Float32Array(16),de),Te=a.mapValue(R.properties.get("star-intensity"),0,1,0,.25),Ee=5e-4,Pe=a.mapValue(R.properties.get("horizon-blend"),0,1,Ee,.25),Me=a.globeUseCustomAntiAliasing(z,N,te)&&Pe===Ee?te.worldSize/(2*Math.PI*1.025)-1:te.globeRadius,je=z.frameCounter/1e3%1,rt=a.length(te.globeCenterInViewSpace),Oe=Math.sqrt(Math.pow(rt,2)-Math.pow(Me,2)),Ke=Math.acos(Oe/rt),$e=((Fe,Ze,ot,Qe,at,Ot,Ht,At,Ut,dn,ln,Lt,Pn,Bn)=>({u_frustum_tl:Fe,u_frustum_tr:Ze,u_frustum_br:ot,u_frustum_bl:Qe,u_horizon:at,u_transition:Ot,u_fadeout_range:Ht,u_color:At,u_high_color:Ut,u_space_color:dn,u_star_intensity:ln,u_star_size:5*a.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Lt,u_horizon_angle:Pn,u_rotation_matrix:Bn}))(te.frustumCorners.TL,te.frustumCorners.TR,te.frustumCorners.BR,te.frustumCorners.BL,te.frustumCorners.horizon,se,Pe,$,ee,ue,Te,je,Ke,Se);z.prepareDrawProgram(N,re);const nt=z.atmosphereBuffer;nt&&re.draw(N,Y.TRIANGLES,ie,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,$e,"skybox",nt.vertexBuffer,nt.indexBuffer,nt.segments)}(this,this.style.fog),this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const z=this.style._layers[g[this.currentLayer]],R=s._getLayerSourceCache(z);z.isSky()&&this.renderLayer(this,R,z,R?T[R.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;){const z=this.style._layers[g[this.currentLayer]],R=s._getLayerSourceCache(z);if(z.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(z)){if(z.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const N=R?(z.type==="symbol"?C:T)[R.id]:void 0;this._renderTileClippingMasks(z,R,R?b[R.id]:void 0),this.renderLayer(this,R,z,N),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let z=null;a.values(this.style._layers).forEach(R=>{const N=s._getLayerSourceCache(R);N&&!R.isHidden(this.transform.zoom)&&(!z||z.getSource().maxzoom<N.getSource().maxzoom)&&(z=N)}),z&&this.options.showTileBoundaries&&Ia.debug(this,z,z.getVisibleCoordinates())}this.options.showPadding&&function(z){const R=z.transform.padding;wg(z,z.transform.height-(R.top||0),3,hl),wg(z,R.bottom||0,3,av),qu(z,R.left||0,3,lv),qu(z,z.transform.width-(R.right||0),3,cv);const N=z.transform.centerPoint;(function(Y,te,ie,re){pl(Y,te-1,ie-10,2,20,re),pl(Y,te-10,ie-1,20,2,re)})(z,N.x,z.transform.height-N.y,uv)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}renderLayer(s,u,g,_){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||_&&_.length)&&(this.id=g.id,this.gpuTimingStart(g),(!s.transform.projection.unsupportedLayers||!s.transform.projection.unsupportedLayers.includes(g.type)||s.terrain&&g.type==="custom")&&Ia[g.type](s,u,g,_,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;let g=this.gpuTimers[s.id];g||(g=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),g.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,g.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const s=this.context.extTimerQuery,u=s.createQueryEXT();this.deferredRenderGpuTimeQueries.push(u),s.beginQueryEXT(s.TIME_ELAPSED_EXT,u)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}collectGpuTimers(){const s=this.gpuTimers;return this.gpuTimers={},s}collectDeferredRenderGpuQueries(){const s=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],s}queryGpuTimers(s){const u={};for(const g in s){const _=s[g],b=this.context.extTimerQuery,T=b.getQueryObjectEXT(_.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(_.query),u[g]=T}return u}queryGpuTimeDeferredRender(s){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.extTimerQuery;let g=0;for(const _ of s)g+=u.getQueryObjectEXT(_,u.QUERY_RESULT_EXT)/1e6,u.deleteQueryEXT(_);return g}translatePosMatrix(s,u,g,_,b){if(!g[0]&&!g[1])return s;const T=b?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(T){const z=Math.sin(T),R=Math.cos(T);g=[g[0]*R-g[1]*z,g[0]*z+g[1]*R]}const C=[b?g[0]:st(u,g[0],this.transform.zoom),b?g[1]:st(u,g[1],this.transform.zoom),0],A=new Float32Array(16);return a.translate(A,s,C),A}saveTileTexture(s){const u=this._tileTextures[s.size[0]];u?u.push(s):this._tileTextures[s.size[0]]=[s]}getTileTexture(s){const u=this._tileTextures[s];return u&&u.length>0?u.pop():null}isPatternMissing(s){return s===null||s!==void 0&&!this.imageManager.getPattern(s.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const s=this.terrain&&this.terrain.renderingToTexture,u=this.terrain&&this.terrain.exaggeration()===0,g=this.style&&this.style.fog,_=[];return this.terrainRenderModeElevated()&&_.push("TERRAIN"),this.transform.projection.name==="globe"&&_.push("GLOBE"),u&&_.push("ZERO_EXAGGERATION"),g&&!s&&g.getOpacity(this.transform.pitch)!==0&&_.push("FOG"),s&&_.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&_.push("OVERDRAW_INSPECTOR"),_}useProgram(s,u,g){this.cache=this.cache||{};const _=g||[],b=this.currentGlobalDefines().concat(_),T=gn.cacheKey(np[s],s,b,u);return this.cache[T]||(this.cache[T]=new gn(this.context,s,np[s],u,_p[s],b)),this.cache[T]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(s,u,g){if(this.terrain&&this.terrain.renderingToTexture)return;const _=this.style.fog;if(_){const b=_.getOpacity(this.transform.pitch),T=((C,A,z,R,N,Y,te,ie,re,se,$)=>{const ee=C.transform,ue=A.properties.get("color").toArray01();ue[3]=R;const de=C.frameCounter/1e3%1;return{u_fog_matrix:z?ee.calculateFogTileMatrix(z):C.identityMat,u_fog_range:A.getFovAdjustedRange(ee._fov),u_fog_color:ue,u_fog_horizon_blend:A.properties.get("horizon-blend"),u_fog_temporal_offset:de,u_frustum_tl:N,u_frustum_tr:Y,u_frustum_br:te,u_frustum_bl:ie,u_globe_pos:re,u_globe_radius:se,u_viewport:$,u_globe_transition:a.globeToMercatorTransition(ee.zoom),u_is_globe:+(ee.projection.name==="globe")}})(this,_,g,b,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.exported.devicePixelRatio,this.transform.height*a.exported.devicePixelRatio]);u.setFogUniformValues(s,T)}}setTileLoadedFlag(s){this.tileLoaded=s}saveCanvasCopy(){const s=this.canvasCopy();s&&(this.frameCopies.push(s),this.tileLoaded=!1)}canvasCopy(){const s=this.context.gl,u=s.createTexture();return s.bindTexture(s.TEXTURE_2D,u),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,s.drawingBufferWidth,s.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const s=this.style&&this.style.fog;return!!s&&s.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const s=this._backgroundTiles,u=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const _ of g)u[_.key]=s[_.key]||new a.Tile(_,512,this.transform.tileZoom,this);return u}clearBackgroundTiles(){this._backgroundTiles={}}}class Zu{constructor(s=0,u=0,g=0,_=0){if(isNaN(s)||s<0||isNaN(u)||u<0||isNaN(g)||g<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=u,this.left=g,this.right=_}interpolate(s,u,g){return u.top!=null&&s.top!=null&&(this.top=a.number(s.top,u.top,g)),u.bottom!=null&&s.bottom!=null&&(this.bottom=a.number(s.bottom,u.bottom,g)),u.left!=null&&s.left!=null&&(this.left=a.number(s.left,u.left,g)),u.right!=null&&s.right!=null&&(this.right=a.number(s.right,u.right,g)),this}getCenter(s,u){const g=a.clamp((this.left+s-this.right)/2,0,s),_=a.clamp((this.top+u-this.bottom)/2,0,u);return new a.Point(g,_)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new Zu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Xu(p,s){const u=a.getColumn(p,3);a.fromQuat(p,s),a.setColumn(p,3,u)}function xn(p,s){const u=a.identity$1([]);return a.rotateZ$1(u,u,-s),a.rotateX$1(u,u,-p),u}function Pc(p,s){const u=[p[0],p[1],0],g=[s[0],s[1],0];if(a.length(u)>=1e-15){const T=a.normalize([],u);a.scale$2(g,T,a.dot(g,T)),s[0]=g[0],s[1]=g[1]}const _=a.cross([],s,p);if(a.len(_)<1e-15)return null;const b=Math.atan2(-_[1],_[0]);return xn(Math.atan2(Math.sqrt(p[0]*p[0]+p[1]*p[1]),-p[2]),b)}class Cg{constructor(s,u){this.position=s,this.orientation=u}get position(){return this._position}set position(s){if(s){const u=s instanceof a.MercatorCoordinate?s:new a.MercatorCoordinate(s[0],s[1],s[2]);this._renderWorldCopies&&(u.x=a.wrap(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(s,u){if(this.orientation=null,!this.position)return;const g=this.position,_=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(s)):0,b=a.MercatorCoordinate.fromLngLat(s,_),T=[b.x-g.x,b.y-g.y,b.z-g.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=Pc(T,u)}setPitchBearing(s,u){this.orientation=xn(a.degToRad(s),a.degToRad(-u))}}class Ku{constructor(s,u){this._transform=a.identity([]),this.orientation=u,this.position=s}get mercatorPosition(){const s=this.position;return new a.MercatorCoordinate(s[0],s[1],s[2])}get position(){const s=a.getColumn(this._transform,3);return[s[0],s[1],s[2]]}set position(s){var u;s&&a.setColumn(this._transform,3,[(u=s)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(s){this._orientation=s||a.identity$1([]),s&&Xu(this._transform,this._orientation)}getPitchBearing(){const s=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(s[0]*s[0]+s[1]*s[1]),-s[2])}}setPitchBearing(s,u){this._orientation=xn(s,u),Xu(this._transform,this._orientation)}forward(){const s=a.getColumn(this._transform,2);return[-s[0],-s[1],-s[2]]}up(){const s=a.getColumn(this._transform,1);return[-s[0],-s[1],-s[2]]}right(){const s=a.getColumn(this._transform,0);return[s[0],s[1],s[2]]}getCameraToWorld(s,u){const g=new Float64Array(16);return a.invert(g,this.getWorldToCamera(s,u)),g}getWorldToCameraPosition(s,u,g){const _=this.position;a.scale$2(_,_,-s);const b=new Float64Array(16);return a.fromScaling(b,[g,g,g]),a.translate(b,b,_),b[10]*=u,b}getWorldToCamera(s,u){const g=new Float64Array(16),_=new Float64Array(4),b=this.position;return a.conjugate(_,this._orientation),a.scale$2(b,b,-s),a.fromQuat(g,_),a.translate(g,g,b),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=u,g[9]*=u,g[10]*=u,g[11]*=u,g}getCameraToClipPerspective(s,u,g,_){const b=new Float64Array(16);return a.perspective(b,s,u,g,_),b}getDistanceToElevation(s,u=!1){const g=s===0?0:a.mercatorZfromAltitude(s,u?a.latFromMercatorY(this.position[1]):this.position[1]),_=this.forward();return(g-this.position[2])/_[2]}clone(){return new Ku([...this.position],[...this.orientation])}}function ml(p,s){const u=Yu(p.projection,p.zoom,p.width,p.height),g=function(b,T,C,A,z){const R=new a.LngLat(C.lng-180*Ms,C.lat),N=new a.LngLat(C.lng+180*Ms,C.lat),Y=b.project(R.lng,R.lat),te=b.project(N.lng,N.lat),ie=-Math.atan2(te.y-Y.y,te.x-Y.x),re=a.MercatorCoordinate.fromLngLat(C);re.y=a.clamp(re.y,-1+Ms,1-Ms);const se=re.toLngLat(),$=b.project(se.lng,se.lat),ee=a.MercatorCoordinate.fromLngLat(se);ee.x+=Ms;const ue=ee.toLngLat(),de=b.project(ue.lng,ue.lat),Se=Ju(de.x-$.x,de.y-$.y,ie),Te=a.MercatorCoordinate.fromLngLat(se);Te.y+=Ms;const Ee=Te.toLngLat(),Pe=b.project(Ee.lng,Ee.lat),Me=Ju(Pe.x-$.x,Pe.y-$.y,ie),je=Math.abs(Se.x)/Math.abs(Me.y),rt=a.identity([]);a.rotateZ(rt,rt,-ie*(1-(z?0:A)));const Oe=a.identity([]);return a.scale(Oe,Oe,[1,1-(1-je)*A,1]),Oe[4]=-Me.x/Me.y*A,a.rotateZ(Oe,Oe,ie),a.multiply(Oe,rt,Oe),Oe}(p.projection,0,p.center,u,s),_=kg(p);return a.scale(g,g,[_,_,1]),g}function kg(p){const s=p.projection,u=Yu(p.projection,p.zoom,p.width,p.height),g=Ig(s,p.center),_=Ig(s,a.LngLat.convert(s.center));return Math.pow(2,g*u+(1-u)*_)}function Yu(p,s,u,g,_=1/0){const b=p.range;if(!b)return 0;const T=Math.min(_,Math.max(u,g)),C=Math.log(T/1024)/Math.LN2;return a.smoothstep(b[0]+C,b[1]+C,s)}const Ms=1/4e4;function Ig(p,s){const u=a.clamp(s.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),g=new a.LngLat(s.lng-180*Ms,u),_=new a.LngLat(s.lng+180*Ms,u),b=p.project(g.lng,u),T=p.project(_.lng,u),C=a.MercatorCoordinate.fromLngLat(g),A=a.MercatorCoordinate.fromLngLat(_),z=T.x-b.x,R=T.y-b.y,N=A.x-C.x,Y=A.y-C.y,te=Math.sqrt((N*N+Y*Y)/(z*z+R*R));return Math.log(te)/Math.LN2}function Ju(p,s,u){const g=Math.cos(u),_=Math.sin(u);return{x:p*g-s*_,y:p*_+s*g}}class gl{constructor(s,u,g,_,b,T,C){this.tileSize=512,this._renderWorldCopies=b===void 0||b,this._minZoom=s||0,this._maxZoom=u||22,this._minPitch=g??0,this._maxPitch=_??60,this.setProjection(T),this.setMaxBounds(C),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Zu,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Ku,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const s=new gl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return s._elevation=this._elevation,s._centerAltitude=this._centerAltitude,s._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,s.tileSize=this.tileSize,s.mercatorFromTransition=this.mercatorFromTransition,s.width=this.width,s.height=this.height,s.cameraElevationReference=this.cameraElevationReference,s._center=this._center,s._setZoom(this.zoom),s._seaLevelZoom=this._seaLevelZoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._nearZ=this._nearZ,s._farZ=this._farZ,s._averageElevation=this._averageElevation,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._camera=this._camera.clone(),s._calcMatrices(),s.freezeTileCoverage=this.freezeTileCoverage,s.frustumCorners=this.frustumCorners,s}get elevation(){return this._elevation}set elevation(s){this._elevation!==s&&(this._elevation=s,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(s,u=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(s||g)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(s){this.projectionOptions=s||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=a.getProjection(this.projectionOptions);const g=!E(u,this.getProjection());return g&&this._calcMatrices(),this.mercatorFromTransition=!1,g}setMercatorFromTransition(){const s=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.getProjection({name:"mercator"});const u=s!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get cameraWorldSize(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.Point(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(s){this.rotation=s}get rotation(){return-this.angle/Math.PI*180}set rotation(s){const u=-s*Math.PI/180;var g;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(g=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g),function(_,b,T){var C=b[0],A=b[1],z=b[2],R=b[3],N=Math.sin(T),Y=Math.cos(T);_[0]=C*Y+z*N,_[1]=A*Y+R*N,_[2]=C*-N+z*Y,_[3]=A*-N+R*Y}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const u=a.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const s=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/s)}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=a.degToRad(s),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(s){this._averageElevation=s,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(s){const u=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(s){this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const s=this._elevation;this._centerAltitude=s.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=s.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const s=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let _=0,b=0;for(let T=0;T<u.length;T++){const C=new a.Point(u[T][0]*this.width,g+u[T][1]*(this.height-g)),A=s.pointCoordinate(C);if(!A)continue;const z=1/Math.hypot(A[0]-this._camera.position[0],A[1]-this._camera.position[1]);_+=A[3]*z,b+=z}return b===0?NaN:_/b}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const s=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*u,_=this._mercatorZfromZoom(s),b=this._mercatorZfromZoom(this._maxZoom),T=Math.max(_-g,b);this._setZoom(this._zoomFromMercatorZ(T))}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}computeZoomRelativeTo(s){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,s.toAltitude()));let g;g=s.z<this._camera.position[2]?[u.x,u.y,u.z]:[s.x,s.y,s.z];const _=a.length(a.sub([],this._camera.position,g));return a.clamp(this._zoomFromMercatorZ(_),this._minZoom,this._maxZoom)}setFreeCameraOptions(s){if(!this.height||!s.position&&!s.orientation)return;this._updateCameraState();let u=!1;if(s.orientation&&!a.exactEquals(s.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(s.orientation)),s.position){const g=[s.position.x,s.position.y,s.position.z];a.exactEquals$1(g,this._camera.position)||(this._setCameraPosition(g),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const s=this._camera.position,u=new Cg;return u.position=new a.MercatorCoordinate(s[0],s[1],s[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(s){if(!a.length$1(s))return!1;a.normalize$1(s,s);const u=a.transformQuat([],[0,0,-1],s),g=a.transformQuat([],[0,-1,0],s);if(g[2]<0)return!1;const _=Pc(u,g);return!!_&&(this._camera.orientation=_,!0)}_setCameraPosition(s){const u=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,_=this.cameraToCenterDistance;s[2]=a.clamp(s[2],_/g,_/u),this._camera.position=s}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,u,g){this._unmodified=!1,this._edgeInsets.interpolate(s,u,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const u=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(s){const u=[new a.UnwrappedTileID(0,s)];if(this.renderWorldCopies){const g=this.pointCoordinate(new a.Point(0,0)),_=this.pointCoordinate(new a.Point(this.width,0)),b=this.pointCoordinate(new a.Point(this.width,this.height)),T=this.pointCoordinate(new a.Point(0,this.height)),C=Math.floor(Math.min(g.x,_.x,b.x,T.x)),A=Math.floor(Math.max(g.x,_.x,b.x,T.x)),z=1;for(let R=C-z;R<=A+z;R++)R!==0&&u.push(new a.UnwrappedTileID(R,s))}return u}coveringTiles(s){let u=this.coveringZoomLevel(s);const g=u,_=this.elevation&&!s.isTerrainDEM,b=this.projection.name==="mercator";if(s.minzoom!==void 0&&u<s.minzoom)return[];s.maxzoom!==void 0&&u>s.maxzoom&&(u=s.maxzoom);const T=this.locationCoordinate(this.center),C=this.center.lat,A=1<<u,z=[A*T.x,A*T.y,0],R=this.projection.name==="globe",N=!R,Y=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,N),te=R?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ie=A*a.mercatorZfromAltitude(1,this.center.lat),re=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),se=[A*te.x,A*te.y,re*(N?1:ie)],$=this.cameraToCenterDistance/s.tileSize*(s.roundZoom?1:.502),ee=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?u:0,ue=s.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,de=s.isTerrainDEM?-ue:this._elevation?this._elevation.getMinElevationBelowMSL():0,Se=this.projection.isReprojectedInTileSpace?kg(this):1,Te=Fe=>{const ot=new a.MercatorCoordinate(Fe.x+25e-6,Fe.y,Fe.z),Qe=new a.MercatorCoordinate(Fe.x,Fe.y+25e-6,Fe.z),at=Fe.toLngLat(),Ot=ot.toLngLat(),Ht=Qe.toLngLat(),At=this.locationCoordinate(at),Ut=this.locationCoordinate(Ot),dn=this.locationCoordinate(Ht),ln=Math.hypot(Ut.x-At.x,Ut.y-At.y),Lt=Math.hypot(dn.x-At.x,dn.y-At.y);return Math.sqrt(ln*Lt)*Se/25e-6},Ee=Fe=>{const Ze=ue,ot=de;return{aabb:a.tileAABB(this,A,0,0,0,Fe,ot,Ze,this.projection),zoom:0,x:0,y:0,minZ:ot,maxZ:Ze,wrap:Fe,fullyVisible:!1}},Pe=[];let Me=[];const je=u,rt=s.reparseOverscaled?g:u,Oe=Fe=>Fe*Fe,Ke=Oe((re-this._centerAltitude)*ie),$e=Fe=>{if(!this._elevation||!Fe.tileID||!b)return;const Ze=this._elevation.getMinMaxForTile(Fe.tileID),ot=Fe.aabb;Ze?(ot.min[2]=Ze.min,ot.max[2]=Ze.max,ot.center[2]=(ot.min[2]+ot.max[2])/2):(Fe.shouldSplit=nt(Fe),Fe.shouldSplit||(ot.min[2]=ot.max[2]=ot.center[2]=this._centerAltitude))},nt=Fe=>{if(Fe.zoom<ee)return!0;if(Fe.zoom===je)return!1;if(Fe.shouldSplit!=null)return Fe.shouldSplit;const Ze=Fe.aabb.distanceX(se),ot=Fe.aabb.distanceY(se);let Qe=Ke,at=1;if(R){Qe=Oe(Fe.aabb.distanceZ(se));const At=Math.pow(2,Fe.zoom),Ut=a.latFromMercatorY((Fe.y+1)/At),dn=a.latFromMercatorY(Fe.y/At),ln=Math.min(Math.max(C,Ut),dn),Lt=a.circumferenceAtLatitude(ln)/a.circumferenceAtLatitude(C);if(at=ln===C?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Lt/this._mercatorScaleRatio),this.zoom<=a.GLOBE_ZOOM_THRESHOLD_MIN&&Fe.zoom===je-1&&Lt>=.9)return!0}else if(_&&(Qe=Oe(Fe.aabb.distanceZ(se)*ie)),this.projection.isReprojectedInTileSpace&&g<=5){const At=Math.pow(2,Fe.zoom),Ut=Te(new a.MercatorCoordinate((Fe.x+.5)/At,(Fe.y+.5)/At));at=Ut>.85?1:Ut}const Ot=Ze*Ze+ot*ot+Qe,Ht=Oe((1<<je-Fe.zoom)*$*at*((At,Ut)=>{if(Ut*Oe(.707)<At)return 1;const dn=Math.sqrt(Ut/At);return dn/(1.4144271570014144+(Math.pow(1.1,dn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Qe,Ke),Ot));return Ot<Ht};if(this.renderWorldCopies)for(let Fe=1;Fe<=3;Fe++)Pe.push(Ee(-Fe)),Pe.push(Ee(Fe));for(Pe.push(Ee(0));Pe.length>0;){const Fe=Pe.pop(),Ze=Fe.x,ot=Fe.y;let Qe=Fe.fullyVisible;if(!Qe){const at=Fe.aabb.intersects(Y);if(at===0)continue;Qe=at===2}if(Fe.zoom!==je&&nt(Fe))for(let at=0;at<4;at++){const Ot=(Ze<<1)+at%2,Ht=(ot<<1)+(at>>1),At={aabb:b?Fe.aabb.quadrant(at):a.tileAABB(this,A,Fe.zoom+1,Ot,Ht,Fe.wrap,Fe.minZ,Fe.maxZ,this.projection),zoom:Fe.zoom+1,x:Ot,y:Ht,wrap:Fe.wrap,fullyVisible:Qe,tileID:void 0,shouldSplit:void 0,minZ:Fe.minZ,maxZ:Fe.maxZ};_&&!R&&(At.tileID=new a.OverscaledTileID(Fe.zoom+1===je?rt:Fe.zoom+1,Fe.wrap,Fe.zoom+1,Ot,Ht),$e(At)),Pe.push(At)}else{const at=Fe.zoom===je?rt:Fe.zoom;if(s.minzoom&&s.minzoom>at)continue;const Ot=z[0]-(.5+Ze+(Fe.wrap<<Fe.zoom))*(1<<u-Fe.zoom),Ht=z[1]-.5-ot,At=Fe.tileID?Fe.tileID:new a.OverscaledTileID(at,Fe.wrap,Fe.zoom,Ze,ot);Me.push({tileID:At,distanceSq:Ot*Ot+Ht*Ht})}}if(this.fogCullDistSq){const Fe=this.fogCullDistSq,Ze=this.horizonLineFromTop();Me=Me.filter(ot=>{const Qe=[0,0,0,1],at=[a.EXTENT,a.EXTENT,0,1],Ot=this.calculateFogTileMatrix(ot.tileID.toUnwrapped());a.transformMat4$1(Qe,Qe,Ot),a.transformMat4$1(at,at,Ot);const Ht=a.getAABBPointSquareDist(Qe,at);if(Ht===0)return!0;let At=!1;const Ut=this._elevation;if(Ut&&Ht>Fe&&Ze!==0){const dn=this.calculateProjMatrix(ot.tileID.toUnwrapped());let ln;s.isTerrainDEM||(ln=Ut.getMinMaxForTile(ot.tileID)),ln||(ln={min:de,max:ue});const Lt=a.furthestTileCorner(this.rotation),Pn=[Lt[0]*a.EXTENT,Lt[1]*a.EXTENT,ln.max];a.transformMat4(Pn,Pn,dn),At=(1-Pn[1])*this.height*.5<Ze}return Ht<Fe||At})}return Me.sort((Fe,Ze)=>Fe.distanceSq-Ze.distanceSq).map(Fe=>Fe.tileID)}resize(s,u){this.width=s,this.height=u,this.pixelsToGLUnits=[2/s,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const u=a.clamp(s.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),g=this.projection.project(s.lng,u);return new a.Point(g.x*this.worldSize,g.y*this.worldSize)}unproject(s){return this.projection.unproject(s.x/this.worldSize,s.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(s,u){let g,_;const b=this.centerPoint;if(this.projection.name==="globe"){const C=this.worldSize;g=(u.x-b.x)/C,_=(u.y-b.y)/C}else{const C=this.pointCoordinate(u),A=this.pointCoordinate(b);g=C.x-A.x,_=C.y-A.y}const T=this.locationCoordinate(s);this.setLocation(new a.MercatorCoordinate(T.x-g,T.y-_))}setLocation(s){this.center=this.coordinateLocation(s),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(s){return this.projection.locationPoint(this,s)}locationPoint3D(s){return this.projection.locationPoint(this,s,!0)}pointLocation(s){return this.coordinateLocation(this.pointCoordinate(s))}pointLocation3D(s){return this.coordinateLocation(this.pointCoordinate3D(s))}locationCoordinate(s,u){const g=u?a.mercatorZfromAltitude(u,s.lat):void 0,_=this.projection.project(s.lng,s.lat);return new a.MercatorCoordinate(_.x,_.y,g)}coordinateLocation(s){return this.projection.unproject(s.x,s.y)}pointRayIntersection(s,u){const g=u??this._centerAltitude,_=[s.x,s.y,0,1],b=[s.x,s.y,1,1];a.transformMat4$1(_,_,this.pixelMatrixInverse),a.transformMat4$1(b,b,this.pixelMatrixInverse);const T=b[3];a.scale$1(_,_,1/_[3]),a.scale$1(b,b,1/T);const C=_[2],A=b[2];return{p0:_,p1:b,t:C===A?0:(g-C)/(A-C)}}screenPointToMercatorRay(s){const u=[s.x,s.y,0,1],g=[s.x,s.y,1,1];return a.transformMat4$1(u,u,this.pixelMatrixInverse),a.transformMat4$1(g,g,this.pixelMatrixInverse),a.scale$1(u,u,1/u[3]),a.scale$1(g,g,1/g[3]),u[2]=a.mercatorZfromAltitude(u[2],this._center.lat)*this.worldSize,g[2]=a.mercatorZfromAltitude(g[2],this._center.lat)*this.worldSize,a.scale$1(u,u,1/this.worldSize),a.scale$1(g,g,1/this.worldSize),new a.Ray([u[0],u[1],u[2]],a.normalize([],a.sub([],g,u)))}rayIntersectionCoordinate(s){const{p0:u,p1:g,t:_}=s,b=a.mercatorZfromAltitude(u[2],this._center.lat),T=a.mercatorZfromAltitude(g[2],this._center.lat);return new a.MercatorCoordinate(a.number(u[0],g[0],_)/this.worldSize,a.number(u[1],g[1],_)/this.worldSize,a.number(b,T,_))}pointCoordinate(s,u=this._centerAltitude){return this.projection.pointCoordinate(this,s.x,s.y,u)}pointCoordinate3D(s){if(!this.elevation)return this.pointCoordinate(s);let u=this.projection.pointCoordinate3D(this,s.x,s.y);if(u)return new a.MercatorCoordinate(u[0],u[1],u[2]);let g=0,_=this.horizonLineFromTop();if(s.y>_)return this.pointCoordinate(s);const b=.02*_,T=s.clone();for(let C=0;C<10&&_-g>b;C++){T.y=a.number(g,_,.66);const A=this.projection.pointCoordinate3D(this,T.x,T.y);A?(_=T.y,u=A):g=T.y}return u?new a.MercatorCoordinate(u[0],u[1],u[2]):this.pointCoordinate(s)}isPointAboveHorizon(s){return this.projection.isPointAboveHorizon(this,s)}isPointOnSurface(s){if(s.y<0||s.y>this.height||s.x<0||s.x>this.width)return!1;if(this.elevation||this.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(s);const u=this.pointCoordinate(s);return u.y>=0&&u.y<=1}_coordinatePoint(s,u){const g=u&&this.elevation?this.elevation.getAtPointOrZero(s,this._centerAltitude):this._centerAltitude,_=[s.x*this.worldSize,s.y*this.worldSize,g+s.toAltitude(),1];return a.transformMat4$1(_,_,this.pixelMatrix),_[3]>0?new a.Point(_[0]/_[3],_[1]/_[3]):new a.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:s,left:u}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,_=this.width-this._edgeInsets.right,b=this.pointLocation3D(new a.Point(u,s)),T=this.pointLocation3D(new a.Point(_,s)),C=this.pointLocation3D(new a.Point(_,g)),A=this.pointLocation3D(new a.Point(u,g));let z=Math.min(b.lng,T.lng,C.lng,A.lng),R=Math.max(b.lng,T.lng,C.lng,A.lng),N=Math.min(b.lat,T.lat,C.lat,A.lat),Y=Math.max(b.lat,T.lat,C.lat,A.lat);const te=Math.pow(2,-this.zoom)/16*270,ie=this.projection.name==="globe"?1:4,re=(se,$,ee,ue,de)=>{const Se=(se+ee)/2,Te=($+ue)/2,Ee=new a.Point(Se,Te),{lng:Pe,lat:Me}=this.pointLocation3D(Ee),je=Math.max(0,z-Pe,N-Me,Pe-R,Me-Y);z=Math.min(z,Pe),R=Math.max(R,Pe),N=Math.min(N,Me),Y=Math.max(Y,Me),(de<ie||je>te)&&(re(se,$,Se,Te,de+1),re(Se,Te,ee,ue,de+1))};if(re(u,s,_,s,1),re(_,s,_,g,1),re(_,g,u,g,1),re(u,g,u,s,1),this.projection.name==="globe"){const[se,$]=a.polesInViewport(this);se?(Y=90,R=180,z=-180):$&&(N=-90,R=180,z=-180)}return new a.LngLatBounds(new a.LngLat(z,N),new a.LngLat(R,Y))}_getBoundsRectangular(s,u){const{top:g,left:_}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,T=this.width-this._edgeInsets.right,C=new a.Point(_,g),A=new a.Point(T,g),z=new a.Point(T,b),R=new a.Point(_,b);let N=this.pointCoordinate(C,s),Y=this.pointCoordinate(A,s);const te=this.pointCoordinate(z,u),ie=this.pointCoordinate(R,u),re=(se,$)=>($.y-se.y)/($.x-se.x);return N.y>1&&Y.y>=0?N=new a.MercatorCoordinate((1-ie.y)/re(ie,N)+ie.x,1):N.y<0&&Y.y<=1&&(N=new a.MercatorCoordinate(-ie.y/re(ie,N)+ie.x,0)),Y.y>1&&N.y>=0?Y=new a.MercatorCoordinate((1-te.y)/re(te,Y)+te.x,1):Y.y<0&&N.y<=1&&(Y=new a.MercatorCoordinate(-te.y/re(te,Y)+te.x,0)),new a.LngLatBounds().extend(this.coordinateLocation(N)).extend(this.coordinateLocation(Y)).extend(this.coordinateLocation(ie)).extend(this.coordinateLocation(te))}_getBoundsRectangularTerrain(){const s=this.elevation;if(!s.visibleDemTiles.length||s.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=s.visibleDemTiles.reduce((g,_)=>{if(_.dem){const b=_.dem.tree;g.min=Math.min(g.min,b.minimums[0]),g.max=Math.max(g.max,b.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*s.exaggeration(),u.max*s.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(s=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,g=this.height/2-u*(1-this._horizonShift);return s?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(s){this.maxBounds=s,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,s&&(this.minLat=s.getSouth(),this.maxLat=s.getNorth(),this.minLng=s.getWest(),this.maxLng=s.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(s,u){return this.projection.createTileMatrix(this,u,s)}calculateDistanceTileData(s){const u=s.key,g=this._distanceTileDataCache;if(g[u])return g[u];const _=s.canonical,b=1/this.height,T=this.cameraWorldSize,C=T/this.zoomScale(_.z),A=(_.x+Math.pow(2,_.z)*s.wrap)*C,z=_.y*C,R=this.point;R.x*=T/this.worldSize,R.y*=T/this.worldSize;const N=this.angle,Y=Math.sin(-N),te=-Math.cos(-N);return g[u]={bearing:[Y,te],center:[(R.x-A)*b,(R.y-z)*b],scale:C/a.EXTENT*b},g[u]}calculateFogTileMatrix(s){const u=s.key,g=this._fogTileMatrixCache;if(g[u])return g[u];const _=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,s);return a.multiply(_,this.worldToFogMatrix,_),g[u]=new Float32Array(_),g[u]}calculateProjMatrix(s,u=!1){const g=s.key,_=u?this._alignedProjMatrixCache:this._projMatrixCache;if(_[g])return _[g];const b=this.calculatePosMatrix(s,this.worldSize);return a.multiply(b,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:u?this.alignedProjMatrix:this.projMatrix,b),_[g]=new Float32Array(b),_[g]}calculatePixelsToTileUnitsMatrix(s){const u=s.tileID.key,g=this._pixelsToTileUnitsCache;if(g[u])return g[u];const _=function(b,T){const{scale:C}=b.tileTransform,A=C*a.EXTENT/(b.tileSize*Math.pow(2,T.zoom-b.tileID.overscaledZ+b.tileID.canonical.z));return z=new Float32Array(4),Y=(R=T.inverseAdjustmentMatrix)[1],te=R[2],ie=R[3],se=(N=[A,A])[1],z[0]=R[0]*(re=N[0]),z[1]=Y*re,z[2]=te*se,z[3]=ie*se,z;var z,R,N,Y,te,ie,re,se}(s,this);return g[u]=_,g[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const s=1/this.worldSize,u=a.fromScaling([],[s,s,s]);return a.multiply(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const s=this._elevation;this._updateCameraState();const u=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(u),_=this._camera.forward(),b=a.mercatorZfromAltitude(1,this._center.lat);g[2]/=b,_[2]/=b,a.normalize(_,_);const T=s.raycast(g,_,s.exaggeration());if(T){const C=a.scaleAndAdd([],g,_,T),A=new a.MercatorCoordinate(C[0],C[1],a.mercatorZfromAltitude(C[2],a.latFromMercatorY(C[1]))),z=(A.z+a.length([A.x-g[0],A.y-g[1],A.z-g[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(z),this._centerAltitude=A.toAltitude(),this._center=this.coordinateLocation(A),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(s=!1){if(!this._elevation)return;const u=this._elevation,g=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(g),b=u.getAtPointOrZero(new a.MercatorCoordinate(..._)),T=this.pixelsPerMeter/this.worldSize*b,C=this._minimumHeightOverTerrain(),A=_[2]-T;if(A<=C)if(A<0||s){const z=this.locationCoordinate(this._center,this._centerAltitude),R=[_[0],_[1],z.z-_[2]],N=a.length(R);R[2]-=(C-A)/this._pixelsPerMercatorPixel;const Y=a.length(R);if(Y===0)return;a.scale$2(R,R,N/Y*this._pixelsPerMercatorPixel),this._camera.position=[_[0],_[1],z.z*this._pixelsPerMercatorPixel-R[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const s=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||s){const Y=this.center;return Y.lat=a.clamp(Y.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!s)&&(Y.lng=a.clamp(Y.lng,this.minLng,this.maxLng)),this.center=Y,void(this._constraining=!1)}const u=this._unmodified,{x:g,y:_}=this.point;let b=0,T=g,C=_;const A=this.width/2,z=this.height/2,R=this.worldMinY*this.scale,N=this.worldMaxY*this.scale;if(_-z<R&&(C=R+z),_+z>N&&(C=N-z),N-R<this.height&&(b=Math.max(b,this.height/(N-R)),C=(N+R)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Y=this.worldMinX*this.scale,te=this.worldMaxX*this.scale,ie=this.worldSize/2-(Y+te)/2;T=(g+ie+this.worldSize)%this.worldSize-ie,T-A<Y&&(T=Y+A),T+A>te&&(T=te-A),te-Y<this.width&&(b=Math.max(b,this.width/(te-Y)),T=(te+Y)/2)}T===g&&C===_||(this.center=this.unproject(new a.Point(T,C))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let s=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(s=Math.max(s,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),s}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,u=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.mercatorZfromAltitude(1,this.center.lat)/a.mercatorZfromAltitude(1,a.GLOBE_SCALE_MATCH_LATITUDE));const g=Yu(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,g),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const _=this.projection.zAxisUnit==="meters"?u:1,b=this._camera.getWorldToCamera(this.worldSize,_),T=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);T[8]=2*-s.x/this.width,T[9]=2*s.y/this.height;let C=a.mul([],T,b);if(this.projection.isReprojectedInTileSpace){const Te=this.locationCoordinate(this.center),Ee=a.identity([]);a.translate(Ee,Ee,[Te.x*this.worldSize,Te.y*this.worldSize,0]),a.multiply(Ee,Ee,ml(this)),a.translate(Ee,Ee,[-Te.x*this.worldSize,-Te.y*this.worldSize,0]),a.multiply(C,C,Ee),this.inverseAdjustmentMatrix=function(Pe){const Me=ml(Pe,!0);return ye([],[Me[0],Me[1],Me[4],Me[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],C,[this.worldSize,this.worldSize,this.worldSize/_,1]),this.projMatrix=C,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const A=a.invert([],T);this.frustumCorners=a.FrustumCorners.fromInvProjectionMatrix(A,this.horizonLineFromTop(),this.height);const z=new Float32Array(16);a.identity(z),a.scale(z,z,[1,-1,1]),a.rotateX(z,z,this._pitch),a.rotateZ(z,z,this.angle);const R=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),N=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;R[8]=2*-s.x/this.width,R[9]=2*(s.y+N)/this.height,this.skyboxMatrix=a.multiply(z,R,z);const Y=this.point,te=Y.x,ie=Y.y,re=this.width%2/2,se=this.height%2/2,$=Math.cos(this.angle),ee=Math.sin(this.angle),ue=te-Math.round(te)+$*re+ee*se,de=ie-Math.round(ie)+$*se+ee*re,Se=new Float64Array(C);if(a.translate(Se,Se,[ue>.5?ue-1:ue,de>.5?de-1:de,0]),this.alignedProjMatrix=Se,C=a.create(),a.scale(C,C,[this.width/2,-this.height/2,1]),a.translate(C,C,[1,-1,0]),this.labelPlaneMatrix=C,C=a.create(),a.scale(C,C,[1,-1,1]),a.translate(C,C,[-1,-1,0]),a.scale(C,C,[2/this.width,2/this.height,1]),this.glCoordMatrix=C,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},C=a.invert(new Float64Array(16),this.pixelMatrix),!C)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=C,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.calculateGlobeMatrix(this);const Te=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.transformMat4(Te,Te,b),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=C;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const s=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,g=this._camera.position,_=1/this.height/this._pixelsPerMercatorPixel,b=[s,s,u];a.scale$2(b,b,_),a.scale$2(g,g,-1),a.multiply$2(g,g,b);const T=a.create();a.translate(T,T,g),a.scale(T,T,b),this.mercatorFogMatrix=T,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(s,u,_)}_computeCameraPosition(s){const u=(s=s||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),_=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-s/this.worldSize*this._centerAltitude;return[_.x/this.worldSize-g[0]*b,_.y/this.worldSize-g[1]*b,s/this.worldSize*this._centerAltitude-g[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(s){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],_=s[2];let b=1;this.projection.wrap&&(this.center=this.center.wrap()),_>0&&(b=Math.min((u-g)/_,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,s,b),this._updateStateFromCamera()}_updateStateFromCamera(){const s=this._camera.position,u=this._camera.forward(),{pitch:g,bearing:_}=this._camera.getPitchBearing(),b=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,T=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),C=Math.max((s[2]-b)/Math.cos(g),T),A=this._zoomFromMercatorZ(C);a.scaleAndAdd(s,s,u,C),this._pitch=a.clamp(g,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(_,-Math.PI,Math.PI),this._setZoom(a.clamp(A,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.MercatorCoordinate(s[0],s[1],s[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(s){return Math.pow(2,s)*this.tileSize}_mercatorZfromZoom(s){return this.cameraToCenterDistance/this._worldSizeFromZoom(s)}_minimumHeightOverTerrain(){const s=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(s)}_zoomFromMercatorZ(s){return this.scaleZoom(this.cameraToCenterDistance/(s*this.tileSize))}zoomFromMercatorZAdjusted(s){let u=0,g=a.GLOBE_ZOOM_THRESHOLD_MAX,_=0,b=1/0;for(;g-u>1e-6&&g>u;){const T=u+.5*(g-u),C=this.tileSize*Math.pow(2,T),A=this.getCameraToCenterDistance(this.projection,T,C),z=this.scaleZoom(A/(s*this.tileSize)),R=Math.abs(T-z);R<b&&(b=R,_=T),T<z?u=T:g=T}return _}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(s,u){const g=Math.min(s.x,u.x),_=Math.max(s.x,u.x),b=Math.min(s.y,u.y),T=Math.max(s.y,u.y);if(b<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const C=[new a.Point(g,b),new a.Point(_,T),new a.Point(g,T),new a.Point(_,b)],A=this.renderWorldCopies?-3:0,z=this.renderWorldCopies?4:1;for(const R of C){const N=this.pointRayIntersection(R);if(N.t<0)return!0;const Y=this.rayIntersectionCoordinate(N);if(Y.x<A||Y.y<0||Y.x>z||Y.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.Point(0,0),new a.Point(this.width,this.height))}zoomDeltaToMovement(s,u){const g=a.length(a.sub([],this._camera.position,s)),_=this._zoomFromMercatorZ(g)+u;return g-this._mercatorZfromZoom(_)}getCameraPoint(){if(this.projection.name==="globe"){const s=function([u,g,_],b){const T=[u,g,_,1];a.transformMat4$1(T,T,b);const C=T[3]=Math.max(T[3],1e-6);return T[0]/=C,T[1]/=C,T[2]/=C,T}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.Point(s[0],s[1])}{const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,s))}}getCameraToCenterDistance(s,u=this.zoom,g=this.worldSize){const _=Yu(s,u,this.width,this.height,1024),b=s.pixelSpaceConversion(this.center.lat,g,_);return .5/Math.tan(.5*this._fov)*this.height*b}getWorldToCameraMatrix(){const s=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.multiply(s,s,this.globeMatrix),s}}function yl(p,s){let u=!1,g=null;const _=()=>{g=null,u&&(p(),g=setTimeout(_,s),u=!1)};return()=>(u=!0,g||_(),g)}class bp{constructor(s){this._hashName=s&&encodeURIComponent(s),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=yl(this._updateHashUnthrottled.bind(this),300)}addTo(s){return this._map=s,a.window.addEventListener("hashchange",this._onHashChange,!1),s.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),a.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const s=this._map;if(!s)return"";const u=Rc(s);if(this._hashName){const g=this._hashName;let _=!1;const b=a.window.location.hash.slice(1).split("&").map(T=>{const C=T.split("=")[0];return C===g?(_=!0,`${C}=${u}`):T}).filter(T=>T);return _||b.push(`${g}=${u}`),`#${b.join("&")}`}return`#${u}`}_getCurrentHash(){const s=a.window.location.hash.replace("#","");if(this._hashName){let u;return s.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(u=g)}),(u&&u[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._map;if(!s)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(g=>isNaN(g))){const g=s.dragRotate.isEnabled()&&s.touchZoomRotate.isEnabled()?+(u[3]||0):s.getBearing();return s.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:g,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){const s=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,s)}}function Rc(p,s){const u=p.getCenter(),g=Math.round(100*p.getZoom())/100,_=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,_),T=Math.round(u.lng*b)/b,C=Math.round(u.lat*b)/b,A=p.getBearing(),z=p.getPitch();let R=s?`/${T}/${C}/${g}`:`${g}/${C}/${T}`;return(A||z)&&(R+="/"+Math.round(10*A)/10),z&&(R+=`/${Math.round(z)}`),R}const zc={linearity:.3,easing:a.bezier(0,0,.3,1)},Qu=a.extend({deceleration:2500,maxSpeed:1400},zc),ed=a.extend({deceleration:20,maxSpeed:1400},zc),Et=a.extend({deceleration:1e3,maxSpeed:360},zc),ko=a.extend({deceleration:1e3,maxSpeed:90},zc);class Ag{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,u=a.exported.now();for(;s.length>0&&u-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const u={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)u.zoom+=b.zoomDelta||0,u.bearing+=b.bearingDelta||0,u.pitch+=b.pitchDelta||0,b.panDelta&&u.pan._add(b.panDelta),b.around&&(u.around=b.around),b.pinchAround&&(u.pinchAround=b.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(u.pan.mag()){const b=Dc(u.pan.mag(),g,a.extend({},Qu,s||{}));_.offset=u.pan.mult(b.amount/u.pan.mag()),_.center=this._map.transform.center,Lc(_,b)}if(u.zoom){const b=Dc(u.zoom,g,ed);_.zoom=this._map.transform.zoom+b.amount,Lc(_,b)}if(u.bearing){const b=Dc(u.bearing,g,Et);_.bearing=this._map.transform.bearing+a.clamp(b.amount,-179,179),Lc(_,b)}if(u.pitch){const b=Dc(u.pitch,g,ko);_.pitch=this._map.transform.pitch+b.amount,Lc(_,b)}if(_.zoom||_.bearing){const b=u.pinchAround===void 0?u.around:u.pinchAround;_.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),_.noMoveStart=!0,_}}function Lc(p,s){(!p.duration||p.duration<s.duration)&&(p.duration=s.duration,p.easing=s.easing)}function Dc(p,s,u){const{maxSpeed:g,linearity:_,deceleration:b}=u,T=a.clamp(p*_/(s/1e3),-g,g),C=Math.abs(T)/(b*_);return{easing:u.easing,duration:1e3*C,amount:T*(C/2)}}class ni extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,g,_={}){const b=pe(u.getCanvasContainer(),g),T=u.unproject(b);super(s,a.extend({point:b,lngLat:T,originalEvent:g},_)),this._defaultPrevented=!1,this.target=u}}class Oc extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,g){const _=s==="touchend"?g.changedTouches:g.touches,b=_e(u.getCanvasContainer(),_),T=b.map(A=>u.unproject(A)),C=b.reduce((A,z,R,N)=>A.add(z.div(N.length)),new a.Point(0,0));super(s,{points:b,point:C,lngLats:T,lngLat:u.unproject(C),originalEvent:g}),this._defaultPrevented=!1}}class td extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,g){super(s,{originalEvent:g}),this._defaultPrevented=!1}}class wp{constructor(s,u){this._map=s,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(s){return this._firePreventable(new td(s.type,this._map,s))}mousedown(s,u){return this._mousedownPos=u,this._firePreventable(new ni(s.type,this._map,s))}mouseup(s){this._map.fire(new ni(s.type,this._map,s))}preclick(s){const u=a.extend({},s);u.type="preclick",this._map.fire(new ni(u.type,this._map,u))}click(s,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(s),this._map.fire(new ni(s.type,this._map,s)))}dblclick(s){return this._firePreventable(new ni(s.type,this._map,s))}mouseover(s){this._map.fire(new ni(s.type,this._map,s))}mouseout(s){this._map.fire(new ni(s.type,this._map,s))}touchstart(s){return this._firePreventable(new Oc(s.type,this._map,s))}touchmove(s){this._map.fire(new Oc(s.type,this._map,s))}touchend(s){this._map.fire(new Oc(s.type,this._map,s))}touchcancel(s){this._map.fire(new Oc(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class nd{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(s){this._map.fire(new ni(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ni("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new ni(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Mg{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,u){this.isEnabled()&&s.shiftKey&&s.button===0&&(Z(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(s,u){if(!this._active)return;const g=u,_=this._startPos,b=this._lastPos;if(!_||!b||b.equals(g)||!this._box&&g.dist(_)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=F("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));const T=Math.min(_.x,g.x),C=Math.max(_.x,g.x),A=Math.min(_.y,g.y),z=Math.max(_.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${T}px,${A}px)`,this._box.style.width=C-T+"px",this._box.style.height=z-A+"px")})}mouseupWindow(s,u){if(!this._active)return;const g=this._startPos,_=u;if(g&&s.button===0){if(this.reset(),oe(),g.x!==_.x||g.y!==_.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:b=>b.fitScreenCoordinates(g,_,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",s)}}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),H(),delete this._startPos,delete this._lastPos}_fireEvent(s,u){return this._map.fire(new a.Event(s,{originalEvent:u}))}}function rd(p,s){const u={};for(let g=0;g<p.length;g++)u[p[g].identifier]=s[g];return u}class _l{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(s,u,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=s.timeStamp),g.length===this.numTouches&&(this.centroid=function(_){const b=new a.Point(0,0);for(const T of _)b._add(T);return b.div(_.length)}(u),this.touches=rd(g,u)))}touchmove(s,u,g){if(this.aborted||!this.centroid)return;const _=rd(g,u);for(const b in this.touches){const T=_[b];(!T||T.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(s,u,g){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Sp{constructor(s){this.singleTap=new _l(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(s,u,g){this.singleTap.touchstart(s,u,g)}touchmove(s,u,g){this.singleTap.touchmove(s,u,g)}touchend(s,u,g){const _=this.singleTap.touchend(s,u,g);if(_){const b=s.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(_)<30;if(b&&T||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class hv{constructor(){this._zoomIn=new Sp({numTouches:1,numTaps:2}),this._zoomOut=new Sp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,u,g){this._zoomIn.touchstart(s,u,g),this._zoomOut.touchstart(s,u,g)}touchmove(s,u,g){this._zoomIn.touchmove(s,u,g),this._zoomOut.touchmove(s,u,g)}touchend(s,u,g){const _=this._zoomIn.touchend(s,u,g),b=this._zoomOut.touchend(s,u,g);return _?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()+1,around:T.unproject(_)},{originalEvent:s})}):b?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()-1,around:T.unproject(b)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Pg={0:1,2:2};class xl{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(s,u){return!1}_move(s,u){return{}}mousedown(s,u){if(this._lastPoint)return;const g=xe(s);this._correctButton(s,g)&&(this._lastPoint=u,this._eventButton=g)}mousemoveWindow(s,u){const g=this._lastPoint;if(g){if(s.preventDefault(),this._eventButton!=null&&function(_,b){const T=Pg[b];return _.buttons===void 0||(_.buttons&T)!==T}(s,this._eventButton))this.reset();else if(this._moved||!(u.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(g,u)}}mouseupWindow(s){this._lastPoint&&xe(s)===this._eventButton&&(this._moved&&oe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ep extends xl{mousedown(s,u){super.mousedown(s,u),this._lastPoint&&(this._active=!0)}_correctButton(s,u){return u===0&&!s.ctrlKey}_move(s,u){return{around:u,panDelta:u.sub(s)}}}class Tp extends xl{_correctButton(s,u){return u===0&&s.ctrlKey||u===2}_move(s,u){const g=.8*(u.x-s.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(s){s.preventDefault()}}class Cp extends xl{_correctButton(s,u){return u===0&&s.ctrlKey||u===2}_move(s,u){const g=-.5*(u.y-s.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(s){s.preventDefault()}}class id{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)}touchstart(s,u,g){return this._calculateTransform(s,u,g)}touchmove(s,u,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!a.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return s.cancelable&&s.preventDefault(),this._calculateTransform(s,u,g)}}touchend(s,u,g){this._calculateTransform(s,u,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,u,g){g.length>0&&(this._active=!0);const _=rd(g,u),b=new a.Point(0,0),T=new a.Point(0,0);let C=0;for(const z in _){const R=_[z],N=this._touches[z];N&&(b._add(R),T._add(R.sub(N)),C++,_[z]=R)}if(this._touches=_,C<this._minTouches||!T.mag())return;const A=T.div(C);return this._sum._add(A),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(C),panDelta:A}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=F("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Bc{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(s){}_move(s,u,g){return{}}touchstart(s,u,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([u[0],u[1]]))}touchmove(s,u,g){const _=this._firstTwoTouches;if(!_)return;s.preventDefault();const[b,T]=_,C=Fc(g,u,b),A=Fc(g,u,T);if(!C||!A)return;const z=this._aroundCenter?null:C.add(A).div(2);return this._move([C,A],z,s)}touchend(s,u,g){if(!this._firstTwoTouches)return;const[_,b]=this._firstTwoTouches,T=Fc(g,u,_),C=Fc(g,u,b);T&&C||(this._active&&oe(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Fc(p,s,u){for(let g=0;g<p.length;g++)if(p[g].identifier===u)return s[g]}function kp(p,s){return Math.log(p/s)/Math.LN2}class Rg extends Bc{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,u){const g=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(kp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:kp(this._distance,g),pinchAround:u}}}function Ip(p,s){return 180*p.angleWith(s)/Math.PI}class zg extends Bc{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,u){const g=this._vector;if(this._vector=s[0].sub(s[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Ip(this._vector,g),pinchAround:u}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const u=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const _=Ip(s,g);return Math.abs(_)<u}}function ea(p){return Math.abs(p.y)>Math.abs(p.x)}class Lg extends Bc{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(s){this._lastPoints=s,ea(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,u,g){const _=this._lastPoints;if(!_)return;const b=s[0].sub(_[0]),T=s[1].sub(_[1]);return this._map._cooperativeGestures&&!a.isFullscreen()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(b,T,g.timeStamp),!this._valid)?void 0:(this._lastPoints=s,this._active=!0,{pitchDelta:(b.y+T.y)/2*-.5})}gestureBeginsVertically(s,u,g){if(this._valid!==void 0)return this._valid;const _=s.mag()>=2,b=u.mag()>=2;if(!_&&!b)return;if(!_||!b)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const T=s.y>0==u.y>0;return ea(s)&&ea(u)&&T}}const Dg={panStep:100,bearingStep:15,pitchStep:10};class pv{constructor(){const s=Dg;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let u=0,g=0,_=0,b=0,T=0;switch(s.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:s.shiftKey?g=-1:(s.preventDefault(),b=-1);break;case 39:s.shiftKey?g=1:(s.preventDefault(),b=1);break;case 38:s.shiftKey?_=1:(s.preventDefault(),T=-1);break;case 40:s.shiftKey?_=-1:(s.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(g=0,_=0),{cameraAnimation:C=>{const A=C.getZoom();C.easeTo({duration:300,easeId:"keyboardHandler",easing:Og,zoom:u?Math.round(A)+u*(s.shiftKey?2:1):A,bearing:C.getBearing()+g*this._bearingStep,pitch:C.getPitch()+_*this._pitchStep,offset:[-b*this._panStep,-T*this._panStep],center:C.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Og(p){return p*(2-p)}const Ap=4.000244140625;class Bg{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(s.ctrlKey||s.metaKey||this.isZooming()||a.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=s.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const g=a.exported.now(),_=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,u!==0&&u%Ap==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(_*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),s.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=s,this._delta-=u,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=pe(this._el,s);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._map.transform;this._type==="wheel"&&s.projection.wrap&&(s._center.lng>=180||s._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>s._terrainEnabled()&&this._aroundCoord?s.computeZoomRelativeTo(this._aroundCoord):s.zoom;if(this._delta!==0){const A=this._type==="wheel"&&Math.abs(this._delta)>Ap?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*A)));this._delta<0&&z!==0&&(z=1/z);const R=u(),N=Math.pow(2,R),Y=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):N;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(Y*z))),this._type==="wheel"&&(this._startZoom=R,this._easing=this._smoothOutEasing(200)),this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:u(),_=this._startZoom,b=this._easing;let T,C=!1;if(this._type==="wheel"&&_&&b){const A=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),z=b(A);T=a.number(_,g,z),A<1?this._frameId||(this._frameId=!0):C=!0}else T=g,C=!0;return this._active=!0,C&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!C,zoomDelta:T-u(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let u=a.ease;if(this._prevEase){const g=this._prevEase,_=(a.exported.now()-g.start)/g.duration,b=g.easing(_+.01)-g.easing(_),T=.27/Math.sqrt(b*b+1e-4)*.01,C=Math.sqrt(.0729-T*T);u=a.bezier(T,C,.25,1)}return this._prevEase={start:a.exported.now(),duration:s,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=F("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Fg{constructor(s,u){this._clickZoom=s,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class vi{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(s,u){return s.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(s.shiftKey?-1:1),around:g.unproject(u)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fv{constructor(){this._tap=new Sp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(s,u,g){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=u[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(s,u,g))}touchmove(s,u,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const _=u[0],b=_.y-this._swipePoint.y;return this._swipePoint=_,s.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(s,u,g)}touchend(s,u,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(s,u,g)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jg{constructor(s,u,g){this._el=s,this._mousePan=u,this._touchPan=g}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class mv{constructor(s,u,g){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=u,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class gv{constructor(s,u,g,_){this._el=s,this._touchZoom=u,this._touchRotate=g,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ho=p=>p.zoom||p.drag||p.pitch||p.rotate;class Ng extends a.Event{}class yv{constructor(){this.constants=[1,1,.01],this.radius=0}setup(s,u){const g=a.sub([],u,s);this.radius=a.length(g[2]<0?a.div([],g,this.constants):[g[0],g[1],0])}projectRay(s){a.div(s,s,this.constants),a.normalize(s,s),a.mul$1(s,s,this.constants);const u=a.scale$2([],s,this.radius);if(u[2]>0){const g=a.scale$2([],[0,0,1],a.dot(u,[0,0,1])),_=a.scale$2([],a.normalize([],[u[0],u[1],0]),this.radius),b=a.add([],u,a.scale$2([],a.sub([],a.add([],_,g),u),2));u[0]=b[0],u[1]=b[1]}return u}}function Io(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class Yo{constructor(s,u){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ag(s),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new yv,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),a.bindAll(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[_,b,T]of this._listeners)_.addEventListener(b,_===a.window.document?this.handleWindowEvent:this.handleEvent,T)}destroy(){for(const[s,u,g]of this._listeners)s.removeEventListener(u,s===a.window.document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(s){const u=this._map,g=u.getCanvasContainer();this._add("mapEvent",new wp(u,s));const _=u.boxZoom=new Mg(u,s);this._add("boxZoom",_);const b=new hv,T=new vi;u.doubleClickZoom=new Fg(T,b),this._add("tapZoom",b),this._add("clickZoom",T);const C=new fv;this._add("tapDragZoom",C);const A=u.touchPitch=new Lg(u);this._add("touchPitch",A);const z=new Tp(s),R=new Cp(s);u.dragRotate=new mv(s,z,R),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",R,["mouseRotate"]);const N=new Ep(s),Y=new id(u,s);u.dragPan=new jg(g,N,Y),this._add("mousePan",N),this._add("touchPan",Y,["touchZoom","touchRotate"]);const te=new zg,ie=new Rg;u.touchZoomRotate=new gv(g,ie,te,C),this._add("touchRotate",te,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]),this._add("blockableMapEvent",new nd(u));const re=u.scrollZoom=new Bg(u,this);this._add("scrollZoom",re,["mousePan"]);const se=u.keyboard=new pv;this._add("keyboard",se);for(const $ of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[$]&&u[$].enable(s[$])}_add(s,u,g){this._handlers.push({handlerName:s,handler:u,allowed:g}),this._handlersById[s]=u}stop(s){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ho(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(s,u,g){for(const _ in s)if(_!==g&&(!u||u.indexOf(_)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const u=[];for(const g of s)this._el.contains(g.target)&&u.push(g);return u}handleEvent(s,u){this._updatingCamera=!0;const g=s.type==="renderFrame",_=g?void 0:s,b={needsRenderFrame:!1},T={},C={},A=s.touches?this._getMapTouches(s.touches):void 0,z=A?_e(this._el,A):g?void 0:pe(this._el,s);for(const{handlerName:Y,handler:te,allowed:ie}of this._handlers){if(!te.isEnabled())continue;let re;this._blockedByActive(C,ie,Y)?te.reset():te[u||s.type]&&(re=te[u||s.type](s,z,A),this.mergeHandlerResult(b,T,re,Y,_),re&&re.needsRenderFrame&&this._triggerRenderFrame()),(re||te.isActive())&&(C[Y]=te)}const R={};for(const Y in this._previousActiveHandlers)C[Y]||(R[Y]=_);this._previousActiveHandlers=C,(Object.keys(R).length||Io(b))&&(this._changes.push([b,T,R]),this._triggerRenderFrame()),(Object.keys(C).length||Io(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=b;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))}mergeHandlerResult(s,u,g,_,b){if(!g)return;a.extend(s,g);const T={handlerName:_,originalEvent:g.originalEvent||b};g.zoomDelta!==void 0&&(u.zoom=T),g.panDelta!==void 0&&(u.drag=T),g.pitchDelta!==void 0&&(u.pitch=T),g.bearingDelta!==void 0&&(u.rotate=T)}_applyChanges(){const s={},u={},g={};for(const[_,b,T]of this._changes)_.panDelta&&(s.panDelta=(s.panDelta||new a.Point(0,0))._add(_.panDelta)),_.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(s.around=_.around),_.aroundCoord!==void 0&&(s.aroundCoord=_.aroundCoord),_.pinchAround!==void 0&&(s.pinchAround=_.pinchAround),_.noInertia&&(s.noInertia=_.noInertia),a.extend(u,b),a.extend(g,T);this._updateMapTransform(s,u,g),this._changes=[]}_updateMapTransform(s,u,g){const _=this._map,b=_.transform,T=ee=>[ee.x,ee.y,ee.z];if((ee=>{const ue=this._eventsInProgress.drag;return ue&&!this._handlersById[ue.handlerName].isActive()})()&&!Io(s)){const ee=b.zoom;b.cameraElevationReference="sea",b.recenterOnTerrain(),b.cameraElevationReference="ground",ee!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&_._stop(!0),!Io(s))return void this._fireEvents(u,g,!0);let{panDelta:C,zoomDelta:A,bearingDelta:z,pitchDelta:R,around:N,aroundCoord:Y,pinchAround:te}=s;b._isCameraConstrained&&(A>0&&(A=0),b._isCameraConstrained=!1),te!==void 0&&(N=te),(A||(ee=>u[ee]&&!this._eventsInProgress[ee])("drag"))&&N&&(this._dragOrigin=T(b.pointCoordinate3D(N)),this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",_._stop(!0),N=N||_.transform.centerPoint,z&&(b.bearing+=z),R&&(b.pitch+=R),b._updateCameraState();const ie=[0,0,0];if(C)if(b.projection.name==="mercator"){const ee=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(N).dir),ue=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(N.sub(C)).dir);ie[0]=ue[0]-ee[0],ie[1]=ue[1]-ee[1]}else{const ee=b.pointCoordinate(N);if(b.projection.name==="globe"){C=C.rotate(-b.angle);const ue=b._pixelsPerMercatorPixel/b.worldSize;ie[0]=-C.x*a.mercatorScale(a.latFromMercatorY(ee.y))*ue,ie[1]=-C.y*a.mercatorScale(b.center.lat)*ue}else{const ue=b.pointCoordinate(N.sub(C));ee&&ue&&(ie[0]=ue.x-ee.x,ie[1]=ue.y-ee.y)}}const re=b.zoom,se=[0,0,0];if(A){const ee=T(Y||b.pointCoordinate3D(N)),ue={dir:a.normalize([],a.sub([],ee,b._camera.position))};if(ue.dir[2]<0){const de=b.zoomDeltaToMovement(ee,A);a.scale$2(se,ue.dir,de)}}const $=a.add(ie,ie,se);b._translateCameraConstrained($),A&&Math.abs(b.zoom-re)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(u,g,!0)}_fireEvents(s,u,g){const _=ho(this._eventsInProgress),b=ho(s),T={};for(const R in s){const{originalEvent:N}=s[R];this._eventsInProgress[R]||(T[`${R}start`]=N),this._eventsInProgress[R]=s[R]}!_&&b&&this._fireEvent("movestart",b.originalEvent);for(const R in T)this._fireEvent(R,T[R]);b&&this._fireEvent("move",b.originalEvent);for(const R in s){const{originalEvent:N}=s[R];this._fireEvent(R,N)}const C={};let A;for(const R in this._eventsInProgress){const{handlerName:N,originalEvent:Y}=this._eventsInProgress[R];this._handlersById[N].isActive()||(delete this._eventsInProgress[R],A=u[N]||Y,C[`${R}end`]=A)}for(const R in C)this._fireEvent(R,C[R]);const z=ho(this._eventsInProgress);if(g&&(_||b)&&!z){this._updatingCamera=!0;const R=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),N=Y=>Y!==0&&-this._bearingSnap<Y&&Y<this._bearingSnap;R?(N(R.bearing||this._map.getBearing())&&(R.bearing=0),this._map.easeTo(R,{originalEvent:A})):(this._map.fire(new a.Event("moveend",{originalEvent:A})),N(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,u){this._map.fire(new a.Event(s,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{this._frameId=void 0,this.handleEvent(new Ng("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Aa="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class od extends a.Evented{constructor(s,u){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=u.bearingSnap,this._respectPrefersReducedMotion=u.respectPrefersReducedMotion!==!1,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(s,u){return this.jumpTo({center:s},u)}panBy(s,u,g){return s=a.Point.convert(s).mult(-1),this.panTo(this.transform.center,a.extend({offset:s},u),g)}panTo(s,u,g){return this.easeTo(a.extend({center:s},u),g)}getZoom(){return this.transform.zoom}setZoom(s,u){return this.jumpTo({zoom:s},u),this}zoomTo(s,u,g){return this.easeTo(a.extend({zoom:s},u),g)}zoomIn(s,u){return this.zoomTo(this.getZoom()+1,s,u),this}zoomOut(s,u){return this.zoomTo(this.getZoom()-1,s,u),this}getBearing(){return this.transform.bearing}setBearing(s,u){return this.jumpTo({bearing:s},u),this}getPadding(){return this.transform.padding}setPadding(s,u){return this.jumpTo({padding:s},u),this}rotateTo(s,u,g){return this.easeTo(a.extend({bearing:s},u),g)}resetNorth(s,u){return this.rotateTo(0,a.extend({duration:1e3},s),u),this}resetNorthPitch(s,u){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},s),u),this}snapToNorth(s,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,u):this}getPitch(){return this.transform.pitch}setPitch(s,u){return this.jumpTo({pitch:s},u),this}cameraForBounds(s,u){s=a.LngLatBounds.convert(s);const g=u&&u.bearing||0,_=u&&u.pitch||0,b=s.getNorthWest(),T=s.getSouthEast();return this._cameraForBounds(this.transform,b,T,g,_,u)}_extendCameraOptions(s){const u={top:0,bottom:0,right:0,left:0};if(typeof(s=a.extend({padding:u,offset:[0,0],maxZoom:this.transform.maxZoom},s)).padding=="number"){const g=s.padding;s.padding={top:g,bottom:g,right:g,left:g}}return s.padding=a.extend(u,s.padding),s}_minimumAABBFrustumDistance(s,u){const g=u.max[0]-u.min[0],_=u.max[1]-u.min[1];return g/_>s.aspect?g/(2*Math.tan(.5*s.fovX)*s.aspect):_/(2*Math.tan(.5*s.fovY)*s.aspect)}_cameraForBoundsOnGlobe(s,u,g,_,b,T){const C=s.clone(),A=this._extendCameraOptions(T);C.bearing=_,C.pitch=b;const z=a.LngLat.convert(u),R=a.LngLat.convert(g),N=.5*(z.lat+R.lat),Y=.5*(z.lng+R.lng),te=a.latLngToECEF(N,Y),ie=a.normalize([],te),re=a.normalize([],a.cross([],ie,[0,1,0])),se=a.cross([],re,ie),$=[re[0],re[1],re[2],0,se[0],se[1],se[2],0,ie[0],ie[1],ie[2],0,0,0,0,1],ee=[te,a.latLngToECEF(z.lat,z.lng),a.latLngToECEF(R.lat,z.lng),a.latLngToECEF(R.lat,R.lng),a.latLngToECEF(z.lat,R.lng),a.latLngToECEF(N,z.lng),a.latLngToECEF(N,R.lng),a.latLngToECEF(z.lat,Y),a.latLngToECEF(R.lat,Y)];let ue=a.Aabb.fromPoints(ee.map(Qe=>[a.dot(re,Qe),a.dot(se,Qe),a.dot(ie,Qe)]));const de=a.transformMat4([],ue.center,$);a.squaredLength(de)===0&&a.set(de,0,0,1),a.normalize(de,de),a.scale$2(de,de,a.GLOBE_RADIUS),C.center=a.ecefToLatLng(de);const Se=C.getWorldToCameraMatrix(),Te=a.invert(new Float64Array(16),Se);ue=a.Aabb.applyTransform(ue,a.multiply([],Se,$)),a.transformMat4(de,de,Se);const Ee=.5*(ue.max[2]-ue.min[2]),Pe=this._minimumAABBFrustumDistance(C,ue),Me=a.scale$2([],[0,0,1],Ee),je=a.add(Me,de,Me),rt=Pe+(C.pitch===0?0:a.distance(de,je)),Oe=C.globeCenterInViewSpace,Ke=a.sub([],de,[Oe[0],Oe[1],Oe[2]]);a.normalize(Ke,Ke),a.scale$2(Ke,Ke,rt);const $e=a.add([],de,Ke);a.transformMat4($e,$e,Te);const nt=a.earthRadius/a.GLOBE_RADIUS,Fe=a.length($e),Ze=a.mercatorZfromAltitude(Math.max(Fe*nt-a.earthRadius,Number.EPSILON),0),ot=Math.min(C.zoomFromMercatorZAdjusted(Ze),A.maxZoom);return ot>.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(C.setProjection({name:"mercator"}),C.zoom=ot,this._cameraForBounds(C,u,g,_,b,T)):{center:C.center,zoom:ot,bearing:_,pitch:b}}queryTerrainElevation(s,u){const g=this.transform.elevation;return g?(u=a.extend({},{exaggerated:!0},u),g.getAtPoint(a.MercatorCoordinate.fromLngLat(s),null,u.exaggerated)):null}_cameraForBounds(s,u,g,_,b,T){if(s.projection.name==="globe")return this._cameraForBoundsOnGlobe(s,u,g,_,b,T);const C=s.clone(),A=this._extendCameraOptions(T),z=C.padding;C.bearing=_,C.pitch=b;const R=a.LngLat.convert(u),N=a.LngLat.convert(g),Y=new a.LngLat(R.lng,N.lat),te=new a.LngLat(N.lng,R.lat),ie=C.project(R),re=C.project(N),se=this.queryTerrainElevation(R),$=this.queryTerrainElevation(N),ee=this.queryTerrainElevation(Y),ue=this.queryTerrainElevation(te),de=[[ie.x,ie.y,Math.min(se||0,$||0,ee||0,ue||0)],[re.x,re.y,Math.max(se||0,$||0,ee||0,ue||0)]];let Se=a.Aabb.fromPoints(de);const Te=C.getWorldToCameraMatrix(),Ee=a.invert(new Float64Array(16),Te);Se=a.Aabb.applyTransform(Se,Te);const Pe=a.sub([],Se.max,Se.min),Me=z.left||0,je=z.right||0,rt=z.bottom||0,Oe=z.top||0,{left:Ke,right:$e,top:nt,bottom:Fe}=A.padding,Ze=.5*(Me+je),ot=.5*(Oe+rt),Qe=Math.min(C.scaleZoom(C.scale*Math.min((C.width-(Me+je+Ke+$e))/Pe[0],(C.height-(rt+Oe+Fe+nt))/Pe[1])),A.maxZoom),at=C.scale/C.zoomScale(Qe);Se=new a.Aabb([Se.min[0]-(Ke+Ze)*at,Se.min[1]-(Fe+ot)*at,Se.min[2]],[Se.max[0]+($e+Ze)*at,Se.max[1]+(nt+ot)*at,Se.max[2]]);const Ot=.5*Pe[2],Ht=this._minimumAABBFrustumDistance(C,Se),At=[0,0,1,0];a.transformMat4$1(At,At,Te),a.normalize$2(At,At);const Ut=a.scale$2([],At,Ht+Ot),dn=a.add([],Se.center,Ut),ln=(typeof A.offset.x=="number"&&typeof A.offset.y=="number"?new a.Point(A.offset.x,A.offset.y):a.Point.convert(A.offset)).rotate(-a.degToRad(_));Se.center[0]-=ln.x*at,Se.center[1]+=ln.y*at,a.transformMat4(Se.center,Se.center,Ee),a.transformMat4(dn,dn,Ee);const Lt=[Se.center[0],Se.center[1],dn[2]*C.pixelsPerMeter];a.scale$2(Lt,Lt,1/C.worldSize);const Pn=a.lngFromMercatorX(Lt[0]),Bn=a.latFromMercatorY(Lt[1]),Fn=Math.min(C._zoomFromMercatorZ(Lt[2]),A.maxZoom),jn=new a.LngLat(Pn,Bn);return C.mercatorFromTransition&&Fn<.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(C.setProjection({name:"globe"}),C.zoom=Fn,this._cameraForBounds(C,u,g,_,b,T)):{center:jn,zoom:Fn,bearing:_,pitch:b}}fitBounds(s,u,g){const _=this.cameraForBounds(s,u);return this._fitInternal(_,u,g)}fitScreenCoordinates(s,u,g,_,b){const T=a.Point.convert(s),C=a.Point.convert(u),A=new a.Point(Math.min(T.x,C.x),Math.min(T.y,C.y)),z=new a.Point(Math.max(T.x,C.x),Math.max(T.y,C.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(T,C))return this;const R=this.transform.pointLocation3D(A),N=this.transform.pointLocation3D(z),Y=this.transform.pointLocation3D(new a.Point(A.x,z.y)),te=this.transform.pointLocation3D(new a.Point(z.x,A.y)),ie=[Math.min(R.lng,N.lng,Y.lng,te.lng),Math.min(R.lat,N.lat,Y.lat,te.lat)],re=[Math.max(R.lng,N.lng,Y.lng,te.lng),Math.max(R.lat,N.lat,Y.lat,te.lat)],se=_&&_.pitch?_.pitch:this.getPitch(),$=this._cameraForBounds(this.transform,ie,re,g,se,_);return this._fitInternal($,_,b)}_fitInternal(s,u,g){return s?(delete(u=a.extend(s,u)).padding,u.linear?this.easeTo(u,g):this.flyTo(u,g)):this}jumpTo(s,u){this.stop();const g=s.preloadOnly?this.transform.clone():this.transform;let _=!1,b=!1,T=!1;return"zoom"in s&&g.zoom!==+s.zoom&&(_=!0,g.zoom=+s.zoom),s.center!==void 0&&(g.center=a.LngLat.convert(s.center)),"bearing"in s&&g.bearing!==+s.bearing&&(b=!0,g.bearing=+s.bearing),"pitch"in s&&g.pitch!==+s.pitch&&(T=!0,g.pitch=+s.pitch),s.padding==null||g.isPaddingEqual(s.padding)||(g.padding=s.padding),s.preloadOnly?(this._preloadTiles(g),this):(this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),_&&this.fire(new a.Event("zoomstart",u)).fire(new a.Event("zoom",u)).fire(new a.Event("zoomend",u)),b&&this.fire(new a.Event("rotatestart",u)).fire(new a.Event("rotate",u)).fire(new a.Event("rotateend",u)),T&&this.fire(new a.Event("pitchstart",u)).fire(new a.Event("pitch",u)).fire(new a.Event("pitchend",u)),this.fire(new a.Event("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(Aa),this.transform.getFreeCameraOptions()}setFreeCameraOptions(s,u){const g=this.transform;if(!g.projection.supportsFreeCamera)return a.warnOnce(Aa),this;this.stop();const _=g.zoom,b=g.pitch,T=g.bearing;g.setFreeCameraOptions(s);const C=_!==g.zoom,A=b!==g.pitch,z=T!==g.bearing;return this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),C&&this.fire(new a.Event("zoomstart",u)).fire(new a.Event("zoom",u)).fire(new a.Event("zoomend",u)),z&&this.fire(new a.Event("rotatestart",u)).fire(new a.Event("rotate",u)).fire(new a.Event("rotateend",u)),A&&this.fire(new a.Event("pitchstart",u)).fire(new a.Event("pitch",u)).fire(new a.Event("pitchend",u)),this.fire(new a.Event("moveend",u)),this}easeTo(s,u){this._stop(!1,s.easeId),((s=a.extend({offset:[0,0],duration:500,easing:a.ease},s)).animate===!1||this._prefersReducedMotion(s))&&(s.duration=0);const g=this.transform,_=this.getZoom(),b=this.getBearing(),T=this.getPitch(),C=this.getPadding(),A="zoom"in s?+s.zoom:_,z="bearing"in s?this._normalizeBearing(s.bearing,b):b,R="pitch"in s?+s.pitch:T,N="padding"in s?s.padding:g.padding,Y=a.Point.convert(s.offset);let te,ie,re;if(g.projection.name==="globe"){const Me=a.MercatorCoordinate.fromLngLat(g.center),je=Y.rotate(-g.angle);Me.x+=je.x/g.worldSize,Me.y+=je.y/g.worldSize;const rt=Me.toLngLat(),Oe=a.LngLat.convert(s.center||rt);this._normalizeCenter(Oe),te=g.centerPoint.add(je),ie=new a.Point(Me.x,Me.y).mult(g.worldSize),re=new a.Point(a.mercatorXfromLng(Oe.lng),a.mercatorYfromLat(Oe.lat)).mult(g.worldSize).sub(ie)}else{te=g.centerPoint.add(Y);const Me=g.pointLocation(te),je=a.LngLat.convert(s.center||Me);this._normalizeCenter(je),ie=g.project(Me),re=g.project(je).sub(ie)}const se=g.zoomScale(A-_);let $,ee;s.around&&($=a.LngLat.convert(s.around),ee=g.locationPoint($));const ue=this._zooming||A!==_,de=this._rotating||b!==z,Se=this._pitching||R!==T,Te=!g.isPaddingEqual(N),Ee=Me=>je=>{if(ue&&(Me.zoom=a.number(_,A,je)),de&&(Me.bearing=a.number(b,z,je)),Se&&(Me.pitch=a.number(T,R,je)),Te&&(Me.interpolatePadding(C,N,je),te=Me.centerPoint.add(Y)),$)Me.setLocationAtPoint($,ee);else{const rt=Me.zoomScale(Me.zoom-_),Oe=A>_?Math.min(2,se):Math.max(.5,se),Ke=Math.pow(Oe,1-je),$e=Me.unproject(ie.add(re.mult(je*Ke)).mult(rt));Me.setLocationAtPoint(Me.renderWorldCopies?$e.wrap():$e,te)}return s.preloadOnly||this._fireMoveEvents(u),Me};if(s.preloadOnly){const Me=this._emulate(Ee,s.duration,g);return this._preloadTiles(Me),this}const Pe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ue,this._rotating=de,this._pitching=Se,this._padding=Te,this._easeId=s.easeId,this._prepareEase(u,s.noMoveStart,Pe),this._ease(Ee(g),Me=>{g.recenterOnTerrain(),this._afterEase(u,Me)},s),this}_prepareEase(s,u,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",u||g.moving||this.fire(new a.Event("movestart",s)),this._zooming&&!g.zooming&&this.fire(new a.Event("zoomstart",s)),this._rotating&&!g.rotating&&this.fire(new a.Event("rotatestart",s)),this._pitching&&!g.pitching&&this.fire(new a.Event("pitchstart",s))}_fireMoveEvents(s){this.fire(new a.Event("move",s)),this._zooming&&this.fire(new a.Event("zoom",s)),this._rotating&&this.fire(new a.Event("rotate",s)),this._pitching&&this.fire(new a.Event("pitch",s))}_afterEase(s,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,_=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new a.Event("zoomend",s)),_&&this.fire(new a.Event("rotateend",s)),b&&this.fire(new a.Event("pitchend",s)),this.fire(new a.Event("moveend",s))}flyTo(s,u){if(this._prefersReducedMotion(s)){const Qe=a.pick(s,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Qe,u)}this.stop(),s=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},s);const g=this.transform,_=this.getZoom(),b=this.getBearing(),T=this.getPitch(),C=this.getPadding(),A="zoom"in s?a.clamp(+s.zoom,g.minZoom,g.maxZoom):_,z="bearing"in s?this._normalizeBearing(s.bearing,b):b,R="pitch"in s?+s.pitch:T,N="padding"in s?s.padding:g.padding,Y=g.zoomScale(A-_),te=a.Point.convert(s.offset);let ie=g.centerPoint.add(te);const re=g.pointLocation(ie),se=a.LngLat.convert(s.center||re);this._normalizeCenter(se);const $=g.project(re),ee=g.project(se).sub($);let ue=s.curve;const de=Math.max(g.width,g.height),Se=de/Y,Te=ee.mag();if("minZoom"in s){const Qe=a.clamp(Math.min(s.minZoom,_,A),g.minZoom,g.maxZoom),at=de/g.zoomScale(Qe-_);ue=Math.sqrt(at/Te*2)}const Ee=ue*ue;function Pe(Qe){const at=(Se*Se-de*de+(Qe?-1:1)*Ee*Ee*Te*Te)/(2*(Qe?Se:de)*Ee*Te);return Math.log(Math.sqrt(at*at+1)-at)}function Me(Qe){return(Math.exp(Qe)-Math.exp(-Qe))/2}function je(Qe){return(Math.exp(Qe)+Math.exp(-Qe))/2}const rt=Pe(0);let Oe=function(Qe){return je(rt)/je(rt+ue*Qe)},Ke=function(Qe){return de*((je(rt)*(Me(at=rt+ue*Qe)/je(at))-Me(rt))/Ee)/Te;var at},$e=(Pe(1)-rt)/ue;if(Math.abs(Te)<1e-6||!isFinite($e)){if(Math.abs(de-Se)<1e-6)return this.easeTo(s,u);const Qe=Se<de?-1:1;$e=Math.abs(Math.log(Se/de))/ue,Ke=function(){return 0},Oe=function(at){return Math.exp(Qe*ue*at)}}s.duration="duration"in s?+s.duration:1e3*$e/("screenSpeed"in s?+s.screenSpeed/ue:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0);const nt=b!==z,Fe=R!==T,Ze=!g.isPaddingEqual(N),ot=Qe=>at=>{const Ot=at*$e,Ht=1/Oe(Ot);Qe.zoom=at===1?A:_+Qe.scaleZoom(Ht),nt&&(Qe.bearing=a.number(b,z,at)),Fe&&(Qe.pitch=a.number(T,R,at)),Ze&&(Qe.interpolatePadding(C,N,at),ie=Qe.centerPoint.add(te));const At=at===1?se:Qe.unproject($.add(ee.mult(Ke(Ot))).mult(Ht));return Qe.setLocationAtPoint(Qe.renderWorldCopies?At.wrap():At,ie),Qe._updateCameraOnTerrain(),s.preloadOnly||this._fireMoveEvents(u),Qe};if(s.preloadOnly){const Qe=this._emulate(ot,s.duration,g);return this._preloadTiles(Qe),this}return this._zooming=!0,this._rotating=nt,this._pitching=Fe,this._padding=Ze,this._prepareEase(u,!1),this._ease(ot(g),()=>this._afterEase(u),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(s,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,u)}if(!s){const g=this.handlers;g&&g.stop(!1)}return this}_ease(s,u,g){g.animate===!1||g.duration===0?(s(1),u()):(this._easeStart=a.exported.now(),this._easeOptions=g,this._onEaseFrame=s,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,u){s=a.wrap(s,-180,180);const g=Math.abs(s-u);return Math.abs(s-360-u)<g&&(s-=360),Math.abs(s+360-u)<g&&(s+=360),s}_normalizeCenter(s){const u=this.transform;if(!u.renderWorldCopies||u.maxBounds)return;const g=s.lng-u.center.lng;s.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(s){return this._respectPrefersReducedMotion&&a.exported.prefersReducedMotion&&!(s&&s.essential)}_emulate(s,u,g){const _=Math.ceil(15*u/1e3),b=[],T=s(g.clone());for(let C=0;C<=_;C++){const A=T(C/_);b.push(A.clone())}return b}}class kt{constructor(s={}){this.options=s,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){const u=this.options&&this.options.compact;return this._map=s,this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=F("button","mapboxgl-ctrl-attrib-button",this._container),F("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=F("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(s,u){const g=this._map._getUIString(`AttributionControl.${u}`);s.setAttribute("aria-label",g),s.removeAttribute("title"),s.firstElementChild&&s.firstElementChild.setAttribute("title",g)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(s){const g=u.reduce((_,b,T)=>(b.value&&(_+=`${b.key}=${b.value}${T<u.length-1?"&":""}`),_),"?");s.href=`${a.config.FEEDBACK_URL}/${g}#${Rc(this._map,!0)}`,s.rel="noopener nofollow",this._setElementTitle(s,"MapFeedback")}}_updateData(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let s=[];if(this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const u=this._map.style._sourceCaches;for(const _ in u){const b=u[_];if(b.used){const T=b.getSource();T.attribution&&s.indexOf(T.attribution)<0&&s.push(T.attribution)}}s.sort((_,b)=>_.length-b.length),s=s.filter((_,b)=>{for(let T=b+1;T<s.length;T++)if(s[T].indexOf(_)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=[...this.options.customAttribution,...s]:s.unshift(this.options.customAttribution));const g=s.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,s.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Mp{constructor(){a.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(s){this._map=s,this._container=F("div","mapboxgl-ctrl");const u=F("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const s=this._map.style._sourceCaches;if(Object.entries(s).length===0)return!0;for(const u in s){const g=s[u].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const s=this._container.children;if(s.length){const u=s[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class Pp{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const u=++this._id;return this._queue.push({callback:s,id:u,cancelled:!1}),u}remove(s){const u=this._currentlyRunning,g=u?this._queue.concat(u):this._queue;for(const _ of g)if(_.id===s)return void(_.cancelled=!0)}run(s=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const g of u)if(!g.cancelled&&(g.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function vl(p,s,u){if(p=new a.LngLat(p.lng,p.lat),s){const g=new a.LngLat(p.lng-360,p.lat),_=new a.LngLat(p.lng+360,p.lat),b=360*Math.ceil(Math.abs(p.lng-u.center.lng)/360),T=u.locationPoint(p).distSqr(s),C=s.x<0||s.y<0||s.x>u.width||s.y>u.height;u.locationPoint(g).distSqr(s)<T&&(C||Math.abs(g.lng-u.center.lng)<b)?p=g:u.locationPoint(_).distSqr(s)<T&&(C||Math.abs(_.lng-u.center.lng)<b)&&(p=_)}for(;Math.abs(p.lng-u.center.lng)>180;){const g=u.locationPoint(p);if(g.x>=0&&g.y>=0&&g.x<=u.width&&g.y<=u.height)break;p.lng>u.center.lng?p.lng-=360:p.lng+=360}return p}const Ma={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class bt extends a.Evented{constructor(s,u){if(super(),(s instanceof a.window.HTMLElement||u)&&(s=a.extend({element:s},u)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&s.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=s&&s.occludedOpacity||.2,s&&s.element)this._element=s.element,this._offset=a.Point.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=F("div");const _=41,b=27,T=K("svg",{display:"block",height:_*this._scale+"px",width:b*this._scale+"px",viewBox:`0 0 ${b} ${_}`},this._element),C=K("radialGradient",{id:"shadowGradient"},K("defs",{},T));K("stop",{offset:"10%","stop-opacity":.4},C),K("stop",{offset:"100%","stop-opacity":.05},C),K("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},T),K("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},T),K("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},T),K("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},T),this._offset=a.Point.convert(s&&s.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",_=>{_.preventDefault()}),this._element.addEventListener("mousedown",_=>{_.preventDefault()});const g=this._element.classList;for(const _ in Ma)g.remove(`mapboxgl-marker-anchor-${_}`);g.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(s){return s===this._map||(this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._updateMoving),s.on("moveend",this._update),s.on("remove",this._clearFadeTimer),s._addMarker(this),this.setDraggable(this._draggable),this._update(),s.on("click",this._onMapClick)),this}remove(){const s=this._map;return s&&(s.off("click",this._onMapClick),s.off("move",this._updateMoving),s.off("moveend",this._update),s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler),s.off("mouseup",this._onUp),s.off("touchend",this._onUp),s.off("mousemove",this._onMove),s.off("touchmove",this._onMove),s.off("remove",this._clearFadeTimer),s._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=a.LngLat.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,s._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(s){const u=s.code,g=s.charCode||s.keyCode;u!=="Space"&&u!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(s){const u=s.originalEvent.target,g=this._element;this._popup&&(u===g||g.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?(s.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(s.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const s=this._map,u=this._pos;if(!s||!u)return!1;const g=s.unproject(u),_=s.getFreeCameraOptions();if(!_.position)return!1;const b=_.position.toLngLat();return b.distanceTo(g)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){const s=this._map;if(!s)return;const u=this._pos;if(!u||u.x<0||u.x>s.transform.width||u.y<0||u.y>s.transform.height)return void this._clearFadeTimer();const g=s.unproject(u);let _;s._showingGlobe()&&a.isLngLatBehindGlobe(s.transform,this._lngLat)?_=0:(_=1-s._queryFogOpacity(g),s.transform._terrainEnabled()&&s.getTerrain()&&this._behindTerrain()&&(_*=this._occludedOpacity)),this._element.style.opacity=`${_}`,this._element.style.pointerEvents=_>0?"auto":"none",this._popup&&this._popup._setOpacity(_),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const s=this._pos;if(!s||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${s.x}px,${s.y}px)
            ${Ma[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const s=this._pos,u=this._map,g=this.getPitchAlignment();if(!u||!s||g!=="map")return"";if(!u._showingGlobe()){const A=u.getPitch();return A?`rotateX(${A}deg)`:""}const _=a.radToDeg(a.globeTiltAtLngLat(u.transform,this._lngLat)),b=s.sub(a.globeCenterToScreenPoint(u.transform)),T=Math.abs(b.x)+Math.abs(b.y);if(T===0)return"";const C=_/T;return`rotateX(${-b.y*C}deg) rotateY(${b.x*C}deg)`}_calculateZTransform(){const s=this._pos,u=this._map;if(!u||!s)return"";let g=0;const _=this.getRotationAlignment();if(_==="map")if(u._showingGlobe()){const b=u.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),T=u.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(b);g=a.radToDeg(Math.atan2(T.y,T.x))-90}else g=-u.getBearing();else if(_==="horizon"){const b=a.smoothstep(4,6,u.getZoom()),T=a.globeCenterToScreenPoint(u.transform);T.y+=b*u.transform.height;const C=s.sub(T),A=a.radToDeg(Math.atan2(C.y,C.x));g=(A>90?A-270:A+90)*(1-b)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(s){a.window.cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=vl(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat),s===!0?this._updateFrameId=a.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(s){return this._offset=a.Point.convert(s),this._update(),this}_onMove(s){const u=this._map;if(!u)return;const g=this._pointerdownPos,_=this._positionDelta;if(g&&_){if(!this._isDragging){const b=this._clickTolerance||u._clickTolerance;if(s.point.dist(g)<b)return;this._isDragging=!0}this._pos=s.point.sub(_),this._lngLat=u.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const s=this._map;s&&(s.off("mousemove",this._onMove),s.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(s){const u=this._map,g=this._pos;u&&g&&this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(g),this._pointerdownPos=s.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(s){this._draggable=!!s;const u=this._map;return u&&(s?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(s){return this._occludedOpacity=s||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Rp={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},_v=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function $g(p=new a.Point(0,0),s="bottom"){if(typeof p=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(p,2)));switch(s){case"top":return new a.Point(0,p);case"top-left":return new a.Point(u,u);case"top-right":return new a.Point(-u,u);case"bottom":return new a.Point(0,-p);case"bottom-left":return new a.Point(u,-u);case"bottom-right":return new a.Point(-u,-u);case"left":return new a.Point(p,0);case"right":return new a.Point(-p,0)}return new a.Point(0,0)}return p instanceof a.Point||Array.isArray(p)?a.Point.convert(p):a.Point.convert(p[s]||[0,0])}class zp{constructor(s){this.jumpTo(s)}getValue(s){if(s<=this._startTime)return this._start;if(s>=this._endTime)return this._end;const u=a.easeCubicInOut((s-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(s){return s>=this._startTime&&s<=this._endTime}jumpTo(s){this._startTime=-1/0,this._endTime=-1/0,this._start=s,this._end=s}easeTo(s,u,g){this._start=this.getValue(u),this._end=s,this._startTime=u,this._endTime=u+g}}const Ug={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Vg={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},xv={showCompass:!0,showZoom:!0,visualizePitch:!1};class vv{constructor(s,u,g=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new Tp({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,g&&(this.mousePitch=new Cp({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(s,u){this.mouseRotate.mousedown(s,u),this.mousePitch&&this.mousePitch.mousedown(s,u),Z()}move(s,u){const g=this.map,_=this.mouseRotate.mousemoveWindow(s,u),b=_&&_.bearingDelta;if(b&&g.setBearing(g.getBearing()+b),this.mousePitch){const T=this.mousePitch.mousemoveWindow(s,u),C=T&&T.pitchDelta;C&&g.setPitch(g.getPitch()+C)}}off(){const s=this.element;s.removeEventListener("mousedown",this.mousedown),s.removeEventListener("touchstart",this.touchstart,{passive:!1}),s.removeEventListener("touchmove",this.touchmove),s.removeEventListener("touchend",this.touchend),s.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){H(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(s){this.down(a.extend({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),pe(this.element,s)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(s){this.move(s,pe(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=_e(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){s.targetTouches.length!==1?this.reset():(this._lastPos=_e(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Lp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Dp={maxWidth:100,unit:"metric"},Op={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},bl={version:a.version,supported:I,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends od{constructor(p){if(a.LivePerformanceUtils.mark(a.PerformanceMarkers.create),(p=a.extend({},Vg,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(p.antialias&&a.isSafariWithAntialiasingBug(a.window)&&(p.antialias=!1,a.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new gl(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies),p),this._interactive=p.interactive,this._minTileCacheSize=p.minTileCacheSize,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._useWebGL2=p.useWebGL2,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=p.crossSourceCollisions,this._collectResourceTiming=p.collectResourceTiming,this._optimizeForTerrain=p.optimizeForTerrain,this._language=this._parseLanguage(p.language),this._worldview=p.worldview,this._renderTaskQueue=new Pp,this._domRenderTaskQueue=new Pp,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Ug,p.locale),this._clickTolerance=p.clickTolerance,this._cooperativeGestures=p.cooperativeGestures,this._performanceMetricsCollection=p.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new zp(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new a.RequestManager(p.transformRequest,p.accessToken,p.testMode),this._silenceAuthErrors=!!p.testMode,typeof p.container=="string"){if(this._container=a.window.document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof a.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),p.maxBounds&&this.setMaxBounds(p.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Yo(this,p),this._localFontFamily=p.localFontFamily,this._localIdeographFontFamily=p.localIdeographFontFamily,p.style&&this.setStyle(p.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),p.projection&&this.setProjection(p.projection),this._hash=p.hash&&new bp(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,a.extend({},p.fitBoundsOptions,{duration:0})))),this.resize(),p.attributionControl&&this.addControl(new kt({customAttribution:p.customAttribution})),this._logoControl=new Mp,this.addControl(this._logoControl,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new a.Event(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new a.Event(`${s.dataType}dataloading`,s))})}_getMapId(){return this._mapId}addControl(p,s){if(s===void 0&&(s=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=p.onAdd(this);this._controls.push(p);const g=this._controlPositions[s];return s.indexOf("bottom")!==-1?g.insertBefore(u,g.firstChild):g.appendChild(u),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(p);return s>-1&&this._controls.splice(s,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(p){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const s=!this._moving;return s&&this.fire(new a.Event("movestart",p)).fire(new a.Event("move",p)),this.fire(new a.Event("resize",p)),s&&this.fire(new a.Event("moveend",p)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(p){return this.transform.setMaxBounds(a.LngLatBounds.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p?this.setZoom(p):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p?this.setZoom(p):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p?this.setPitch(p):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p?this.setPitch(p):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(p){return p==="auto"?a.window.navigator.language:Array.isArray(p)?p.length===0?void 0:p.map(s=>s==="auto"?a.window.navigator.language:s):p}setLanguage(p){const s=this._parseLanguage(p);if(!this.style||s===this._language)return this;this._language=s,this.style._reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(p){return this.style&&p!==this._worldview?(this._worldview=p,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(p){return this._lazyInitEmptyStyle(),p?typeof p=="string"&&(p={name:p}):p=null,this._useExplicitProjection=!!p,this._prioritizeAndUpdateProjection(p,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const p=this.transform,s=p.projection.name;let u;s==="globe"&&p.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?(p.setMercatorFromTransition(),u=!0):s==="mercator"&&p.zoom<a.GLOBE_ZOOM_THRESHOLD_MAX&&(p.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(p,s){return this._updateProjection(p||s||{name:"mercator"})}_updateProjection(p){let s;if(s=p.name==="globe"&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(p),this.style.applyProjectionUpdate(),s){this.painter.clearBackgroundTiles();for(const u in this.style._sourceCaches)this.style._sourceCaches[u].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(p){return this.transform.locationPoint3D(a.LngLat.convert(p))}unproject(p){return this.transform.pointLocation3D(a.Point.convert(p))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(p,s,u){if(p==="mouseenter"||p==="mouseover"){let g=!1;const _=T=>{const C=s.filter(z=>this.getLayer(z)),A=C.length?this.queryRenderedFeatures(T.point,{layers:C}):[];A.length?g||(g=!0,u.call(this,new ni(p,this,T.originalEvent,{features:A}))):g=!1},b=()=>{g=!1};return{layers:new Set(s),listener:u,delegates:{mousemove:_,mouseout:b}}}if(p==="mouseleave"||p==="mouseout"){let g=!1;const _=T=>{const C=s.filter(A=>this.getLayer(A));(C.length?this.queryRenderedFeatures(T.point,{layers:C}):[]).length?g=!0:g&&(g=!1,u.call(this,new ni(p,this,T.originalEvent)))},b=T=>{g&&(g=!1,u.call(this,new ni(p,this,T.originalEvent)))};return{layers:new Set(s),listener:u,delegates:{mousemove:_,mouseout:b}}}{const g=_=>{const b=s.filter(C=>this.getLayer(C)),T=b.length?this.queryRenderedFeatures(_.point,{layers:b}):[];T.length&&(_.features=T,u.call(this,_),delete _.features)};return{layers:new Set(s),listener:u,delegates:{[p]:g}}}}on(p,s,u){if(u===void 0)return super.on(p,s);Array.isArray(s)||(s=[s]);const g=this._createDelegatedListener(p,s,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(g);for(const _ in g.delegates)this.on(_,g.delegates[_]);return this}once(p,s,u){if(u===void 0)return super.once(p,s);Array.isArray(s)||(s=[s]);const g=this._createDelegatedListener(p,s,u);for(const _ in g.delegates)this.once(_,g.delegates[_]);return this}off(p,s,u){if(u===void 0)return super.off(p,s);s=new Set(Array.isArray(s)?s:[s]);const g=(b,T)=>{if(b.size!==T.size)return!1;for(const C of b)if(!T.has(C))return!1;return!0},_=this._delegatedListeners?this._delegatedListeners[p]:void 0;return _&&(b=>{for(let T=0;T<b.length;T++){const C=b[T];if(C.listener===u&&g(C.layers,s)){for(const A in C.delegates)this.off(A,C.delegates[A]);return b.splice(T,1),this}}})(_),this}queryRenderedFeatures(p,s){return this.style?(s!==void 0||p===void 0||p instanceof a.Point||Array.isArray(p)||(s=p,p=void 0),this.style.queryRenderedFeatures(p=p||[[0,0],[this.transform.width,this.transform.height]],s=s||{},this.transform)):[]}querySourceFeatures(p,s){return this.style.querySourceFeatures(p,s)}isPointOnSurface(p){const{name:s}=this.transform.projection;return s!=="globe"&&s!=="mercator"&&a.warnOnce(`${s} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.Point.convert(p))}setStyle(p,s){return(s=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},s)).diff!==!1&&s.localIdeographFontFamily===this._localIdeographFontFamily&&s.localFontFamily===this._localFontFamily&&this.style&&p?(this._diffStyle(p,s),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._localFontFamily=s.localFontFamily,this._updateStyle(p,s))}_getUIString(p){const s=this._locale[p];if(s==null)throw new Error(`Missing UI string '${p}'`);return s}_updateStyle(p,s){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),p&&(this.style=new Xo(this,s||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p):this.style.loadJSON(p)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Xo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,s){if(typeof p=="string"){const u=this._requestManager.normalizeStyleURL(p),g=this._requestManager.transformRequest(u,a.ResourceType.Style);a.getJSON(g,(_,b)=>{_?this.fire(new a.ErrorEvent(_)):b&&this._updateDiff(b,s)})}else typeof p=="object"&&this._updateDiff(p,s)}_updateDiff(p,s){try{this.style.setState(p)&&this._update(!0)}catch(u){a.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(p,s)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.warnOnce("There is no style added to the map."),!1)}addSource(p,s){return this._lazyInitEmptyStyle(),this.style.addSource(p,s),this._update(!0)}isSourceLoaded(p){return!!this.style&&this.style._isSourceCacheLoaded(p)}areTilesLoaded(){const p=this.style&&this.style._sourceCaches;for(const s in p){const u=p[s]._tiles;for(const g in u){const _=u[g];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}addSourceType(p,s,u){this._lazyInitEmptyStyle(),this.style.addSourceType(p,s,u)}removeSource(p){return this.style.removeSource(p),this._updateTerrain(),this._update(!0)}getSource(p){return this.style.getSource(p)}addImage(p,s,{pixelRatio:u=1,sdf:g=!1,stretchX:_,stretchY:b,content:T}={}){if(this._lazyInitEmptyStyle(),s instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&s instanceof a.window.ImageBitmap){const{width:C,height:A,data:z}=a.exported.getImageData(s);this.style.addImage(p,{data:new a.RGBAImage({width:C,height:A},z),pixelRatio:u,stretchX:_,stretchY:b,content:T,sdf:g,version:0})}else if(s.width===void 0||s.height===void 0)this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:C,height:A}=s,z=s;this.style.addImage(p,{data:new a.RGBAImage({width:C,height:A},new Uint8Array(z.data)),pixelRatio:u,stretchX:_,stretchY:b,content:T,sdf:g,version:0,userImage:z}),z.onAdd&&z.onAdd(this,p)}}updateImage(p,s){const u=this.style.getImage(p);if(!u)return void this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=s instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&s instanceof a.window.ImageBitmap?a.exported.getImageData(s):s,{width:_,height:b}=g;_!==void 0&&b!==void 0?_===u.data.width&&b===u.data.height?(u.data.replace(g.data,!(s instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&s instanceof a.window.ImageBitmap)),this.style.updateImage(p,u)):this.fire(new a.ErrorEvent(new Error(`The width and height of the updated image (${_}, ${b})
                must be that same as the previous version of the image
                (${u.data.width}, ${u.data.height})`))):this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p,s){a.getImage(this._requestManager.transformRequest(p,a.ResourceType.Image),(u,g)=>{s(u,g instanceof a.window.HTMLImageElement?a.exported.getImageData(g):g)})}listImages(){return this.style.listImages()}addLayer(p,s){return this._lazyInitEmptyStyle(),this.style.addLayer(p,s),this._update(!0)}moveLayer(p,s){return this.style.moveLayer(p,s),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}setLayerZoomRange(p,s,u){return this.style.setLayerZoomRange(p,s,u),this._update(!0)}setFilter(p,s,u={}){return this.style.setFilter(p,s,u),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,s,u,g={}){return this.style.setPaintProperty(p,s,u,g),this._update(!0)}getPaintProperty(p,s){return this.style.getPaintProperty(p,s)}setLayoutProperty(p,s,u,g={}){return this.style.setLayoutProperty(p,s,u,g),this._update(!0)}getLayoutProperty(p,s){return this.style.getLayoutProperty(p,s)}setLight(p,s={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,s),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(p){return this._lazyInitEmptyStyle(),!p&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(p),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(p){return this._lazyInitEmptyStyle(),this.style.setFog(p),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(p){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(p),this.transform):0}setFeatureState(p,s){return this.style.setFeatureState(p,s),this._update()}removeFeatureState(p,s){return this.style.removeFeatureState(p,s),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}_updateContainerDimensions(){if(!this._container)return;const p=this._container.getBoundingClientRect().width||400,s=this._container.getBoundingClientRect().height||300;let u,g,_,b=this._container;for(;b&&(!g||!_);){const T=a.window.getComputedStyle(b).transform;T&&T!=="none"&&(u=T.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(g=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(_=u[3])),b=b.parentElement}this._containerWidth=g?Math.abs(p/g):p,this._containerHeight=_?Math.abs(s/_):s}_detectMissingCSS(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=F("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();const s=this._canvasContainer=F("div","mapboxgl-canvas-container",p);this._interactive&&s.classList.add("mapboxgl-interactive"),this._canvas=F("canvas","mapboxgl-canvas",s),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=F("div","mapboxgl-control-container",p),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{g[_]=F("div",`mapboxgl-ctrl-${_}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,s){const u=a.exported.devicePixelRatio||1;this._canvas.width=u*Math.ceil(p),this._canvas.height=u*Math.ceil(s),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${s}px`}_addMarker(p){this._markers.push(p)}_removeMarker(p){const s=this._markers.indexOf(p);s!==-1&&this._markers.splice(s,1)}_addPopup(p){this._popups.push(p)}_removePopup(p){const s=this._popups.indexOf(p);s!==-1&&this._popups.splice(s,1)}_setupPainter(){const p=a.extend({},I.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._useWebGL2&&this._canvas.getContext("webgl2",p),u=s||this._canvas.getContext("webgl",p)||this._canvas.getContext("experimental-webgl",p);u?(this._useWebGL2&&!s&&a.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),a.storeAuthState(u,!0),this.painter=new fl(u,this.transform,!!s),this.on("data",g=>{g.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(u)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:p}))}_contextRestored(p){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:p}))}_onMapScroll(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_requestDomTask(p){!this.loaded()||this.loaded()&&!this.isMoving()?p():this._domRenderTaskQueue.add(p)}_render(p){let s;const u=this.painter.context.extTimerQuery,g=a.exported.now();if(this.listens("gpu-timing-frame")&&(s=u.createQueryEXT(),u.beginQueryEXT(u.TIME_ELAPSED_EXT,s)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],a.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],a.window.performance.now())),this._renderTaskQueue.run(p),this._domRenderTaskQueue.run(p),this._removed)return;this._updateProjectionTransition();const _=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const C=this.transform.zoom,A=this.transform.pitch,z=a.exported.now(),R=new a.EvaluationParameters(C,{now:z,fadeDuration:_,pitch:A,transition:this.style.getTransition()});this.style.update(R)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let b=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),b=this._updateAverageElevation(g),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):b=this._updateAverageElevation(g),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,_,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:_,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),s){const C=a.exported.now()-g;u.endQueryEXT(u.TIME_ELAPSED_EXT,s),setTimeout(()=>{const A=u.getQueryObjectEXT(s,u.QUERY_RESULT_EXT)/1e6;u.deleteQueryEXT(s),this.fire(new a.Event("gpu-timing-frame",{cpuTime:C,gpuTime:A})),a.window.performance.mark("frame-gpu",{startTime:g,detail:{gpuTime:A}})},50)}if(this.listens("gpu-timing-layer")){const C=this.painter.collectGpuTimers();setTimeout(()=>{const A=this.painter.queryGpuTimers(C);this.fire(new a.Event("gpu-timing-layer",{layerTimes:A}))},50)}if(this.listens("gpu-timing-deferred-render")){const C=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const A=this.painter.queryGpuTimeDeferredRender(C);this.fire(new a.Event("gpu-timing-deferred-render",{gpuTime:A}))},50)}const T=this._sourcesDirty||this._styleDirty||this._placementDirty||b;if(T||this._repaint)this.triggerRepaint();else{const C=!this.isMoving()&&this.loaded();if(C&&(b=this._updateAverageElevation(g,!0)),b)this.triggerRepaint();else if(this._triggerFrame(!1),C&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const A=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:A})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||T||(this._fullyLoaded=!0,a.LivePerformanceUtils.mark(a.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&a.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(p){for(const s of this._markers)p&&!this.getRenderWorldCopies()&&(s._lngLat=s._lngLat.wrap()),s._update();for(const s of this._popups)!p||this.getRenderWorldCopies()||s._trackPointer||(s._lngLat=s._lngLat.wrap()),s._update()}_updateAverageElevation(p,s=!1){const u=g=>(this.transform.averageElevation=g,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);if((s||p-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(p)){const g=this.transform.averageElevation;let _=this.transform.sampleAverageElevation(),b=!1;this.transform.elevation&&(b=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(_)?_=0:this._averageElevationLastSampledAt=p;const T=Math.abs(g-_);if(T>1){if(this._isInitialLoad||b)return this._averageElevation.jumpTo(_),u(_);this._averageElevation.easeTo(_,p,300)}else if(T>1e-4)return this._averageElevation.jumpTo(_),u(_)}return!!this._averageElevation.isEasing(p)&&u(this._averageElevation.getValue(p))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,p=>{if(p&&(p.message===a.AUTH_ERR_MSG||p.status===401)){const s=this.painter.context.gl;a.storeAuthState(s,!1),this._logoControl instanceof Mp&&this._logoControl._updateLogo(),s&&s.clear(s.DEPTH_BUFFER_BIT|s.COLOR_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const p=this._isDragging();this.painter.updateTerrain(this.style,p)}_calculateSpeedIndex(){const p=this.painter.canvasCopy(),s=this.painter.getCanvasCopiesAndTimestamps();s.timeStamps.push(performance.now());const u=this.painter.context.gl,g=u.createFramebuffer();function _(b){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,b,0);const T=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,T),T}return u.bindFramebuffer(u.FRAMEBUFFER,g),this._canvasPixelComparison(_(p),s.canvasCopies.map(_),s.timeStamps)}_canvasPixelComparison(p,s,u){let g=u[1]-u[0];const _=p.length/4;for(let b=0;b<s.length;b++){const T=s[b];let C=0;for(let A=0;A<T.length;A+=4)T[A]===p[A]&&T[A+1]===p[A+1]&&T[A+2]===p[A+2]&&T[A+3]===p[A+3]&&(C+=1);g+=(u[b+2]-u[b+1])*(1-C/_)}return g}remove(){this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1),a.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const p=this.painter.context.gl.getExtension("WEBGL_lose_context");p&&p.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(p){this._renderNextFrame=this._renderNextFrame||p,this.style&&!this._frame&&(this._frame=a.exported.frame(s=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(s)}))}_preloadTiles(p){const s=this.style?Object.values(this.style._sourceCaches):[];return a.asyncAll(s,(u,g)=>u._preloadTiles(p,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(p){this._trackResize&&this.resize({originalEvent:p})._update()}_onVisibilityChange(){a.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(p){this._showTerrainWireframe!==p&&(this._showTerrainWireframe=p,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(p){this._speedIndexTiming!==p&&(this._speedIndexTiming=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(p){this._showTileAABBs!==p&&(this._showTileAABBs=p,p&&this._update())}_setCacheLimits(p,s){a.setCacheLimits(p,s)}get version(){return a.version}},NavigationControl:class{constructor(p){this.options=a.extend({},xv,p),this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",s=>{this._map&&this._map.zoomIn({},{originalEvent:s})}),F("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",s=>{this._map&&this._map.zoomOut({},{originalEvent:s})}),F("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",s=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:s}):u.resetNorth({},{originalEvent:s}))}),this._compassIcon=F("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const p=this._map;if(!p)return;const s=p.getZoom(),u=s===p.getMaxZoom(),g=s===p.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const p=this._map;if(!p)return;const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(p.transform.pitch*(Math.PI/180)),.5)}) rotateX(${p.transform.pitch}deg) rotateZ(${p.transform.angle*(180/Math.PI)}deg)`:`rotate(${p.transform.angle*(180/Math.PI)}deg)`;p._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=s)})}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),p.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&p.on("pitch",this._rotateCompassArrow),p.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new vv(p,this._compass,this.options.visualizePitch)),this._container}onRemove(){const p=this._map;p&&(this._container.remove(),this.options.showZoom&&p.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&p.off("pitch",this._rotateCompassArrow),p.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(p,s){const u=F("button",p,this._container);return u.type="button",u.addEventListener("click",s),u}_setButtonTitle(p,s){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${s}`);p.setAttribute("aria-label",u),p.firstElementChild&&p.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends a.Evented{constructor(p){super(),this.options=a.extend({geolocation:a.window.navigator.geolocation},Lp,p),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=yl(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(p){return this._map=p,this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(p){const s=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,p(u)};this._supportsGeolocation!==void 0?p(this._supportsGeolocation):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(u=>s(u.state!=="denied")).catch(()=>s()):s()}_isOutOfMapMaxBounds(p){const s=this._map.getMaxBounds(),u=p.coords;return!!s&&(u.longitude<s.getWest()||u.longitude>s.getEast()||u.latitude<s.getSouth()||u.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(p),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(p),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",p)),this._finish()}}_updateCamera(p){const s=new a.LngLat(p.coords.longitude,p.coords.latitude),u=p.coords.accuracy,g=this._map.getBearing(),_=a.extend({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(u),_,{geolocateSource:!0})}_updateMarker(p){if(p){const s=new a.LngLat(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const p=this._map.transform,s=a.mercatorZfromAltitude(1,p._center.lat)*p.worldSize,u=Math.ceil(2*this._accuracy*s);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(p){if(this._map){if(this.options.trackUserLocation)if(p.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(p.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",p)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(p){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=F("button","mapboxgl-ctrl-geolocate",this._container),F("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",p===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=F("div","mapboxgl-user-location"),this._dotElement.appendChild(F("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(F("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new bt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=F("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new bt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}}_onDeviceOrientation(p){this._userLocationDotMarker&&(p.webkitCompassHeading?this._heading=p.webkitCompassHeading:p.absolute===!0&&(this._heading=-1*p.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(p={maximumAge:6e5,timeout:0},this._noTimeout=!0):(p=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,p),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const p=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};a.window.DeviceMotionEvent!==void 0&&typeof a.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(s=>{s==="granted"&&p()}).catch(console.error):p()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientation),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:kt,ScaleControl:class{constructor(p){this.options=a.extend({},Dp,p),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),a.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const p=this.options.maxWidth||100,s=this._map,u=s._containerHeight/2,g=s._containerWidth/2-p/2,_=s.unproject([g,u]),b=s.unproject([g+p,u]),T=_.distanceTo(b);if(this.options.unit==="imperial"){const C=3.2808*T;C>5280?this._setScale(p,C/5280,"mile"):this._setScale(p,C,"foot")}else this.options.unit==="nautical"?this._setScale(p,T/1852,"nautical-mile"):T>=1e3?this._setScale(p,T/1e3,"kilometer"):this._setScale(p,T,"meter")}_setScale(p,s,u){this._map._requestDomTask(()=>{const g=function(b){const T=Math.pow(10,`${Math.floor(b)}`.length-1);let C=b/T;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(A){const z=Math.pow(10,Math.ceil(-Math.log(A)/Math.LN10));return Math.round(A*z)/z}(C),T*C}(s),_=g/s;this._container.innerHTML=this._isNumberFormatSupported&&u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:u}).format(g):`${g}&nbsp;${Op[u]}`,this._container.style.width=p*_+"px"})}onAdd(p){return this._map=p,this._language=p.getLanguage(),this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-scale",p.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(p){this._language=p,this._update()}setUnit(p){this.options.unit=p,this._update()}},FullscreenControl:class{constructor(p){this._fullscreen=!1,p&&p.container&&(p.container instanceof a.window.HTMLElement?this._container=p.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const p=this._fullscreenButton=F("button","mapboxgl-ctrl-fullscreen",this._controlContainer);F("span","mapboxgl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",p)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(p){super(),this.options=a.extend(Object.create(Rp),p),a.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(p&&p.className?p.className.trim().split(/\s+/):[])}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&p.on("preclick",this._onClose),this.options.closeOnMove&&p.on("move",this._onClose),p.on("remove",this.remove),this._update(),p._addPopup(this),this._focusFirstElement(),this._trackPointer?(p.on("mousemove",this._onMouseEvent),p.on("mouseup",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")):p.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const p=this._map;return p&&(p.off("move",this._update),p.off("move",this._onClose),p.off("preclick",this._onClose),p.off("click",this._onClose),p.off("remove",this.remove),p.off("mousemove",this._onMouseEvent),p.off("mouseup",this._onMouseEvent),p.off("drag",this._onMouseEvent),p._canvasContainer&&p._canvasContainer.classList.remove("mapboxgl-track-pointer"),p._removePopup(this),this._map=void 0),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(p){this._lngLat=a.LngLat.convert(p),this._pos=null,this._trackPointer=!1,this._update();const s=this._map;return s&&(s.on("move",this._update),s.off("mousemove",this._onMouseEvent),s._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const p=this._map;return p&&(p.off("move",this._update),p.on("mousemove",this._onMouseEvent),p.on("drag",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(a.window.document.createTextNode(p))}setHTML(p){const s=a.window.document.createDocumentFragment(),u=a.window.document.createElement("body");let g;for(u.innerHTML=p;g=u.firstChild,g;)s.appendChild(g);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){let s=this._content;if(s)for(;s.hasChildNodes();)s.firstChild&&s.removeChild(s.firstChild);else s=this._content=F("div","mapboxgl-popup-content",this._container||void 0);if(s.appendChild(p),this.options.closeButton){const u=this._closeButton=F("button","mapboxgl-popup-close-button",s);u.type="button",u.setAttribute("aria-label","Close popup"),u.setAttribute("aria-hidden","true"),u.innerHTML="&#215;",u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(p){return this._classList.add(p),this._updateClassList(),this}removeClassName(p){return this._classList.delete(p),this._updateClassList(),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){let s;return this._classList.delete(p)?s=!1:(this._classList.add(p),s=!0),this._updateClassList(),s}_onMouseEvent(p){this._update(p.point)}_getAnchor(p){if(this.options.anchor)return this.options.anchor;const s=this._map,u=this._container,g=this._pos;if(!s||!u||!g)return"bottom";const _=u.offsetWidth,b=u.offsetHeight,T=g.x<_/2,C=g.x>s.transform.width-_/2;if(g.y+p<b)return T?"top-left":C?"top-right":"top";if(g.y>s.transform.height-b){if(T)return"bottom-left";if(C)return"bottom-right"}return T?"left":C?"right":"bottom"}_updateClassList(){const p=this._container;if(!p)return;const s=[...this._classList];s.push("mapboxgl-popup"),this._anchor&&s.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&s.push("mapboxgl-popup-track-pointer"),p.className=s.join(" ")}_update(p){const s=this._map,u=this._content;if(!s||!this._lngLat&&!this._trackPointer||!u)return;let g=this._container;if(g||(g=this._container=F("div","mapboxgl-popup",s.getContainer()),this._tip=F("div","mapboxgl-popup-tip",g),g.appendChild(u)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),s.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=vl(this._lngLat,this._pos,s.transform)),!this._trackPointer||p){const _=this._pos=this._trackPointer&&p?p:s.project(this._lngLat),b=$g(this.options.offset),T=this._anchor=this._getAnchor(b.y),C=$g(this.options.offset,T),A=_.add(C).round();s._requestDomTask(()=>{this._container&&T&&(this._container.style.transform=`${Ma[T]} translate(${A.x}px,${A.y}px)`)})}if(!this._marker&&s._showingGlobe()){const _=a.isLngLatBehindGlobe(s.transform,this._lngLat)?0:1;this._setOpacity(_)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(_v);p&&p.focus()}_onClose(){this.remove()}_setOpacity(p){this._container&&(this._container.style.opacity=`${p}`),this._content&&(this._content.style.pointerEvents=p?"auto":"none")}},Marker:bt,Style:Xo,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:Cg,Evented:a.Evented,config:a.config,prewarm:function(){rl().acquire(qo)},clearPrewarmedResources:function(){const p=Ai;p&&(p.isPreloaded()&&p.numActive()===1?(p.release(qo),Ai=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(p){a.config.ACCESS_TOKEN=p},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(p){a.config.API_URL=p},get workerCount(){return ei.workerCount},set workerCount(p){ei.workerCount=p},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(p){a.config.MAX_PARALLEL_IMAGE_REQUESTS=p},clearStorage(p){a.clearTileCache(p)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return bl});var x=h;return x})})(KL);var OX=KL.exports;const cs=l2(OX);const Lb=e=>!e||typeof e!="object"||Object.keys(e).length===0?!1:Object.values(e).some(t=>!Array.isArray(t)||t.length===0?!1:t.some(r=>Array.isArray(r)&&r.length>=2&&typeof r[0]=="number"&&typeof r[1]=="number"&&!isNaN(r[0])&&!isNaN(r[1])));cs.accessToken="pk.eyJ1IjoiZ2lvZGVsYXBlbmEiLCJhIjoiY21leXk3MHc5MHo4djJtb29mbHl5bHN1cCJ9.-mAPWY3XRKsQ5YmLEvMtNA";const BX=()=>{const e=lx(),{filteredRoutes:t,isLoading:r,error:l}=$0(pe=>pe.routes),h=J.useRef(null),m=J.useRef(null),[x,a]=J.useState({origin:"",destination:""}),[E,I]=J.useState(null),[L,O]=J.useState(!1),[F,K]=J.useState("all"),W=[123.8854,10.3157],G={Colon:[123.9025,10.2969],Carbon:[123.9025,10.2969],Ayala:[123.9147,10.3188],SM:[123.9147,10.3188],Fuente:[123.9025,10.2969],Parkmall:[123.9147,10.3188],Mabolo:[123.9147,10.3188],Lahug:[123.9147,10.3188],Urgello:[123.9025,10.2969],"Plaza Housing":[123.9025,10.2969],"South Bus Terminal":[123.9025,10.2969],Private:[123.9025,10.2969],"SM City":[123.9147,10.3188],"Ayala Center":[123.9147,10.3188],"Carbon Market":[123.9025,10.2969],"Fuente Osmea":[123.9025,10.2969],"Parkmall Mandaue":[123.9147,10.3188],"Mabolo Church":[123.9147,10.3188],"Lahug Airport":[123.9147,10.3188],"Urgello Church":[123.9025,10.2969],"Plaza Housing Lahug":[123.9147,10.3188],"South Bus Terminal Cebu":[123.9025,10.2969],"Private Hospital":[123.9025,10.2969]};J.useEffect(()=>{if(!m.current)return requestAnimationFrame(()=>{h.current&&(m.current=new cs.Map({container:h.current,style:"mapbox://styles/mapbox/streets-v11",center:W,zoom:12}),m.current.on("load",()=>{console.log(" Map fully loaded"),O(!0),ne()}),m.current.addControl(new cs.NavigationControl,"top-right"),m.current.addControl(new cs.FullscreenControl,"top-right"))}),()=>{var pe;return(pe=m.current)==null?void 0:pe.remove()}},[]);const ne=()=>{m.current&&(m.current.addSource("routes",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),m.current.addSource("route-markers",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),m.current.addLayer({id:"route-lines",type:"line",source:"routes",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["case",["==",["get","type"],"jeepney"],"#1976d2",["==",["get","type"],"modern_jeep"],"#4caf50",["==",["get","type"],"bus"],"#ff9800","#1976d2"],"line-width":4,"line-opacity":.8}}),m.current.addLayer({id:"route-markers",type:"circle",source:"route-markers",paint:{"circle-radius":8,"circle-color":["case",["==",["get","type"],"jeepney"],"#1976d2",["==",["get","type"],"modern_jeep"],"#4caf50",["==",["get","type"],"bus"],"#ff9800","#1976d2"],"circle-stroke-width":2,"circle-stroke-color":"#fff"}}),m.current.on("click","route-markers",pe=>{const _e=pe.features[0].geometry.coordinates.slice(),xe=pe.features[0].properties,De=xe.route_code,ye=t.find(Ae=>Ae.route_code===De);ye&&(console.log("Selected route:",ye),I(ye)),new cs.Popup().setLngLat(_e).setHTML(`
          <div style="padding: 10px;">
            <h4 style="margin: 0 0 8px 0;">Route ${xe.route_code}</h4>
            <p style="margin: 0 0 4px 0;"><strong>From:</strong> ${xe.origin}</p>
            <p style="margin: 0 0 4px 0;"><strong>To:</strong> ${xe.destination}</p>
            <p style="margin: 0 0 4px 0;"><strong>Type:</strong> ${xe.type}</p>
            ${xe.notes?`<p style="margin: 0 0 4px 0;"><strong>Notes:</strong> ${xe.notes}</p>`:""}
          </div>
        `).addTo(m.current)}),m.current.on("mouseenter","route-markers",()=>{m.current.getCanvas().style.cursor="pointer"}),m.current.on("mouseleave","route-markers",()=>{m.current.getCanvas().style.cursor=""}),m.current.on("click","route-lines",pe=>{if(pe.features&&pe.features.length>0){const xe=pe.features[0].properties.route_code,De=t.find(ye=>ye.route_code===xe);De&&(console.log("Selected route from line click:",De),I(De))}}),m.current.on("mouseenter","route-lines",()=>{m.current.getCanvas().style.cursor="pointer"}),m.current.on("mouseleave","route-lines",()=>{m.current.getCanvas().style.cursor=""}))},Z=pe=>{if(G[pe])return G[pe];for(const[_e,xe]of Object.entries(G))if(_e.toLowerCase().includes(pe.toLowerCase())||pe.toLowerCase().includes(_e.toLowerCase()))return xe;return W};J.useEffect(()=>{!m.current||!t||H(t)},[t]);const H=async pe=>{if(!m.current||!m.current.getSource("routes"))return;console.log("Routes to display:",pe.map(Ae=>({code:Ae.route_code,hasCoords:Ae.route_coordinates?Object.keys(Ae.route_coordinates).length>0:!1})));const _e=pe.map(async Ae=>{let ft;if(Ae.route_code==="01C"&&(console.log("01C route data:",Ae),console.log("01C route_coordinates:",Ae.route_coordinates),console.log("Has coordinates?",Ae.route_coordinates&&Object.keys(Ae.route_coordinates).length>0),console.log("Has actual coordinates?",Lb(Ae.route_coordinates))),Ae.route_coordinates&&Object.keys(Ae.route_coordinates).length>0&&Lb(Ae.route_coordinates)){let Ge=[];if(Object.values(Ae.route_coordinates).forEach(lt=>{Array.isArray(lt)&&lt.length>0&&(Ge=[...Ge,...lt])}),Ge.length===0)return console.log(`Route ${Ae.route_code} has no valid coordinates, skipping`),null;const et=[];for(let lt=0;lt<Ge.length;lt++){const gt=Ge[lt];(lt===0||gt[0]!==Ge[lt-1][0]||gt[1]!==Ge[lt-1][1])&&et.push(gt)}ft=et}else return console.log(`Route ${Ae.route_code} has no coordinates, skipping`),null;return{type:"Feature",geometry:{type:"LineString",coordinates:ft},properties:{route_code:Ae.route_code,type:Ae.type,origin:Ae.origin,destination:Ae.destination}}}),xe=(await Promise.all(_e)).filter(Ae=>Ae!==null),ye=pe.filter(Ae=>Ae.route_coordinates&&Object.keys(Ae.route_coordinates).length>0&&Lb(Ae.route_coordinates)).map(Ae=>{const ft=Z(Ae.origin),Ge=Z(Ae.destination);return[{type:"Feature",geometry:{type:"Point",coordinates:ft},properties:{route:Ae,type:"origin",label:Ae.origin}},{type:"Feature",geometry:{type:"Point",coordinates:Ge},properties:{route:Ae,type:"destination",label:Ae.destination}}]}).flat();if(m.current.getSource("routes").setData({type:"FeatureCollection",features:xe}),m.current.getSource("route-markers").setData({type:"FeatureCollection",features:ye}),xe.length>0){const Ae=new cs.LngLatBounds;xe.forEach(ft=>{ft.geometry.coordinates.forEach(Ge=>{Ae.extend(Ge)})}),m.current.fitBounds(Ae,{padding:50})}},V=async()=>{if(!(!x.origin||!x.destination))try{await e(nm(x)).unwrap()}catch(pe){console.error("Search failed:",pe)}},oe=async pe=>{const _e=pe.target.value;K(_e),_e==="all"?await e(ga()):e(gN(_e))};return J.useEffect(()=>{e(ga())},[e]),J.useEffect(()=>{if(E&&t.length>0){const pe=t.find(_e=>_e.route_code===E.route_code);pe&&JSON.stringify(pe)!==JSON.stringify(E)&&I(pe)}},[t,E]),D.jsxs(Pt,{sx:{maxWidth:1400,mx:"auto",px:{xs:1,sm:2,md:3},minHeight:"100vh",display:"flex",flexDirection:"column"},children:[D.jsx(yt,{variant:"h4",gutterBottom:!0,align:"center",color:"primary",sx:{fontSize:{xs:"1.5rem",sm:"2rem",md:"2.125rem"},mb:{xs:2,sm:3},flexShrink:0},children:" Cebu Transport Routes Map"}),D.jsx(Pt,{sx:{flex:1,display:"flex",flexDirection:"column"},children:D.jsxs(er,{container:!0,spacing:{xs:2,sm:3},sx:{flex:1},children:[D.jsx(er,{item:!0,xs:12,md:8,children:D.jsxs(fr,{sx:{height:{xs:"50vh",sm:"50vh",md:"60vh",lg:"70vh"},position:"relative",minHeight:{xs:"250px",sm:"350px",md:"400px"},overflow:"hidden"},children:[D.jsx("div",{ref:h,style:{height:"100%",width:"100%"}}),!L&&D.jsx(Pt,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(255, 255, 255, 0.8)",zIndex:1},children:D.jsx(Om,{})})]})}),D.jsx(er,{item:!0,xs:12,md:4,children:D.jsxs(Pt,{sx:{display:"flex",flexDirection:"column",gap:{xs:1.5,sm:2}},children:[D.jsx(fr,{children:D.jsxs(vr,{sx:{p:{xs:2,sm:3}},children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,sx:{fontSize:{xs:"1.1rem",sm:"1.25rem"}},children:" Search Routes"}),D.jsxs(Pt,{sx:{display:"flex",flexDirection:"column",gap:{xs:1.5,sm:2}},children:[D.jsx(lh,{fullWidth:!0,label:"Origin",value:x.origin,onChange:pe=>a({...x,origin:pe.target.value}),placeholder:"e.g., Apas, Ayala, Colon",size:"small",sx:{"& .MuiInputBase-root":{fontSize:{xs:"0.875rem",sm:"1rem"}}}}),D.jsx(lh,{fullWidth:!0,label:"Destination",value:x.destination,onChange:pe=>a({...x,destination:pe.target.value}),placeholder:"e.g., Fuente, SM, Carbon",size:"small",sx:{"& .MuiInputBase-root":{fontSize:{xs:"0.875rem",sm:"1rem"}}}}),D.jsx(ro,{variant:"contained",onClick:V,disabled:!x.origin||!x.destination||r,startIcon:r?D.jsx(Om,{size:20}):D.jsx(Za,{}),sx:{py:{xs:1,sm:1.5},fontSize:{xs:"0.875rem",sm:"1rem"}},children:"Search Routes"})]})]})}),D.jsx(fr,{children:D.jsxs(vr,{sx:{p:{xs:2,sm:3}},children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,sx:{fontSize:{xs:"1.1rem",sm:"1.25rem"}},children:" Filter by Type"}),D.jsxs(x0,{fullWidth:!0,size:"small",children:[D.jsx(v0,{children:"Route Type"}),D.jsxs(w0,{value:F,label:"Route Type",onChange:oe,sx:{"& .MuiSelect-select":{fontSize:{xs:"0.875rem",sm:"1rem"}}},children:[D.jsx(zo,{value:"all",children:"All Routes"}),D.jsx(zo,{value:"jeepney",children:"Jeepney"}),D.jsx(zo,{value:"modern_jeep",children:"Modern Jeepney"}),D.jsx(zo,{value:"bus",children:"Bus"})]})]})]})}),E&&D.jsx(fr,{children:D.jsxs(vr,{sx:{p:{xs:2,sm:3}},children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,sx:{fontSize:{xs:"1.1rem",sm:"1.25rem"}},children:" Route Details"}),D.jsxs(Pt,{sx:{display:"flex",flexDirection:"column",gap:1},children:[D.jsx(Zi,{label:`Route ${E.route_code}`,color:"primary",size:"small",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"}}}),D.jsxs(yt,{variant:"body2",sx:{fontSize:{xs:"0.8rem",sm:"0.875rem"}},children:[D.jsx("strong",{children:"From:"})," ",E.origin]}),D.jsxs(yt,{variant:"body2",sx:{fontSize:{xs:"0.8rem",sm:"0.875rem"}},children:[D.jsx("strong",{children:"To:"})," ",E.destination]}),D.jsxs(yt,{variant:"body2",sx:{fontSize:{xs:"0.8rem",sm:"0.875rem"}},children:[D.jsx("strong",{children:"Type:"})," ",E.type]}),E.notes&&D.jsxs(yt,{variant:"body2",color:"text.secondary",sx:{fontSize:{xs:"0.8rem",sm:"0.875rem"}},children:[D.jsx("strong",{children:"Notes:"})," ",E.notes]}),E.route_coordinates&&Object.keys(E.route_coordinates).length>0&&D.jsxs(Pt,{sx:{mt:2},children:[D.jsx(yt,{variant:"body2",sx:{fontSize:{xs:"0.8rem",sm:"0.875rem"}},children:D.jsx("strong",{children:"Streets:"})}),D.jsx(Pt,{sx:{mt:1,display:"flex",flexWrap:"wrap",gap:1},children:Object.keys(E.route_coordinates).map((pe,_e)=>D.jsx(Zi,{label:pe,size:"small",variant:"outlined",color:"info",sx:{fontSize:"0.7rem"}},_e))})]})]})]})}),D.jsx(fr,{children:D.jsxs(vr,{sx:{p:{xs:2,sm:3}},children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,sx:{fontSize:{xs:"1.1rem",sm:"1.25rem"}},children:" Map Legend"}),D.jsxs(Pt,{sx:{display:"flex",flexDirection:"column",gap:1},children:[D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[D.jsx(Pt,{sx:{width:{xs:16,sm:20},height:{xs:3,sm:4},backgroundColor:"#1976d2",borderRadius:1}}),D.jsx(yt,{variant:"body2",sx:{fontSize:{xs:"0.8rem",sm:"0.875rem"}},children:"Jeepney Routes"})]}),D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[D.jsx(Pt,{sx:{width:{xs:16,sm:20},height:{xs:3,sm:4},backgroundColor:"#4caf50",borderRadius:1}}),D.jsx(yt,{variant:"body2",sx:{fontSize:{xs:"0.8rem",sm:"0.875rem"}},children:"Modern Jeepney Routes"})]}),D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[D.jsx(Pt,{sx:{width:{xs:16,sm:20},height:{xs:3,sm:4},backgroundColor:"#ff9800",borderRadius:1}}),D.jsx(yt,{variant:"body2",sx:{fontSize:{xs:"0.8rem",sm:"0.875rem"}},children:"Bus Routes"})]}),D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[D.jsx(Pt,{sx:{width:{xs:12,sm:16},height:{xs:12,sm:16},backgroundColor:"#ff9800",borderRadius:"50%",border:"2px solid white"}}),D.jsx(yt,{variant:"body2",sx:{fontSize:{xs:"0.8rem",sm:"0.875rem"}},children:"Route Markers"})]})]})]})}),l&&D.jsx(im,{severity:"error",children:l})]})})]})})]})};cs.accessToken="pk.eyJ1IjoiZ2lvZGVsYXBlbmEiLCJhIjoiY21leXk3MHc5MHo4djJtb29mbHl5bHN1cCJ9.-mAPWY3XRKsQ5YmLEvMtNA";const Db={"Gaisano Country Mall":[123.909825,10.340333],Carbon:[123.9003,10.2926],Colon:[123.8989,10.2963],Ayala:[123.9055,10.3177],SM:[123.9183,10.3113],Fuente:[123.8991,10.3096],Parkmall:[123.9305,10.334],Mabolo:[123.9181,10.3226],Lahug:[123.9015,10.3259],"Cebu IT Park":[123.9028,10.3305],"Cebu IT Park Transport Terminal":[123.9042,10.3311]},FX=()=>{const e=lx(),{filteredRoutes:t,isLoading:r,error:l}=$0(Ie=>Ie.routes),[h,m]=J.useState({origin:"",destination:""}),[x,a]=J.useState(""),[E,I]=J.useState({type:"all",sortBy:"route_code"}),[L,O]=J.useState([]),[F,K]=J.useState(null),[W,G]=J.useState(!1),[ne,Z]=J.useState({show:!1,message:"",severity:"info"}),H=J.useRef(null),V=J.useRef(null),[oe,pe]=J.useState(!1);J.useEffect(()=>{e(ga())},[e]),J.useEffect(()=>{if(!(V.current||!W)&&!(F&&!F.route_coordinates))return requestAnimationFrame(()=>{H.current&&(V.current=new cs.Map({container:H.current,style:"mapbox://styles/mapbox/streets-v11",center:[123.8854,10.3157],zoom:12}),V.current.on("load",()=>{console.log(" Map fully loaded"),pe(!0),_e(),F&&F.route_coordinates&&Ge(F)}),V.current.addControl(new cs.NavigationControl,"top-right"))}),()=>{V.current&&(V.current.remove(),V.current=null)}},[W,F]);const _e=()=>{V.current&&(V.current.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}}}),V.current.addLayer({id:"route-outline",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#ffffff","line-width":6,"line-opacity":.9}}),V.current.addLayer({id:"route-line",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#1976d2","line-width":4,"line-opacity":.9}}),V.current.addLayer({id:"route-dash",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#4CAF50","line-width":3,"line-opacity":.7,"line-dasharray":[0,4,3]}}),V.current.addSource("markers",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),V.current.addLayer({id:"route-markers",type:"circle",source:"markers",paint:{"circle-radius":["case",["==",["get","pointType"],"via"],6,8],"circle-color":["case",["==",["get","pointType"],"origin"],"#4caf50",["==",["get","pointType"],"destination"],"#f44336",["==",["get","pointType"],"via"],"#ff9800","#1976d2"],"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),V.current.on("click","route-markers",Ie=>{const st=Ie.features[0].geometry.coordinates.slice(),Tt=Ie.features[0].properties;new cs.Popup().setLngLat(st).setHTML(`
          <div style="padding: 10px;">
            <h4 style="margin: 0 0 8px 0;">${Tt.pointType==="origin"?"Origin":"Destination"}</h4>
            <p style="margin: 0;">${Tt.location}</p>
          </div>
        `).addTo(V.current)}),V.current.on("mouseenter","route-markers",()=>{V.current.getCanvas().style.cursor="pointer"}),V.current.on("mouseleave","route-markers",()=>{V.current.getCanvas().style.cursor=""}))},xe=async()=>{if(!(!h.origin||!h.destination)){Z({show:!1,message:"",severity:"info"});try{const Ie=await e(nm(h)).unwrap(),st={id:Date.now(),query:{...h},timestamp:new Date().toISOString(),resultCount:Ie.data?Ie.data.length:0};O(Tt=>[st,...Tt.slice(0,9)])}catch(Ie){console.error("Search failed:",Ie)}}},De=async()=>{if(x.trim()){Z({show:!1,message:"",severity:"info"});try{const Ie=await e(y_(x.trim())).unwrap(),st=Ie&&Ie.data&&(Array.isArray(Ie.data)?Ie.data.length>0:!0),Tt={id:Date.now(),query:{routeCode:x.trim()},timestamp:new Date().toISOString(),resultCount:st?Array.isArray(Ie.data)?Ie.data.length:1:0};O(zt=>[Tt,...zt.slice(0,9)]),st?(e({type:"routes/setFilteredRoutes",payload:Array.isArray(Ie.data)?Ie.data:[Ie.data]}),Array.isArray(Ie.data)?Ie.data.length>0&&et(Ie.data[0]):et(Ie.data)):(e({type:"routes/setFilteredRoutes",payload:[]}),K(null),G(!1))}catch(Ie){console.error("Route lookup failed:",Ie),e({type:"routes/setFilteredRoutes",payload:[]})}}},ye=Ie=>{if(Db[Ie])return Db[Ie];for(const[st,Tt]of Object.entries(Db))if(st.toLowerCase().includes(Ie.toLowerCase())||Ie.toLowerCase().includes(st.toLowerCase()))return Tt;return[123.8854,10.3157]},Ae=Ie=>{if(Ie.route_coordinates&&Object.keys(Ie.route_coordinates).length>0){let zt=[];Object.values(Ie.route_coordinates).forEach(en=>{zt=[...zt,...en]});const Nt=[];for(let en=0;en<zt.length;en++){const Zt=zt[en];(en===0||Zt[0]!==zt[en-1][0]||Zt[1]!==zt[en-1][1])&&Nt.push(Zt)}return Nt}const st=ye(Ie.origin),Tt=ye(Ie.destination);return[st,Tt]},ft=async(Ie,st)=>{try{const Tt=ye(Ie),zt=ye(st),Nt=`https://api.mapbox.com/directions/v5/mapbox/driving/${Tt[0]},${Tt[1]};${zt[0]},${zt[1]}?geometries=geojson&access_token=${cs.accessToken}`,Zt=await(await fetch(Nt)).json();return Zt.routes&&Zt.routes[0]?Zt.routes[0].geometry.coordinates:[Tt,zt]}catch(Tt){console.error("Error fetching route path:",Tt);const zt=ye(Ie),Nt=ye(st);return[zt,Nt]}},Ge=async Ie=>{if(!(!V.current||!oe))try{let st;Ie.route_coordinates&&Object.keys(Ie.route_coordinates).length>0?(console.log("Using route_coordinates data for plotting"),st=Ae(Ie)):(console.log("No route_coordinates data, using Mapbox Directions API"),st=await ft(Ie.origin,Ie.destination));const Tt=[0,4,3];V.current.setPaintProperty("route-dash","line-dasharray",Tt),V.current.getSource("route").setData({type:"Feature",properties:{route_code:Ie.route_code,type:Ie.type},geometry:{type:"LineString",coordinates:st}});const zt=ye(Ie.origin),Nt=ye(Ie.destination);V.current.getSource("markers").setData({type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:zt},properties:{pointType:"origin",location:Ie.origin}},{type:"Feature",geometry:{type:"Point",coordinates:Nt},properties:{pointType:"destination",location:Ie.destination}}]});const en=new cs.LngLatBounds;st.forEach(Mn=>en.extend(Mn)),V.current.fitBounds(en,{padding:80}),document.querySelectorAll(".mapboxgl-popup.active-route-popup").forEach(Mn=>Mn.remove())}catch(st){console.error("Error displaying route on map:",st)}},et=Ie=>{K(Ie),e(gb(Ie)),e(wN(Ie)),G(!0),Z({show:!1,message:"",severity:"info"}),Ie.route_coordinates?V.current&&oe&&Ge(Ie):V.current&&(V.current.remove(),V.current=null,pe(!1)),setTimeout(()=>{const st=document.querySelector(".map-area-container");if(st){const Tt=st.getBoundingClientRect(),zt=window.pageYOffset||document.documentElement.scrollTop,Nt=Tt.top+zt-20;window.scrollTo({top:Nt,behavior:"smooth"})}},200),setTimeout(()=>{if(H.current){const st=H.current.getBoundingClientRect(),Tt=window.pageYOffset||document.documentElement.scrollTop,zt=st.top+Tt-20;window.scrollTo({top:zt,behavior:"smooth"})}},200)},lt=(Ie,st)=>{I(Tt=>({...Tt,[Ie]:st})),Z({show:!1,message:"",severity:"info"}),Ie==="type"&&e(st==="all"?ga():__(st))},gt=()=>{m({origin:"",destination:""}),a(""),K(null),G(!1),Z({show:!1,message:"",severity:"info"}),e(ga())};J.useEffect(()=>{!h.origin&&!h.destination&&e(ga())},[h.origin,h.destination,e]),J.useEffect(()=>{!W&&F&&(K(null),e(gb(null)))},[W,e]);const St=Ie=>{switch(Ie){case"jeepney":return D.jsx(nc,{fontSize:"small",color:"primary"});case"modern_jeep":return D.jsx(nc,{fontSize:"small",color:"secondary"});case"bus":return D.jsx(JS,{fontSize:"small",color:"primary"});default:return D.jsx(nc,{fontSize:"small"})}},It=Ie=>{switch(Ie){case"jeepney":return"primary";case"modern_jeep":return"secondary";case"bus":return"info";default:return"default"}},ct=(()=>{if(!t)return[];const Ie=[...t];switch(E.sortBy){case"route_code":return Ie.sort((st,Tt)=>st.route_code.localeCompare(Tt.route_code));case"origin":return Ie.sort((st,Tt)=>st.origin.localeCompare(Tt.origin));case"destination":return Ie.sort((st,Tt)=>st.destination.localeCompare(Tt.destination));case"type":return Ie.sort((st,Tt)=>st.type.localeCompare(Tt.type));default:return Ie}})();return D.jsxs(Pt,{sx:{maxWidth:1400,mx:"auto",px:{xs:1,sm:2,md:3}},children:[D.jsx(yt,{variant:"h4",gutterBottom:!0,align:"center",color:"primary",sx:{fontSize:{xs:"1.5rem",sm:"2rem",md:"2.125rem"}},children:" Route Search & Discovery"}),W&&F&&D.jsxs(fr,{sx:{mb:3,position:"relative"},children:[D.jsx(Pt,{sx:{position:"absolute",top:10,right:10,zIndex:10},children:D.jsx(Th,{onClick:()=>{G(!1),K(null),e(gb(null))},sx:{bgcolor:"white","&:hover":{bgcolor:"rgba(255,255,255,0.8)"}},children:D.jsx(AZ,{})})}),D.jsx(vr,{sx:{p:0},children:F.route_coordinates?D.jsx("div",{className:"map-area-container",children:D.jsx(Pt,{sx:{height:{xs:"300px",sm:"350px",md:"400px"},width:"100%",borderRadius:{xs:"8px",sm:"12px"},overflow:"hidden"},ref:H,className:"route-map-container"})}):D.jsx(Pt,{className:"map-area-container",sx:{height:"400px",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",bgcolor:"background.paper",p:3},children:D.jsxs(im,{severity:"warning",variant:"filled",sx:{mb:2,width:"80%",maxWidth:"600px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,children:"No Map Data Available"}),D.jsxs(yt,{children:["Route ",F.route_code," (",F.origin," to ",F.destination,") currently has no route coordinates set up."]}),D.jsx(yt,{sx:{mt:1},children:"Please check back later or contact support for assistance."})]})})}),D.jsxs(Pt,{sx:{p:2,borderTop:"1px solid rgba(0,0,0,0.12)"},children:[D.jsx(Pt,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:D.jsx(Zi,{label:"Active Route",color:"success",size:"small",sx:{fontWeight:"bold"}})}),D.jsxs(yt,{variant:"h6",color:"primary",gutterBottom:!0,children:["Route ",F.route_code,": ",F.origin,"  ",F.destination]}),D.jsxs(Pt,{sx:{display:"flex",gap:2,flexWrap:"wrap",mb:2},children:[D.jsx(Zi,{icon:St(F.type),label:F.type,color:It(F.type),size:"small"}),F.fare&&D.jsx(Zi,{label:`Fare: ${F.fare}`,size:"small",variant:"outlined"}),F.schedule&&D.jsx(Zi,{label:`Schedule: ${F.schedule}`,size:"small",variant:"outlined"})]}),F.via&&F.via.length>0&&D.jsxs(yt,{variant:"body2",color:"text.secondary",sx:{mt:1},children:[D.jsx("strong",{children:"Via:"})," ",F.via.join(", ")]}),F.route_coordinates&&Object.keys(F.route_coordinates).length>0&&D.jsxs(Pt,{sx:{mt:2},children:[D.jsx(yt,{variant:"body2",color:"text.secondary",fontWeight:"medium",children:D.jsx("strong",{children:"Streets:"})}),D.jsx(Pt,{sx:{mt:1,display:"flex",flexWrap:"wrap",gap:1},children:Object.keys(F.route_coordinates).map((Ie,st)=>D.jsx(Zi,{label:Ie,size:"small",variant:"outlined",color:"info"},st))})]}),F.notes&&D.jsxs(yt,{variant:"body2",color:"text.secondary",sx:{mt:2},children:[D.jsx("strong",{children:"Notes:"})," ",F.notes]}),F.last_verified&&D.jsxs(yt,{variant:"caption",color:"text.secondary",sx:{mt:2,display:"block"},children:["Last verified: ",new Date(F.last_verified).toLocaleDateString()]})]})]}),D.jsxs(er,{container:!0,spacing:{xs:1,sm:2,md:3},children:[D.jsx(er,{item:!0,xs:12,md:4,children:D.jsxs(Pt,{sx:{display:"flex",flexDirection:"column",gap:{xs:1,sm:1.5,md:2}},children:[D.jsx(fr,{children:D.jsxs(vr,{sx:{px:{xs:2,sm:2.5},py:{xs:1.5,sm:2}},children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,sx:{fontSize:{xs:"1rem",sm:"1.25rem"}},children:" Search by Location"}),D.jsxs(Pt,{sx:{display:"flex",flexDirection:"column",gap:{xs:1.5,sm:2}},children:[D.jsx(lh,{fullWidth:!0,label:"Origin",value:h.origin,onChange:Ie=>m({...h,origin:Ie.target.value}),placeholder:"e.g., Apas, Ayala, Colon",size:"small",InputProps:{style:{fontSize:"0.9rem"}},InputLabelProps:{style:{fontSize:"0.9rem"}},sx:{"& .MuiOutlinedInput-root":{borderRadius:{xs:1,sm:1.5}}}}),D.jsx(lh,{fullWidth:!0,label:"Destination",value:h.destination,onChange:Ie=>m({...h,destination:Ie.target.value}),placeholder:"e.g., Fuente, SM, Carbon",size:"small",InputProps:{style:{fontSize:"0.9rem"}},InputLabelProps:{style:{fontSize:"0.9rem"}},sx:{"& .MuiOutlinedInput-root":{borderRadius:{xs:1,sm:1.5}}}}),D.jsx(ro,{variant:"contained",onClick:xe,disabled:!h.origin||!h.destination||r,startIcon:r?D.jsx(Om,{size:18}):D.jsx(Za,{fontSize:"small"}),fullWidth:!0,size:"medium",sx:{py:{xs:.8,sm:1},fontSize:{xs:"0.875rem",sm:"0.9rem"},borderRadius:{xs:1,sm:1.5}},children:"Search Routes"})]})]})}),D.jsx(fr,{children:D.jsxs(vr,{sx:{px:{xs:2,sm:2.5},py:{xs:1.5,sm:2}},children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,sx:{fontSize:{xs:"1rem",sm:"1.25rem"}},children:" Lookup by Route Code"}),D.jsxs(Pt,{sx:{display:"flex",flexDirection:"column",gap:2},children:[D.jsx(lh,{fullWidth:!0,label:"Route Code",value:x,onChange:Ie=>a(Ie.target.value),placeholder:"e.g., 17B, 04L, 03Q",size:"small",InputProps:{style:{fontSize:"0.9rem"}},InputLabelProps:{style:{fontSize:"0.9rem"}},sx:{"& .MuiOutlinedInput-root":{borderRadius:{xs:1,sm:1.5}}},onKeyPress:Ie=>{Ie.key==="Enter"&&x.trim()&&De()}}),D.jsx(ro,{variant:"outlined",onClick:De,disabled:!x.trim()||r,startIcon:D.jsx(Za,{fontSize:"small"}),fullWidth:!0,size:"medium",sx:{py:{xs:.8,sm:1},fontSize:{xs:"0.875rem",sm:"0.9rem"},borderRadius:{xs:1,sm:1.5}},children:"Find Route"})]})]})}),D.jsx(fr,{children:D.jsxs(vr,{sx:{px:{xs:2,sm:2.5},py:{xs:1.5,sm:2}},children:[D.jsxs(yt,{variant:"h6",gutterBottom:!0,sx:{fontSize:{xs:"1rem",sm:"1.25rem"}},children:[D.jsx(MZ,{sx:{mr:1,verticalAlign:"middle",fontSize:{xs:"1rem",sm:"1.25rem"}}}),"Filters & Sorting"]}),D.jsxs(Pt,{sx:{display:"flex",flexDirection:"column",gap:{xs:1.5,sm:2}},children:[D.jsxs(x0,{fullWidth:!0,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:{xs:1,sm:1.5}}},children:[D.jsx(v0,{style:{fontSize:"0.9rem"},children:"Route Type"}),D.jsxs(w0,{value:E.type,label:"Route Type",onChange:Ie=>lt("type",Ie.target.value),children:[D.jsx(zo,{value:"all",sx:{fontSize:{xs:"0.875rem",sm:"0.9rem"}},children:"All Routes"}),D.jsx(zo,{value:"jeepney",sx:{fontSize:{xs:"0.875rem",sm:"0.9rem"}},children:"Jeepney"}),D.jsx(zo,{value:"modern_jeep",sx:{fontSize:{xs:"0.875rem",sm:"0.9rem"}},children:"Modern Jeepney"}),D.jsx(zo,{value:"bus",sx:{fontSize:{xs:"0.875rem",sm:"0.9rem"}},children:"Bus"})]})]}),D.jsxs(x0,{fullWidth:!0,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:{xs:1,sm:1.5}}},children:[D.jsx(v0,{style:{fontSize:"0.9rem"},children:"Sort By"}),D.jsxs(w0,{value:E.sortBy,label:"Sort By",onChange:Ie=>lt("sortBy",Ie.target.value),children:[D.jsx(zo,{value:"route_code",sx:{fontSize:{xs:"0.875rem",sm:"0.9rem"}},children:"Route Code"}),D.jsx(zo,{value:"origin",sx:{fontSize:{xs:"0.875rem",sm:"0.9rem"}},children:"Origin"}),D.jsx(zo,{value:"destination",sx:{fontSize:{xs:"0.875rem",sm:"0.9rem"}},children:"Destination"}),D.jsx(zo,{value:"type",sx:{fontSize:{xs:"0.875rem",sm:"0.9rem"}},children:"Type"})]})]}),D.jsx(ro,{variant:"outlined",onClick:gt,startIcon:D.jsx(IZ,{fontSize:"small"}),fullWidth:!0,size:"medium",sx:{py:{xs:.8,sm:1},fontSize:{xs:"0.875rem",sm:"0.9rem"},borderRadius:{xs:1,sm:1.5}},children:"Clear All"})]})]})}),L.length>0&&D.jsx(fr,{children:D.jsxs(vr,{children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,children:" Search History"}),D.jsx(Tu,{dense:!0,children:L.map(Ie=>D.jsxs(Ga,{sx:{px:0},children:[D.jsx(pu,{primary:Ie.query.routeCode?`Route Code: ${Ie.query.routeCode}`:`${Ie.query.origin}  ${Ie.query.destination}`,secondary:`${Ie.resultCount} routes found  ${new Date(Ie.timestamp).toLocaleString()}`}),D.jsx(ro,{size:"small",onClick:()=>{Ie.query.routeCode?(a(Ie.query.routeCode),De()):m(Ie.query)},children:"Reuse"})]},Ie.id))})]})})]})}),D.jsxs(er,{item:!0,xs:12,md:8,sx:{mt:{xs:0,md:0}},children:[D.jsx(fr,{sx:{height:{md:"550px",lg:"670px",display:"flex",flexDirection:"column"}},children:D.jsxs(vr,{sx:{display:"flex",flexDirection:"column",height:"100%",overflow:{md:"hidden"}},children:[D.jsxs(Pt,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[D.jsx(yt,{variant:"h6",children:" Search Results"}),t&&D.jsx(Zi,{label:`${t.length} routes found`,color:"primary",variant:"outlined"})]}),r&&D.jsx(Pt,{sx:{display:"flex",justifyContent:"center",p:4,flexGrow:1,alignItems:"center"},children:D.jsx(Om,{})}),l&&D.jsx(im,{severity:"error",sx:{mb:2},children:l}),ne.show&&D.jsx(im,{severity:ne.severity,sx:{mb:2},onClose:()=>Z({show:!1,message:"",severity:"info"}),children:ne.message}),ct&&ct.length>0?D.jsx(Tu,{sx:{overflow:{md:"auto"},maxHeight:{md:"450px",lg:"600px"},"&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,0.2)",borderRadius:"3px"},"&::-webkit-scrollbar-track":{backgroundColor:"rgba(0,0,0,0.05)"},flexGrow:1},children:ct.map((Ie,st)=>D.jsxs(Do.Fragment,{children:[D.jsxs(Ga,{sx:{px:{xs:.5,sm:1},py:{xs:.5,sm:.75},cursor:"pointer","&:hover":{backgroundColor:"rgba(25, 118, 210, 0.08)"},transition:"background-color 0.2s",borderRadius:{xs:.5,sm:1},backgroundColor:F&&F._id===Ie._id?"rgba(25, 118, 210, 0.15)":"transparent",border:F&&F._id===Ie._id?"1px solid rgba(25, 118, 210, 0.5)":"none"},onClick:()=>et(Ie),children:[D.jsx(Wf,{children:D.jsx(Zi,{icon:St(Ie.type),label:Ie.route_code,color:It(Ie.type),size:"small",sx:{mx:2}})}),D.jsx(pu,{primary:D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[D.jsx(yt,{variant:"body1",fontWeight:"medium",sx:{fontSize:{xs:"0.85rem",sm:"0.95rem",md:"1rem"}},children:Ie.origin}),D.jsx(yt,{variant:"body2",color:"text.secondary",sx:{fontSize:{xs:"0.8rem",sm:"0.9rem"}},children:""}),D.jsx(yt,{variant:"body1",fontWeight:"medium",sx:{fontSize:{xs:"0.85rem",sm:"0.95rem",md:"1rem"}},children:Ie.destination})]}),secondary:D.jsxs(Pt,{sx:{mt:1},children:[D.jsx(Zi,{label:Ie.type,size:"small",variant:"outlined",sx:{mr:1,fontSize:{xs:"0.7rem",sm:"0.75rem"},height:{xs:"20px",sm:"24px"}}}),Ie.notes&&D.jsx(yt,{variant:"caption",color:"text.secondary",children:Ie.notes})]})}),D.jsxs(Pt,{sx:{display:"flex",alignItems:"center",gap:1},children:[F&&F._id===Ie._id&&D.jsx(Zi,{label:"Active",size:"small",color:"success",variant:"outlined",sx:{fontSize:{xs:"0.7rem",sm:"0.75rem"},height:{xs:"20px",sm:"24px"}}}),D.jsx(Th,{size:"small",title:"View on Map",sx:{backgroundColor:F&&F._id===Ie._id?"rgba(25, 118, 210, 0.15)":"transparent","&:hover":{backgroundColor:"rgba(25, 118, 210, 0.25)"},padding:{xs:"4px",sm:"8px"},marginRight:{xs:"4px",sm:0}},children:D.jsx(Kd,{fontSize:"small",color:F&&F._id===Ie._id?"success":"primary"})})]})]}),st<ct.length-1&&D.jsx(XS,{})]},Ie._id||st))}):!r&&D.jsx(Pt,{sx:{textAlign:"center",p:4,flexGrow:1,display:"flex",alignItems:"center",justifyContent:"center"},children:D.jsx(yt,{variant:"body1",color:"text.secondary",children:"No routes found. Try adjusting your search criteria."})})]})}),D.jsx(fr,{sx:{mt:2},children:D.jsxs(vr,{children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,children:" Popular Searches"}),D.jsx(er,{container:!0,spacing:2,children:[{origin:"Apas",destination:"Fuente"},{origin:"Ayala",destination:"SM"},{origin:"Colon",destination:"Carbon"},{origin:"Lahug",destination:"Ayala"},{origin:"Guadalupe",destination:"Carbon"},{origin:"Mabolo",destination:"Carbon"}].map((Ie,st)=>D.jsx(er,{item:!0,xs:12,sm:6,md:4,children:D.jsxs(ro,{variant:"outlined",size:"small",onClick:()=>m(Ie),fullWidth:!0,sx:{justifyContent:"flex-start"},children:[Ie.origin,"  ",Ie.destination]})},st))})]})})]})]})]})},jX=()=>{const e=lx(),{allRoutes:t,stats:r,isLoading:l}=$0(a=>a.routes);J.useEffect(()=>{e(ga()),e(x_())},[e]);const h=a=>t?t.filter(E=>E.type===a).length:0,m=[{title:"Chat with CeBot",description:"Ask questions about transport routes",icon:D.jsx(Gf,{color:"primary"}),path:"/chat",color:"primary"},{title:"View Routes Map",description:"Interactive map of all transport routes",icon:D.jsx(Kd,{color:"secondary"}),path:"/map",color:"secondary"},{title:"Search Routes",description:"Find specific routes by location",icon:D.jsx(Za,{color:"info"}),path:"/search",color:"info"}],x=[{origin:"Apas",destination:"Fuente",code:"17B"},{origin:"Ayala",destination:"SM",code:"03Q"},{origin:"Colon",destination:"Carbon",code:"01C"},{origin:"Lahug",destination:"Ayala",code:"04L"}];return D.jsxs(Pt,{sx:{maxWidth:1400,mx:"auto"},children:[D.jsxs(lc,{elevation:3,sx:{p:{xs:2,sm:3,md:4},mb:4,background:"linear-gradient(135deg, #1976d2 0%, #42a5f5 100%)",color:"white",textAlign:"center"},children:[D.jsx(yt,{variant:"h3",gutterBottom:!0,fontWeight:"bold",sx:{fontSize:{xs:"1.8rem",sm:"2.2rem",md:"3rem"}},children:" Welcome to CeBot"}),D.jsx(yt,{variant:"h6",sx:{mb:3,opacity:.9,fontSize:{xs:"1rem",sm:"1.2rem",md:"1.25rem"}},children:"Your intelligent Cebu City transport assistant"}),D.jsx(yt,{variant:"body1",sx:{mb:4,opacity:.8,px:{xs:1,sm:2,md:4}},children:"Find jeepney routes, bus schedules, and get real-time transport information"}),D.jsxs(Pt,{sx:{display:"flex",gap:{xs:1,sm:2},justifyContent:"center",flexWrap:"wrap"},children:[D.jsx(ro,{component:$l,to:"/chat",variant:"contained",size:"large",startIcon:D.jsx(Gf,{}),sx:{backgroundColor:"white",color:"primary.main","&:hover":{backgroundColor:"grey.100"}},children:"Start Chatting"}),D.jsx(ro,{component:$l,to:"/map",variant:"outlined",size:"large",startIcon:D.jsx(Kd,{}),sx:{borderColor:"white",color:"white","&:hover":{borderColor:"grey.100",backgroundColor:"rgba(255,255,255,0.1)"}},children:"View Map"})]})]}),D.jsx(yt,{variant:"h5",gutterBottom:!0,sx:{mb:3},children:" Quick Actions"}),D.jsx(er,{container:!0,spacing:3,sx:{mb:4},children:m.map((a,E)=>D.jsx(er,{item:!0,xs:12,md:4,children:D.jsx(fr,{component:$l,to:a.path,sx:{height:"100%",textDecoration:"none",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-4px)",boxShadow:4}},children:D.jsxs(vr,{sx:{textAlign:"center",p:3},children:[D.jsx(Pt,{sx:{mb:2},children:a.icon}),D.jsx(yt,{variant:"h6",gutterBottom:!0,children:a.title}),D.jsx(yt,{variant:"body2",color:"text.secondary",children:a.description})]})})},E))}),D.jsx(yt,{variant:"h5",gutterBottom:!0,sx:{mb:3},children:" Transport Statistics"}),D.jsxs(er,{container:!0,spacing:3,sx:{mb:4},children:[D.jsx(er,{item:!0,xs:12,sm:6,md:3,children:D.jsx(fr,{children:D.jsxs(vr,{sx:{textAlign:"center"},children:[D.jsx(nc,{color:"primary",sx:{fontSize:40,mb:1}}),D.jsx(yt,{variant:"h4",color:"primary",gutterBottom:!0,children:h("jeepney")}),D.jsx(yt,{variant:"body2",color:"text.secondary",children:"Jeepney Routes"})]})})}),D.jsx(er,{item:!0,xs:12,sm:6,md:3,children:D.jsx(fr,{children:D.jsxs(vr,{sx:{textAlign:"center"},children:[D.jsx(nc,{color:"secondary",sx:{fontSize:40,mb:1}}),D.jsx(yt,{variant:"h4",color:"secondary",gutterBottom:!0,children:h("modern_jeep")}),D.jsx(yt,{variant:"body2",color:"text.secondary",children:"Modern Jeepney"})]})})}),D.jsx(er,{item:!0,xs:12,sm:6,md:3,children:D.jsx(fr,{children:D.jsxs(vr,{sx:{textAlign:"center"},children:[D.jsx(JS,{color:"info",sx:{fontSize:40,mb:1}}),D.jsx(yt,{variant:"h4",color:"info.main",gutterBottom:!0,children:h("bus")}),D.jsx(yt,{variant:"body2",color:"text.secondary",children:"Bus Routes"})]})})}),D.jsx(er,{item:!0,xs:12,sm:6,md:3,children:D.jsx(fr,{children:D.jsxs(vr,{sx:{textAlign:"center"},children:[D.jsx(jZ,{color:"success",sx:{fontSize:40,mb:1}}),D.jsx(yt,{variant:"h4",color:"success.main",gutterBottom:!0,children:t?t.length:0}),D.jsx(yt,{variant:"body2",color:"text.secondary",children:"Total Routes"})]})})})]}),D.jsx(yt,{variant:"h5",gutterBottom:!0,sx:{mb:3},children:" Popular Routes"}),D.jsxs(er,{container:!0,spacing:3,sx:{mb:4},children:[D.jsx(er,{item:!0,xs:12,sm:12,md:6,children:D.jsx(fr,{children:D.jsxs(vr,{children:[D.jsxs(yt,{variant:"h6",gutterBottom:!0,children:[D.jsx(zZ,{sx:{mr:1,verticalAlign:"middle"}}),"Route Examples"]}),D.jsx(Tu,{dense:!0,children:x.map((a,E)=>D.jsxs(Do.Fragment,{children:[D.jsxs(Ga,{children:[D.jsx(Wf,{children:D.jsx(Zi,{label:a.code,size:"small",color:"primary",variant:"outlined"})}),D.jsx(pu,{primary:`${a.origin}  ${a.destination}`,secondary:"Popular jeepney route"})]}),E<x.length-1&&D.jsx(XS,{})]},E))})]})})}),D.jsx(er,{item:!0,xs:12,sm:12,md:6,children:D.jsx(fr,{children:D.jsxs(vr,{children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,children:" How to Use CeBot"}),D.jsxs(Tu,{dense:!0,children:[D.jsxs(Ga,{children:[D.jsx(Wf,{children:D.jsx(Gf,{color:"primary"})}),D.jsx(pu,{primary:"Ask natural language questions",secondary:"e.g., 'How do I get from Apas to Fuente?'"})]}),D.jsxs(Ga,{children:[D.jsx(Wf,{children:D.jsx(Za,{color:"secondary"})}),D.jsx(pu,{primary:"Search by route code",secondary:"e.g., 'What is route 17B?'"})]}),D.jsxs(Ga,{children:[D.jsx(Wf,{children:D.jsx(Kd,{color:"info"})}),D.jsx(pu,{primary:"View routes on interactive map",secondary:"See all transport routes visually"})]})]})]})})})]}),D.jsx(yt,{variant:"h5",gutterBottom:!0,sx:{mb:3},children:" Features"}),D.jsxs(er,{container:!0,spacing:3,children:[D.jsx(er,{item:!0,xs:12,md:4,children:D.jsx(fr,{children:D.jsxs(vr,{children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,children:" AI-Powered Chat"}),D.jsx(yt,{variant:"body2",color:"text.secondary",children:"Natural language processing to understand your transport queries"})]})})}),D.jsx(er,{item:!0,xs:12,md:4,children:D.jsx(fr,{children:D.jsxs(vr,{children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,children:" Interactive Maps"}),D.jsx(yt,{variant:"body2",color:"text.secondary",children:"Visual representation of all transport routes in Cebu City"})]})})}),D.jsx(er,{item:!0,xs:12,md:4,children:D.jsx(fr,{children:D.jsxs(vr,{children:[D.jsx(yt,{variant:"h6",gutterBottom:!0,children:" Smart Search"}),D.jsx(yt,{variant:"body2",color:"text.secondary",children:"Find routes by origin, destination, or route code"})]})})})]}),D.jsxs(lc,{elevation:2,sx:{p:4,mt:4,textAlign:"center",background:"linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%)"},children:[D.jsx(yt,{variant:"h5",gutterBottom:!0,children:"Ready to explore Cebu transport?"}),D.jsx(yt,{variant:"body1",sx:{mb:3},children:"Start chatting with CeBot or explore the interactive map"}),D.jsxs(Pt,{sx:{display:"flex",gap:2,justifyContent:"center",flexWrap:"wrap"},children:[D.jsx(ro,{component:$l,to:"/chat",variant:"contained",size:"large",startIcon:D.jsx(Gf,{}),children:"Start Chatting"}),D.jsx(ro,{component:$l,to:"/map",variant:"outlined",size:"large",startIcon:D.jsx(Kd,{}),children:"View Map"})]})]})]})},NX=US({palette:{primary:{main:"#1976d2"},secondary:{main:"#ff9800"},background:{default:"#f5f5f5"}},typography:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',h4:{fontWeight:600},h5:{fontWeight:600}},components:{MuiCssBaseline:{styleOverrides:{"@globalThis":{"@keyframes fadeIn":{"0%":{opacity:0,transform:"translateY(10px)"},"100%":{opacity:1,transform:"translateY(0)"}}}}},MuiCard:{styleOverrides:{root:{borderRadius:12,boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"}}},MuiButton:{styleOverrides:{root:{borderRadius:8,textTransform:"none",fontWeight:600}}}}});function $X(){return console.log("API URL:","https://cebot-api.vercel.app"),console.log("MAPBOX Token:","pk.eyJ1IjoiZ2lvZGVsYXBlbmEiLCJhIjoiY21leXk3MHc5MHo4djJtb29mbHl5bHN1cCJ9.-mAPWY3XRKsQ5YmLEvMtNA"),D.jsxs(e9,{theme:NX,children:[D.jsx(o9,{}),D.jsx(w$,{children:D.jsxs(Pt,{sx:{minHeight:"100vh",backgroundColor:"background.default",display:"flex",flexDirection:"column"},children:[D.jsx(NZ,{}),D.jsx(ZS,{maxWidth:"xl",sx:{py:{xs:2,md:3},px:{xs:1,sm:2,md:3},flex:1},children:D.jsxs(m$,{children:[D.jsx(Uf,{path:"/",element:D.jsx(jX,{})}),D.jsx(Uf,{path:"/chat",element:D.jsx(DX,{})}),D.jsx(Uf,{path:"/map",element:D.jsx(BX,{})}),D.jsx(Uf,{path:"/search",element:D.jsx(FX,{})})]})}),D.jsx($Z,{})]})})]})}Ob.createRoot(document.getElementById("root")).render(D.jsx(Do.StrictMode,{children:D.jsx(N4,{store:EN,children:D.jsx($X,{})})}));
//# sourceMappingURL=index-82d69ed9.js.map
